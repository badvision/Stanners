{"b3e1c8a45e9ead1235a997ca3bcc677f0371216c":{"changes":{"test\/pom.xml":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenBuild.java":"MODIFY","test\/src\/test\/java\/hudson\/maven\/MavenBuildTest.java":"MODIFY"},"diff":{"test\/pom.xml":[{"add":["44","          <!-- override with -DforkMode=pertest if you have \"unable to create thread problems\" on Windows -->","51","              <!-- use AntClassLoader that supports predictable file handle release -->","110","      <groupId>org.jvnet.hudson.plugins<\/groupId>","111","      <artifactId>subversion<\/artifactId>","112","      <version>1.7<\/version>","113","    <\/dependency>","114","    <dependency>"],"delete":["44","          <!-- override with -DforkMode=pertest if you have \"unable to create thread problems\" on Windows","45","-->","52","              <!-- use AntClassLoader that supports predictable file handle release","53","-->"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenBuild.java":[{"add":["480","            return wsl.allocate(getModuleSetBuild().getModuleRoot().child(getProject().getRelativePath()));"],"delete":["480","            return wsl.allocate(getParentBuild().getModuleRoot().child(getProject().getRelativePath()));"]}],"test\/src\/test\/java\/hudson\/maven\/MavenBuildTest.java":[{"add":["6","import hudson.scm.SubversionSCM;","36","        m.setGoals(\"clean install findbugs:findbugs\");","47","        m.setGoals(\"clean install\");","60","","61","    \/**","62","     * Workspace determination problem on non-aggregator style build.","63","     *\/","64","    @Bug(4226)","65","    public void testParallelModuleBuild() throws Exception {","66","        configureDefaultMaven();","67","        MavenModuleSet m = createMavenProject();","68","        m.setScm(new SubversionSCM(\"https:\/\/www.dev.java.net\/svn\/hudson\/trunk\/hudson\/test-projects\/multimodule-maven\"));","69","        m.setAggregatorStyleBuild(false);","70","","71","        assertBuildStatusSuccess(m.scheduleBuild2(0).get());","72","        \/\/ run module builds","73","        assertBuildStatusSuccess(m.getModule(\"test$module1\").scheduleBuild2(0).get());","74","        assertBuildStatusSuccess(m.getModule(\"test$module1\").scheduleBuild2(0).get());","75","    }"],"delete":["35","\tm.setGoals(\"clean install findbugs:findbugs\");","46","\tm.setGoals(\"clean install\");"]}]}},"346fc998b16f2021cbd6b3bb1cd1878a2b19ff5b":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Run\/console.jelly":"MODIFY","core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY","core\/src\/main\/java\/hudson\/console\/AnnotatedLargeText.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Run\/console.jelly":[{"add":["37","      <j:set var=\"offset\" value=\"${empty(consoleFull) ? it.logText.length()-threshold*1024 : 0}\" \/>"],"delete":["37","      <j:set var=\"offset\" value=\"${empty(consoleFull) ? it.logFile.length()-threshold*1024 : 0}\" \/>"]}],"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["1163","        File rawF = new File(getRootDir(), \"log\");","1164","        if (rawF.isFile()) {","1165","            return rawF;","1166","        }","1167","        File gzF = new File(getRootDir(), \"log.gz\");","1168","        if (gzF.isFile()) {","1169","            return gzF;","1170","        }","1171","        \/\/If both fail, return the standard, uncompressed log file","1172","        return rawF;","1185","    \t","1186","    \tif (logFile != null && logFile.exists() ) {","1187","    \t    \/\/ Checking if a \".gz\" file was return","1188","    \t    FileInputStream fis = new FileInputStream(logFile);","1189","    \t    if (logFile.getName().endsWith(\".gz\")) {","1190","    \t        return new GZIPInputStream(fis);","1191","    \t    } else {","1192","    \t        return fis;","1193","    \t    }"],"delete":["1163","        return new File(getRootDir(),\"log\");","1176","    \tif (logFile.exists() ) {","1177","            return new FileInputStream(logFile);","1178","    \t}","1179","","1180","    \tFile compressedLogFile = new File(logFile.getParentFile(), logFile.getName()+ \".gz\");","1181","    \tif (compressedLogFile.exists()) {","1182","            return new GZIPInputStream(new FileInputStream(compressedLogFile));"]}],"core\/src\/main\/java\/hudson\/console\/AnnotatedLargeText.java":[{"add":["79","        super(file, charset, completed, true);"],"delete":["79","        super(file, charset, completed);"]}]}},"0311b2dffa76ba01748b1be6a18fc7c1955e65fe":{"changes":{"test\/src\/test\/resources\/plugins\/jenkins-47406.hpi":"ADD","test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"test\/src\/test\/resources\/plugins\/jenkins-47406.hpi":[{"add":[],"delete":[]}],"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":[{"add":["25","import static hudson.init.InitMilestone.*;","47","import hudson.init.Initializer;","76","import org.jvnet.hudson.test.recipes.WithPlugin;","88","import java.util.logging.Logger;","689","","690","    @Issue(\"JENKINS-47406\")","691","    @Test","692","    @WithPlugin(\"jenkins-47406.hpi\") \/\/ Sources: https:\/\/github.com\/Vlatombe\/jenkins-47406","693","    public void jobCreatedByInitializerIsRetained() {","694","        assertNotNull(\"JENKINS-47406 should exist\", j.jenkins.getItem(\"JENKINS-47406\"));","695","    }"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3056","        List<Handle> loadJobs = new ArrayList<>();","3058","            loadJobs.add(g.requires(loadJenkins).attains(JOB_LOADED).notFatal().add(\"Loading item \" + subdir.getName(), new Executable() {","3068","            }));","3071","        g.requires(loadJobs.toArray(new Handle[loadJobs.size()])).attains(JOB_LOADED).add(\"Cleaning up obsolete items deleted from the disk\", new Executable() {"],"delete":["3057","            g.requires(loadJenkins).attains(JOB_LOADED).notFatal().add(\"Loading item \" + subdir.getName(), new Executable() {","3067","            });","3070","        g.requires(JOB_LOADED).attains(COMPLETED).add(\"Cleaning up obsolete items deleted from the disk\", new Executable() {"]}]}},"82e57cb8e4fb710735b1cd633e0ad60f25024b0b":{"changes":{"changelog.html":"MODIFY","war\/src\/main\/webapp\/images\/title.png":"MODIFY"},"diff":{"changelog.html":[{"add":["67","  <li class=bug>","68","    Fixed background of title image","69","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9571\">issue 9571<\/a>)"],"delete":[]}],"war\/src\/main\/webapp\/images\/title.png":[{"add":[],"delete":[]}]}},"a0bc50fb887c5046aecbacadf6c12d8702143261":{"changes":{"core\/src\/main\/java\/jenkins\/telemetry\/impl\/UserLanguages.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/telemetry\/impl\/UserLanguages.java":[{"add":["43","import java.util.HashMap;","54","    private static volatile Map<String, AtomicLong> requestsByLanguage = new HashMap<>();","86","        requestsByLanguage = new HashMap<>();","87","        Map<String, AtomicLong> sortedRequests = new TreeMap<>(currentRequests);","88","        for (Map.Entry<String, AtomicLong> entry : sortedRequests.entrySet()) {"],"delete":["53","    private static volatile Map<String, AtomicLong> requestsByLanguage = new TreeMap<>();","85","        requestsByLanguage = new TreeMap<>();","86","        for (Map.Entry<String, AtomicLong> entry : currentRequests.entrySet()) {"]}]}},"676ef12fc7467ba320e69bf710ffeec34c53367c":{"changes":{"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_it.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_bg.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_cs.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_ja.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_sl.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_de.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_es.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_lt.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_zh_TW.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_hu.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_uk.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_fi.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_da.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_nl.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_lv.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_et.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_pl.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_pt_PT.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_pt_BR.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_fr.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_sk.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_nb_NO.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_ko.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_ru.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_it.properties":[{"add":["23","  (<a href=\"{2}\">log delle modifiche<\/a>)."],"delete":["23","  (<a href=\"${changelog.url}\">log delle modifiche<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_bg.properties":[{"add":["31"," (<a href=\"{2}\">\\u0441\\u043f\\u0438\\u0441\\u044a\\u043a \\u0441 \\u043f\\u0440\\u043e\\u043c\\u0435\\u043d\\u0438\\u0442\\u0435<\/a>)."],"delete":["31"," (<a href=\"${changelog.url}\">\\u0441\\u043f\\u0438\\u0441\\u044a\\u043a \\u0441 \\u043f\\u0440\\u043e\\u043c\\u0435\\u043d\\u0438\\u0442\\u0435<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_cs.properties":[{"add":["22","NewVersionAvailable=Nov\\u00E1 verze Jenkins-u ({0}) je k dispozici <a href=\"{1}\">ke sta\\u017Een\\u00ED<\/a> (<a href=\"{2}\">changelog<\/a>)."],"delete":["22","NewVersionAvailable=Nov\\u00E1 verze Jenkins-u ({0}) je k dispozici <a href=\"{1}\">ke sta\\u017Een\\u00ED<\/a> (<a href=\"${changelog.url}\">changelog<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_ja.properties":[{"add":["22","NewVersionAvailable=Jenkins\\u306E\\u65B0\\u3057\\u3044\\u30D0\\u30FC\\u30B8\\u30E7\\u30F3({0})\\u3092<a href=\"{1}\">\\u30C0\\u30A6\\u30F3\\u30ED\\u30FC\\u30C9<\/a>\\u3067\\u304D\\u307E\\u3059 (<a href=\"{2}\">\\u5909\\u66F4\\u5C65\\u6B74<\/a>)\\u3002"],"delete":["22","NewVersionAvailable=Jenkins\\u306E\\u65B0\\u3057\\u3044\\u30D0\\u30FC\\u30B8\\u30E7\\u30F3({0})\\u3092<a href=\"{1}\">\\u30C0\\u30A6\\u30F3\\u30ED\\u30FC\\u30C9<\/a>\\u3067\\u304D\\u307E\\u3059 (<a href=\"${changelog.url}\">\\u5909\\u66F4\\u5C65\\u6B74<\/a>)\\u3002"]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_sl.properties":[{"add":["2","NewVersionAvailable=Nova razli\\u010Dica Jenkins-a ({0}) je na voljo za <a href=\"{1}\">prenos<\/a> (<a href=\"{2}\">seznam sprememb<\/a>)."],"delete":["2","NewVersionAvailable=Nova razli\\u010Dica Jenkins-a ({0}) je na voljo za <a href=\"{1}\">prenos<\/a> (<a href=\"${changelog.url}\">seznam sprememb<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_de.properties":[{"add":["25","NewVersionAvailable=Eine neue Version von Jenkins ({0}) kann <a href=\"{1}\">hier heruntergeladen<\/a> werden (<a href=\"{2}\">Was ist neu?<\/a>)."],"delete":["25","NewVersionAvailable=Eine neue Version von Jenkins ({0}) kann <a href=\"{1}\">hier heruntergeladen<\/a> werden (<a href=\"${changelog.url}\">Was ist neu?<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_es.properties":[{"add":["22","NewVersionAvailable=Hay una nueva versi\\u00f3n de Jenkins disponible ({0}). <a href=\"{1}\">descargar<\/a> (<a href=\"{2}\">listado de cambios<\/a>)."],"delete":["22","NewVersionAvailable=Hay una nueva versi\\u00f3n de Jenkins disponible ({0}). <a href=\"{1}\">descargar<\/a> (<a href=\"${changelog.url}\">listado de cambios<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_lt.properties":[{"add":["2","NewVersionAvailable=Galima <a href=\"{1}\">parsisi\\u0173sti<\/a> nauj\\u0105 ({0}) Jenkins versij\\u0105. (<a href=\"{2}\">pakeitimai<\/a>)."],"delete":["2","NewVersionAvailable=Galima <a href=\"{1}\">parsisi\\u0173sti<\/a> nauj\\u0105 ({0}) Jenkins versij\\u0105. (<a href=\"${changelog.url}\">pakeitimai<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_zh_TW.properties":[{"add":["26","NewVersionAvailable=\\u65b0\\u7248\\u7684 Jenkins ({0}) \\u5df2\\u7d93\\u53ef\\u4ee5<a href=\"{1}\">\\u4e0b\\u8f09<\/a> (<a href=\"{2}\">\\u6539\\u7248\\u8a18\\u9304<\/a>)\\u3002"],"delete":["26","NewVersionAvailable=\\u65b0\\u7248\\u7684 Jenkins ({0}) \\u5df2\\u7d93\\u53ef\\u4ee5<a href=\"{1}\">\\u4e0b\\u8f09<\/a> (<a href=\"${changelog.url}\">\\u6539\\u7248\\u8a18\\u9304<\/a>)\\u3002"]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_hu.properties":[{"add":["22","NewVersionAvailable=A Jenkins \\u00FAj verzi\\u00F3ja ({0}) el\\u00E9rhet\\u0151 <a href=\"{1}\">let\\u00F6lt\\u00E9sre<\/a> (<a href=\"{2}\">v\\u00E1ltoz\\u00E1sok<\/a>)."],"delete":["22","NewVersionAvailable=A Jenkins \\u00FAj verzi\\u00F3ja ({0}) el\\u00E9rhet\\u0151 <a href=\"{1}\">let\\u00F6lt\\u00E9sre<\/a> (<a href=\"${changelog.url}\">v\\u00E1ltoz\\u00E1sok<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_uk.properties":[{"add":["22","NewVersionAvailable=\\u041D\\u043E\\u0432\\u0430 \\u0432\\u0435\\u0440\\u0441\\u0456\\u044F \\u0414\\u0436\\u0435\\u043D\\u043A\\u0456\\u043D\\u0441 ({0}) \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430 \\u0434\\u043B\\u044F <a href=\"{1}\">\\u0437\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F<\/a> (<a href=\"{2}\">\\u0437\\u043C\\u0456\\u043D\\u0438<\/a>)."],"delete":["22","NewVersionAvailable=\\u041D\\u043E\\u0432\\u0430 \\u0432\\u0435\\u0440\\u0441\\u0456\\u044F \\u0414\\u0436\\u0435\\u043D\\u043A\\u0456\\u043D\\u0441 ({0}) \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430 \\u0434\\u043B\\u044F <a href=\"{1}\">\\u0437\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F<\/a> (<a href=\"${changelog.url}\">\\u0437\\u043C\\u0456\\u043D\\u0438<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_fi.properties":[{"add":["2","NewVersionAvailable=Uusi Jenkinsin versio ({0}) on <a href=\"{1}\">saatavana<\/a> (<a href=\"{2}\">muutosloki<\/a>)."],"delete":["2","NewVersionAvailable=Uusi Jenkinsin versio ({0}) on <a href=\"{1}\">saatavana<\/a> (<a href=\"${changelog.url}\">muutosloki<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_da.properties":[{"add":["27","  (<a href=\"${2}\">changelog<\/a>)."],"delete":["27","  (<a href=\"${changelog.url}\">changelog<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_nl.properties":[{"add":["22","NewVersionAvailable=Er is een nieuwere versie van Jenkins ({0}) beschikbaar. <a href=\"{1}\">downloaden<\/a> (<a href=\"{2}\">changelog<\/a>)."],"delete":["22","NewVersionAvailable=Er is een nieuwere versie van Jenkins ({0}) beschikbaar. <a href=\"{1}\">downloaden<\/a> (<a href=\"${changelog.url}\">changelog<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_lv.properties":[{"add":["22","NewVersionAvailable=Jauna Jenkins ({0}) versija ir pieejama <a href=\"{1}\">lejupl\\u0101dei<\/a> (<a href=\"{2}\">izmai\\u0146as<\/a>)."],"delete":["22","NewVersionAvailable=Jauna Jenkins ({0}) versija ir pieejama <a href=\"{1}\">lejupl\\u0101dei<\/a> (<a href=\"${changelog.url}\">izmai\\u0146as<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_et.properties":[{"add":["2","NewVersionAvailable=Jenkinsi uus versioon ({0}) on saadaval <a href=\"{1}\">allalaadimiseks<\/a> (<a href=\"{2}\">muudatuste nimekiri<\/a>)."],"delete":["2","NewVersionAvailable=Jenkinsi uus versioon ({0}) on saadaval <a href=\"{1}\">allalaadimiseks<\/a> (<a href=\"${changelog.url}\">muudatuste nimekiri<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_pl.properties":[{"add":["21","NewVersionAvailable=Nowa wersja Jenkinsa ({0}) jest dost\\u0119pna do <a href=\"{1}\">pobrania<\/a> (<a href=\"{2}\">historia zmian<\/a>)."],"delete":["21","NewVersionAvailable=Nowa wersja Jenkinsa ({0}) jest dost\\u0119pna do <a href=\"{1}\">pobrania<\/a> (<a href=\"${changelog.url}\">historia zmian<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_pt_PT.properties":[{"add":["2","NewVersionAvailable=Uma nova vers\\u00E3o do Jenkins ({0}) est\\u00E1 dispon\\u00EDvel para <a href=\"{1}\">download<\/a> (<a href=\"{2}\">registo de altera\\u00E7\\u00F5es<\/a>)."],"delete":["2","NewVersionAvailable=Uma nova vers\\u00E3o do Jenkins ({0}) est\\u00E1 dispon\\u00EDvel para <a href=\"{1}\">download<\/a> (<a href=\"${changelog.url}\">registo de altera\\u00E7\\u00F5es<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_pt_BR.properties":[{"add":["29","# (<a href=\"{2}\">changelog<\/a>)."],"delete":["29","# (<a href=\"${changelog.url}\">changelog<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_fr.properties":[{"add":["22","NewVersionAvailable=Une nouvelle version de Jenkins ({0}) est <a href=\"{1}\">disponible<\/a> (<a href=\"{2}\">changelog<\/a>)."],"delete":["22","NewVersionAvailable=Une nouvelle version de Jenkins ({0}) est <a href=\"{1}\">disponible<\/a> (<a href=\"${changelog.url}\">changelog<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_sk.properties":[{"add":["22","NewVersionAvailable=Nov\\u00E1 verzia Jenkins ({0}) je dostupn\\u00E1 na <a href=\"{1}\">stiahnutie<\/a> (<a href=\"{2}\">zoznam zmien<\/a>)."],"delete":["22","NewVersionAvailable=Nov\\u00E1 verzia Jenkins ({0}) je dostupn\\u00E1 na <a href=\"{1}\">stiahnutie<\/a> (<a href=\"${changelog.url}\">zoznam zmien<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_nb_NO.properties":[{"add":["22","NewVersionAvailable=En ny versjon av Jenkins ({0}) er <a href=\"{1}\">n\\u00E5 tilgjengelig<\/a> (<a href=\"{2}\">Endringer<\/a>)."],"delete":["22","NewVersionAvailable=En ny versjon av Jenkins ({0}) er <a href=\"{1}\">n\\u00E5 tilgjengelig<\/a> (<a href=\"${changelog.url}\">Endringer<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_ko.properties":[{"add":["22","NewVersionAvailable=Jenkins \\uC2E0\\uADDC\\uBC84\\uC804({0})\\uC744  <a href=\"{1}\">\\uC5EC\\uAE30<\/a>\\uC11C \\uBC1B\\uC744 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.(<a href=\"{2}\">\\uBCC0\\uACBD\\uC0AC\\uD56D<\/a>)."],"delete":["22","NewVersionAvailable=Jenkins \\uC2E0\\uADDC\\uBC84\\uC804({0})\\uC744  <a href=\"{1}\">\\uC5EC\\uAE30<\/a>\\uC11C \\uBC1B\\uC744 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.(<a href=\"${changelog.url}\">\\uBCC0\\uACBD\\uC0AC\\uD56D<\/a>)."]}],"core\/src\/main\/resources\/hudson\/model\/UpdateCenter\/CoreUpdateMonitor\/message_ru.properties":[{"add":["22","NewVersionAvailable=\\u041d\\u043e\\u0432\\u0430\\u044f \\u0432\\u0435\\u0440\\u0441\\u0438\\u044f Jenkins ({0}) \\u0434\\u043e\\u0441\\u0442\\u0443\\u043f\\u043d\\u0430 \\u0434\\u043b\\u044f <a href=\"{1}\">\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043a\\u0438<\/a> (<a href=\"{2}\">\\u0441\\u043f\\u0438\\u0441\\u043e\\u043a \\u0438\\u0437\\u043c\\u0435\\u043d\\u0435\\u043d\\u0438\\u0439<\/a>)."],"delete":["22","NewVersionAvailable=\\u041d\\u043e\\u0432\\u0430\\u044f \\u0432\\u0435\\u0440\\u0441\\u0438\\u044f Jenkins ({0}) \\u0434\\u043e\\u0441\\u0442\\u0443\\u043f\\u043d\\u0430 \\u0434\\u043b\\u044f <a href=\"{1}\">\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043a\\u0438<\/a> (<a href=\"${changelog.url}\">\\u0441\\u043f\\u0438\\u0441\\u043e\\u043a \\u0438\\u0437\\u043c\\u0435\\u043d\\u0435\\u043d\\u0438\\u0439<\/a>)."]}]}},"bcf55ecd7f8a22046c5cb3c4c50016d936e5460c":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractCIBase.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Node.java":"MODIFY","core\/src\/main\/java\/hudson\/slaves\/RetentionStrategy.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractCIBase.java":[{"add":["41","import javax.annotation.Nonnull;","128","                try {","129","                    c = n.createComputer();","130","                } catch(RuntimeException ex) { \/\/ Just in case there is a bogus extension","131","                    LOGGER.log(Level.WARNING, \"Error retrieving computer for node \" + n.getNodeName() + \", continuing\", ex);","132","                }","133","                if (c == null) {","134","                    LOGGER.log(Level.WARNING, \"Cannot create computer for node {0}, the {1}#createComputer() method returned null. Skipping this node\", ","135","                            new Object[]{n.getNodeName(), n.getClass().getName()});","136","                    return;","137","                }","138","                ","139","                computers.put(n, c);","150","                used.add(c);","151","            } else {","152","                \/\/ TODO: Maybe it should be allowed, but we would just get NPE in the original logic before JENKINS-43496","153","                LOGGER.log(Level.WARNING, \"Node {0} has no executors. Cannot update the Computer instance of it\", n.getNodeName());","201","                Set<Computer> used = new HashSet<>(old.size());"],"delete":["127","                computers.put(n, c = n.createComputer());","139","            used.add(c);","186","                Set<Computer> used = new HashSet<Computer>(old.size());"]}],"core\/src\/main\/java\/hudson\/model\/Node.java":[{"add":["42","import hudson.slaves.Cloud;","68","import org.kohsuke.accmod.Restricted;","69","import org.kohsuke.accmod.restrictions.ProtectedExternally;","219","     * ","221","     * @return Created instance of the computer.","222","     *         Can be {@code null} if the {@link Node} implementation does not support it (e.g. {@link Cloud} agent).","224","    @CheckForNull","225","    @Restricted(ProtectedExternally.class)"],"delete":[]}],"core\/src\/main\/java\/hudson\/slaves\/RetentionStrategy.java":[{"add":["41","import javax.annotation.Nonnull;","60","    public abstract long check(@Nonnull T c);","95","     * @param c Computer instance","98","    public void start(final @Nonnull T c) {"],"delete":["59","    public abstract long check(T c);","96","    public void start(final T c) {"]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3053","    @Override","3054","    @Nonnull"],"delete":[]}]}},"1421ca15d5a36706214476e613eeab789b9066df":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenEmbedderRequest.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenUtil.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenEmbedderRequest.java":[{"add":["85","","86","    \/**","87","     * @since 1.461","88","     *\/","89","    private boolean updateSnapshots;","231","","232","    public MavenEmbedderRequest setUpdateSnapshots(boolean updateSnapshots) {","233","      this.updateSnapshots = updateSnapshots;","234","      return this;","235","    }","236","    ","237","    public boolean isUpdateSnapshots() {","238","      return updateSnapshots;","239","    }"],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["1071","        private boolean updateSnapshots = false;","1072","        ","1083","            this.updateSnapshots = isUpdateSnapshots(project.getGoals());","1126","        private boolean isUpdateSnapshots(String goals) {","1127","          return StringUtils.contains(goals, \"-U\") || StringUtils.contains(goals, \"--update-snapshots\");","1128","        }","1129","","1195","                mavenEmbedderRequest.setUpdateSnapshots( this.updateSnapshots );"],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenUtil.java":[{"add":["178","        mavenRequest.setUpdateSnapshots(mavenEmbedderRequest.isUpdateSnapshots());","179",""],"delete":[]}],"changelog.html":[{"add":["58","    Flag -U is not used during the parsing step of a Maven Job","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-8663\">issue 8663<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"2fd5f247c4aa1fa92f11f9be9d26cf17a27ea142":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["60","  <li class=bug>","61","    When installing plugins with overlapping dependencies, Jenkins downloads the duplicate plugins multiple times.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10569\">issue 10569<\/a>)"],"delete":[]}]}},"47bc6d38c72f31babf2d453e87ccdf4c40f1f2a5":{"changes":{"test\/src\/test\/groovy\/hudson\/matrix\/MatrixProjectTest.groovy":"MODIFY","core\/src\/main\/java\/hudson\/model\/FileParameterValue.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"test\/src\/test\/groovy\/hudson\/matrix\/MatrixProjectTest.groovy":[{"add":["3"," * Copyright (c) 2004-2011, Sun Microsystems, Inc., CloudBees, Inc.","50","import hudson.model.ParametersDefinitionProperty","51","import hudson.model.FileParameterDefinition","52","import hudson.model.Cause.LegacyCodeCause","53","import hudson.model.ParametersAction","54","import hudson.model.FileParameterValue","297","","298","    @Bug(10108)","299","    void testTwoFileParams() {","300","        def p = createMatrixProject();","301","        p.axes = new AxisList(new TextAxis(\"foo\",\"1\",\"2\",\"3\",\"4\"));","302","        p.addProperty(new ParametersDefinitionProperty(","303","            new FileParameterDefinition(\"a.txt\",\"\"),","304","            new FileParameterDefinition(\"b.txt\",\"\"),","305","        ));","306","","307","        def dir = createTmpDir()","308","        def f = p.scheduleBuild2(0,new LegacyCodeCause(),new ParametersAction(","309","            [\"aaa\",\"bbb\"].collect { it ->","310","                def v = new FileParameterValue(it+\".txt\",File.createTempFile(it,\"\", dir),it)","311","                v.setLocation(it)","312","                return v;","313","            }","314","        ))","315","        ","316","        assertBuildStatusSuccess(f.get(10,TimeUnit.SECONDS));","317","    }"],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc."]}],"core\/src\/main\/java\/hudson\/model\/FileParameterValue.java":[{"add":["59","    private final FileItem file;"],"delete":["59","    private FileItem file;","109","            \t    file = null;"]}],"changelog.html":[{"add":["66","  <li class=bug>","67","    File parameter didn't work correctly with matrix projects","68","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10108\">issue 10108<\/a>)"],"delete":[]}]}},"339f01f382f3ec93339e424b38b38bbd83d01c38":{"changes":{"core\/src\/main\/resources\/hudson\/model\/View\/AsynchPeople\/index_pl.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages_pl.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/View\/AsynchPeople\/index_pl.properties":[{"add":["28","blurb=Prezentuje wszystkich uwierzytelnionych u\\u017Cytkownik\\u00F3w w\\u0142\\u0105cznie z identyfikatorem oraz osoby wymienione w opisach zarejestrowanych zmian."],"delete":["28","blurb=Prezentuje wszystkich uwierzytelnionych u\\u017Cytkownik\\u00F3w w\\u0142\\u0105cznie z identyfikuj\\u0105cym loginem oraz osoby wymienione w opisach zarejestrowanych zmianach."]}],"core\/src\/main\/resources\/hudson\/model\/Messages_pl.properties":[{"add":["40","UpdateCenter.DownloadButNotActivated=Pobrana pomy\\u015Blnie. Zostanie w\\u0142\\u0105czona podczas ponownego uruchomienia Jenkinsa"],"delete":["40","UpdateCenter.DownloadButNotActivated=Pobrana pomy\\u015Blnie. Zostanie w\\u0142\\u0105czony podczas kolejnego restartu Jenkinsa"]}]}},"6763eb88e87638a05f699152937ff6ba44a8aef9":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["1218","        return new Graph(getLastBuildTime(),500,400) {","1352","    private Calendar getLastBuildTime() {","1353","        final RunT lastBuild = getLastBuild();","1354","        if (lastBuild ==null) {","1355","            final GregorianCalendar neverBuiltCalendar = new GregorianCalendar();","1356","            neverBuiltCalendar.setTimeInMillis(0);","1357","            return neverBuiltCalendar;","1358","        }","1359","        return lastBuild.getTimestamp();","1360","    }","1361",""],"delete":["1218","        return new Graph(getLastBuild().getTimestamp(),500,400) {"]}]}},"27569a965a80caa1352e67c255065b5a67cb1a27":{"changes":{"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":"MODIFY","test\/src\/test\/java\/jenkins\/install\/InstallUtilTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":[{"add":["64","import hudson.util.VersionNumber;","604","","605","    @Issue(\"JENKINS-42577\")","606","    @Test","607","    public void versionIsSavedInSave() throws Exception {","608","        Jenkins.VERSION = \"1.0\";","609","        j.jenkins.save();","610","        VersionNumber storedVersion = Jenkins.getStoredVersion();","611","        assertNotNull(storedVersion);","612","        assertEquals(storedVersion.toString(), \"1.0\");","613","","614","        Jenkins.VERSION = null;","615","        j.jenkins.save();","616","        VersionNumber nullVersion = Jenkins.getStoredVersion();","617","        assertNull(nullVersion);","618","    }"],"delete":[]}],"test\/src\/test\/java\/jenkins\/install\/InstallUtilTest.java":[{"add":["82","        InstallUtil.getLastExecVersionFile().delete();","83","        InstallUtil.getConfigFile().delete();","84","        ","131","        Jenkins.VERSION = version;","134","        Assert.assertEquals(version, Jenkins.getStoredVersion().toString());"],"delete":["25","import java.lang.reflect.Field;","129","        Field versionField = Jenkins.class.getDeclaredField(\"version\");","130","        versionField.setAccessible(true);","131","        versionField.set(jenkinsRule.jenkins, version);","132","        Assert.assertEquals(version, Jenkins.getStoredVersion().toString());"]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3183","        version = VERSION;","3184","","3662","            "],"delete":["3660","","3661","            version = VERSION;","3662",""]}]}},"780257d51081369cc0550d0e45bb014275303028":{"changes":{"core\/src\/main\/resources\/hudson\/node_monitors\/Messages_fr.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/node_monitors\/Messages_fr.properties":[{"add":["23","ClockMonitor.DisplayName=Différence entre les horloges","25","DiskSpaceMonitor.MarkedOffline=Déconnexion temporaire de {0} par cause de manque d''espace disque","26","ResponseTimeMonitor.DisplayName=Temps de réponse","27","ResponseTimeMonitor.MarkedOffline={0} est marqué comme déconnecté temporairement, parce qu''il ne répond pas"],"delete":["23","ClockMonitor.DisplayName=Diff\\u00C3\\u00A9rence entre les horloges","25","DiskSpaceMonitor.MarkedOffline=D\\u00C3\\u00A9connexion temporaire de {0} par cause de manque d''espace disque","26","ResponseTimeMonitor.DisplayName=Temps de r\\u00C3\\u00A9ponse","27","ResponseTimeMonitor.MarkedOffline={0} est marqu\\u00C3\\u00A9 comme d\\u00C3\\u00A9connect\\u00C3\\u00A9 temporairement, parce qu''il ne r\\u00C3\\u00A9pond pas"]}]}},"36e79456403ca6a4f51d43dde39351e83aef6462":{"changes":{"core\/src\/main\/resources\/hudson\/PluginManager\/table.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/PluginManager\/table.jelly":[{"add":["51","      ","52","      <div id=\"filter-container\">","53","        ${%Filter}:","54","        <input type=\"text\" id=\"filter-box\"\/>","55","      <\/div>","57","      <form method=\"post\" action=\"install\">"],"delete":["51","      <form method=\"post\" action=\"install\">","52","        <div id=\"filter-container\">","53","          ${%Filter}:","54","          <input type=\"text\" id=\"filter-box\"\/>","55","        <\/div>"]}]}},"6a2e907e7d4c00ae673a054cc3c65feb24f559de":{"changes":{"core\/src\/main\/java\/hudson\/model\/AllView.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AllView.java":[{"add":["122","     * {@code primaryView = migrateLegacyPrimaryAllViewLocalizedName(views, primaryView)}","165","                                new Object[] {allView.owner, primaryView, DEFAULT_VIEW_NAME});"],"delete":["29","import javax.annotation.CheckForNull;","123","     * {@code primaryView = applyJenkins38606Fixup(views, primaryView)}","166","                                new Object[]{allView.owner.getUrl(), primaryView, DEFAULT_VIEW_NAME});"]}]}},"312fcd1b9ebb5f4ce396c2b7cc93659edd6301c1":{"changes":{"core\/src\/main\/java\/hudson\/triggers\/Trigger.java":"MODIFY","core\/src\/main\/java\/hudson\/triggers\/SlowTriggerAdminMonitor.java":"ADD","core\/src\/main\/resources\/hudson\/triggers\/SlowTriggerAdminMonitor\/message.groovy":"ADD","test\/src\/test\/java\/jenkins\/triggers\/TriggerTest.java":"ADD","core\/src\/main\/resources\/hudson\/triggers\/Messages.properties":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/triggers\/Trigger.java":[{"add":["31","import hudson.Util;","278","                                long begin_time = System.currentTimeMillis();","280","                                long end_time = System.currentTimeMillis();","281","                                if ((end_time - begin_time) > CRON_THRESHOLD) {","282","                                    final String msg = String.format(\"Trigger %s.run() triggered by %s spent too much time \"","283","                                                    + \"(%s) in its execution, other timers can be affected\",","284","                                            t.getClass().getName(), p, Util.getTimeSpanString(end_time - begin_time));","285","                                    LOGGER.log(Level.WARNING, msg);","286","                                    SlowTriggerAdminMonitor.getInstance().report(t.getClass().getName(), msg);","287","                                }","304","    public static long CRON_THRESHOLD = 1000*30;    \/\/ Default threshold 30s","305",""],"delete":[]}],"core\/src\/main\/java\/hudson\/triggers\/SlowTriggerAdminMonitor.java":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/hudson\/triggers\/SlowTriggerAdminMonitor\/message.groovy":[{"add":[],"delete":[]}],"test\/src\/test\/java\/jenkins\/triggers\/TriggerTest.java":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/hudson\/triggers\/Messages.properties":[{"add":["37","SlowTriggerAdminMonitor.DisplayName=Cron Triggers Monitor"],"delete":[]}]}},"1186e7b4047a70162a1a3be399fc449ae3b0e1f5":{"changes":{"core\/src\/main\/java\/hudson\/model\/JDK.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/JDK.java":[{"add":["184","","185","            \/\/ JENKINS-25601: JDK 9+ no longer has tools.jar. Keep the existing dt.jar\/tools.jar checks to be safe.","186","            File javac = new File(value, \"bin\/javac\");","187","            File javacExe = new File(value, \"bin\/javac.exe\");","188","            if(!toolsJar.exists() && !mac.exists() && !javac.exists() && !javacExe.exists())"],"delete":["184","            if(!toolsJar.exists() && !mac.exists())"]}]}},"780b38bc755028f4c4d72378896407a182bd5b30":{"changes":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["2995","        if(\".\".equals(name.trim())) ","2996","            throw new Failure(Messages.Jenkins_NotAllowedName(\".\"));"],"delete":[]}]}},"088edabb31a90cd607f3c6a3123effce5703c817":{"changes":{"core\/src\/main\/java\/hudson\/model\/User.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/UserTest.java":"MODIFY","changelog.html":"MODIFY","test\/src\/test\/resources\/hudson\/model\/UserTest\/migration.zip":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/model\/User.java":[{"add":["386","                for (File legacyUserDir : legacy) {","387","                    final XmlFile legacyXml = new XmlFile(XSTREAM, new File(legacyUserDir, \"config.xml\"));","391","                            if (idStrategy().equals(id, legacyUserDir.getName()) && !idStrategy().filenameOf(legacyUserDir.getName())","392","                                    .equals(legacyUserDir.getName())) {","393","                                if (!legacyUserDir.renameTo(configFile.getParentFile())) {","394","                                    LOGGER.log(Level.WARNING, \"Failed to migrate user record from {0} to {1}\",","395","                                            new Object[]{legacyUserDir, configFile.getParentFile()});","399","                        } else {","400","                            LOGGER.log(Level.FINE, \"Unexpected object loaded from {0}: {1}\",","401","                                    new Object[]{ legacyUserDir, o });","404","                        LOGGER.log(Level.FINE, String.format(\"Exception trying to load user from {0}: {1}\",","405","                                new Object[]{ legacyUserDir, e.getMessage() }), e);"],"delete":["386","                for (File p : legacy) {","387","                    final XmlFile legacyXml = new XmlFile(XSTREAM, new File(p, \"config.xml\"));","391","                            User tmp = (User) o;","392","                            if (idStrategy().equals(id, tmp.getId()) && !idStrategy().filenameOf(tmp.getId())","393","                                    .equals(p.getParentFile().getName())) {","394","                                if (!p.getParentFile().renameTo(configFile.getParentFile())) {","395","                                    LOGGER.log(Level.FINE, \"Could not migrate user record from {0} to {1}\",","396","                                            new Object[]{p.getParentFile(), configFile.getParentFile()});","402","                        \/\/ ignore"]}],"test\/src\/test\/java\/hudson\/model\/UserTest.java":[{"add":["35","import java.io.File;","38","import java.util.Arrays;","51","import org.jvnet.hudson.test.Issue;","54","import org.jvnet.hudson.test.recipes.LocalData;","226","    @Issue(\"JENKINS-24317\")","227","    @LocalData","228","    @Test public void migration() throws Exception {","229","        User bob = User.get(\"bob\");","230","        assertEquals(\"Bob Smith\", bob.getFullName());","231","        assertEquals(\"Bob Smith\", User.get(\"Bob\").getFullName());","232","        assertEquals(\"nonexistent\", User.get(\"nonexistent\").getFullName());","233","        assertEquals(\"[bob]\", Arrays.toString(new File(j.jenkins.getRootDir(), \"users\").list()));","234","    }","235",""],"delete":[]}],"changelog.html":[{"add":["63","  <li class='major bug'>","64","    Failure to migrate legacy user records properly broke Jenkins.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-24317\">issue 24317<\/a>)"],"delete":[]}],"test\/src\/test\/resources\/hudson\/model\/UserTest\/migration.zip":[{"add":[],"delete":[]}]}},"4b6da0c3e4dfbb402d86f7a5124ca6e323b2c959":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["103","      <version>5.3<\/version>"],"delete":["103","      <version>5.8<\/version>"]}]}},"8a4cab3088c8800e6810000f2484ea7e22cc8744":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/AbstractDiskSpaceMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/TemporarySpaceMonitor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitor.java":[{"add":["48","","49","    public DiskSpaceMonitor() {}","50","    "],"delete":["48","\t"]}],"core\/src\/main\/java\/hudson\/node_monitors\/AbstractDiskSpaceMonitor.java":[{"add":["25","    public AbstractDiskSpaceMonitor() {","26","        this.freeSpaceThreshold = \"1GB\";","27","    }","28",""],"delete":[]}],"core\/src\/main\/java\/hudson\/node_monitors\/TemporarySpaceMonitor.java":[{"add":["50","","51","    public TemporarySpaceMonitor() {}","52",""],"delete":["50","\t"]}]}},"b5644ea25bb7bb49233bc950e199253cf72cb52f":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/settings\/SettingsProviderUtils.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/settings\/SettingsProviderUtils.java":[{"add":["29"," * @author Dominik Bartholdi (imod)","65","\t    return workspace.createTextTempFile(\"config\", \".tmp\", config.content, false);"],"delete":["20","import java.io.ByteArrayInputStream;","25","import org.apache.commons.io.IOUtils;","66","\t\tFile tmpContentFile = null;","67","\t\tByteArrayInputStream bs = null;","68","","69","\t\ttry {","70","\t\t\ttmpContentFile = File.createTempFile(\"config\", \"tmp\");","71","\t\t\tFilePath filePath = new FilePath(workspace, tmpContentFile.getName());","72","\t\t\tbs = new ByteArrayInputStream(config.content.getBytes());","73","\t\t\tfilePath.copyFrom(bs);","74","\t\t\treturn filePath;","75","\t\t} finally {","76","\t\t\tFileUtils.deleteQuietly(tmpContentFile);","77","\t\t\tIOUtils.closeQuietly(bs);","78","\t\t}"]}]}},"b6124e2ac3bb164ff12f0e3b1fe5fa7577bd46fc":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["91","      <version>5.0<\/version>"],"delete":["91","      <version>5.0-20180829.042035-1<\/version>"]}]}},"bb03d5ead8edc3eb36dd27dfcd5fa5603a2c09bc":{"changes":{"core\/src\/main\/resources\/hudson\/model\/View\/AsynchPeople\/index_pl.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages_pl.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/View\/AsynchPeople\/index_pl.properties":[{"add":["28","blurb=Prezentuje wszystkich uwierzytelnionych u\\u017Cytkownik\\u00F3w w\\u0142\\u0105cznie z identyfikatorem oraz osoby wymienione w opisach zarejestrowanych zmian."],"delete":["28","blurb=Prezentuje wszystkich uwierzytelnionych u\\u017Cytkownik\\u00F3w w\\u0142\\u0105cznie z identyfikuj\\u0105cym loginem oraz osoby wymienione w opisach zarejestrowanych zmianach."]}],"core\/src\/main\/resources\/hudson\/model\/Messages_pl.properties":[{"add":["40","UpdateCenter.DownloadButNotActivated=Pobrana pomy\\u015Blnie. Zostanie w\\u0142\\u0105czona podczas ponownego uruchomienia Jenkinsa"],"delete":["40","UpdateCenter.DownloadButNotActivated=Pobrana pomy\\u015Blnie. Zostanie w\\u0142\\u0105czony podczas kolejnego restartu Jenkinsa"]}]}},"cdbe303dd263ebb7b92f08c790ffc72e1842fd0b":{"changes":{"core\/src\/main\/resources\/hudson\/model\/FileParameterValue\/value.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/FileParameterValue\/value.jelly":[{"add":["29","            <j:invokeStatic var=\"encodedName\" className=\"hudson.Util\" method=\"rawEncode\">","30","                <j:arg value=\"${it.name}\" \/>","31","            <\/j:invokeStatic>","32","            <a href=\"parameter\/${encodedName}\/${it.originalFileName}\">${it.originalFileName}<\/a>"],"delete":["29","            <a href=\"parameter\/${it.name}\/${it.originalFileName}\">${it.originalFileName}<\/a>"]}]}},"c1cd42f0f1ecbd30683cb8b44537e913a512485d":{"changes":{"war\/resources\/scripts\/hudson-behavior.js":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Job\/configure.jelly":"MODIFY","war\/resources\/css\/style.css":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Hudson\/configure.jelly":"MODIFY"},"diff":{"war\/resources\/scripts\/hudson-behavior.js":[{"add":["941","    \"DIV.behavior-loading\" : function(e) { e.style.display = 'none' }"],"delete":["941","    \"DIV.loading\" : function(e) { e.style.display = 'none' }"]}],"core\/src\/main\/resources\/hudson\/model\/Job\/configure.jelly":[{"add":["31","      <div class=\"behavior-loading\">${%LOADING}<\/div>"],"delete":["31","      <div class=\"loading\">${%LOADING}<\/div>"]}],"war\/resources\/css\/style.css":[{"add":["434","div.behavior-loading {"],"delete":["434",".loading {"]}],"core\/src\/main\/resources\/hudson\/model\/Hudson\/configure.jelly":[{"add":["32","    <div class=\"behavior-loading\">${%LOADING}<\/div>"],"delete":["32","    <div class=\"loading\">${%LOADING}<\/div>"]}]}},"766a78fd5473c1d0a86b2960ec596150e712ea36":{"changes":{"core\/src\/main\/java\/hudson\/util\/WriterOutputStream.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/WriterOutputStream.java":[{"add":["10","import java.nio.charset.UnsupportedCharsetException;","27","        decoder = DEFAULT_CHARSET.newDecoder();","93","","94","    private static final Charset DEFAULT_CHARSET = getDefaultCharset();","95","","96","    private static Charset getDefaultCharset() {","97","        try {","98","            String encoding = System.getProperty(\"file.encoding\");","99","            return Charset.forName(encoding);","100","        } catch (UnsupportedCharsetException e) {","101","            return Charset.forName(\"UTF-8\");","102","        }","103","    }"],"delete":["26","        decoder = Charset.defaultCharset().newDecoder();"]}]}},"65cd6555301535af4f8796a694c4d52664205778":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModule.java":"MODIFY","maven-plugin\/src\/test\/java\/hudson\/maven\/MavenModuleTest.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/ModuleDependency.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModule.java":[{"add":["480","        \/\/Create a map of groupId:artifact id keys to modules for faster look ups in findMatchingDependentModule","481","        Map<String, List<ModuleDependency>> mapModules = createModuleDependencyMap(data.allModules.keySet());","485","                src = findMatchingDependentModule(mapModules, data.allModules, d);","665","    \/**","666","     * Given a list of the same ModuleDependency objects for this MavenModule, this method finds the one that","667","     * satisfies this MavenModule with the highest version defined.","668","     *","669","     * @param dependencyMap this map is defined by keys made up of groupId:artifactId and the value is a list of","670","     * ModuleDependency objects that matches this.","671","     * @param modules a map of all MavenModules in Jenkins keyed on ModuleDependency.","672","     * @param dependencyDescription The ModuleDependency we are using as the search reference.","673","     * @return The highest satisfying ModuleDependency for this MavenModule.","674","     *\/","675","    private MavenModule findMatchingDependentModule(","676","            final Map<String, List<ModuleDependency>> dependencyMap,","677","            final Map<ModuleDependency, MavenModule> modules,","678","            final ModuleDependency dependencyDescription) {","679","","680","        MavenModule module = null;","681","        String lookupKey = buildDependencyKey(dependencyDescription);","682","        List<ModuleDependency> dependencyList = dependencyMap.get(lookupKey);","683","","684","        if (dependencyList != null) {","685","","686","            \/\/Shortcut for size 1 list...this is most common?","687","            if (dependencyList.size() == 1) {","688","                ModuleDependency moduleDependency = dependencyList.get(0);","689","                if (dependencyDescription.isSatisfiedBy(moduleDependency)) {","690","                    module = modules.get(moduleDependency);","691","                }","692","            } else {","693","","694","                \/\/We need to filter out the list to the set that is satisfied and then find sort this and","695","                \/\/get the highest one.","696","                List<ModuleDependency> possibles = dependencyMap.get(buildDependencyKey(dependencyDescription));","697","                if (possibles != null) {","698","                    ModuleDependency satisfyingModule = dependencyDescription.findHighestSatisfyingModule(possibles);","699","                    module = modules.get(satisfyingModule);","700","                }","701","            }","702","        }","703","        return module;","704","    }","705","","706","    \/**","707","     * Builds a map of all the modules, keyed against the groupId and artifactId. The values are a list of modules","708","     * that match this criteria.","709","     *","710","     * @param moduleSet The entire set in the Jenkins instance.","711","     * @return A map of ModuleDependencies.","712","     *\/","713","    private static Map<String, List<ModuleDependency>> createModuleDependencyMap(Set<ModuleDependency> moduleSet) {","714","        Map<String, List<ModuleDependency>> map = new HashMap<String, List<ModuleDependency>>();","715","","716","        for (ModuleDependency dependency : moduleSet) {","717","            String compositeKey = buildDependencyKey(dependency);","718","","719","            List<ModuleDependency> moduleDependencies = map.get(compositeKey);","720","            if (moduleDependencies == null) {","721","                moduleDependencies = new ArrayList<ModuleDependency>();","722","                moduleDependencies.add(dependency);","723","            } else {","724","                moduleDependencies.add(dependency);","725","            }","726","","727","            map.put(compositeKey, moduleDependencies);","728","        }","729","","730","        return map;","731","    }","732","","733","    private static String buildDependencyKey(ModuleDependency moduleDependency) {","734","        return moduleDependency.groupId + ':' + moduleDependency.artifactId;","735","    }"],"delete":["483","                src = data.allModules.get(d);"]}],"maven-plugin\/src\/test\/java\/hudson\/maven\/MavenModuleTest.java":[{"add":["12","import java.util.Collection;","19","import org.apache.maven.model.Dependency;","130","    \/**","131","     * This test is a standard project that has a versioned dependency.","132","     *\/","133","    @Test","134","    public void testSimpleVersion() {","135","        TestComponents testComponents = createTestComponents(\"1.0.1-SNAPSHOT\");","136","","137","        DependencyGraph graph = testComponents.graph;","138","        MavenModule appMavenModule = testComponents.applicationMavenModule;","139","        MavenModule libMavenModule = testComponents.libraryMavenModule;","140","","141","        graph.build();","142","","143","        List<AbstractProject> appDownstream = graph.getDownstream(appMavenModule);","144","        List<AbstractProject> appUpstream = graph.getUpstream(appMavenModule);","145","        List<AbstractProject> libDownstream = graph.getDownstream(libMavenModule);","146","        List<AbstractProject> libUpstream = graph.getUpstream(libMavenModule);","147","","148","        Assert.assertEquals(0, appDownstream.size());","149","        Assert.assertEquals(1, appUpstream.size());","150","        Assert.assertEquals(1, libDownstream.size());","151","        Assert.assertEquals(0, libUpstream.size());","152","    }","153","","154","    \/**","155","     * This tests that a version range declaration in the dependency of a top level project","156","     * resolves the up and downstream correctly.","157","     *\/","158","    @Test","159","    public void testSimpleVersionRange() {","160","        TestComponents testComponents = createTestComponents(\"[1.0.0, )\");","161","","162","        DependencyGraph graph = testComponents.graph;","163","        MavenModule appMavenModule = testComponents.applicationMavenModule;","164","        MavenModule libMavenModule = testComponents.libraryMavenModule;","165","","166","        graph.build();","167","","168","        List<AbstractProject> appDownstream = graph.getDownstream(appMavenModule);","169","        List<AbstractProject> appUpstream = graph.getUpstream(appMavenModule);","170","        List<AbstractProject> libDownstream = graph.getDownstream(libMavenModule);","171","        List<AbstractProject> libUpstream = graph.getUpstream(libMavenModule);","172","","173","        Assert.assertEquals(0, appDownstream.size());","174","        Assert.assertEquals(1, appUpstream.size());","175","        Assert.assertEquals(1, libDownstream.size());","176","        Assert.assertEquals(0, libUpstream.size());","177","    }","178","","179","    \/**","180","     * Test multiple projects with dependencies on differing library versions declared with","181","     * multiple version definitions.","182","     *\/","183","    @Test","184","    public void testMultipleDependencies() {","185","","186","        MavenProject projectA = createMavenProject(\"ProjectA\", \"test\", \"projectA\", \"1.0-SNAPSHOT\", \"jar\");","187","        Dependency dependencyA = createDependency(\"test\", \"library\", \"[1.0, 2.0)\");","188","        projectA.getDependencies().add(dependencyA);","189","","190","        MavenProject projectB = createMavenProject(\"ProjectB\", \"test\", \"projectB\", \"2.0-SNAPSHOT\", \"jar\");","191","        Dependency dependencyB = createDependency(\"test\", \"library\", \"[1.1, 2.1]\");","192","        projectB.getDependencies().add(dependencyB);","193","","194","        MavenProject dependX = createMavenProject(\"DependX-1.1\", \"test\", \"library\", \"1.1.3-SNAPSHOT\", \"jar\");","195","        MavenProject dependY = createMavenProject(\"DependX-1.2\", \"test\", \"library\", \"1.2.1-SNAPSHOT\", \"jar\");","196","        MavenProject dependZ = createMavenProject(\"DependX-2.0\", \"test\", \"library\", \"2.0.1-SNAPSHOT\", \"jar\");","197","","198","        MavenModuleSet parent = mock(MavenModuleSet.class);","199","        when(parent.isAggregatorStyleBuild()).thenReturn(Boolean.FALSE);","200","","201","        \/\/Now create maven modules for all the projects","202","        MavenModule mavenModuleA = mockMavenModule(projectA);","203","        MavenModule mavenModuleB = mockMavenModule(projectB);","204","        MavenModule mavenModuleX = mockMavenModule(dependX);","205","        MavenModule mavenModuleY = mockMavenModule(dependY);","206","        MavenModule mavenModuleZ = mockMavenModule(dependZ);","207","","208","        Collection<AbstractProject<?,?>> allModules = Lists.<AbstractProject<?,?>>newArrayList(mavenModuleA,","209","                mavenModuleB, mavenModuleX, mavenModuleY, mavenModuleZ);","210","","211","        for (AbstractProject<?, ?> module : allModules) {","212","            MavenModule mm = (MavenModule) module;","213","            enhanceMavenModuleMock(mm, parent, allModules);","214","        }","215","","216","        DependencyGraph graph = MockHelper.mockDependencyGraph(allModules);","217","        doCallRealMethod().when(graph).getDownstream(Matchers.any(AbstractProject.class));","218","        doCallRealMethod().when(graph).getUpstream(Matchers.any(AbstractProject.class));","219","        doCallRealMethod().when(graph).compare(Matchers.<AbstractProject>any(), Matchers.<AbstractProject>any());","220","        graph.build();","221","","222","        List<AbstractProject> downstreamA = graph.getDownstream(mavenModuleA);","223","        List<AbstractProject> upstreamA = graph.getUpstream(mavenModuleA);","224","","225","        Assert.assertEquals(0, downstreamA.size());","226","        Assert.assertEquals(1, upstreamA.size());","227","        Assert.assertSame(dependY.getVersion(), ((MavenModule) upstreamA.get(0)).getVersion());","228","","229","        List<AbstractProject> downstreamB = graph.getDownstream(mavenModuleB);","230","        List<AbstractProject> upstreamB = graph.getUpstream(mavenModuleB);","231","","232","        Assert.assertEquals(0, downstreamB.size());","233","        Assert.assertEquals(1, upstreamA.size());","234","        Assert.assertSame(dependZ.getVersion(), ((MavenModule) upstreamB.get(0)).getVersion());","235","    }","236","","237","    private TestComponents createTestComponents(String libraryVersion) {","238","        MavenProject appProject = createMavenProject(\"testapp\", \"test\", \"application\", \"1.0-SNAPSHOT\", \"jar\");","239","        Dependency dependency = createDependency(\"test\", \"library\", libraryVersion);","240","        appProject.getDependencies().add(dependency);","241","","242","        MavenModule appMavenModule = mockMavenModule(appProject);","243","","244","        MavenProject libProject = createLibrary();","245","        MavenModule libMavenModule = mockMavenModule(libProject);","246","","247","        MavenModuleSet parent = mock(MavenModuleSet.class);","248","        when(parent.isAggregatorStyleBuild()).thenReturn(Boolean.FALSE);","249","        when(appMavenModule.getParent()).thenReturn(parent);","250","        when(libMavenModule.getParent()).thenReturn(parent);","251","","252","        Collection<MavenModule> projects = Lists.newArrayList(appMavenModule, libMavenModule);","253","        when(parent.getModules()).thenReturn(projects);","254","        when(appMavenModule.getAllMavenModules()).thenReturn(projects);","255","        when(libMavenModule.getAllMavenModules()).thenReturn(projects);","256","","257","        DependencyGraph graph = MockHelper.mockDependencyGraph(Lists.<AbstractProject<?,?>>newArrayList(appMavenModule, libMavenModule));","258","        doCallRealMethod().when(graph).getDownstream(Matchers.any(AbstractProject.class));","259","        doCallRealMethod().when(graph).getUpstream(Matchers.any(AbstractProject.class));","260","","261","        TestComponents testComponents = new TestComponents();","262","        testComponents.graph = graph;","263","        testComponents.applicationMavenModule = appMavenModule;","264","        testComponents.libraryMavenModule = libMavenModule;","265","","266","        return testComponents;","267","    }","268","","269","    private static void enhanceMavenModuleMock(MavenModule module,","270","                                                      MavenModuleSet parent,","271","                                                      Collection allProjects) {","272","        when(module.getParent()).thenReturn(parent);","273","        when(module.getAllMavenModules()).thenReturn(allProjects);","274","    }","275","","276","    private static MavenModule mockMavenModule(MavenProject project) {","277","        MavenModule mavenModule = mock(MavenModule.class);","278","        when(mavenModule.getName()).thenReturn(project.getName());","279","        basicMocking(mavenModule);","280","        mavenModule.doSetName(project.getGroupId() + '$' + project.getArtifactId());","281","","282","        PomInfo pomInfo = new PomInfo(project, null, \"relPath\");","283","        mavenModule.reconfigure(pomInfo);","284","","285","        return mavenModule;","286","    }","287","","288","    private static MavenProject createMavenProject(String name,","289","                                                   String groupId,","290","                                                   String artifactId,","291","                                                   String version,","292","                                                   String packaging) {","293","        MavenProject proj = new MavenProject();","294","        proj.setName(name);","295","        proj.setGroupId(groupId);","296","        proj.setArtifactId(artifactId);","297","        proj.setVersion(version);","298","        proj.setPackaging(packaging);","299","","300","        return proj;","301","    }","302","","303","    private static Dependency createDependency(String groupId, String artifactId, String version) {","304","        Dependency dependency = new Dependency();","305","        dependency.setGroupId(groupId);","306","        dependency.setArtifactId(artifactId);","307","        dependency.setVersion(version);","308","        return dependency;","309","    }","310","","311","    private static MavenProject createLibrary() {","312","        MavenProject proj = createMavenProject(\"testlib\", \"test\", \"library\", \"1.0.1-SNAPSHOT\", \"jar\");","313","","314","        Dependency dependency = new Dependency();","315","        dependency.setArtifactId(\"log4j\");","316","        dependency.setGroupId(\"log4j\");","317","        dependency.setVersion(\"1.6.15\");","318","        proj.getDependencies().add(dependency);","319","        return proj;","320","    }","321","","322","    private static class TestComponents {","323","        public DependencyGraph graph;","324","        public MavenModule applicationMavenModule;","325","        public MavenModule libraryMavenModule;","326","    }"],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/ModuleDependency.java":[{"add":["25","import org.apache.maven.artifact.versioning.ArtifactVersion;","26","import org.apache.maven.artifact.versioning.DefaultArtifactVersion;","27","import org.apache.maven.artifact.versioning.InvalidVersionSpecificationException;","28","import org.apache.maven.artifact.versioning.VersionRange;","35","import java.util.List;","36","import java.util.SortedMap;","37","import java.util.TreeMap;","172","    \/**","173","     * Checks whether this ModuleDependency is satisfied by the dependency of the given ModuleDependency.","174","     * This caters for versions where the version string defines a version range. It is assumed that the given","175","     * ModuleDependency is of the same groupId and artifactId and only validates against the version.","176","     *","177","     * @param otherDependency The dependency to check for.","178","     * @return true if contained false otherwise.","179","     *\/","180","    public boolean isSatisfiedBy(ModuleDependency otherDependency) {","181","        if (otherDependency == null) {","182","            return false;","183","        }","184","","185","        boolean result = false;","186","        try {","187","            VersionRange myRange = VersionRange.createFromVersionSpec(version);","188","            ArtifactVersion otherVersion = new DefaultArtifactVersion(otherDependency.version);","189","            result = myRange.containsVersion(otherVersion);","190","        } catch (InvalidVersionSpecificationException ivse) {","191","            \/\/Do nothing. Return false.","192","        }","193","","194","        return result;","195","    }","196","","197","    \/**","198","     * Given a list of ModuleDependencies of the same groupId and artifactId, it will sort this list using the","199","     * version and finds the highest version that satisfies this ModuleDependency.","200","     *","201","     * @param listModuleDependencies The list of ModuleDependencies.","202","     * @return The highest satisfying ModuleDependency or null if none can be found.","203","     *\/","204","    public ModuleDependency findHighestSatisfyingModule(List<ModuleDependency> listModuleDependencies) {","205","","206","        ModuleDependency highestDependency = null;","207","","208","        \/\/Create a sorted map of the ModuleDependnecies sorted on version.","209","        SortedMap<ArtifactVersion, ModuleDependency> sorted = new TreeMap<ArtifactVersion, ModuleDependency>();","210","        for (ModuleDependency otherDependency : listModuleDependencies) {","211","            sorted.put(new DefaultArtifactVersion(otherDependency.version), otherDependency);","212","        }","213","","214","        try {","215","            VersionRange myRange = VersionRange.createFromVersionSpec(version);","216","","217","            \/\/Now find the highest version that satisfies this dependency.","218","            ArtifactVersion highestVersion = null;","219","            for (ArtifactVersion version : sorted.keySet()) {","220","                if (myRange.containsVersion(version)) {","221","                    highestVersion = version;","222","                } else {","223","                    break;","224","                }","225","            }","226","","227","            if (highestVersion != null) {","228","                highestDependency = sorted.get(highestVersion);","229","            }","230","        } catch (InvalidVersionSpecificationException e) {","231","            \/\/Do nothing - return null.","232","        }","233","        return highestDependency;","234","    }","235","","236","    @Override","237","    public String toString() {","238","        return \"ModuleDependency{\" +","239","               \"groupId='\" + groupId + '\\'' +","240","               \", artifactId='\" + artifactId + '\\'' +","241","               \", version='\" + version + '\\'' +","242","               \", plugin=\" + plugin +","243","               '}';","244","    }"],"delete":[]}]}},"60ecdee0d2704b698ca6302f92262ba2aff8facb":{"changes":{"core\/src\/main\/resources\/hudson\/PluginManager\/_table.js":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/PluginManager\/_table.js":[{"add":["13","        var filterParts = filter.split(\/ +\/).filter (function(word) { return word.length > 0; });"],"delete":["13","        var filterParts = filter.split(\/ +\/).filter (word => word.length > 0);"]}]}},"9e1d1b0ab6aece09f23140701067dfc501b34a20":{"changes":{"core\/src\/main\/java\/hudson\/model\/BuildTimelineWidget.java":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable.jelly":"MODIFY","core\/src\/main\/java\/jenkins\/widgets\/BuildListTable.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/BuildTimelineWidget.java":[{"add":["64","            e.start = new Date(r.getStartTimeInMillis());","65","            e.end   = new Date(r.getStartTimeInMillis()+r.getDuration());"],"delete":["64","            e.start = r.getTime();","65","            e.end   = new Date(r.timestamp+r.getDuration());"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable.jelly":[{"add":["49","              tr.insert(new Element('td', {data: e.timestampString2, tooltip: '${%Click to center timeline on event}', onclick: 'javascript:tl.getBand(0).scrollToCenter(Timeline.DateTime.parseGregorianDateTime(\"' + e.timestampString3 + '\"))'})."],"delete":["49","              tr.insert(new Element('td', {data: e.timestampString2, tooltip: '${%Click to center timeline on event}', onclick: 'javascript:tl.getBand(0).scrollToCenter(Timeline.DateTime.parseGregorianDateTime(\"' + e.timestampString2 + '\"))'})."]}],"core\/src\/main\/java\/jenkins\/widgets\/BuildListTable.java":[{"add":["27","import hudson.Util;","31","","32","import java.util.Date;","33","","51","        element.put(\"timestampString3\", Util.XS_DATETIME_FORMATTER.format(new Date(build.getStartTimeInMillis())));"],"delete":[]}]}},"965f31ed98c35aa1a30e98c807ad6bdbd87f5395":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["867","        \/\/ send to the new job page","868","        \/\/ note we can't use getUrl() because that would pick up old name in the Ancestor.getUrl()","869","        rsp.sendRedirect2(req.getContextPath()+'\/'+getParent().getUrl()+getShortUrl());"],"delete":["867","        rsp.sendRedirect2(req.getContextPath()+'\/'+getUrl()); \/\/ send to the new job page"]}]}},"9a9d771f231847c2337ef9d088c292e3c24eee06":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Api\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Hudson\/_api.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Api\/index.jelly":[{"add":["81","      <h2>Controlling the amount of data you fetch<\/h2>","94","<\/j:jelly>"],"delete":["81","      <h2>Controling the amount of data you fetch<\/h2>","94","<\/j:jelly>"]}],"core\/src\/main\/resources\/hudson\/model\/Hudson\/_api.jelly":[{"add":["36","    three query parameters <tt>name=<i>NEWJOBNAME<\/i>&amp;mode=copy&amp;from=<i>FROMJOBNAME<\/i><\/tt>","52","<\/j:jelly>"],"delete":["36","    three query parameters <tt>name=<i>NEWJOBNAME<\/i>&amp;mode=copyJob&amp;from=<i>FROMJOBNAME<\/i><\/tt>","52","<\/j:jelly>"]}]}},"cbbc3b0ede88a101287c4f6fa852ba0853082b97":{"changes":{"core\/src\/main\/java\/hudson\/model\/UpdateCenter.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/UpdateCenter.java":[{"add":["98","\t","99","    private static final String UPDATE_CENTER_URL = System.getProperty(UpdateCenter.class.getName()+\".updateCenterUrl\",\"http:\/\/updates.jenkins-ci.org\/\");","100","\t","694","            return UPDATE_CENTER_URL;"],"delete":["691","            return \"http:\/\/updates.jenkins-ci.org\/\";"]}]}},"84f08379e8a06f9cec0765da0ac397950fbad1d3":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Item.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["59","AbstractProject.DiscoverPermission.Description=\\","60","  This permission grants discover access to jobs. Lower than read permissions, it allows you to \\","61","  redirect anonymous users to the login page when they try to access a job url. \\","62","  Without it they would get a 404 error and wouldn't be able to discover project names."],"delete":[]}],"changelog.html":[{"add":["60","  <li class=rfe>","61","    Added a DISCOVER permission to allow anonymous users to be presented the login screen","62","    when accessing job URLs.","63","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-8214\">issue 8214<\/a>)"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["2112","        if (item==null)","2114","        if (!item.hasPermission(Item.READ)) {","2115","            if (item.hasPermission(Item.DISCOVER)) {","2116","                throw new AccessDeniedException(\"Please login to access job \" + name);","2117","            }","2118","            return null;","2119","        }"],"delete":["202","import org.acegisecurity.context.SecurityContext;","2113","        if (item==null || !item.hasPermission(Item.READ))"]}],"core\/src\/main\/java\/hudson\/model\/Item.java":[{"add":["226","    Permission DISCOVER = new Permission(PERMISSIONS, \"Discover\", Messages._AbstractProject_DiscoverPermission_Description(), Permission.READ, PermissionScope.ITEM);"],"delete":[]}]}},"ee56c4b9017b2749c9c03963cfecc6307dace0d8":{"changes":{"core\/src\/main\/resources\/jenkins\/install\/SetupWizard\/setupWizardFirstUser.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/install\/SetupWizard\/setupWizardFirstUser.jelly":[{"add":["20","          line-height: 48px;"],"delete":[]}]}},"ae29e6b2463754778c3988e62292a07a846ffe57":{"changes":{"core\/src\/main\/resources\/hudson\/tools\/Messages.properties":"MODIFY","core\/src\/main\/java\/hudson\/tools\/InstallerTranslator.java":"MODIFY","test\/src\/test\/java\/hudson\/tools\/InstallerTranslatorTest.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/tools\/Messages.properties":[{"add":["39","CannotBeInstalled=Installer \"{0}\" cannot be used to install \"{1}\" on the node \"{2}\""],"delete":[]}],"core\/src\/main\/java\/hudson\/tools\/InstallerTranslator.java":[{"add":["30","import java.util.ArrayList;","53","","54","        ArrayList<String> inapplicableInstallersMessages = new ArrayList<String>();","55","","75","            } else {","76","                inapplicableInstallersMessages.add(Messages.CannotBeInstalled(","77","                        installer.getDescriptor().getDisplayName(),","78","                        tool.getName(),","79","                        node.getDisplayName()));","82","        for (String message : inapplicableInstallersMessages) {","83","            log.getLogger().println(message);","84","        }"],"delete":[]}],"test\/src\/test\/java\/hudson\/tools\/InstallerTranslatorTest.java":[{"add":["37","import java.util.ArrayList;","38","import java.util.Arrays;","102","    @Issue(\"JENKINS-26940\")","103","    @Test","104","    public void testMessageLoggedWhenNoInstallerFound() throws Exception {","105","        final CommandInstaller ci = new CommandInstaller(\"wrong1\", \"echo hello\", \"\/opt\/jdk\");","106","        final BatchCommandInstaller bci = new BatchCommandInstaller(\"wrong2\", \"echo hello\", \"\/opt\/jdk2\");","107","        InstallSourceProperty isp = new InstallSourceProperty(Arrays.asList(ci, bci));","108","","109","        JDK jdk = new JDK(\"jdk\", null, Collections.singletonList(isp));","110","        r.jenkins.getJDKs().add(jdk);","111","","112","","113","        FreeStyleProject p = r.createFreeStyleProject();","114","        p.setJDK(jdk);","115","        p.getBuildersList().add(new Shell(\"echo $JAVA_HOME\"));","116","        FreeStyleBuild b1 = r.buildAndAssertSuccess(p);","117","        r.assertLogContains(hudson.tools.Messages.CannotBeInstalled(ci.getDescriptor().getDisplayName(), jdk.getName(), r.jenkins.getDisplayName()), b1);","118","        r.assertLogContains(hudson.tools.Messages.CannotBeInstalled(bci.getDescriptor().getDisplayName(), jdk.getName(), r.jenkins.getDisplayName()), b1);","119","    }","120","","121","    @Issue(\"JENKINS-26940\")","122","    @Test","123","    public void testNoMessageLoggedWhenAnyInstallerFound() throws Exception {","124","        final CommandInstaller ci = new CommandInstaller(\"wrong1\", \"echo hello\", \"\/opt\/jdk\");","125","        final CommandInstaller ci2 = new CommandInstaller(\"master\", \"echo hello\", \"\/opt\/jdk2\");","126","        InstallSourceProperty isp = new InstallSourceProperty(Arrays.asList(ci, ci2));","127","","128","        JDK jdk = new JDK(\"jdk\", null, Collections.singletonList(isp));","129","        r.jenkins.getJDKs().add(jdk);","130","","131","","132","        FreeStyleProject p = r.createFreeStyleProject();","133","        p.setJDK(jdk);","134","        p.getBuildersList().add(new Shell(\"echo $JAVA_HOME\"));","135","        FreeStyleBuild b1 = r.buildAndAssertSuccess(p);","136","        r.assertLogNotContains(ci.getDescriptor().getDisplayName(), b1);","137","    }","138",""],"delete":[]}]}},"08a1fc39d5231f319e64776889d6a66aac94f26d":{"changes":{"core\/pom.xml":"MODIFY","test\/src\/test\/groovy\/hudson\/cli\/BuildCommandTest.groovy":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["190","      <version>2.0.23<\/version>"],"delete":["190","      <version>2.0.21<\/version>"]}],"test\/src\/test\/groovy\/hudson\/cli\/BuildCommandTest.groovy":[{"add":["177","","178","    @Test void correctlyParseMapValuesContainingEqualsSign() {","179","","180","        def project = j.createFreeStyleProject(\"the-project\");","181","        project.addProperty(new ParametersDefinitionProperty([","182","                new StringParameterDefinition(\"expr\", null)","183","        ]));","184","","185","        def invoker = new CLICommandInvoker(j, new BuildCommand());","186","        def result = invoker.invokeWithArgs(\"the-project\", \"-p\", \"expr=a=b\", \"-s\");","187","","188","        assertEquals(\"Command is expected to succeed\", 0, result.returnCode());","189","        assertEquals(\"a=b\", project.getBuildByNumber(1).getBuildVariables().get(\"expr\"));","190","    }"],"delete":[]}]}},"ce0a36ffbd3a4d506303c825cc737d1c925ab6b5":{"changes":{"core\/src\/main\/java\/hudson\/cli\/GroovyshCommand.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/cli\/GroovyshCommand.java":[{"add":["84","        final ClassLoader cl = Jenkins.getInstance().pluginManager.uberClassLoader;"],"delete":["84","        final ClassLoader cl = Thread.currentThread().getContextClassLoader();"]}],"changelog.html":[{"add":["58","    'groovysh' command should be able to see all the plugin classes.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-14982\">issue 14982<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"a0c958b61fc1d15b9bea2cf7c55a64cbc169e9ac":{"changes":{"core\/src\/main\/java\/hudson\/model\/FileParameterDefinition.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/FileParameterValue.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/FileParameterDefinition.java":[{"add":["81","        FileParameterValue p = new FileParameterValue(getName(), local, src.getName());","82","        p.setDescription(getDescription());"],"delete":["81","        FileParameterValue p = new FileParameterValue(getName(), local, getDescription());"]}],"core\/src\/main\/java\/hudson\/model\/FileParameterValue.java":[{"add":["2"," *","4"," *","11"," *","14"," *","70","        this(name, file, FilenameUtils.getName(file.getName()));","73","    public FileParameterValue(String name, File file, String originalFileName) {","74","        this(name, new FileItemImpl(file), originalFileName);","75","    }","76","","77","    private FileParameterValue(String name, FileItem file, String originalFileName) {","78","        super(name);","80","        this.originalFileName = originalFileName;","145","","186","            if (file == null) {","187","                throw new NullPointerException(\"file\");","188","            }"],"delete":["2"," * ","4"," * ","11"," * ","14"," * ","70","        this(name, file, null);","73","    public FileParameterValue(String name, FileItem file, String description) {","74","        super(name, description);","75","        assert file!=null;","77","        this.originalFileName = FilenameUtils.getName(file.getName());","78","    }","79","","80","    public FileParameterValue(String name, File file, String desc) {","81","        this(name,new FileItemImpl(file),desc);","146","\t"]}]}},"4e23793f62aa5019226f2ba96f8063f01affeb92":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY","pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["181","      <version>1.13<\/version>"],"delete":["181","      <version>1.9<\/version>"]}],"changelog.html":[{"add":["58","    Worked around \"incompatible InnerClasses attribute\" bug in IBM J9 VM","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22525\">issue 22525<\/a>)","60","  <li class=\"bug\">"],"delete":[]}],"pom.xml":[{"add":["454","          <version>1.13<\/version>"],"delete":["454","          <version>1.9<\/version>"]}]}},"95c1ba927a747fbb17a83ed1dfb9f29e6d5fa252":{"changes":{"core\/src\/main\/java\/hudson\/model\/ParametersDefinitionProperty.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/ParametersDefinitionProperty.java":[{"add":["206","        return null;"],"delete":["206","        return \"parameters\";"]}]}},"b93d77119f0df2c89bc0c50727affe2a6755df76":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["57","  <li class=bug>","58","    Fix a bug which only showed the first detail part for radio buttons.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22583\">issue 22583<\/a>)"],"delete":[]}]}},"6acdd66f435bb0c87479cb32449f0bb52b325d57":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["201","    Don't submit form on Save after Apply in new window on some browsers.","203","  <li class=bug>","204","    Remotely triggered builds now show correct IP address through proxy.","205","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18008\">issue 18008<\/a>)"],"delete":["201","    Don't submit form on Apply after Save in new window on some browsers."]}]}},"6ccad2bc3264bc9e165a23686697904d4c1cc40f":{"changes":{"core\/src\/main\/java\/hudson\/Proc.java":"MODIFY","remoting\/src\/test\/java\/hudson\/remoting\/SimpleTest.java":"MODIFY","core\/src\/test\/java\/hudson\/LauncherTest.java":"ADD","remoting\/src\/main\/java\/hudson\/remoting\/Request.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Proc.java":[{"add":["35","import java.util.concurrent.CancellationException;","298","            } catch (CancellationException x) {","299","                return -1;"],"delete":["283","            join();"]}],"remoting\/src\/test\/java\/hudson\/remoting\/SimpleTest.java":[{"add":["25","import java.util.concurrent.CancellationException;","106","    \/**","107","     * Checks whether {@link Future#cancel} behaves according to spec.","108","     * Currently seems to be used by MavenBuilder.call and Proc.RemoteProc.kill","109","     * (in turn used by MercurialSCM.joinWithTimeout when polling on remote host).","110","     *\/","111","    \/\/@Bug(4611)","112","    public void testCancellation() throws Exception {","113","        Cancellable task = new Cancellable();","114","        Future<Integer> r = channel.callAsync(task);","115","        r.cancel(true);","116","        try {","117","            r.get();","118","            fail(\"should not return normally\");","119","        } catch (CancellationException x) {","120","            \/\/ right","121","        }","122","        assertTrue(r.isCancelled());","123","        assertFalse(task.ran);","124","        \/\/ XXX ought to also test various other aspects: cancelling before start, etc.","125","    }","126","    private static class Cancellable implements Callable<Integer, InterruptedException> {","127","        boolean ran;","128","        public Integer call() throws InterruptedException {","129","            Thread.sleep(9999);","130","            ran = true;","131","            return 0;","132","        }","133","    }","134",""],"delete":[]}],"core\/src\/test\/java\/hudson\/LauncherTest.java":[{"add":[],"delete":[]}],"remoting\/src\/main\/java\/hudson\/remoting\/Request.java":[{"add":["27","import java.util.concurrent.CancellationException;","172","","173","            private boolean cancelled;","174","","176","                if (cancelled || isDone()) {","177","                    return false;","178","                }","179","                cancelled = true;","180","                if (mayInterruptIfRunning) {","181","                    try {","182","                        channel.send(new Cancel(id));","183","                    } catch (IOException x) {","184","                        return false;","185","                    }","186","                }","187","                return true;","191","                return cancelled;","195","                return isCancelled() || response!=null;","201","                        while(response==null) {","202","                            if (isCancelled()) {","203","                                throw new CancellationException();","204","                            }","206","                        }","225","                    if(response==null) {","226","                        if (isCancelled()) {","227","                            throw new CancellationException();","228","                        }","230","                    }"],"delete":["171","            \/**","172","             * The task cannot be cancelled.","173","             *\/","175","                return false;","179","                return false;","183","                return response!=null;","189","                        while(response==null)","209","                    if(response==null)"]}]}},"5e143d1c662555a3430a47f01e40beb0e404dbc2":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Job\/permalinks_zh_CN.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Job\/permalinks_zh_CN.properties":[{"add":["22","Permalinks=\\u76F8\\u5173\\u94FE\\u63A5"],"delete":["22","Permalinks=\\u76F8\\u5173\\u8FDE\\u63A5"]}]}},"f57b06cebfdcf03ec89cc491143dc563fd91dfe6":{"changes":{"core\/src\/main\/java\/hudson\/security\/FullControlOnceLoggedInAuthorizationStrategy.java":"MODIFY","core\/src\/main\/java\/hudson\/security\/LegacyAuthorizationStrategy.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/security\/FullControlOnceLoggedInAuthorizationStrategy.java":[{"add":["3","import hudson.model.Hudson;","31","        THE_ACL.add(ACL.EVERYONE,Hudson.ADMINISTER,true);","32","        THE_ACL.add(ACL.ANONYMOUS,Hudson.ADMINISTER,false);"],"delete":["30","        THE_ACL.add(ACL.EVERYONE,Permission.FULL_CONTROL,true);","31","        THE_ACL.add(ACL.ANONYMOUS,Permission.FULL_CONTROL,false);"]}],"core\/src\/main\/java\/hudson\/security\/LegacyAuthorizationStrategy.java":[{"add":["3","import hudson.model.Hudson;","18","        add(new GrantedAuthoritySid(\"admin\"), Hudson.ADMINISTER,true);"],"delete":["17","        add(new GrantedAuthoritySid(\"admin\"),Permission.FULL_CONTROL,true);"]}]}},"0b517705f5de454f2896d5c345ac8ec4fa8f6651":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","core\/src\/main\/resources\/jenkins\/model\/Messages.properties":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["1233","            \t\/\/This handles the situation when Parameterized build checkbox is checked but no parameters are selected. User will be redirected to an error page with proper error message.","1234","            \tJob.checkForEmptyParameters(jsonProperties);","1539","    ","1540","    \/**","1541","     * This handles the situation when Parameterized build checkbox is checked ","1542","     * but no parameters are selected. User will be redirected to an error page","1543","     * with proper error message.","1544","     * @param jsonProperties","1545","     * @throws FormException ","1546","     *\/","1547","    private static void checkForEmptyParameters(JSONObject jsonProperties) throws FormException{","1548","        JSONObject parameterDefinitionProperty = jsonProperties.getJSONObject(\"hudson-model-ParametersDefinitionProperty\");","1549","        if ((parameterDefinitionProperty.getBoolean(\"specified\") == true)&& !parameterDefinitionProperty.has(\"parameterDefinitions\")) {","1550","\t\t    throw new FormException(Messages.Hudson_NoParamsSpecified(),\"parameterDefinitions\");","1551","        }","1552","    }"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["385","","386","Hudson.NoParamsSpecified=No Parameters are specified for this parameterized build"],"delete":[]}],"core\/src\/main\/resources\/jenkins\/model\/Messages.properties":[{"add":["44","Hudson.NoParamsSpecified=No Parameters are specified for this parameterized build"],"delete":["44",""]}]}},"d9296edee929452272767f13db2c0bdba255375f":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":"MODIFY","test\/src\/test\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptorTest.java":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":[{"add":["34","import java.io.Serializable;","47","    public static final class DiskSpace implements Serializable {","77","","78","        private static final long serialVersionUID = 1L;"],"delete":["46","    public static final class DiskSpace {"]}],"test\/src\/test\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptorTest.java":[{"add":[],"delete":[]}]}},"e5cffeeb140a580d83329715bf424173fe8499a2":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["77","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23810\">issue 23810<\/a>,","78","    <a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23829\">issue 23829<\/a>)","80","    Add option to CLI to skip key authentication (e.g. when there's a password on the default key)."],"delete":["77","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23810\">issue 23810<\/a>)","79","    CLI authentication with username\/password try to read my .ssh\/id_rsa and prompts for key password."]}]}},"732bca61e05ccf01f89b3756f4422135ce53ece6":{"changes":{"core\/src\/main\/java\/hudson\/PluginWrapper.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/PluginWrapper.java":[{"add":["82","     * Short name of the plugin. The artifact Id of the plugin.","83","     * This is also used in the URL within Hudson, so it needs","84","     * to remain stable even when the *.hpi file name is changed","85","     * (like Maven does.)","147","            expandDir = new File(archive.getParentFile(), getBaseName(archive));","162","        this.shortName = computeShortName(manifest,archive);","163","","206","    private String computeShortName(Manifest manifest, File archive) {","207","        \/\/ use the name captured in the manifest, as often plugins","208","        \/\/ depend on the specific short name in its URLs.","209","        String n = manifest.getMainAttributes().getValue(\"Short-Name\");","210","        if(n!=null)     return n;","211","","212","        \/\/ maven seems to put this automatically, so good fallback to check.","213","        n = manifest.getMainAttributes().getValue(\"Extension-Name\");","214","        if(n!=null)     return n;","215","","216","        \/\/ otherwise infer from the file name, since older plugins don't have","217","        \/\/ this entry.","218","        return getBaseName(archive);","219","    }","220","","359","    private static String getBaseName(File archive) {"],"delete":["82","     * Short name of the plugin. The \"abc\" portion of \"abc.hpl\".","121","        this.shortName = getShortName(archive);","122","","146","            expandDir = new File(archive.getParentFile(), shortName);","341","    private static String getShortName(File archive) {"]}]}},"ab16e52519260c0e9398f15256ed8061a4c00bf0":{"changes":{"test\/src\/test\/java\/jenkins\/I18nTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/util\/ResourceBundleUtil.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/HttpResponses.java":"MODIFY"},"diff":{"test\/src\/test\/java\/jenkins\/I18nTest.java":[{"add":["25","import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;","34","import org.jvnet.hudson.test.Issue;","53","        try {","54","            JSONObject response = jenkinsRule.getJSON(\"i18n\/resourceBundle?baseName=com.acme.XyzWhatever\").getJSONObject();","55","        } catch (FailingHttpStatusCodeException e) {","56","            Assert.assertNotNull(e);","57","            Assert.assertTrue(e.getMessage().contains(\"com.acme.XyzWhatever\"));","58","        }","59","    }","60","","61","    @Issue(\"JENKINS-35270\")","62","    @Test","63","    public void test_baseName_plugin() throws IOException, SAXException {","64","        \/\/ ssh-slaves plugin is installed by default","65","        JSONObject response = jenkinsRule.getJSON(\"i18n\/resourceBundle?baseName=hudson.plugins.sshslaves.Messages\").getJSONObject();","66","        Assert.assertEquals(\"ok\", response.getString(\"status\"));","67","        JSONObject data = response.getJSONObject(\"data\");","68","        Assert.assertEquals(\"The launch timeout must be a number.\", data.getString(\"SSHConnector.LaunchTimeoutMustBeANumber\"));"],"delete":["51","        JSONObject response = jenkinsRule.getJSON(\"i18n\/resourceBundle?baseName=com.acme.XyzWhatever\").getJSONObject();","52","        Assert.assertEquals(\"error\", response.getString(\"status\"));","53","        Assert.assertTrue(response.getString(\"message\").contains(\"com.acme.XyzWhatever\"));"]}],"core\/src\/main\/java\/jenkins\/util\/ResourceBundleUtil.java":[{"add":["29","import javax.annotation.CheckForNull;","31","import hudson.PluginWrapper;","32","import java.util.logging.Logger;","38","import jenkins.model.Jenkins;","48","    private static final Logger logger = Logger.getLogger(\"jenkins.util.ResourceBundle\");","79","        ResourceBundle bundle = getBundle(baseName, locale, Jenkins.class.getClassLoader());","80","        if (bundle == null) {","81","            \/\/ Not in Jenkins core. Check the plugins.","82","            Jenkins jenkins = Jenkins.getInstance(); \/\/ will never return null","83","            if (jenkins != null) {","84","                for (PluginWrapper plugin : jenkins.getPluginManager().getPlugins()) {","85","                    bundle = getBundle(baseName, locale, plugin.classLoader);","86","                    if (bundle != null) {","87","                        break;","88","                    }","89","                }","90","            }","91","        }","92","        if (bundle == null) {","93","            throw new MissingResourceException(\"Can't find bundle for base name \"","94","                    + baseName + \", locale \" + locale, baseName + \"_\" + locale, \"\");","95","        }","103","    \/**","104","     * Get a plugin bundle using the supplied Locale and classLoader","105","     *","106","     * @param baseName The bundle base name.","107","     * @param locale The Locale.","108","     * @param classLoader The classLoader","109","     * @return The bundle JSON.","110","     *\/","111","    private static @CheckForNull ResourceBundle getBundle(@Nonnull String baseName, @Nonnull Locale locale, @Nonnull ClassLoader classLoader) {","112","        try {","113","            return ResourceBundle.getBundle(baseName, locale, classLoader);","114","        } catch (MissingResourceException e) {","115","            \/\/ fall through and return null.","116","            logger.warning(e.getMessage());","117","        }","118","        return null;","119","    }","120","","121","    \/**","122","     * Create a JSON representation of a resource bundle","123","     *","124","     * @param bundle The resource bundle.","125","     * @return The bundle JSON.","126","     *\/"],"delete":["74","        ResourceBundle bundle = ResourceBundle.getBundle(baseName, locale);"]}],"core\/src\/main\/java\/hudson\/util\/HttpResponses.java":[{"add":["31","import javax.annotation.CheckForNull;"],"delete":[]}]}},"b295527b62ae993da1c06c55a1c035c47b52c2b1":{"changes":{"core\/src\/main\/resources\/jenkins\/install\/pluginSetupWizard_it.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/install\/pluginSetupWizard_it.properties":[{"add":["11","Per informazioni sul processo di installazione Jenkins in assenza di una connessione a Internet, si veda la \\","24","installWizard_installCustom_pluginListDesc=Si noti che qui non viene visualizzata la lista completa di plugins. \\u00C8 possibile installare plugin aggiuntivi nel <strong>Gestore plugin<\/strong> una volta completata la fase di installazione iniziale. <a href=\"https:\/\/jenkins.io\/redirect\/installation-wizard\" target=\"_blank\">Si veda il Wiki per ulteriori informazioni<\/a>.","36","installWizard_installComplete_installComplete_restartRequiredNotSupportedMessage=Installazione di Jenkins completata, ma alcuni plugin richiedono il riavvio di Jenkins e sembra che questa istanza non supporti il riavvio automatico. Riavviare manualmente questa istanza ora per completare l''installazione.","47","durante la procedura guidata di installazione.\\"],"delete":["11","Per informazioni sul processo di Jenkins in assenza di una connessione a Internet, si veda la \\","24","installWizard_installCustom_pluginListDesc=Si noti che qui non viene visualizzata la lista completo di plugins. \\u00C8 possibile installare plugin aggiuntivi nel <strong>Gestore plugin<\/strong> una volta completata la fase di installazione iniziale. <a href=\"https:\/\/jenkins.io\/redirect\/installation-wizard\" target=\"_blank\">Si veda il Wiki per ulteriori informazioni<\/a>.","36","installWizard_installComplete_installComplete_restartRequiredNotSupportedMessage=Installazione di Jenkins completata, ma alcuni plugin richiedono il riavvio di Jenkins e sembra che quest istanza non supporti il riavvio automatico. Riavviare manualmente quest istanza ora per completare l''installazione.","47","per accedere alla procedura guidata di installazione.\\"]}]}},"3450b52a8ac90c357fb96a67c58eaf2b8e68d01c":{"changes":{"core\/src\/main\/java\/jenkins\/util\/VirtualFile.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/util\/VirtualFile.java":[{"add":["40","import java.nio.file.InvalidPathException;","308","            } catch (InvalidPathException x2) {","309","                \/\/ if this cannot be converted to a path, it cannot be an illegal symlink, as it cannot exist","310","                Logger.getLogger(VirtualFile.class.getName()).log(Level.FINE, \"Could not convert \" + f + \" to path\", x2);"],"delete":[]}]}},"33799df36cbf2f5e0c5d0ac8372ff761e82c3784":{"changes":{"core\/src\/main\/resources\/hudson\/diagnosis\/ReverseProxySetupMonitor\/message.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/diagnosis\/ReverseProxySetupMonitor\/message.jelly":[{"add":["29","          if (transport.status != 200) {","30","          ","31","            "],"delete":["29","          if (transport.status==0 || transport.status==404) {"]}]}},"574fe1409ec80135c91054ed13afd131fa5eb48c":{"changes":{"changelog.html":"MODIFY","core\/src\/test\/java\/hudson\/FilePathTest.java":"MODIFY","core\/src\/main\/java\/hudson\/FilePath.java":"MODIFY"},"diff":{"changelog.html":[{"add":["60","  <li class=bug>","61","    When copying a directory from master to slave fails due to an error on the slave, properly report it.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9540\">issue 9540<\/a>)"],"delete":[]}],"core\/src\/test\/java\/hudson\/FilePathTest.java":[{"add":["208","    @Bug(9540)","209","    public void testErrorMessageInRemoteCopyRecursive() throws Exception {","210","        File tmp = Util.createTempDir();","211","        try {","212","            File src = new File(tmp, \"src\");","213","            File dst = new File(tmp, \"dst\");","214","            FilePath from = new FilePath(src);","215","            FilePath to = new FilePath(british, dst.getAbsolutePath());","216","            for (int i = 0; i < 10000; i++) {","217","                \/\/ TODO is there a simpler way to force the TarOutputStream to be flushed and the reader to start?","218","                \/\/ Have not found a way to make the failure guaranteed.","219","                OutputStream os = from.child(\"content\" + i).write();","220","                try {","221","                    for (int j = 0; j < 1024; j++) {","222","                        os.write('.');","223","                    }","224","                } finally {","225","                    os.close();","226","                }","227","            }","228","            FilePath toF = to.child(\"content0\");","229","            toF.write().close();","230","            toF.chmod(0400);","231","            try {","232","                from.copyRecursiveTo(to);","233","                \/\/ on Windows this may just succeed; OK, test did not prove anything then","234","            } catch (IOException x) {","235","                if (Functions.printThrowable(x).contains(\"content0\")) {","236","                    \/\/ Fine, error message talks about permission denied.","237","                } else {","238","                    throw x;","239","                }","240","            } finally {","241","                toF.chmod(700);","242","            }","243","        } finally {","244","            Util.deleteRecursive(tmp);","245","        }","246","    }","247",""],"delete":[]}],"core\/src\/main\/java\/hudson\/FilePath.java":[{"add":["1933","            Future<Integer> future2 = actAsync(new FileCallable<Integer>() {","1934","                private static final long serialVersionUID = 1L;","1935","                @Override public Integer invoke(File f, VirtualChannel channel) throws IOException, InterruptedException {","1936","                    return writeToTar(new File(remote),fileMask,excludes,TarCompression.GZIP.compress(pipe.getOut()));","1937","                }","1938","            });","1940","                \/\/ JENKINS-9540 in case the reading side failed, report that error first","1942","                return future2.get();"],"delete":["1933","            int r = writeToTar(new File(remote),fileMask,excludes,TarCompression.GZIP.compress(pipe.getOut()));","1939","            return r;"]}]}},"1b2cd19a61600cb8b886637224d92a51e6032a93":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/NodeProvisioner.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/NodeProvisioner.java":[{"add":["34","import jenkins.util.Timer;","139","    private transient volatile boolean queuedReview;","169","     * Hints are throttled to one every second.","174","        if (!queuedReview) {","175","            long delay = TimeUnit.SECONDS.toMillis(1) - (System.currentTimeMillis() - lastSuggestedReview);","176","            if (delay < 0) {","177","                lastSuggestedReview = System.currentTimeMillis();","178","                Computer.threadPoolForRemoting.submit(() -> {","181","                });","182","            } else {","183","                queuedReview = true;","184","                LOGGER.fine(() -> \"running suggested review in \" + delay + \" ms for \" + label);","185","                Timer.get().schedule(() -> {","186","                    lastSuggestedReview = System.currentTimeMillis();","187","                    LOGGER.fine(() -> \"running suggested review for \" + label + \" after \" + delay + \" ms\");","188","                    update();","189","                }, delay, TimeUnit.MILLISECONDS);","190","            }","208","            queuedReview = false;","222","            Queue.withLock(() -> {"],"delete":["167","     * The hint will be ignored if subjected to excessive pestering by callers.","172","        if (System.currentTimeMillis() > lastSuggestedReview + TimeUnit.SECONDS.toMillis(1)) {","173","            lastSuggestedReview = System.currentTimeMillis();","174","            Computer.threadPoolForRemoting.submit(new Runnable() {","175","                public void run() {","178","                }","179","            });","197","","211","            Queue.withLock(new Runnable() {","212","                @Override","213","                public void run() {","313","                }"]}]}},"d88df7eac540ffd3d6661e9c5415a937a711f907":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["42","  <li class='major bug'>","43","    Fixed a master\/slave communication problem that often manifests as \"Not in GZIP format\"","44","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-7745\">issue 7745<\/a>)","50","<h3><a name=v1.396>What's new in 1.396<\/a> <!--=DATE=--><\/h3>","64","  <li class'major rfe'>","67","<\/div><!--=END=-->"],"delete":["42","  <li class=rfe>","43","    Added auto-completion to the build trigger.","49","<h3><a name=v1.397>What's new in 1.397<\/a> <!--=DATE=--><\/h3>","50","<!--=RC-CHANGES=-->","51","<\/div><!--=END=-->","52","<h3><a name=v1.396>What's new in 1.396<\/a> (2011\/02\/02)<\/h3>","66","  <li class='major rfe'>"]}]}},"fdaee7eba3eb2e4fae59255138fa70aa5ada19dc":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/security\/ACL.java":"MODIFY"},"diff":{"changelog.html":[{"add":["65","  <li class=bug>","66","    API token authentication was broken in 1.461","67","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-13600\">issue 13600<\/a>)"],"delete":[]}],"core\/src\/main\/java\/hudson\/security\/ACL.java":[{"add":["132","        SecurityContextHolder.setContext(new NotSerilizableSecurityContext(auth));"],"delete":["132","        SecurityContextHolder.setContext(new NotSerilizableSecurityContext(ACL.SYSTEM));"]}]}},"507af4ee41bbef398de92c2e3a684c0fdb76324c":{"changes":{"core\/src\/main\/resources\/hudson\/model\/View\/main.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/View\/main.jelly":[{"add":["1","  <j:choose xmlns:local=\"local\">","2","    <d:taglib uri=\"local\">","3","      <d:tag name=\"viewTabs\">","13","      <\/d:tag>","14","    <\/d:taglib>","15","    <j:when test=\"${empty(items)}\">","16","      <local:viewTabs\/>","17","      <br\/>","18","      <st:include page=\"noJob.jelly\" \/>","19","    <\/j:when>","20","    <j:otherwise>","21","      <!-- set @jobBaseUrl=\"\" so that links to jobs will be under this view. -->","22","      <t:projectView jobs=\"${items}\" jobBaseUrl=\"\" showViewTabs=\"true\" columnExtensions=\"${it.columns}\">","23","        <local:viewTabs\/>","27","<\/j:jelly>"],"delete":["1","  <j:choose>","2","    <j:when test=\"${empty(items)}\">","3","      <st:include page=\"noJob.jelly\" \/>","4","    <\/j:when>","5","    <j:otherwise>","6","      <!-- set @jobBaseUrl=\"\" so that links to jobs will be under this view. -->","7","      <t:projectView jobs=\"${items}\" jobBaseUrl=\"\" showViewTabs=\"true\" columnExtensions=\"${it.columns}\">","20","<\/j:jelly>"]}]}},"2b5c4b701c95ed9b71983e6af99a9917f5dfd2a5":{"changes":{"pom.xml":"MODIFY"},"diff":{"pom.xml":[{"add":["750","            <version>2.5.2<\/version>"],"delete":["754","          <!--<plugin>-->","755","            <!--<groupId>org.apache.maven.plugins<\/groupId>-->","756","            <!--<artifactId>maven-pmd-plugin<\/artifactId>-->","757","            <!--<version>2.5<\/version>-->","758","            <!--<configuration>-->","759","              <!--&lt;!&ndash;rulesets>-->","760","                  <!--<ruleset>ruleset.xml<\/ruleset>-->","761","                  <!--<\/rulesets&ndash;&gt;-->","762","            <!--<\/configuration>-->","763","          <!--<\/plugin>-->","764","          <!--<plugin>-->","765","            <!--<groupId>org.apache.maven.plugins<\/groupId>-->","766","            <!--<artifactId>maven-checkstyle-plugin<\/artifactId>-->","767","            <!--<version>2.6<\/version>-->","768","          <!--<\/plugin>-->"]}]}},"6bdd321228e1d8bcea43622c0af4b4cd9eedbc74":{"changes":{"core\/pom.xml":"MODIFY","test\/src\/test\/java\/hudson\/model\/QueueTest.java":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["41","    <stapler.version>1.236<\/stapler.version>"],"delete":["41","    <stapler.version>1.234<\/stapler.version>"]}],"test\/src\/test\/java\/hudson\/model\/QueueTest.java":[{"add":["28","import com.gargoylesoftware.htmlunit.xml.XmlPage;","424","    @Issue(\"JENKINS-27256\")","425","    @Test public void inQueueTaskLookupByAPI() throws Exception {","426","        FreeStyleProject p = r.createFreeStyleProject();","427","        Label label = Label.get(\"unknown-slave\");","428","","429","        \/\/ Give the project an \"unknown-slave\" label, forcing it to","430","        \/\/ stay in the queue after we schedule it, allowing us to query it.","431","        p.setAssignedLabel(label);","432","        p.scheduleBuild2(0);","433","","434","        JenkinsRule.WebClient webclient = r.createWebClient();","435","","436","        XmlPage queueItems = webclient.goToXml(\"queue\/api\/xml\");","437","        String queueTaskId = queueItems.getXmlDocument().getElementsByTagName(\"id\").item(0).getTextContent();","438","        assertNotNull(queueTaskId);","439","        XmlPage queueItem = webclient.goToXml(\"queue\/item\/\" + queueTaskId + \"\/api\/xml\");","440","        assertNotNull(queueItem);","441","        String tagName = queueItem.getDocumentElement().getTagName();","442","        assertTrue(tagName.equals(\"blockedItem\") || tagName.equals(\"buildableItem\"));","443","    }","444",""],"delete":[]}]}},"adf01d08884bcebbb802543fb71c68073bb6c7cc":{"changes":{"test\/pom.xml":"MODIFY"},"diff":{"test\/pom.xml":[{"add":[],"delete":["84","          <!--","85","            during test, this jar gets loaded at the same level as remoting.jar and can cause conflicts depending on the order.","86","            the package is also not signed, and it creates package conflicts between the signed package from remoting.jar","87","          -->","88","          <groupId>org.jenkins-ci<\/groupId>","89","          <artifactId>SECURITY-144-compat<\/artifactId>","90","        <\/exclusion>","91","        <exclusion>"]}]}},"0b56fb5354b483f5a0f0860f587f5f3cc1b8d939":{"changes":{"test\/src\/test\/java\/hudson\/model\/ListViewTest.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/ListViewTest.java":[{"add":["268","","277","","283","            assertEquals(e.getMessage(), \"Query parameter 'name' does not correspond to a known and readable item\");"],"delete":["268","        ","277","        ","283","            assertEquals(e.getMessage(), \"Query parameter 'name' does not correspond to a known item\");"]}]}},"6999c607f86d91be5f7137de3214f83b6d6344eb":{"changes":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":[{"add":["3"," * Copyright (c) 2009-2010, Sun Microsystems, Inc.","164","            if (launcher.launch().cmds(jdkBundle, \"-noregister\")","165","                  .stdin(new ByteArrayInputStream(\"yes\".getBytes())).stdout(out)","166","                  .pwd(new FilePath(launcher.getChannel(), expectedLocation)).join() != 0)","212","            if (launcher.launch().cmds(args).stdout(out)","213","                  .pwd(new FilePath(launcher.getChannel(), expectedLocation)).join() != 0) {"],"delete":["3"," * Copyright (c) 2009, Sun Microsystems, Inc.","164","            if(launcher.launch().cmds(jdkBundle,\"-noregister\")","165","                .stdin(new ByteArrayInputStream(\"yes\".getBytes())).stdout(out).pwd(expectedLocation).join()!=0)","211","            if(launcher.launch().cmds(args).stdout(out).pwd(expectedLocation).join()!=0) {"]}]}},"5f443a7dba06791a8877437d984a415634d602ca":{"changes":{"test\/src\/test\/java\/hudson\/model\/DirectlyModifiableViewTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/ListView.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/DirectlyModifiableView.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/DirectlyModifiableViewTest.java":[{"add":["30","import javax.annotation.Nonnull;","31","","32","import org.hamcrest.Matchers;","37","import org.jvnet.hudson.test.MockFolder;","96","    public void doAddNestedJobToRecursiveView() throws Exception {","97","        ListView view = new ListView(\"a_view\", j.jenkins);","98","        view.setRecurse(true);","99","        j.jenkins.addView(view);","100","","101","        MockFolder folder = j.createFolder(\"folder\");","102","        FreeStyleProject np = folder.createProject(FreeStyleProject.class, \"nested_project\");","103","","104","        view.add(np);","105","        assertTrue(view.contains(np));","106","        view.remove(np);","107","        assertFalse(view.contains(np));","108","","109","        Page page = doPost(view, \"addJobToView?name=folder\/nested_project\");","110","        j.assertGoodStatus(page);","111","        assertTrue(view.contains(np));","112","","113","        page = doPost(view, \"removeJobFromView?name=folder\/nested_project\");","114","        j.assertGoodStatus(page);","115","        assertFalse(view.contains(np));","116","","117","        MockFolder nf = folder.createProject(MockFolder.class, \"nested_folder\");","118","        FreeStyleProject nnp = nf.createProject(FreeStyleProject.class, \"nested_nested_project\");","119","        ListView nestedView = new ListView(\"nested_view\", folder);","120","        nestedView.setRecurse(true);","121","        folder.addView(nestedView);","122","","123","        page = doPost(nestedView, \"addJobToView?name=nested_folder\/nested_nested_project\");","124","        j.assertGoodStatus(page);","125","        assertTrue(nestedView.contains(nnp));","126","","127","        page = doPost(nestedView, \"removeJobFromView?name=nested_folder\/nested_nested_project\");","128","        j.assertGoodStatus(page);","129","        assertFalse(nestedView.contains(nnp));","130","","131","        page = doPost(nestedView, \"addJobToView?name=\/folder\/nested_folder\/nested_nested_project\");","132","        j.assertGoodStatus(page);","133","        assertTrue(nestedView.contains(nnp));","134","","135","        page = doPost(nestedView, \"removeJobFromView?name=\/folder\/nested_folder\/nested_nested_project\");","136","        j.assertGoodStatus(page);","137","        assertFalse(nestedView.contains(nnp));","138","    }","139","","140","    @Test","175","","176","        MockFolder folder = j.createFolder(\"folder\");","177","        ListView folderView = new ListView(\"folder_view\", folder);","178","        folder.addView(folderView);","179","","180","        assertBadStatus( \/\/ Item is scoped to different ItemGroup","181","                doPost(folderView, \"addJobToView?name=top_project\"),","182","                \"Query parameter 'name' does not correspond to a known item\"","183","        );","200","        assertThat(rsp.getContentAsString(), Matchers.containsString(message));"],"delete":["142","        assertTrue(rsp.getContentAsString().contains(message));"]}],"core\/src\/main\/java\/hudson\/model\/ListView.java":[{"add":["314","        TopLevelItem item = resolveName(name);","333","        TopLevelItem item = resolveName(name);","340","    private TopLevelItem resolveName(String name) {","341","        TopLevelItem item = getOwnerItemGroup().getItem(name);","342","        if (item == null) {","343","            name = Items.getCanonicalName(getOwnerItemGroup(), name);","344","            item = Jenkins.getInstance().getItemByFullName(name, TopLevelItem.class);","345","        }","346","        return item;","347","    }","348",""],"delete":["314","        TopLevelItem item = getOwnerItemGroup().getItem(name);","333","        TopLevelItem item = getOwnerItemGroup().getItem(name);"]}],"core\/src\/main\/java\/hudson\/model\/DirectlyModifiableView.java":[{"add":["64","     * This method should {@link RequirePOST}.","66","     * @param name Item name. This can be either full name relative to owner item group or full item name prefixed with '\/'.","73","     * This method should {@link RequirePOST}.","75","     * @param name Item name. This can be either full name relative to owner item group or full item name prefixed with '\/'."],"delete":["64","     * This method should @RequirePOST.","66","     * @param name Item name.","73","     * This method should @RequirePOST.","75","     * @param name Item name."]}]}},"7f856b56082b0b164c94bafc108408dfc4b4b138":{"changes":{"core\/src\/main\/java\/hudson\/ClassicPluginStrategy.java":"MODIFY","core\/src\/main\/java\/hudson\/PluginStrategy.java":"MODIFY","core\/src\/main\/java\/hudson\/PluginWrapper.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY","test\/src\/test\/java\/hudson\/PluginManagerTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/ClassicPluginStrategy.java":[{"add":["68","import java.util.jar.JarFile;","95","    @Override public String getShortName(File archive) throws IOException {","96","        Manifest manifest;","97","        if (isLinked(archive)) {","98","            manifest = loadLinkedManifest(archive);","99","        } else {","100","            JarFile jf = new JarFile(archive, false);","101","            try {","102","                manifest = jf.getManifest();","103","            } finally {","104","                jf.close();","105","            }","106","        }","107","        return PluginWrapper.computeShortName(manifest, archive);","108","    }","110","    private static boolean isLinked(File archive) {","111","        return archive.getName().endsWith(\".hpl\") || archive.getName().endsWith(\".jpl\");","112","    }","114","    private static Manifest loadLinkedManifest(File archive) throws IOException {","126","                return new Manifest(in);","132","    }","133","","134","    @Override public PluginWrapper createPluginWrapper(File archive) throws IOException {","135","        final Manifest manifest;","136","        URL baseResourceURL;","137","","138","        File expandDir = null;","139","        \/\/ if .hpi, this is the directory where war is expanded","140","","141","        boolean isLinked = isLinked(archive);","142","        if (isLinked) {","143","            manifest = loadLinkedManifest(archive);"],"delete":["94","    public PluginWrapper createPluginWrapper(File archive) throws IOException {","95","        final Manifest manifest;","96","        URL baseResourceURL;","98","        File expandDir = null;","99","        \/\/ if .hpi, this is the directory where war is expanded","101","        boolean isLinked = archive.getName().endsWith(\".hpl\") || archive.getName().endsWith(\".jpl\");","102","        if (isLinked) {","114","                manifest = new Manifest(in);"]}],"core\/src\/main\/java\/hudson\/PluginStrategy.java":[{"add":["29","import javax.annotation.Nonnull;","51","    \/**","52","     * Finds the plugin name without actually unpacking anything {@link #createPluginWrapper} would.","53","     * Needed by {@link PluginManager#dynamicLoad} to decide whether such a plugin is already installed.","54","     * @return the {@link PluginWrapper#getShortName}","55","     *\/","56","    @Nonnull String getShortName(File archive) throws IOException;","57",""],"delete":["26","import jenkins.model.Jenkins;","27",""]}],"core\/src\/main\/java\/hudson\/PluginWrapper.java":[{"add":["240","    static String computeShortName(Manifest manifest, File archive) {"],"delete":["240","    private String computeShortName(Manifest manifest, File archive) {"]}],"changelog.html":[{"add":["58","    Misleading error message trying to dynamically update a plugin (which is impossible) on an NFS filesystem.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-12753\">issue 12753<\/a>)","60","  <li class=\"bug\">"],"delete":[]}],"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["414","        PluginWrapper p = null;","415","        String sn;","416","        try {","417","            sn = strategy.getShortName(arc);","418","        } catch (AbstractMethodError x) {","419","            LOGGER.log(WARNING, \"JENKINS-12753 fix not active: {0}\", x.getMessage());","420","            p = strategy.createPluginWrapper(arc);","421","            sn = p.getShortName();","422","        }","426","        if (p == null) {","427","            p = strategy.createPluginWrapper(arc);","428","        }","454","        final ClassLoader loader = p.classLoader;","455","        r.addAll(new InitializerFinder(loader) {","458","                return e.getDeclaringClass().getClassLoader() != loader || super.filter(e);"],"delete":["414","        final PluginWrapper p = strategy.createPluginWrapper(arc);","415","        String sn = p.getShortName();","444","        r.addAll(new InitializerFinder(p.classLoader) {","447","                return e.getDeclaringClass().getClassLoader()!=p.classLoader || super.filter(e);"]}],"test\/src\/test\/java\/hudson\/PluginManagerTest.java":[{"add":["42","import jenkins.RestartRequiredException;","359","    @Bug(12753)","360","    @WithPlugin(\"tasks.jpi\")","361","    @Test public void dynamicLoadRestartRequiredException() throws Exception {","362","        File jpi = new File(r.jenkins.getRootDir(), \"plugins\/tasks.jpi\");","363","        assertTrue(jpi.isFile());","364","        FileUtils.touch(jpi);","365","        File timestamp = new File(r.jenkins.getRootDir(), \"plugins\/tasks\/.timestamp2\");","366","        assertTrue(timestamp.isFile());","367","        long lastMod = timestamp.lastModified();","368","        try {","369","            r.jenkins.getPluginManager().dynamicLoad(jpi);","370","            fail(\"should not have worked\");","371","        } catch (RestartRequiredException x) {","372","            \/\/ good","373","        }","374","        assertEquals(\"should not have tried to delete & unpack\", lastMod, timestamp.lastModified());","375","    }","376",""],"delete":[]}]}},"64b953d13c3cc2ab6388045a111967320f34f050":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/resources\/lib\/layout\/layout.jelly":"MODIFY"},"diff":{"changelog.html":[{"add":["65","  <li class=bug>","66","    Jenkins logo headless when server is starting.","67","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-11444\">issue 11444<\/a>)"],"delete":[]}],"core\/src\/main\/resources\/lib\/layout\/layout.jelly":[{"add":["237","          <div id=\"navigation\" style=\"min-height: 323px; height: auto !important; height: 323px;\">"],"delete":["237","          <div id=\"navigation\">"]}]}},"3caef8ec3278f0554f23098beaf25be6adf19679":{"changes":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":[{"add":["58","import java.util.Optional;","686","            return get(UnixReflection.pid(proc));","814","    \/\/TODO: can be replaced by multi-release JAR","821","         * Required for Java 8 and older JVMs.","823","        private static final Field JAVA8_PID_FIELD;","824","","825","        \/**","826","         * Field to access the PID of the process.","827","         * Required for Java 9 and above until this is replaced by multi-release JAR.","828","         *\/","829","        private static final Method JAVA9_PID_METHOD;","836","        private static final Method JAVA8_DESTROY_PROCESS;","837","        private static final Method JAVA_9_PROCESSHANDLE_OF;","838","        private static final Method JAVA_9_PROCESSHANDLE_DESTROY;","842","                if (isPostJava8()) { \/\/ Java 9+","843","                    Class<?> clazz = Process.class;","844","                    JAVA9_PID_METHOD = clazz.getMethod(\"pid\");","845","                    JAVA8_PID_FIELD = null;","846","                    Class<?> processHandleClazz = Class.forName(\"java.lang.ProcessHandle\");","847","                    JAVA_9_PROCESSHANDLE_OF = processHandleClazz.getMethod(\"of\", long.class);","848","                    JAVA_9_PROCESSHANDLE_DESTROY = processHandleClazz.getMethod(\"destroy\");","849","                    JAVA8_DESTROY_PROCESS = null;","851","                    Class<?> clazz = Class.forName(\"java.lang.UNIXProcess\");","852","                    JAVA8_PID_FIELD = clazz.getDeclaredField(\"pid\");","853","                    JAVA8_PID_FIELD.setAccessible(true);","854","                    JAVA9_PID_METHOD = null;","855","","856","                    JAVA8_DESTROY_PROCESS = clazz.getDeclaredMethod(\"destroyProcess\", int.class, boolean.class);","857","                    JAVA8_DESTROY_PROCESS.setAccessible(true);","858","                    JAVA_9_PROCESSHANDLE_OF = null;","859","                    JAVA_9_PROCESSHANDLE_DESTROY = null;","861","            } catch (ClassNotFoundException | NoSuchFieldException | NoSuchMethodException e) {","862","                LinkageError x = new LinkageError(\"Cannot initialize reflection for Unix Processes\", e);","867","        public static void destroy(int pid) throws IllegalAccessException,","868","                InvocationTargetException {","869","            if (JAVA8_DESTROY_PROCESS != null) {","870","                JAVA8_DESTROY_PROCESS.invoke(null, pid, false);","872","                final Optional handle = (Optional)JAVA_9_PROCESSHANDLE_OF.invoke(null, pid);","873","                if (handle.isPresent()) {","874","                    JAVA_9_PROCESSHANDLE_DESTROY.invoke(handle.get());","875","                }","879","        \/\/TODO: We ideally need to update ProcessTree APIs to Support Long (JENKINS-53799).","880","        public static int pid(@Nonnull Process proc) {","881","            try {","882","                if (JAVA8_PID_FIELD != null) {","883","                    return JAVA8_PID_FIELD.getInt(proc);","884","                } else {","885","                    long pid = (long)JAVA9_PID_METHOD.invoke(proc);","886","                    if (pid > Integer.MAX_VALUE) {","887","                        throw new IllegalAccessError(\"Java 9+ support error (JENKINS-53799). PID is out of Jenkins API bounds: \" + pid);","888","                    }","889","                    return (int)pid;","890","                }","891","            } catch (IllegalAccessException | InvocationTargetException e) { \/\/ impossible","892","                IllegalAccessError x = new IllegalAccessError();","893","                x.initCause(e);","894","                throw x;","895","            }","896","        }","897","","898","        \/\/ Java 9 uses new version format","899","        private static boolean isPostJava8() {","900","            String javaVersion = System.getProperty(\"java.version\");","901","            return !javaVersion.startsWith(\"1.\");"],"delete":["66","import static java.util.logging.Level.FINE;","686","            try {","687","                return get((Integer) UnixReflection.PID_FIELD.get(proc));","688","            } catch (IllegalAccessException e) { \/\/ impossible","689","                IllegalAccessError x = new IllegalAccessError();","690","                x.initCause(e);","691","                throw x;","692","            }","827","        private static final Field PID_FIELD;","834","        private static final Method DESTROY_PROCESS;","838","                Class<?> clazz = Class.forName(\"java.lang.UNIXProcess\");","839","                PID_FIELD = clazz.getDeclaredField(\"pid\");","840","                PID_FIELD.setAccessible(true);","841","","842","                if (isPreJava8()) {","843","                    DESTROY_PROCESS = clazz.getDeclaredMethod(\"destroyProcess\",int.class);","845","                    DESTROY_PROCESS = clazz.getDeclaredMethod(\"destroyProcess\",int.class, boolean.class);","847","                DESTROY_PROCESS.setAccessible(true);","848","            } catch (ClassNotFoundException e) {","849","                LinkageError x = new LinkageError();","850","                x.initCause(e);","851","                throw x;","852","            } catch (NoSuchFieldException e) {","853","                LinkageError x = new LinkageError();","854","                x.initCause(e);","855","                throw x;","856","            } catch (NoSuchMethodException e) {","857","                LinkageError x = new LinkageError();","858","                x.initCause(e);","863","        public static void destroy(int pid) throws IllegalAccessException, InvocationTargetException {","864","            if (isPreJava8()) {","865","                DESTROY_PROCESS.invoke(null, pid);","867","                DESTROY_PROCESS.invoke(null, pid, false);","871","        private static boolean isPreJava8() {","872","            int javaVersionAsAnInteger = Integer.parseInt(System.getProperty(\"java.version\").replaceAll(\"\\\\.\", \"\").replaceAll(\"_\", \"\").substring(0, 2));","873","            return javaVersionAsAnInteger < 18;"]}]}},"6ae32202576a24a7272ed29a4c7c59ac4551d5a7":{"changes":{"core\/src\/main\/resources\/hudson\/atom.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/rss20.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/atom.jelly":[{"add":["25","<j:jelly xmlns:j=\"jelly:core\" xmlns:l=\"\/lib\/layout\">","26","  <l:view contentType=\"application\/atom+xml;charset=UTF-8\"><!-- No whitespace before xml header: -->&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;","27","    <!-- ATOM. See http:\/\/atompub.org\/rfc4287.html for the format -->","28","    <feed xmlns=\"http:\/\/www.w3.org\/2005\/Atom\">","29","      <title>${title}<\/title>","30","      <link rel=\"alternate\" type=\"text\/html\" href=\"${rootURL}${url}\"\/>","32","      <j:choose>","33","        <j:when test=\"${empty(entries)}\">","34","          <updated>2001-01-01T00:00:00Z<\/updated>","35","        <\/j:when>","36","        <j:otherwise>","37","          <updated>${h.xsDate(adapter.getEntryTimestamp(entries[0]))}<\/updated>","38","        <\/j:otherwise>","39","      <\/j:choose>","40","      <author>","41","        <name>Jenkins Server<\/name>","42","      <\/author>","43","      <id>urn:uuid:903deee0-7bfa-11db-9fe1-0800200c9a66<\/id>","45","      <j:forEach var=\"e\" items=\"${entries}\" >","46","        <entry>","47","          <title>${adapter.getEntryTitle(e)}<\/title>","48","          <link rel=\"alternate\" type=\"text\/html\" href=\"${rootURL}${h.encode(adapter.getEntryUrl(e))}\"\/>","49","          <id>${adapter.getEntryID(e)}<\/id>","50","          <published>${h.xsDate(adapter.getEntryTimestamp(e))}<\/published>","51","          <updated>${h.xsDate(adapter.getEntryTimestamp(e))}<\/updated>","52","          <j:set var=\"desc\" value=\"${adapter.getEntryDescription(e)}\"\/>","53","          <j:if test=\"${desc!=null}\">","54","            <content>${desc}<\/content>","55","          <\/j:if>","56","        <\/entry>","57","      <\/j:forEach>","58","    <\/feed>","59","  <\/l:view>"],"delete":["25","<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\"><st:contentType value=\"application\/atom+xml;charset=UTF-8\" \/><!-- No whitespace before xml header: -->&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;","27","  <!-- ATOM. See http:\/\/atompub.org\/rfc4287.html for the format -->","28","  <feed xmlns=\"http:\/\/www.w3.org\/2005\/Atom\">","29","    <title>${title}<\/title>","30","    <link rel=\"alternate\" type=\"text\/html\" href=\"${rootURL}${url}\"\/>","32","    <j:choose>","33","      <j:when test=\"${empty(entries)}\">","34","        <updated>2001-01-01T00:00:00Z<\/updated>","35","      <\/j:when>","36","      <j:otherwise>","37","        <updated>${h.xsDate(adapter.getEntryTimestamp(entries[0]))}<\/updated>","38","      <\/j:otherwise>","39","    <\/j:choose>","40","    <author>","41","      <name>Jenkins Server<\/name>","42","    <\/author>","43","    <id>urn:uuid:903deee0-7bfa-11db-9fe1-0800200c9a66<\/id>","44","","45","    <j:forEach var=\"e\" items=\"${entries}\" >","46","      <entry>","47","        <title>${adapter.getEntryTitle(e)}<\/title>","48","        <link rel=\"alternate\" type=\"text\/html\" href=\"${rootURL}${h.encode(adapter.getEntryUrl(e))}\"\/>","49","        <id>${adapter.getEntryID(e)}<\/id>","50","        <published>${h.xsDate(adapter.getEntryTimestamp(e))}<\/published>","51","        <updated>${h.xsDate(adapter.getEntryTimestamp(e))}<\/updated>","52","        <j:set var=\"desc\" value=\"${adapter.getEntryDescription(e)}\"\/>","53","        <j:if test=\"${desc!=null}\">","54","          <content>${desc}<\/content>","55","        <\/j:if>","56","      <\/entry>","57","    <\/j:forEach>","58","  <\/feed>"]}],"core\/src\/main\/resources\/hudson\/rss20.jelly":[{"add":["25","<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:l=\"\/lib\/layout\">","26","  <l:view contentType=\"text\/xml;charset=UTF-8\"><!-- No whitespace before xml header: -->&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;","27","    <!-- RSS 2.0 feed. See http:\/\/cyber.law.harvard.edu\/rss\/rss.html for the format -->","28","    <rss version=\"2.0\">","29","      <channel>","30","        <title>${title}<\/title>","31","        <link>${rootURL}${url}<\/link>","32","        <description>${title}<\/description>","34","        <j:forEach var=\"e\" items=\"${entries}\" >","35","          <item>","36","            <title>${adapter.getEntryTitle(e)}<\/title>","37","            <link>${rootURL}${h.encode(adapter.getEntryUrl(e))}<\/link>","38","            <guid isPermaLink=\"false\">${adapter.getEntryID(e)}<\/guid>","39","            <pubDate>${h.rfc822Date(adapter.getEntryTimestamp(e))}<\/pubDate>","40","            <author><st:out value=\"${adapter.getEntryAuthor(e)}\"\/><\/author>","41","            <j:set var=\"desc\" value=\"${adapter.getEntryDescription(e)}\"\/>","42","            <j:if test=\"${desc!=null}\">","43","              <description>${desc}<\/description>","44","            <\/j:if>","45","          <\/item>","46","        <\/j:forEach>","47","      <\/channel>","48","    <\/rss>","49","  <\/l:view>"],"delete":["25","<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\"><st:contentType value=\"text\/xml;charset=UTF-8\" \/><!-- No whitespace before xml header: -->&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;","27","  <!-- RSS 2.0 feed. See http:\/\/cyber.law.harvard.edu\/rss\/rss.html for the format -->","28","  <rss version=\"2.0\">","29","    <channel>","30","      <title>${title}<\/title>","31","      <link>${rootURL}${url}<\/link>","32","      <description>${title}<\/description>","33","","34","      <j:forEach var=\"e\" items=\"${entries}\" >","35","        <item>","36","          <title>${adapter.getEntryTitle(e)}<\/title>","37","          <link>${rootURL}${h.encode(adapter.getEntryUrl(e))}<\/link>","38","          <guid isPermaLink=\"false\">${adapter.getEntryID(e)}<\/guid>","39","          <pubDate>${h.rfc822Date(adapter.getEntryTimestamp(e))}<\/pubDate>","40","          <author><st:out value=\"${adapter.getEntryAuthor(e)}\"\/><\/author>","41","          <j:set var=\"desc\" value=\"${adapter.getEntryDescription(e)}\"\/>","42","          <j:if test=\"${desc!=null}\">","43","            <description>${desc}<\/description>","44","          <\/j:if>","45","        <\/item>","46","      <\/j:forEach>","47","    <\/channel>","48","  <\/rss>"]}]}},"0879051bdfe25a3f60e1cb7cc9546d905f82f637":{"changes":{"maven-plugin\/pom.xml":"MODIFY"},"diff":{"maven-plugin\/pom.xml":[{"add":[],"delete":["117","      <!-- this plugin is optional and is used to provide settigns.xml from a central UI -->","118","      <groupId>org.jenkins-ci.plugins<\/groupId>","119","      <artifactId>config-file-provider<\/artifactId>","120","      <version>1.9.1<\/version>","121","      <optional>true<\/optional>","122","    <\/dependency>","123","    <dependency>"]}]}},"6c521259e2b1061c105cb09724e4c29e8bc07ecd":{"changes":{"core\/src\/main\/java\/hudson\/widgets\/HistoryWidget.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/widgets\/HistoryWidget.java":[{"add":[],"delete":["35","import javax.servlet.http.HttpServletResponse;"]}],"changelog.html":[{"add":["66","  <li class=bug>","67","    Fixed an NPE when loading full build history.","68","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-8660\">issue 8660<\/a>)"],"delete":[]}]}},"6f335c3d7e30cc7b96b09c3be3b74c526b06cb05":{"changes":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":[{"add":["632","                return FormValidation.errorWithMarkup(Messages.JDKInstaller_RequireOracleAccount(Stapler.getCurrentRequest().getContextPath()+'\/'+getDescriptorUrl()+\"\/enterCredential\"));"],"delete":["632","                return FormValidation.errorWithMarkup(Messages.JDKInstaller_RequireOracleAccount(Stapler.getCurrentRequest().getContextPath()+getDescriptorUrl()+\"\/enterCredential\"));"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Auto Install JDK asks for Oracle account, but the link goes 404.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10556\">issue 10556<\/a>)"],"delete":["57","  <li class=>"]}]}},"3b73c45f52eb1ba83af9bdc2f1760f90708b3f6c":{"changes":{"test\/src\/test\/java\/hudson\/model\/UpdateSiteTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/UpdateSite.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/UpdateSiteTest.java":[{"add":["56","import org.jvnet.hudson.test.Issue;","154","","155","    @Issue(\"JENKINS-31448\")","156","    @Test public void isLegacyDefault() throws Exception {","157","        assertFalse(\"isLegacyDefault should be false with null id\",new UpdateSite(null,\"url\").isLegacyDefault());","158","        assertFalse(\"isLegacyDefault should be false when id is not default and url is http:\/\/hudson-ci.org\/\",new UpdateSite(\"dummy\",\"http:\/\/hudson-ci.org\/\").isLegacyDefault());","159","        assertTrue(\"isLegacyDefault should be true when id is default and url is http:\/\/hudson-ci.org\/\",new UpdateSite(UpdateCenter.PREDEFINED_UPDATE_SITE_ID,\"http:\/\/hudson-ci.org\/\").isLegacyDefault());","160","        assertTrue(\"isLegacyDefault should be true when url is http:\/\/updates.hudson-labs.org\/\",new UpdateSite(\"dummy\",\"http:\/\/updates.hudson-labs.org\/\").isLegacyDefault());","161","        assertFalse(\"isLegacyDefault should be false with null url\",new UpdateSite(null,null).isLegacyDefault());","162","    }"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/UpdateSite.java":[{"add":["487","        return isHudsonCI() || isUpdatesFromHudsonLabs();","488","    }","489","","490","    private boolean isHudsonCI() {","491","        return url != null && UpdateCenter.PREDEFINED_UPDATE_SITE_ID.equals(id) && url.startsWith(\"http:\/\/hudson-ci.org\/\");","492","    }","493","","494","    private boolean isUpdatesFromHudsonLabs() {","495","        return url != null && url.startsWith(\"http:\/\/updates.hudson-labs.org\/\");"],"delete":["487","        return id.equals(UpdateCenter.PREDEFINED_UPDATE_SITE_ID) && url.startsWith(\"http:\/\/hudson-ci.org\/\") || url.startsWith(\"http:\/\/updates.hudson-labs.org\/\");"]}]}},"2d5ad2ed2aec63fec162d428dd7d183711c8ef9a":{"changes":{"core\/src\/main\/resources\/lib\/hudson\/buildCaption.jelly":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/executors.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Job\/buildHistory.jelly":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/queue.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/hudson\/buildCaption.jelly":[{"add":["13","            <l:isAdmin>","14","\t            <a href=\"stop\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"[cancel]\" \/><\/a>","15","            <\/l:isAdmin>"],"delete":["13","\t          <a href=\"stop\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"[cancel]\" \/><\/a>"]}],"core\/src\/main\/resources\/lib\/hudson\/executors.jelly":[{"add":["48","                <l:isAdmin>","49","                  <a href=\"${rootURL}\/computers\/${cloop.index}\/executors\/${eloop.index}\/stop\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"terminate this build\" \/><\/a>","50","                <\/l:isAdmin>"],"delete":["48","\t              <a href=\"${rootURL}\/computers\/${cloop.index}\/executors\/${eloop.index}\/stop\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"terminate this build\" \/><\/a>"]}],"core\/src\/main\/resources\/hudson\/model\/Job\/buildHistory.jelly":[{"add":["59","              <l:isAdmin>","60","                <a href=\"${link}stop\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"[cancel]\"\/><\/a>","61","              <\/l:isAdmin>"],"delete":["59","              <a href=\"${link}stop\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"[cancel]\"\/><\/a>"]}],"core\/src\/main\/resources\/lib\/hudson\/queue.jelly":[{"add":["40","              <l:isAdmin>","41","                <a href=\"${rootURL}\/${item.project.url}cancelQueue\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"cancel this build\" \/><\/a>","42","              <\/l:isAdmin>","43","             <\/td>"],"delete":["40","              <a href=\"${rootURL}\/${item.project.url}cancelQueue\"><img src=\"${rootURL}\/images\/16x16\/stop.gif\" alt=\"cancel this build\" \/><\/a>","41","            <\/td>"]}]}},"af1a53d91c4863f27e4fad295911f131beb64b9a":{"changes":{"core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveAgentProtocol.java":"MODIFY","core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveAgentProtocol2.java":"MODIFY","core\/src\/main\/java\/jenkins\/slaves\/DefaultJnlpSlaveReceiver.java":"MODIFY","core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveAgentProtocol3.java":"ADD","core\/src\/main\/java\/jenkins\/slaves\/JnlpAgentReceiver.java":"MODIFY","core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveHandshake.java":"MODIFY","pom.xml":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveAgentProtocol.java":[{"add":["4","import hudson.model.Computer;","14","import org.jenkinsci.remoting.engine.JnlpServerHandshake;","71","    protected static class Handler extends JnlpServerHandshake {","83","            super(hub, Computer.threadPoolForRemoting, socket);"],"delete":["69","    protected static class Handler extends JnlpSlaveHandshake {","81","            super(hub,socket,","82","                    new DataInputStream(socket.getInputStream()),","83","                    new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream(),\"UTF-8\")),true));"]}],"core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveAgentProtocol2.java":[{"add":["3","import org.jenkinsci.remoting.engine.JnlpServerHandshake;","57","                try {","58","                    if (recv.handle(nodeName,this))","59","                        return;","60","                } catch (AbstractMethodError e) {","61","                    if (recv.handle(nodeName,new JnlpSlaveHandshake(this)))","62","                        return;","63","                }"],"delete":["56","                if (recv.handle(nodeName,this))","57","                    return;"]}],"core\/src\/main\/java\/jenkins\/slaves\/DefaultJnlpSlaveReceiver.java":[{"add":["9","import org.jenkinsci.remoting.engine.JnlpServerHandshake;","30","    public boolean handle(String nodeName, JnlpServerHandshake handshake) throws IOException, InterruptedException {","46","                } catch (ExecutionException | TimeoutException e) {","88","    private boolean matchesSecret(String nodeName, JnlpServerHandshake handshake){"],"delete":["29","    public boolean handle(String nodeName, JnlpSlaveHandshake handshake) throws IOException, InterruptedException {","45","                } catch (ExecutionException e) {","46","                    throw new IOException(\"Failed to disconnect the current client\",e);","47","                } catch (TimeoutException e) {","89","    private boolean matchesSecret(String nodeName, JnlpSlaveHandshake handshake){"]}],"core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveAgentProtocol3.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/jenkins\/slaves\/JnlpAgentReceiver.java":[{"add":["5","import jenkins.model.Jenkins;","6","import org.jenkinsci.remoting.engine.JnlpServerHandshake;","59","    public abstract boolean handle(String name, JnlpServerHandshake handshake) throws IOException, InterruptedException;","60","","61","    \/**","62","     * @deprecated","63","     *      Use {@link #handle(String, JnlpServerHandshake)}","64","     *\/","65","    public boolean handle(String name, JnlpSlaveHandshake handshake) throws IOException, InterruptedException {","66","        return handle(name,(JnlpServerHandshake)handshake);","67","    }","68",""],"delete":["57","    public abstract boolean handle(String name, JnlpSlaveHandshake handshake) throws IOException, InterruptedException;"]}],"core\/src\/main\/java\/jenkins\/slaves\/JnlpSlaveHandshake.java":[{"add":["2","import org.jenkinsci.remoting.engine.JnlpServerHandshake;","7","import java.util.concurrent.ExecutorService;","14"," * @deprecated as of 1.609","15"," *      Use {@link JnlpServerHandshake}","17","public class JnlpSlaveHandshake extends JnlpServerHandshake {","18","    \/*package*\/ JnlpSlaveHandshake(JnlpServerHandshake rhs) {","19","        super(rhs);"],"delete":["2","import hudson.model.Computer;","3","import hudson.remoting.Channel;","4","import hudson.remoting.ChannelBuilder;","5","import hudson.remoting.Engine;","8","import java.io.DataInputStream;","9","import java.io.DataOutputStream;","11","import java.io.PrintWriter;","13","import java.util.Map.Entry;","14","import java.util.Properties;","15","import java.util.logging.Level;","16","import java.util.logging.Logger;","24","public class JnlpSlaveHandshake {","25","    \/**","26","     * Useful for creating a {@link Channel} with NIO as the underlying transport.","27","     *\/","28","    \/*package*\/  final NioChannelHub hub;","29","","30","    \/**","31","     * Socket connection to the slave.","32","     *\/","33","    \/*package*\/  final Socket socket;","34","","35","    \/**","36","     * Wrapping Socket input stream.","37","     *\/","38","    \/*package*\/ final DataInputStream in;","39","","40","    \/**","41","     * For writing handshaking response.","42","     *","43","     * This is a poor design choice that we just carry forward for compatibility.","44","     * For better protocol design, {@link DataOutputStream} is preferred for newer","45","     * protocols.","46","     *\/","47","    \/*package*\/  final PrintWriter out;","48","","49","    \/**","50","     * Bag of properties the JNLP agent have sent us during the hand-shake.","51","     *\/","52","    \/*package*\/ final Properties request = new Properties();","53","","54","","55","    \/*package*\/ JnlpSlaveHandshake(NioChannelHub hub, Socket socket, DataInputStream in, PrintWriter out) {","56","        this.hub = hub;","57","        this.socket = socket;","58","        this.in = in;","59","        this.out = out;","61","","62","    public NioChannelHub getHub() {","63","        return hub;","64","    }","65","","66","    public Socket getSocket() {","67","        return socket;","68","    }","69","","70","    public DataInputStream getIn() {","71","        return in;","72","    }","73","","74","    public PrintWriter getOut() {","75","        return out;","76","    }","77","","78","    public Properties getRequestProperties() {","79","        return request;","80","    }","81","","82","    public String getRequestProperty(String name) {","83","        return request.getProperty(name);","84","    }","85","","86","","87","    \/**","88","     * Sends the error output and bail out.","89","     *\/","90","    public void error(String msg) throws IOException {","91","        out.println(msg);","92","        LOGGER.log(Level.WARNING,Thread.currentThread().getName()+\" is aborted: \"+msg);","93","        socket.close();","94","    }","95","","96","    \/**","97","     * {@link JnlpAgentReceiver} calls this method to tell the client that the server","98","     * is happy with the handshaking and is ready to move on to build a channel.","99","     *\/","100","    public void success(Properties response) {","101","        out.println(Engine.GREETING_SUCCESS);","102","        for (Entry<Object, Object> e : response.entrySet()) {","103","            out.println(e.getKey()+\": \"+e.getValue());","104","        }","105","        out.println(); \/\/ empty line to conclude the response header","106","    }","107","","108","    public ChannelBuilder createChannelBuilder(String nodeName) {","109","        if (hub==null)","110","            return new ChannelBuilder(nodeName, Computer.threadPoolForRemoting);","111","        else","112","            return hub.newChannelBuilder(nodeName, Computer.threadPoolForRemoting);","113","    }","114","","115","","116","    private static final Logger LOGGER = Logger.getLogger(JnlpSlaveHandshake.class.getName());"]}],"pom.xml":[{"add":["181","        <version>2.56<\/version>"],"delete":["181","        <version>2.53.3<\/version>"]}]}},"85ef6b11b9ad0ffd8f616d79b0fa56d4b6e9e60d":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["97","                  <classifier>${hudsonRemotingClassifier}<\/classifier>","117","                  <classifier>${hudsonRemotingClassifier}<\/classifier>"],"delete":["84","            this is always JDK 1.5 jar, to make it easy to deploy JNLP agent."]}]}},"53a31c31530166fc7a53900b58127c002a7e8cda":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["128","    private transient Object notifyModuleBuildLock = new Object();","129","","138","    @Override","139","    protected void onLoad() {","140","        super.onLoad();","141","        notifyModuleBuildLock = new Object();","142","    }","143","","467","            \/\/ use a separate lock object since this synchronized block calls into plugins,","468","            \/\/ which in turn can access other MavenModuleSetBuild instances, which will result in a dead lock.","469","            synchronized(notifyModuleBuildLock) {","1330",""],"delete":["459","            synchronized(this) {","1320","    "]}],"changelog.html":[{"add":["63","  <li class=bug>","64","    Fixed a dead lock in concurrent builds of the same Maven projects.","65","      (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-4220\">issue 4220<\/a>)"],"delete":[]}]}},"199cdb071be9d4ca44cb8d8e8f5e9c5685e96d26":{"changes":{"core\/src\/main\/java\/hudson\/model\/DirectoryBrowserSupport.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/DirectoryBrowserSupport.java":[{"add":["100","        if(!f.exists()) {","101","            rsp.sendError(HttpServletResponse.SC_NOT_FOUND);","102","            return;","103","        }"],"delete":["78","        if(!f.exists()) {","79","            rsp.sendError(HttpServletResponse.SC_NOT_FOUND);","80","            return;","81","        }","82",""]}]}},"e4c4b810793aa4d118702608c16c1d680edbab89":{"changes":{"core\/src\/main\/java\/hudson\/logging\/LogRecorder.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/logging\/LogRecorder.java":[{"add":["75","    private final static TargetComparator TARGET_COMPARATOR = new TargetComparator();","76","    ","82","        Arrays.sort(ts, TARGET_COMPARATOR);","205","    ","206","    private static class TargetComparator implements Comparator<Target> {","207","","208","        @Override","209","        public int compare(Target left, Target right) {","210","            return right.getName().length() - left.getName().length();","211","        }","212","    }"],"delete":["75","","81","        Arrays.sort(ts, new Comparator<Target>() {","82","            public int compare(Target left, Target right) {","83","                return right.getName().length() - left.getName().length();","84","            }","85","        });"]}]}},"757fbe41fab0af4dd61d32464e7f4208fdbb0b25":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Job\/rename.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Job\/rename.jelly":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["122","import org.acegisecurity.AccessDeniedException;","123","import org.acegisecurity.context.SecurityContext;","124","import org.acegisecurity.context.SecurityContextHolder;","1611","    ","1612","    \/**","1613","     * Check new name for job","1614","     * @param newName - New name for job","1615","     * @return {@code true} - if newName occupied and user has permissions for this job","1616","     *         {@code false} - if newName occupied and user hasn't permissions for this job","1617","     *         {@code null} - if newName didn't occupied","1618","     * ","1619","     * @throws Failure if the given name is not good","1620","     *\/","1621","    @CheckForNull","1622","    @Restricted(NoExternalUse.class)","1623","    public Boolean checkIfNameIsUsed(@Nonnull String newName) throws Failure{","1624","        ","1625","        Item item = null;","1626","        Jenkins.checkGoodName(newName);","1627","        ","1628","        try {","1629","            item = getParent().getItem(newName);","1630","        } catch(AccessDeniedException ex) {  ","1631","            if (LOGGER.isLoggable(Level.FINE)) {","1632","                LOGGER.log(Level.FINE, \"Unable to rename the job {0}: name {1} is already in use. \" +","1633","                        \"User {2} has {3} permission, but no {4} for existing job with the same name\", ","1634","                        new Object[] {this.getFullName(), newName, User.current().getFullName(), Item.DISCOVER.name, Item.READ.name} );","1635","            }","1636","            return true;","1637","        }","1638","        ","1639","        if (item != null) {","1640","            \/\/ User has Read permissions for existing job with the same name","1641","            return true;","1642","        } else {","1643","            SecurityContext initialContext = null;","1644","            try {","1645","                initialContext = hudson.security.ACL.impersonate(ACL.SYSTEM);","1646","                item = getParent().getItem(newName);","1647","","1648","                if (item != null) {","1649","                    if (LOGGER.isLoggable(Level.FINE)) {","1650","                        LOGGER.log(Level.FINE, \"Unable to rename the job {0}: name {1} is already in use. \" +","1651","                                \"User {2} has no {3} permission for existing job with the same name\", ","1652","                                new Object[] {this.getFullName(), newName, initialContext.getAuthentication().getName(), Item.DISCOVER.name} );","1653","                    }","1654","                    return false;","1655","                }","1656","","1657","            } finally {","1658","                if (initialContext != null) {","1659","                    SecurityContextHolder.setContext(initialContext);","1660","                }","1661","            }","1662","        }","1663","        return null;","1664","    }"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/Job\/rename.properties":[{"add":["24","newNameNotValid=The name {0} is not valid."],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/Job\/rename.jelly":[{"add":["31","      <j:set var=\"checkIfNameIsUsed\" value=\"${it.checkIfNameIsUsed(newName)}\" \/>","32","      ","33","      <j:choose> ","40","        ","41","        <j:when test=\"${checkIfNameIsUsed != null and !it.name.equalsIgnoreCase(newName)}\" >    ","42","          <j:if test=\"${checkIfNameIsUsed}\" >","43","            ${%newNameInUse(newName)}","44","          <\/j:if>  ","45","          <j:if test=\"${!checkIfNameIsUsed}\" >","46","            ${%newNameNotValid(newName)}","47","          <\/j:if>","52","        "],"delete":["31","      <j:choose>","38","        <j:when test=\"${it.parent.getItem(newName)!=null and !it.name.equalsIgnoreCase(newName)}\">","39","          ${%newNameInUse(newName)}"]}]}},"4a3978c34ea41fed3f583b0a82de0ca126d2b51b":{"changes":{"pom.xml":"MODIFY"},"diff":{"pom.xml":[{"add":["170","        <version>3.10.1-20170926.021703-2<\/version>"],"delete":["170","        <version>3.10<\/version>"]}]}},"701485e86b0163cb0d683234f6d3e3915abe01a3":{"changes":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":"MODIFY","test\/src\/test\/java\/hudson\/util\/ProcessTreeKillerTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":[{"add":["96","    ","97","    \/**","98","     * Flag to skip the veto check since there aren't any.","99","     *\/","100","    private boolean skipVetoes;","103","    private ProcessTree() {","104","       skipVetoes = false;","105","    }","106","    ","107","    private ProcessTree(boolean vetoesExist) {","108","        skipVetoes = !vetoesExist;","109","    }","254","            String causeMessage = null;","255","            ","256","            \/\/ Quick check, does anything exist to check against","257","            if (!skipVetoes) {","258","                try {","259","                    VirtualChannel channelToMaster = SlaveComputer.getChannelToMaster();","260","                    if (channelToMaster!=null) {","261","                        CheckVetoes vetoCheck = new CheckVetoes(this);","262","                        causeMessage = channelToMaster.call(vetoCheck);","263","                    }","264","                } catch (IOException e) {","265","                    LOGGER.log(Level.WARNING, \"I\/O Exception while checking for vetoes\", e);","266","                } catch (InterruptedException e) {","267","                    LOGGER.log(Level.WARNING, \"Interrupted Exception while checking for vetoes\", e);","270","            ","271","            if (causeMessage != null) {","272","                return new VetoCause(causeMessage);","273","            }","325","        ","326","        private class CheckVetoes extends SlaveToMasterCallable<String, IOException> {","327","            private IOSProcess process;","328","            ","329","            public CheckVetoes(IOSProcess processToCheck) {","330","                process = processToCheck;","331","            }","332","        ","333","            @Override","334","            public String call() throws IOException {","335","                for (ProcessKillingVeto vetoExtension : ProcessKillingVeto.all()) {","336","                    VetoCause cause = vetoExtension.vetoProcessKilling(process);","337","                    if (cause != null) {","338","                        if (LOGGER.isLoggable(FINEST))","339","                            LOGGER.info(\"Killing of pid \" + getPid() + \" vetoed by \" + vetoExtension.getClass().getName() + \": \" + cause.getMessage());","340","                        return cause.getMessage();","341","                    }","342","                }","343","                return null;","344","            }","345","        }","384","    private static Boolean vetoersExist;","385","    ","395","        \/\/ Check for the existance of vetoers if I don't know already","396","        if (vetoersExist == null) {","397","            try {","398","                vetoersExist = SlaveComputer.getChannelToMaster().call(new DoVetoersExist());","399","            }","400","            catch (Exception e) {","401","                LOGGER.log(Level.WARNING, \"Error while determining if vetoers exist\", e);","402","            }","403","        }","404","        ","405","        \/\/ Null-check in case the previous call worked","406","        boolean vetoes = (vetoersExist == null ? true : vetoersExist);","407","        ","410","                return new Windows(vetoes);","414","                return new Linux(vetoes);","416","                return new Solaris(vetoes);","418","                return new Darwin(vetoes);","426","    ","427","    private static class DoVetoersExist extends SlaveToMasterCallable<Boolean, IOException> {","428","        @Override","429","        public Boolean call() throws IOException {","430","            return ProcessKillingVeto.all().size() > 0;","431","        }","432","    }","580","        Windows(boolean vetoesExist) {","581","            super(vetoesExist);","582","            ","644","        public Unix(boolean vetoersExist) {","645","            super(vetoersExist);","646","        }","647","        ","669","        ProcfsUnix(boolean vetoersExist) {","670","            super(vetoersExist);","671","            ","815","        public Linux(boolean vetoersExist) {","816","            super(vetoersExist);","817","        }","818","        ","933","        public Solaris(boolean vetoersExist) {","934","            super(vetoersExist);","935","        }","936","        ","1177","        Darwin(boolean vetoersExist) {","1178","            super(vetoersExist);","1179","","1398","        @Deprecated","1401","        ","1402","        Local(boolean vetoesExist) {","1403","            super(vetoesExist);","1404","        }","1413","        @Deprecated","1419","        ","1420","        public Remote(ProcessTree proxy, Channel ch, boolean vetoersExist) {","1421","            super(vetoersExist);","1422","            ","1423","            this.proxy = ch.export(IProcessTree.class,proxy);","1424","            for (Entry<Integer,OSProcess> e : proxy.processes.entrySet())","1425","                processes.put(e.getKey(),new RemoteProcess(e.getValue(),ch));","1426","        }"],"delete":["98","    private ProcessTree() {}","243","            for (ProcessKillingVeto vetoExtension : ProcessKillingVeto.all()) {","244","                VetoCause cause = vetoExtension.vetoProcessKilling(this);","245","                if (cause != null) {","246","                    if (LOGGER.isLoggable(FINEST))","247","                        LOGGER.finest(\"Killing of pid \" + getPid() + \" vetoed by \" + vetoExtension.getClass().getName() + \": \" + cause.getMessage());","248","                    return cause;","351","                return new Windows();","355","                return new Linux();","357","                return new Solaris();","359","                return new Darwin();","514","        Windows() {","597","        ProcfsUnix() {","1095","        Darwin() {"]}],"test\/src\/test\/java\/hudson\/util\/ProcessTreeKillerTest.java":[{"add":["6","import java.io.StringWriter;","16","import hudson.model.Slave;","31","","141","    ","142","    @Test","143","    @Issue(\"JENKINS-9104\")","144","    public void considersKillingVetosOnSlave() throws Exception {","145","        \/\/ on some platforms where we fail to list any processes, this test will","146","        \/\/ just not work","147","        assumeTrue(ProcessTree.get() != ProcessTree.DEFAULT);","148","        ","149","        \/\/ Define a process we (shouldn't) kill","150","        ProcessBuilder pb = new ProcessBuilder();","151","        pb.environment().put(\"cookie\", \"testKeepDaemonsAlive\");","152","        ","153","        if (File.pathSeparatorChar == ';') {","154","            pb.command(\"cmd\");","155","        } else {","156","            pb.command(\"sleep\", \"5m\");","157","        }","158","        ","159","        \/\/ Create a slave so we can tell it to kill the process","160","        Slave s = j.createSlave();","161","        s.toComputer().connect(false).get();","162","        ","163","        \/\/ Start the process","164","        process = pb.start();","165","        ","166","        \/\/ Call killall (somewhat roundabout though) to (not) kill it","167","        StringWriter out = new StringWriter();","168","        s.createLauncher(new StreamTaskListener(out)).kill(ImmutableMap.of(\"cookie\", \"testKeepDaemonsAlive\"));","169","        ","170","        try {","171","            process.exitValue();","172","            fail(\"Process should have been excluded from the killing\");","173","        } catch (IllegalThreadStateException e) {","174","            \/\/ Means the process is still running","175","        }","176","    }","178","    @TestExtension({\"considersKillingVetos\", \"considersKillingVetosOnSlave\"})"],"delete":["139","    @TestExtension(\"considersKillingVetos\")"]}]}},"9fbd7aa5170745f0e724031c4736d8da7a57b55e":{"changes":{"war\/src\/main\/js\/templates\/progressPanel.hbs":"MODIFY","war\/src\/main\/js\/pluginSetupWizardGui.js":"MODIFY","core\/src\/main\/resources\/jenkins\/install\/pluginSetupWizard.properties":"MODIFY","war\/src\/main\/less\/pluginSetupWizard.less":"MODIFY"},"diff":{"war\/src\/main\/js\/templates\/progressPanel.hbs":[{"add":["19","\t<div class=\"install-console\">","20","\t  <div class=\"install-console-scroll\">","21","\t    <div class=\"install-text\"><\/div>","22","\t  <\/div>","23","\t  <div class=\"dependency-legend\">{{translations.installWizard_installingConsole_dependencyIndicatorNote}}<\/div>","24","\t<\/div>"],"delete":["19","\t<div class=\"install-console\"><div class=\"install-text\"><\/div><\/div>"]}],"war\/src\/main\/js\/pluginSetupWizardGui.js":[{"add":["417","\t\t\t\t$c = $('.install-console-scroll');"],"delete":["417","\t\t\t\t$c = $('.install-console');"]}],"core\/src\/main\/resources\/jenkins\/install\/pluginSetupWizard.properties":[{"add":["50","installWizard_installingConsole_dependencyIndicatorNote=** - required dependency"],"delete":[]}],"war\/src\/main\/less\/pluginSetupWizard.less":[{"add":["523","    ","524","    .install-console-scroll {","525","        position: absolute;","526","        top: 6px;","527","        right: 0;","528","        bottom: 2em;","529","        left: 0;","530","        overflow:auto;","531","        font: 12px monospace;","532","    }","533","    ","554","            padding-left: 10px;","560","        ","561","        .dependency-legend {","562","            color: #aaa;","563","            position: absolute;","564","            bottom: 0;","565","            left: 0;","566","            right: 0;","567","            border-top: 1px solid #ccc;","568","            background: #f8f8f8;","569","            padding: 4px 10px;","570","            font: 12px monospace;","571","        }"],"delete":["523","    padding: 6px 0;","524","    overflow:auto;","525","","546","            padding-left: .4em;"]}]}},"695b4ba8a3d7390f1bbe2d52a224b709e978470a":{"changes":{"core\/src\/main\/java\/hudson\/matrix\/MatrixConfiguration.java":"MODIFY","core\/src\/main\/java\/hudson\/matrix\/MatrixBuild.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/matrix\/MatrixConfiguration.java":[{"add":["12","import hudson.model.ParameterValue;","13","import hudson.model.ParameterizedProjectTask;","14","import hudson.model.ParametersAction;","260","","261","\tpublic boolean scheduleBuild(ParametersAction parameters) {","262","        return Hudson.getInstance().getQueue().add(","263","                new ParameterizedProjectTask(this, parameters.getParameters()), getQuietPeriod());","264","\t}","265","\t"],"delete":[]}],"core\/src\/main\/java\/hudson\/matrix\/MatrixBuild.java":[{"add":["9","import hudson.model.ParametersAction;","22","import org.kohsuke.stapler.StaplerRequest;","23","import org.kohsuke.stapler.StaplerResponse;","24","","149","                    ParametersAction parameters = getAction(ParametersAction.class);","150","                    if (parameters != null) {","151","                    \tc.scheduleBuild(parameters);","152","                    } else {","153","                    \tc.scheduleBuild();","154","                    }"],"delete":["12","import org.kohsuke.stapler.StaplerRequest;","13","import org.kohsuke.stapler.StaplerResponse;","147","                    c.scheduleBuild();"]}]}},"c8dcd3b06b3553e8c0b04ff4ef3c3bf72e805978":{"changes":{"war\/src\/main\/less\/pluginSetupWizard.less":"MODIFY","war\/src\/main\/js\/templates\/pluginSelectList.hbs":"MODIFY"},"diff":{"war\/src\/main\/less\/pluginSetupWizard.less":[{"add":["414","\t\t\t\t@badge-color: #555;","415","\t\t\t\t@badge-background: #f8f8f8;","416","\t\t\t\t@link-color: #337ab7;","417","\t","418","\t\t\t\t\t.website-link {","419","\t\t\t\t\t\tposition: relative;","420","\t\t\t\t\t\theight: 15px;","421","\t\t\t\t\t\twidth: 15px;","422","\t\t\t\t\t\tmargin-left: 2px;","423","\t\t\t\t\t}","424","\t\t\t\t\t.website-link:before {","425","\t\t\t\t\t\tdisplay: inline-block;","426","\t\t\t\t\t\tposition: absolute;","427","\t\t\t\t\t\twidth: 11px;","428","\t\t\t\t\t\theight: 11px;","429","\t\t\t\t\t\tcontent: '';","430","\t\t\t\t\t\tleft: 2px;","431","\t\t\t\t\t\ttop: 2px;","432","\t\t\t\t\t\tbackground: @badge-color;","433","\t\t\t\t\t\tborder-radius: 4px;","434","\t\t\t\t\t}","435","\t\t\t\t\t.website-link:after {","436","\t\t\t\t\t\tcontent: '\\f14c';","437","\t\t\t\t\t\tdisplay: inline-block;","438","\t\t\t\t\t\tfont: 15px FontAwesome;","439","\t\t\t\t\t\ttext-indent: 0;","440","\t\t\t\t\t\tposition: absolute;","441","\t\t\t\t\t\ttop: 0;","442","\t\t\t\t\t\tleft: 1px;","443","\t\t\t\t\t\twidth: 14px;","444","\t\t\t\t\t\theight: 14px;","445","\t\t\t\t\t\tborder-radius: 2px;","446","\t\t\t\t\t\tcolor: @badge-background;","447","\t\t\t\t\t}","448","\t\t\t\t\t.website-link:hover:before,.website-link:focus:before {","449","\t\t\t\t\t\tbackground: #fff;","450","\t\t\t\t\t}","451","\t\t\t\t\t.website-link:hover:after,.website-link:focus:after {","452","\t\t\t\t\t\tcolor: @link-color;","453","\t\t\t\t\t\twidth: 16px;","454","\t\t\t\t\t\theight: 16px;","455","\t\t\t\t\t\tfont-size: 17px;","456","\t\t\t\t\t\tleft: 0px;","457","\t\t\t\t\t\ttop: -1px;","458","\t\t\t\t\t}","463","\t\t\t\t\t\tcolor: @badge-color;","467","\t\t\t\t\t\tmargin: 0 0;","472","\t\t\t\t\t\t\tpadding-left: 9px;","473","\t\t\t\t\t\t\tbackground: @badge-background;","474","\t\t\t\t\t\t\tcolor: @badge-color;","475","\t\t\t\t\t\t\tbox-shadow: 0 0 1px 0 rgba(0,0,0,.25);","477","\t\t\t\t\t\t\t&:after {","478","\t\t\t\t\t\t\t\tcontent: '\\f0d9';","479","\t\t\t\t\t\t\t\tfont: 15px FontAwesome;","480","\t\t\t\t\t\t\t\tdisplay: inline-block;","481","\t\t\t\t\t\t\t\twidth: 13px; ","482","\t\t\t\t\t\t\t\theight: 13px; ","483","\t\t\t\t\t\t\t\tmargin: -4px -2px 0px 1px;","484","\t\t\t\t\t\t\t\tvertical-align: middle;","485","\t\t\t\t\t\t\t}","486","\t\t\t\t\t\t}","487","\t\t\t\t\t\t&:hover, &.active, &:focus {","488","\t\t\t\t\t\t\ttext-decoration: none;","489","\t\t\t\t\t\t\toutline: none;","490","\t\t\t\t\t\t\t","491","\t\t\t\t\t\t\t.badge {","492","\t\t\t\t\t\t\t\tbackground: @badge-color;","493","\t\t\t\t\t\t\t\tcolor: #fff;","494","\t\t\t\t\t\t\t}","508","\t\t\t\t\t\t> h3 {","509","\t\t\t\t\t\t\tmargin: 0 25px 4px 0;","510","\t\t\t\t\t\t\tcolor: #555555;","511","\t\t\t\t\t\t\tfont-size: 14px;","512","\t\t\t\t\t\t\tborder-bottom: 1px solid #fff;","513","\t\t\t\t\t\t\tborder-bottom: 1px solid rgba(255, 255, 255, 0.5);","514","\t\t\t\t\t\t\tpadding-bottom: 5px;","515","\t\t\t\t\t\t}","516","\t\t\t\t\t\t","520","\t\t\t\t\t\t\tbackground: @badge-background;","521","\t\t\t\t\t\t\tcolor: @badge-color;","522","\t\t\t\t\t\t\tbox-shadow: 0 0 1px 0 rgba(0,0,0,.25);","523","\t\t\t\t\t\t\t","524","\t\t\t\t\t\t\t&:after {","525","\t\t\t\t\t\t\t\tcontent: '\\f14c';","526","\t\t\t\t\t\t\t\tfont: 11px FontAwesome;","527","\t\t\t\t\t\t\t}","531","\t\t\t\t\t\t\t\tbackground: @link-color;","532","\t\t\t\t\t\t\t\ttext-decoration: none;","536","\t\t\t\t\t","538","\t\t\t\t\t\t.toggle-dependency-list .badge:after {","539","\t\t\t\t\t\t\tcontent: '\\f0d7';"],"delete":["418","\t\t\t\t\t\tcolor: #777;","426","\t\t\t\t\t\t}","428","\t\t\t\t\t\t&:hover, &:focus, &.active {","429","\t\t\t\t\t\t\ttext-decoration: underline;","452","\t\t\t\t\t\t","454","\t\t\t\t\t\t.toggle-dependency-list:after {","455","\t\t\t\t\t\t\tcontent: '';","456","\t\t\t\t\t\t\tdisplay: inline-block;","457","\t\t\t\t\t\t\tposition: absolute;","458","\t\t\t\t\t\t\ttop: 50%;","459","\t\t\t\t\t\t\tright: 100%;","460","\t\t\t\t\t\t\twidth: 0; ","461","\t\t\t\t\t\t\theight: 0; ","462","\t\t\t\t\t\t\tborder-left: 7px solid transparent;","463","\t\t\t\t\t\t\tborder-right: 7px solid transparent;","464","\t\t\t\t\t\t\tborder-top: 7px solid #999;","465","\t\t\t\t\t\t\tmargin: -3px -3px 0 0;"]}],"war\/src\/main\/js\/templates\/pluginSelectList.hbs":[{"add":["9","        <a href=\"{{plugin.website}}\" target=\"_blank\" class=\"website-link\" title=\"{{plugin.title}} {{..\/..\/translations.installWizard_websiteLinkLabel}}\"><\/a>","12","        <a href=\"#\" class=\"btn btn-link toggle-dependency-list\" type=\"button\" data-plugin-name=\"{{..\/plugin.name}}\" title=\"{{..\/plugin.title}} {{..\/..\/..\/translations.installWizard_installIncomplete_dependenciesLabel}}\">","13","          <span class=\"badge\">{{dependencyCount ..\/plugin.name}}<\/span>","14","        <\/a>","21","          <h3 class=\"dep-title\">{{..\/..\/..\/translations.installWizard_installIncomplete_dependenciesLabel}}<\/h3>"],"delete":["9","        <a href=\"{{plugin.website}}\" target=\"_blank\">{{..\/..\/translations.installWizard_websiteLinkLabel}}<\/a>","12","      <a href=\"#\" class=\"btn btn-link toggle-dependency-list\" type=\"button\" data-plugin-name=\"{{..\/plugin.name}}\">","13","        {{..\/..\/..\/translations.installWizard_installIncomplete_dependenciesLabel}}<span class=\"badge\">{{dependencyCount ..\/plugin.name}}<\/span>","14","      <\/a>"]}]}},"7d2c0efa7bad8f2a0a47f7dcc395a5a4baee99cd":{"changes":{"core\/src\/main\/java\/hudson\/model\/Project.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","changelog.html":"MODIFY","test\/src\/test\/java\/hudson\/model\/FreeStyleProjectTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Project.java":[{"add":["61","    private DescribableList<Builder,Descriptor<Builder>> builders;","66","    private DescribableList<Publisher,Descriptor<Publisher>> publishers;","71","    private DescribableList<BuildWrapper,Descriptor<BuildWrapper>> buildWrappers;","83","        getBuildersList().setOwner(this);","84","        getPublishersList().setOwner(this);","85","        getBuildWrappersList().setOwner(this);","93","        return getBuildersList().toList();","102","        return getPublishersList().toMap();","105","    public synchronized DescribableList<Builder,Descriptor<Builder>> getBuildersList() {","106","        if (builders == null) {","107","            builders = new DescribableList<Builder,Descriptor<Builder>>(this);","108","        }","112","    public synchronized DescribableList<Publisher,Descriptor<Publisher>> getPublishersList() {","113","        if (publishers == null) {","114","            publishers = new DescribableList<Publisher,Descriptor<Publisher>>(this);","115","        }","120","        return getBuildWrappersList().toMap();","123","    public synchronized DescribableList<BuildWrapper, Descriptor<BuildWrapper>> getBuildWrappersList() {","124","        if (buildWrappers == null) {","125","            buildWrappers = new DescribableList<BuildWrapper,Descriptor<BuildWrapper>>(this);","126","        }","135","        activities.addAll(Util.filter(getBuildersList(),ResourceActivity.class));","136","        activities.addAll(Util.filter(getPublishersList(),ResourceActivity.class));","137","        activities.addAll(Util.filter(getBuildWrappersList(),ResourceActivity.class));","149","        getPublishersList().add(buildStep);","159","        getPublishersList().remove(descriptor);","163","        for (Publisher p : getPublishersList()) {","171","        getPublishersList().buildDependencyGraph(this,graph);","172","        getBuildersList().buildDependencyGraph(this,graph);","173","        getBuildWrappersList().buildDependencyGraph(this,graph);","198","        getBuildWrappersList().rebuild(req,json, BuildWrappers.getFor(this));","199","        getBuildersList().rebuildHetero(req,json, Builder.all(), \"builder\");","200","        getPublishersList().rebuildHetero(req, json, Publisher.all(), \"publisher\");"],"delete":["27","import hudson.diagnosis.OldDataMonitor;","30","import hudson.tasks.BuildStepDescriptor;","63","    private DescribableList<Builder,Descriptor<Builder>> builders =","64","            new DescribableList<Builder,Descriptor<Builder>>(this);","69","    private DescribableList<Publisher,Descriptor<Publisher>> publishers =","70","            new DescribableList<Publisher,Descriptor<Publisher>>(this);","75","    private DescribableList<BuildWrapper,Descriptor<BuildWrapper>> buildWrappers =","76","            new DescribableList<BuildWrapper,Descriptor<BuildWrapper>>(this);","88","","89","        if (buildWrappers==null) {","90","            \/\/ it didn't exist in < 1.64","91","            buildWrappers = new DescribableList<BuildWrapper, Descriptor<BuildWrapper>>(this);","92","            OldDataMonitor.report(this, \"1.64\");","93","        }","94","        builders.setOwner(this);","95","        publishers.setOwner(this);","96","        buildWrappers.setOwner(this);","104","        return builders.toList();","113","        return publishers.toMap();","116","    public DescribableList<Builder,Descriptor<Builder>> getBuildersList() {","120","    public DescribableList<Publisher,Descriptor<Publisher>> getPublishersList() {","125","        return buildWrappers.toMap();","128","    public DescribableList<BuildWrapper, Descriptor<BuildWrapper>> getBuildWrappersList() {","137","        activities.addAll(Util.filter(builders,ResourceActivity.class));","138","        activities.addAll(Util.filter(publishers,ResourceActivity.class));","139","        activities.addAll(Util.filter(buildWrappers,ResourceActivity.class));","151","        publishers.add(buildStep);","161","        publishers.remove(descriptor);","165","        for (Publisher p : publishers) {","173","        publishers.buildDependencyGraph(this,graph);","174","        builders.buildDependencyGraph(this,graph);","175","        buildWrappers.buildDependencyGraph(this,graph);","200","        buildWrappers.rebuild(req,json, BuildWrappers.getFor(this));","201","        builders.rebuildHetero(req,json, Builder.all(), \"builder\");","202","        publishers.rebuildHetero(req, json, Publisher.all(), \"publisher\");"]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["285","        for (Trigger t : triggers())","295","    private synchronized List<Trigger<?>> triggers() {","296","        if (triggers == null) {","297","            triggers = new Vector<Trigger<?>>();","298","        }","299","        return triggers;","300","    }","301","","1532","        addToList(trigger,triggers());","1536","        removeFromList(trigger,triggers());","1570","        return (Map)Descriptor.toMap(triggers());","1577","        for (Trigger p : triggers()) {","1863","        for (Trigger t : triggers())"],"delete":["41","import hudson.diagnosis.OldDataMonitor;","82","import hudson.util.RunList;","287","","288","        if(triggers==null) {","289","            \/\/ it didn't exist in < 1.28","290","            triggers = new Vector<Trigger<?>>();","291","            OldDataMonitor.report(this, \"1.28\");","292","        }","293","        for (Trigger t : triggers)","1533","        addToList(trigger,triggers);","1537","        removeFromList(trigger,triggers);","1571","        return (Map)Descriptor.toMap(triggers);","1578","        for (Trigger p : triggers) {","1864","        for (Trigger t : triggers)"]}],"changelog.html":[{"add":["57","  <li class=rfe>","58","    XStream form of projects excessively strict about null fields.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-15817\">issue 15817<\/a>)"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/FreeStyleProjectTest.java":[{"add":["27","import edu.umd.cs.findbugs.annotations.SuppressWarnings;","30","import java.io.ByteArrayInputStream;","125","","126","    @Bug(15817)","127","    @SuppressWarnings(\"DM_DEFAULT_ENCODING\")","128","    public void testMinimalConfigXml() throws Exception {","129","        \/\/ Make sure it can be created without exceptions:","130","        FreeStyleProject project = (FreeStyleProject) jenkins.createProjectFromXML(\"stuff\", new ByteArrayInputStream(\"<project\/>\".getBytes()));","131","        System.out.println(project.getConfigFile().asString());","132","        \/\/ and round-tripped:","133","        Shell shell = new Shell(\"echo hello\");","134","        project.getBuildersList().add(shell);","135","        WebClient webClient = new WebClient();","136","        HtmlPage page = webClient.getPage(project,\"configure\");","137","        HtmlForm form = page.getFormByName(\"config\");","138","        submit(form);","139","        List<Builder> builders = project.getBuilders();","140","        assertEquals(1,builders.size());","141","        assertEquals(Shell.class,builders.get(0).getClass());","142","        assertEquals(\"echo hello\",((Shell)builders.get(0)).getCommand().trim());","143","        assertTrue(builders.get(0)!=shell);","144","        System.out.println(project.getConfigFile().asString());","145","    }","146",""],"delete":[]}]}},"d1543575e2b4bcb0938a2bc88df589c462b227ef":{"changes":{"core\/src\/main\/java\/hudson\/Proc.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Proc.java":[{"add":["202","                \/\/ while this is not discussed in javadoc, even with ProcessBuilder.redirectErrorStream(true),","203","                \/\/ Process.getErrorStream() still returns a distinct reader end of a pipe that needs to be closed.","204","                \/\/ this is according to the source code of JVM","205","                proc.getErrorStream().close();"],"delete":[]}],"changelog.html":[{"add":["45","  <li class=bug>","46","    Fixed a pipe leak to child processes.","47","    (<a href=\"http:\/\/issues.hudson-ci.org\/browse\/HUDSON-8244\">issue 8244<\/a>)"],"delete":[]}]}},"35552ca2e2a63a486fed9c5a5c21335e314655c8":{"changes":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3082","        configLoaded = true;"],"delete":["3088","        configLoaded = true;"]}]}},"0082b67a7f2c0a1abca07e6f746360568a57a768":{"changes":{"core\/src\/main\/java\/hudson\/console\/ConsoleNote.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/console\/ConsoleNote.java":[{"add":["241","                if (sz < 0) {","242","                    throw new IOException(\"Corrupt stream\");","243","                }"],"delete":[]}]}},"490adc9d0f4b0ed2c7e3183b18b136c006953824":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/Maven.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/Maven.java":[{"add":[],"delete":["252","            if(Functions.isWindows())","253","                seed += \".bat\";"]}]}},"8b8c62a891088adabab20f872342413a600371da":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["57","  <li class=bug>","58","    Infinite loop or invalid next execution with crontab DoW=7","59","    (a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-12357\">issue 12357<\/a>)"],"delete":["57","  <li class=>"]}]}},"415c809fa82790552b5b2244f482c919e9da0bb0":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenBuild.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["381","                        boolean failed=false;","382","                        for( int i=buildEnvironments.size()-1; i>=0; i-- ) {","383","                            if (!buildEnvironments.get(i).tearDown(MavenModuleSetBuild.this,listener)) {","384","                                failed=true;","385","                            }                    ","386","                        }","387","                        buildEnvironments = null;","388","                        \/\/ WARNING The return in the finally clause will trump any return before","389","                        if (failed) return Result.FAILURE;"],"delete":["381","                        for( int i=buildEnvironments.size()-1; i>=0; i-- )","382","                            buildEnvironments.get(i)","383","                                    .tearDown(MavenModuleSetBuild.this, listener);","384","                            buildEnvironments = null;"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenBuild.java":[{"add":["503","","504","                \/\/ tear down in reverse order","505","                boolean failed=false;","506","                for( int i=buildEnvironments.size()-1; i>=0; i-- ) {","507","                    if (!buildEnvironments.get(i).tearDown(MavenBuild.this,listener)) {","508","                        failed=true;","509","                    }                    ","511","                buildEnvironments = null;","512","                \/\/ WARNING The return in the finally clause will trump any return before","513","                if (failed) return Result.FAILURE;"],"delete":["503","                for (int i = buildEnvironments.size() - 1; i >= 0; i--) {","504","                    buildEnvironments.get(i).tearDown(MavenBuild.this, listener);","505","                    buildEnvironments = null;"]}]}},"b8b9b71be1c55f76791e958318105302f3e226b8":{"changes":{"core\/src\/main\/java\/hudson\/matrix\/DefaultMatrixExecutionStrategyImpl.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/matrix\/DefaultMatrixExecutionStrategyImpl.java":[{"add":["316","                if(why != null && !why.equals(whyInQueue) && System.currentTimeMillis()-startTime>5000) {"],"delete":["316","                if(!why.equals(whyInQueue) && System.currentTimeMillis()-startTime>5000) {"]}]}},"c84d3484ddf8e5d2572f1e22b3b2fa09725433a1":{"changes":{"core\/src\/main\/java\/hudson\/scm\/NullSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/NullSCM.java":[{"add":["60","    @Extension(ordinal = Integer.MAX_VALUE)"],"delete":["60","    @Extension"]}]}},"87de5aa5f5ffdde884c9506e8ffd89c3a1f13351":{"changes":{"core\/src\/main\/resources\/hudson\/tasks\/LogRotator\/config_de.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/tasks\/LogRotator\/config_de.properties":[{"add":["28","  (Optional) Maximale Anzahl an Builds, die aufbewahrt werden.","36","  (Optional) Maximale Anzahl an Build-Artefakten, die aufbewahrt werden. Protokolle, Verlaufsdaten, Berichte usw. eines Builds werden jedoch weiter behalten."],"delete":["28","  (Optional) Builds werden nur bis zu diesem Alter in Builds aufbewahrt.","36","  (Optional) Artefakte werden nur bis zu diesem Alter in Builds aufbewahrt. Protokolle, Verlaufsdaten, Berichte usw. eines Builds werden jedoch weiter behalten."]}]}},"f98699fa487e8479a4c3bca4cf651bdb9ef28004":{"changes":{"war\/src\/main\/webapp\/css\/style.css":"MODIFY"},"diff":{"war\/src\/main\/webapp\/css\/style.css":[{"add":["124","}","125","","126","body, table, form, td, th, p","127","{"],"delete":["125","  background-color: #fff;"]}]}},"dcea7d5bf6a011518bbc642426d26073b337086a":{"changes":{"core\/src\/main\/java\/hudson\/model\/Descriptor.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/DescriptorTest.java":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/model\/Descriptor.java":[{"add":["195","            if (it == null) {","196","                throw new AssertionError(clazz + \" is not an array\/collection type in \" + displayName + \". See https:\/\/wiki.jenkins-ci.org\/display\/JENKINS\/My+class+is+missing+descriptor\");","197","            }"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/DescriptorTest.java":[{"add":[],"delete":[]}]}},"e1691a1f2fc5246024a416a20e109faeab0e26ab":{"changes":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":"MODIFY","core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":[{"add":["30","import hudson.ProxyConfiguration;","43","import org.apache.commons.httpclient.HttpClient;","44","import org.apache.commons.httpclient.HttpMethodBase;","45","import org.apache.commons.httpclient.UsernamePasswordCredentials;","46","import org.apache.commons.httpclient.auth.AuthScope;","47","import org.apache.commons.httpclient.methods.GetMethod;","48","import org.apache.commons.httpclient.methods.PostMethod;","72","import java.util.regex.Matcher;","73","import java.util.regex.Pattern;","348","        HttpClient hc = new HttpClient();","349","        hc.getParams().setParameter(\"http.useragent\",\"Mozilla\/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\");","350","        Jenkins j = Jenkins.getInstance();","351","        ProxyConfiguration jpc = j!=null ? j.proxy : null;","353","            hc.getHostConfiguration().setProxy(jpc.name, jpc.port);","354","            if(jpc.getUserName() != null)","355","                hc.getState().setProxyCredentials(AuthScope.ANY,new UsernamePasswordCredentials(jpc.getUserName(),jpc.getPassword()));","358","        int authCount=0, totalPageCount=0;  \/\/ counters for avoiding infinite loop","359","","360","        HttpMethodBase m = new GetMethod(primary.filepath);","362","            while (true) {","363","                if (totalPageCount++>16) \/\/ looping too much","364","                    throw new IOException(\"Unable to find the login form\");","366","                LOGGER.fine(\"Requesting \" + m.getURI());","367","                int r = hc.executeMethod(m);","368","                if (r\/100==3) {","369","                    \/\/ redirect?","370","                    String loc = m.getResponseHeader(\"Location\").getValue();","371","                    m.releaseConnection();","372","                    m = new GetMethod(loc);","373","                    continue;","374","                }","375","                if (r!=200)","376","                    throw new IOException(\"Failed to request \" + m.getURI() +\" exit code=\"+r);","377","","378","                if (m.getURI().getHost().equals(\"login.oracle.com\")) {","379","                    LOGGER.fine(\"Appears to be a login page\");","380","                    String resp = IOUtils.toString(m.getResponseBodyAsStream(), m.getResponseCharSet());","381","                    m.releaseConnection();","382","                    Matcher pm = Pattern.compile(\"<form .*?action=\\\"([^\\\"]*)\\\" .*?<\/form>\", Pattern.DOTALL).matcher(resp);","383","                    if (!pm.find())","384","                        throw new IllegalStateException(\"Unable to find a form in the response:\\n\"+resp);","385","","386","                    String form = pm.group();","387","                    PostMethod post = new PostMethod(","388","                            new URL(new URL(m.getURI().getURI()),pm.group(1)).toExternalForm());","389","","390","                    String u = getDescriptor().getUsername();","391","                    Secret p = getDescriptor().getPassword();","392","                    if (u==null || p==null) {","393","                        log.hyperlink(getCredentialPageUrl(),\"Oracle now requires Oracle account to download previous versions of JDK. Please specify your Oracle account username\/password.\\n\");","394","                        throw new AbortException(\"Unable to install JDK unless a valid Oracle account username\/password is provided in the system configuration.\");","395","                    }","396","","397","                    for (String fragment : form.split(\"<input\")) {","398","                        String n = extractAttribute(fragment,\"name\");","399","                        String v = extractAttribute(fragment,\"value\");","400","                        if (n==null || v==null)     continue;","401","                        if (n.equals(\"ssousername\"))","402","                            v = u;","403","                        if (n.equals(\"password\")) {","404","                            v = p.getPlainText();","405","                            if (authCount++ > 3) {","406","                                log.hyperlink(getCredentialPageUrl(),\"Your Oracle account doesn't appear valid. Please specify a valid username\/password\\n\");","407","                                throw new AbortException(\"Unable to install JDK unless a valid username\/password is provided.\");","408","                            }","409","                        }","410","                        post.addParameter(n, v);","411","                    }","412","","413","                    m = post;","414","                } else {","415","                    log.getLogger().println(\"Downloading \" + m.getResponseContentLength() + \"bytes\");","416","","417","                    \/\/ download to a temporary file and rename it in to handle concurrency and failure correctly,","418","                    File tmp = new File(cache.getPath()+\".tmp\");","419","                    try {","420","                        tmp.getParentFile().mkdirs();","421","                        FileOutputStream out = new FileOutputStream(tmp);","422","                        try {","423","                            IOUtils.copy(m.getResponseBodyAsStream(), out);","424","                        } finally {","425","                            out.close();","426","                        }","427","","428","                        tmp.renameTo(cache);","429","                        return cache.toURL();","430","                    } finally {","431","                        tmp.delete();","432","                    }","433","                }","434","            }","436","            m.releaseConnection();","440","    private static String extractAttribute(String s, String name) {","441","        String h = name + \"=\\\"\";","442","        int si = s.indexOf(h);","443","        if (si<0)   return null;","444","        int ei = s.indexOf('\\\"',si+h.length());","445","        return s.substring(si+h.length(),ei);","446","    }","447",""],"delete":["25","import com.gargoylesoftware.htmlunit.BrowserVersion;","26","import com.gargoylesoftware.htmlunit.DefaultCredentialsProvider;","27","import com.gargoylesoftware.htmlunit.ProxyConfig;","28","import com.gargoylesoftware.htmlunit.ElementNotFoundException;","29","import com.gargoylesoftware.htmlunit.Page;","30","import com.gargoylesoftware.htmlunit.WebClient;","31","import com.gargoylesoftware.htmlunit.html.HtmlForm;","32","import com.gargoylesoftware.htmlunit.html.HtmlPage;","36","import hudson.ProxyConfiguration;","51","import org.apache.commons.httpclient.auth.CredentialsProvider;","348","        URL src = new URL(primary.filepath);","350","        WebClient wc = new WebClient();","351","        \/\/ honor jenkins proxy settings in WebClient","352","        Jenkins h = Jenkins.getInstance();","353","        ProxyConfiguration jpc = h!=null ? h.proxy : null;","355","            ProxyConfig pc = new ProxyConfig();","356","            pc.setProxyHost(jpc.name);","357","            pc.setProxyPort(jpc.port);","358","            wc.setProxyConfig(pc);","359","            if(jpc.getUserName() != null) {","360","                DefaultCredentialsProvider cp = new DefaultCredentialsProvider();","361","                cp.addCredentials(jpc.getUserName(), jpc.getPassword(), jpc.name, jpc.port, null);","362","                wc.setCredentialsProvider(cp);","363","            }","364","        }","365","        ","366","        wc.setJavaScriptEnabled(false);","367","        wc.setCssEnabled(false);","368","        Page page = wc.getPage(src);","369","        int authCount=0;","370","        int totalPageCount=0;","371","        while (page instanceof HtmlPage) {","372","            \/\/ some times we are redirected to the SSO login page.","373","            HtmlPage html = (HtmlPage) page;","374","            URL loginUrl = page.getWebResponse().getUrl();","375","            if (!loginUrl.getHost().equals(\"login.oracle.com\"))","376","                throw new IOException(\"Expected to see a login page but instead saw \"+loginUrl);","377","","378","            String u = getDescriptor().getUsername();","379","            Secret p = getDescriptor().getPassword();","380","            if (u==null || p==null) {","381","                log.hyperlink(getCredentialPageUrl(),\"Oracle now requires Oracle account to download previous versions of JDK. Please specify your Oracle account username\/password.\\n\");","382","                throw new AbortException(\"Unable to install JDK unless a valid Oracle account username\/password is provided in the system configuration.\");","383","            }","384","","385","            if (totalPageCount++>16) \/\/ looping too much","386","                throw new IOException(\"Unable to find the login form in \"+html.asXml());","387","","388","            try {","389","                \/\/ JavaScript check page. Just submit and move on","390","                HtmlForm loginForm = html.getFormByName(\"myForm\");","391","                page = loginForm.submit(null);","392","                continue;","393","            } catch (ElementNotFoundException e) {","394","                \/\/ fall through","395","            }","396","","397","            try {","398","                \/\/ real authentication page","399","                if (authCount++ > 3) {","400","                    log.hyperlink(getCredentialPageUrl(),\"Your Oracle account doesn't appear valid. Please specify a valid username\/password\\n\");","401","                    throw new AbortException(\"Unable to install JDK unless a valid username\/password is provided.\");","402","                }","403","                HtmlForm loginForm = html.getFormByName(\"LoginForm\");","404","                loginForm.getInputByName(\"ssousername\").setValueAttribute(u);","405","                loginForm.getInputByName(\"password\").setValueAttribute(p.getPlainText());","406","                page = loginForm.submit(null);","407","                continue;","408","            } catch (ElementNotFoundException e) {","409","                \/\/ fall through","410","            }","411","","412","            throw new IOException(\"Unable to find the login form in \"+html.asXml());","415","        \/\/ download to a temporary file and rename it in to handle concurrency and failure correctly,","416","        File tmp = new File(cache.getPath()+\".tmp\");","417","        tmp.getParentFile().mkdirs();","419","            FileOutputStream out = new FileOutputStream(tmp);","420","            try {","421","                IOUtils.copy(page.getWebResponse().getContentAsStream(), out);","422","            } finally {","423","                out.close();","424","            }","426","            tmp.renameTo(cache);","427","            return cache.toURL();","429","            tmp.delete();"]}],"core\/pom.xml":[{"add":["172","      <groupId>commons-httpclient<\/groupId>","173","      <artifactId>commons-httpclient<\/artifactId>"],"delete":["172","      <groupId>org.jenkins-ci<\/groupId>","173","      <artifactId>htmlunit<\/artifactId>","174","      <version>2.6-jenkins-6<\/version>","175","      <exclusions>","176","        <exclusion>","177","          <groupId>xml-apis<\/groupId>","178","          <artifactId>xml-apis<\/artifactId>","179","        <\/exclusion>","180","        <exclusion>","181","          <groupId>xalan<\/groupId>","182","          <artifactId>xalan<\/artifactId>","183","        <\/exclusion>","184","      <\/exclusions>"]}],"changelog.html":[{"add":["66","  <li class=rfe>","67","    Rewrote the JDK installer to remove problematic HtmlUnit dependencies.","68","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-11420\">issue 11420<\/a>)"],"delete":["66",""]}]}},"8fdca297132b953b5572c97480b8017695f92d6d":{"changes":{"core\/src\/main\/java\/hudson\/Functions.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Functions.java":[{"add":["1539","     *","1540","     * @return null in case the action should not be presented to the user.","1542","    public static @CheckForNull String getActionUrl(String itUrl,Action action) {"],"delete":["1540","    public static String getActionUrl(String itUrl,Action action) {"]}]}},"5aef97cebcda2124074d29fde6f62b48cb77e135":{"changes":{"test\/src\/test\/java\/hudson\/maven\/MavenBuildTest.java":"MODIFY","test\/src\/test\/resources\/hudson\/maven\/JENKINS-15865.zip":"ADD"},"diff":{"test\/src\/test\/java\/hudson\/maven\/MavenBuildTest.java":[{"add":["8","import hudson.tasks.test.AbstractTestResultAction;","9","import hudson.tasks.test.AggregatedTestResultAction;","10","import hudson.tasks.test.TestResultProjectAction;","14","import java.util.List;","15","import java.util.Map;","152","    }","153","    ","154","    @Bug(value=15865)","155","    public void testMavenFailsafePluginTestResultsAreRecorded() throws Exception {","156","        ","157","        \/\/ GIVEN: a Maven project with maven-failsafe-plugin and Maven 2.2.1","158","        MavenModuleSet mavenProject = createMavenProject();","159","        MavenInstallation mavenInstallation = configureDefaultMaven();","160","        mavenProject.setMaven(mavenInstallation.getName());","161","        mavenProject.getReporters().add(new TestReporter());","162","        mavenProject.setScm(new ExtractResourceSCM(getClass().getResource(\"JENKINS-15865.zip\")));","163","        mavenProject.setGoals( \"clean install\" );","164","        ","165","        \/\/ WHEN project is build","166","        MavenModuleSetBuild mmsb =  buildAndAssertSuccess(mavenProject);","167","        ","168","        \/\/ THEN we have a testresult recorded","169","        AggregatedTestResultAction aggregatedTestResultAction = mmsb.getAggregatedTestResultAction();","170","        assertNotNull(aggregatedTestResultAction);","171","        assertEquals(1, aggregatedTestResultAction.getTotalCount());","172","        ","173","        Map<MavenModule, MavenBuild> moduleBuilds = mmsb.getModuleLastBuilds();","174","        assertEquals(1, moduleBuilds.size());","175","        MavenBuild moduleBuild = moduleBuilds.values().iterator().next();","176","         AbstractTestResultAction<?> testResultAction = moduleBuild.getTestResultAction();","177","        assertNotNull(testResultAction);","178","        assertEquals(1, testResultAction.getTotalCount());"],"delete":[]}],"test\/src\/test\/resources\/hudson\/maven\/JENKINS-15865.zip":[{"add":[],"delete":[]}]}},"21bb7c2097c39e37143580b8b4d0d54830c3f7d3":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["141","      <version>1.2.1<\/version>","147","      <version>1.3.2<\/version>","153","      <version>1.1.1<\/version>"],"delete":["141","      <version>1.2<\/version>","147","      <version>1.3.1<\/version>","153","      <version>1.1<\/version>"]}]}},"63c2f6c5d7d154a3a0f58c54f04f9b1a25ea5385":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["498","      <version>1.24<\/version>"],"delete":["498","      <version>1.22<\/version>"]}]}},"24c97b9f83bf6ed0d81dae77ed958d42aaf077f0":{"changes":{"core\/src\/main\/java\/hudson\/ExtensionFinder.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/ExtensionFinder.java":[{"add":["193","                } catch (LinkageError e) {","194","                    LOGGER.log(Level.WARNING,\"Failed to scout \"+item.className(), e);"],"delete":[]}]}},"f4c3cd1dfc3ba6c42064bb93d77f43f1e236ecc1":{"changes":{"core\/src\/main\/resources\/jenkins\/slaves\/Messages_de.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/slaves\/Messages_de.properties":[{"add":["26","JnlpSlaveAgentProtocol3.displayName=Java-Web-Start-Agentenprotokoll Version 3 (einfache Verschl\\u00FCsselung)"],"delete":["26","JnlpSlaveAgentProtocol3.displayName=Java-Web-Start-Agentenprotokoll Version (einfache Verschl\\u00FCsselung)"]}]}},"ed81cd5f5492449ed3be11cf67bd78fff30d311a":{"changes":{"core\/src\/test\/java\/hudson\/FilePathTest.java":"MODIFY","core\/src\/main\/java\/hudson\/FilePath.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/FilePathTest.java":[{"add":["144","","145","    \/\/ @Bug(6494)","146","    public void testGetParent() throws Exception {","147","        FilePath fp = new FilePath((VirtualChannel)null, \"\/abc\/def\");","148","        assertEquals(\"\/abc\", (fp = fp.getParent()).getRemote());","149","        assertEquals(\"\/\", (fp = fp.getParent()).getRemote());","150","        assertNull(fp.getParent());","151","","152","        fp = new FilePath((VirtualChannel)null, \"abc\/def\\\\ghi\");","153","        assertEquals(\"abc\/def\", (fp = fp.getParent()).getRemote());","154","        assertEquals(\"abc\", (fp = fp.getParent()).getRemote());","155","        assertNull(fp.getParent());","156","","157","        fp = new FilePath((VirtualChannel)null, \"C:\\\\abc\\\\def\");","158","        assertEquals(\"C:\\\\abc\", (fp = fp.getParent()).getRemote());","159","        assertEquals(\"C:\\\\\", (fp = fp.getParent()).getRemote());","160","        assertNull(fp.getParent());","161","    }"],"delete":[]}],"core\/src\/main\/java\/hudson\/FilePath.java":[{"add":["898","     * @return parent FilePath or null if there is no parent","901","        int i = remote.length() - 2;","902","        for (; i >= 0; i--) {","903","            char ch = remote.charAt(i);","908","        return i >= 0 ? new FilePath( channel, remote.substring(0,i+1) ) : null;"],"delete":["900","        int len = remote.length()-1;","901","        while(len>=0) {","902","            char ch = remote.charAt(len);","905","            len--;","908","        return new FilePath( channel, remote.substring(0,len) );"]}]}},"73706a45bce4bdce211f01a16bc8937f9c811bce":{"changes":{"core\/src\/main\/java\/hudson\/model\/DisplayNameListener.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/DisplayNameListener.java":[{"add":["51","        \/\/ bug 5056825 - Display name field should be cleared when you copy a job within the same folder."],"delete":["51","        \/\/ bug 5056825 - Display name field should be cleared when you copy a job."]}]}},"e937b099cb49e7458159980adc4b59d1f98b057c":{"changes":{"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":"MODIFY","core\/src\/main\/resources\/hudson\/triggers\/SCMTrigger\/SCMTriggerCause\/description.jelly":"MODIFY","core\/src\/main\/java\/hudson\/model\/Cause.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":[{"add":["48","import org.kohsuke.accmod.Restricted;","49","import org.kohsuke.accmod.restrictions.DoNotUse;","76","import javax.annotation.Nonnull;","77","","542","        private transient AbstractBuild<?, ?>  build;","543","","562","        public void onLoad(@Nonnull AbstractBuild<?, ?> build) {","563","            this.build = build;","564","        }","565","","566","        @Override","568","            this.build = build;","584","        @Restricted(DoNotUse.class)","585","        public AbstractBuild<?, ?> getBuild() {","586","            return this.build;","587","        }","588",""],"delete":[]}],"core\/src\/main\/resources\/hudson\/triggers\/SCMTrigger\/SCMTriggerCause\/description.jelly":[{"add":["25","    <!-- this link loses breadcrumb context, but need absolute URL for upstream cause support (JENKINS-18048) -->","26","    <span><a href=\"${rootURL}\/${it.build.url}pollingLog\">${it.shortDescription}<\/a><\/span>"],"delete":["25","    <span><a href=\"pollingLog\">${it.shortDescription}<\/a><\/span>"]}],"core\/src\/main\/java\/hudson\/model\/Cause.java":[{"add":["159","        @Override","160","        public void onLoad(@Nonnull AbstractBuild<?, ?> build) {","161","            Item i = Jenkins.getInstance().getItemByFullName(this.upstreamProject);","162","            if (i == null || !(i instanceof AbstractProject)) {","163","                \/\/ cannot initialize upstream causes","164","                return;","165","            }","166","","167","            AbstractProject j = (AbstractProject)i;","168","            AbstractBuild r = j.getBuildByNumber(this.getUpstreamBuild());","169","            if (r == null) {","170","                \/\/ build doesn't exist anymore","171","                return;","172","            }","173","","174","            for (Cause c : this.upstreamCauses) {","175","                c.onLoad(r);","176","            }","177","        }","178",""],"delete":[]}]}},"95c8b214072f53e05b81a357193acd77f02bd171":{"changes":{"core\/src\/test\/java\/hudson\/util\/RetrierTest.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/util\/RetrierTest.java":[{"add":["99","        Assert.assertTrue(timeElapsed >= SLEEP);"],"delete":["99","        Assert.assertTrue(timeElapsed > SLEEP);"]}]}},"9429fff861d25f40990ba5e1e7c00e0bc7883051":{"changes":{"war\/resources\/help\/project-config\/maven.html":"MODIFY","war\/resources\/help\/project-config\/ant.html":"MODIFY"},"diff":{"war\/resources\/help\/project-config\/maven.html":[{"add":["7","  Hudson passes <a href=\"https:\/\/hudson.dev.java.net\/source\/browse\/*checkout*\/hudson\/trunk\/hudson\/main\/war\/resources\/env-vars.html\" target=\"_new\">","13","<\/div>"],"delete":["7","  Hudson passes <a href=\"https:\/\/hudson.dev.java.net\/source\/browse\/*checkout*\/hudson\/hudson\/main\/war\/resources\/env-vars.html\">","13","<\/div>"]}],"war\/resources\/help\/project-config\/ant.html":[{"add":["5","  Hudson supplies some <a href=\"https:\/\/hudson.dev.java.net\/source\/browse\/*checkout*\/hudson\/trunk\/hudson\/main\/war\/resources\/env-vars.html\" target=\"_new\">","7","<\/div>"],"delete":["5","  Hudson supplies some <a href='..\/..\/env-vars.html' target=_new>","7","<\/div>"]}]}},"17c4c358138deb3fd00f39f7489febbfb4f820e2":{"changes":{"core\/src\/main\/java\/hudson\/ExtensionFinder.java":"MODIFY","test\/src\/test\/java\/hudson\/ExtensionFinderTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/ExtensionFinder.java":[{"add":["499","                    for (Class<?> cc = c; cc != Object.class && cc != null; cc = cc.getSuperclass()) {"],"delete":["499","                    for (Class cc = c; cc != Object.class; cc = cc.getSuperclass()) {"]}],"test\/src\/test\/java\/hudson\/ExtensionFinderTest.java":[{"add":["26","import com.google.inject.ImplementedBy;","32","import static org.hamcrest.Matchers.*;","36","import org.jvnet.hudson.test.Issue;","150","    @Issue(\"JENKINS-60816\")","151","    @Test","152","    public void injectInterface() {","153","        assertThat(ExtensionList.lookupSingleton(X.class).xface, instanceOf(Impl.class));","154","    }","155","    @TestExtension(\"injectInterface\")","156","    public static final class X {","157","        @Inject","158","        XFace xface;","159","    }","160","    @ImplementedBy(Impl.class)","161","    public interface XFace {}","162","    public static final class Impl implements XFace {}","163",""],"delete":[]}]}},"9005eb665f1208f9750eddafaf77d734a7b97245":{"changes":{"core\/src\/main\/java\/hudson\/os\/windows\/ManagedWindowsServiceLauncher.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/os\/windows\/ManagedWindowsServiceLauncher.java":[{"add":[],"delete":["313","            if(slaveService==null) { \/\/ backward compatibility. is this needed ?","314","                slaveService = services.getService(\"hudsonslave\");","315","            }"]}]}},"15c40425af801560cfa6fbaccbd22289c29d6bd1":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["57","  <li class=bug>","58","  Repeated ids, expandTextArea() and multiple \"Invoke Ant\" build steps.","59","  (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10989\">issue 10989<\/a>)","60",""],"delete":["57","  <li class=>"]}]}},"99cf772da11823ec965874b17e89866a3931ebc1":{"changes":{"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/slave-agent.jnlp.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/slave-agent.jnlp.jelly":[{"add":["52","            <j2se version=\"1.8+\" java-vm-args=\"${it.launcher.vmargs} -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=${port}\" \/>","55","            <j2se version=\"1.8+\" java-vm-args=\"${it.launcher.vmargs}\"\/>"],"delete":["52","            <j2se version=\"1.7+\" java-vm-args=\"${it.launcher.vmargs} -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=${port}\" \/>","55","            <j2se version=\"1.7+\" java-vm-args=\"${it.launcher.vmargs}\"\/>"]}]}},"249dfb13be296b01b750497c0a93120200672508":{"changes":{"core\/src\/main\/java\/hudson\/tools\/DownloadFromUrlInstaller.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tools\/DownloadFromUrlInstaller.java":[{"add":["12","import java.util.HashSet;","172","        \/**","173","         * Merge a list of ToolInstallerList and removes duplicate tool installers (ie having the same id)","174","         * @param jsonList the list of ToolInstallerList to merge","175","         * @return the merged ToolInstallerList wrapped in a JSONObject","176","         *\/","179","","180","            HashSet<String> processedIds = new HashSet<String>();","183","                for(ToolInstallerEntry entry : toolInstallerList.list) {","184","                    \/\/ being able to add the id into the processedIds set means this tool has not been processed before","185","                    if (processedIds.add(entry.id)) {","186","                        reducedToolEntries.add(entry);"],"delete":["173","            \/\/collect all tool installers objects from the multiple json objects","176","                reducedToolEntries.addAll(Arrays.asList(toolInstallerList.list));","177","            }","178","","179","            while (Downloadable.hasDuplicates(reducedToolEntries, \"id\")) {","180","                List<ToolInstallerEntry> tmpToolInstallerEntries = new LinkedList<>();","181","                \/\/we need to skip the processed entries","182","                boolean processed[] = new boolean[reducedToolEntries.size()];","183","                for (int i = 0; i < reducedToolEntries.size(); i++) {","184","                    if (processed[i] == true) {","185","                        continue;","186","                    }","187","                    ToolInstallerEntry data1 = reducedToolEntries.get(i);","188","                    boolean hasDuplicate = false;","189","                    for (int j = i + 1; j < reducedToolEntries.size(); j ++) {","190","                        ToolInstallerEntry data2 = reducedToolEntries.get(j);","191","                        \/\/if we found a duplicate we choose the first one","192","                        if (data1.id.equals(data2.id)) {","193","                            hasDuplicate = true;","194","                            processed[j] = true;","195","                            tmpToolInstallerEntries.add(data1);","196","                            \/\/after the first duplicate has been found we break the loop since the duplicates are","197","                            \/\/processed two by two","198","                            break;","199","                        }","200","                    }","201","                    \/\/if no duplicate has been found we just insert the entry in the tmp list","202","                    if (!hasDuplicate) {","203","                        tmpToolInstallerEntries.add(data1);","206","                reducedToolEntries = tmpToolInstallerEntries;"]}]}},"f76eca4ee801869c1cbf9b59e73fe76594fe265e":{"changes":{"core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["305","                                        ListIterator<PluginWrapper> litr = getPlugins().listIterator();","578","        List<PluginWrapper> out = new ArrayList<PluginWrapper>(plugins.size());","579","        out.addAll(plugins);","580","        return out;","593","        for (PluginWrapper p : getPlugins()) {","607","        for (PluginWrapper p : getPlugins()) {","622","        for (PluginWrapper p : getPlugins()) {"],"delete":["305","                                        ListIterator<PluginWrapper> litr = plugins.listIterator();","578","        return plugins;","591","        for (PluginWrapper p : plugins) {","605","        for (PluginWrapper p : plugins) {","620","        for (PluginWrapper p : plugins) {"]}]}},"447224ed732e85f7c1976e58b250e44eae9d5826":{"changes":{"core\/src\/main\/java\/hudson\/model\/labels\/LabelAtom.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/labels\/LabelAtom.java":[{"add":["25","import com.thoughtworks.xstream.converters.MarshallingContext;","27","import com.thoughtworks.xstream.io.HierarchicalStreamReader;","28","import com.thoughtworks.xstream.io.HierarchicalStreamWriter;","238","    \/\/ class name is not ConverterImpl, to avoid getting picked up by AssociatedConverterImpl","240","        private Label.ConverterImpl leafLabelConverter = new Label.ConverterImpl();","241","","245","","246","        public boolean canConvert(Class type) {","249","","250","        public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) {","251","            if (context.get(IN_NESTED)==null) {","252","                context.put(IN_NESTED,true);","253","                try {","254","                    super.marshal(source,writer,context);","255","                } finally {","256","                    context.put(IN_NESTED,false);","257","                }","258","            } else","259","                leafLabelConverter.marshal(source,writer,context);","261","","262","        public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {","263","            if (context.get(IN_NESTED)==null) {","264","                context.put(IN_NESTED,true);","265","                try {","266","                    return super.unmarshal(reader,context);","267","                } finally {","268","                    context.put(IN_NESTED,false);","269","                }","270","            } else","271","                return leafLabelConverter.unmarshal(reader,context);","272","        }","273","","274","        @Override","275","        protected void callback(LabelAtom obj, UnmarshallingContext context) {","276","            \/\/ noop","277","        }","278","","279","        private static final Object IN_NESTED = \"VisitingInnerLabelAtom\";"],"delete":["239","        @Override public boolean canConvert(Class type) {","242","        @Override protected void callback(LabelAtom obj, UnmarshallingContext context) {","243","            \/\/ Unused"]}]}},"7796b32023a04032ab7cd47bfb46e4d3d7eddfbb":{"changes":{"\/dev\/null":"DELETE","core\/src\/main\/java\/hudson\/Util.java":"MODIFY","core\/src\/test\/java\/hudson\/UtilTest.java":"MODIFY","core\/src\/test\/java\/hudson\/RemoveWindowsDirectoryJunctionTest.java":"MODIFY"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/Util.java":[{"add":["25","import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;","26","","63","import java.nio.file.LinkOption;","64","import java.nio.file.NoSuchFileException;","68","import java.nio.file.attribute.BasicFileAttributes;","69","import java.nio.file.attribute.PosixFileAttributes;","70","import java.nio.file.attribute.DosFileAttributes;","249","        for( int numberOfAttempts=1 ; ; numberOfAttempts++ ) {","250","            try {","251","                tryOnceDeleteContentsRecursive(file);","252","                break; \/\/ success","253","            } catch (IOException ex) {","254","                boolean threadWasInterrupted = pauseBetweenDeletes(numberOfAttempts);","255","                if( numberOfAttempts>= DELETION_MAX || threadWasInterrupted)","256","                    throw new IOException(deleteFailExceptionMessage(file, numberOfAttempts, threadWasInterrupted), ex);","257","            }","258","        }","269","        for( int numberOfAttempts=1 ; ; numberOfAttempts++ ) {","270","            try {","271","                tryOnceDeleteFile(f);","272","                break; \/\/ success","273","            } catch (IOException ex) {","274","                boolean threadWasInterrupted = pauseBetweenDeletes(numberOfAttempts);","275","                if( numberOfAttempts>= DELETION_MAX || threadWasInterrupted)","276","                    throw new IOException(deleteFailExceptionMessage(f, numberOfAttempts, threadWasInterrupted), ex);","277","            }","278","        }","279","    }","280","","281","    \/**","282","     * Deletes this file, working around most problems which might make","283","     * this difficult.","284","     * ","285","     * @param f","286","     *            What to delete. If a directory, it'll need to be empty.","287","     * @throws IOException if it exists but could not be successfully deleted,","288","     * or if it represents an invalid {@link Path}.","289","     *\/","290","    private static void tryOnceDeleteFile(File f) throws IOException {","291","        Path path = fileToPath(f);","292","        try {","293","            Files.deleteIfExists(path);","294","        } catch (IOException e) {","295","            \/\/ perhaps this file is read-only?","296","            makeWritable(path);","297","            \/*","298","             on Unix both the file and the directory that contains it has to be writable","299","             for a file deletion to be successful. (Confirmed on Solaris 9)","300","","301","             $ ls -la","302","             total 6","303","             dr-xr-sr-x   2 hudson   hudson       512 Apr 18 14:41 .","304","             dr-xr-sr-x   3 hudson   hudson       512 Apr 17 19:36 ..","305","             -r--r--r--   1 hudson   hudson       469 Apr 17 19:36 manager.xml","306","             -rw-r--r--   1 hudson   hudson         0 Apr 18 14:41 x","307","             $ rm x","308","             rm: x not removed: Permission denied","309","             *\/","310","            Path parent = path.getParent();","311","            if (parent != null) {","312","                makeWritable(parent);","313","            }","314","            try {","315","                Files.deleteIfExists(path);","316","            } catch (IOException e2) {","317","                \/\/ see https:\/\/java.net\/projects\/hudson\/lists\/users\/archive\/2008-05\/message\/357","318","                \/\/ I suspect other processes putting files in this directory","319","                File[] files = f.listFiles();","320","                if(files!=null && files.length>0)","321","                    throw new IOException(\"Unable to delete \" + f.getPath()+\" - files in dir: \"+Arrays.asList(files), e2);","322","                throw e2;","323","            }","324","        }","325","    }","326","","327","    \/**","328","     * Makes the file at the given path writable by any means possible.","329","     *\/","330","    private static void makeWritable(@Nonnull Path path) throws IOException {","331","        if (!Functions.isWindows()) {","332","            try {","333","                PosixFileAttributes attrs = Files.readAttributes(path, PosixFileAttributes.class);","334","                Set<PosixFilePermission> newPermissions = attrs.permissions();","335","                newPermissions.add(PosixFilePermission.OWNER_WRITE);","336","                Files.setPosixFilePermissions(path, newPermissions);","337","                return;","338","            } catch (NoSuchFileException e) {","339","                return;","340","            } catch (UnsupportedOperationException e) {","341","                \/\/ PosixFileAttributes not supported, fall back to old IO.","342","            }","343","        }","344","","345","        \/**","346","         * We intentionally do not check the return code of setWritable, because if it","347","         * is false we prefer to rethrow the exception thrown by Files.deleteIfExists,","348","         * which will have a more useful message than something we make up here.","349","         *\/","350","        path.toFile().setWritable(true);","362","        for( int numberOfAttempts=1 ; ; numberOfAttempts++ ) {","363","            try {","364","                tryOnceDeleteRecursive(dir);","365","                break; \/\/ success","366","            } catch (IOException ex) {","367","                boolean threadWasInterrupted = pauseBetweenDeletes(numberOfAttempts);","368","                if( numberOfAttempts>= DELETION_MAX || threadWasInterrupted)","369","                    throw new IOException(deleteFailExceptionMessage(dir, numberOfAttempts, threadWasInterrupted), ex);","370","            }","371","        }","372","    }","373","","374","    \/**","375","     * Deletes a file or folder, throwing the first exception encountered, but","376","     * having a go at deleting everything. i.e. it does not <em>stop<\/em> on the","377","     * first exception, but tries (to delete) everything once.","378","     *","379","     * @param dir","380","     * What to delete. If a directory, the contents will be deleted","381","     * too.","382","     * @throws The first exception encountered.","383","     *\/","384","    private static void tryOnceDeleteRecursive(File dir) throws IOException {","385","        if(!isSymlink(dir))","386","            tryOnceDeleteContentsRecursive(dir);","387","        tryOnceDeleteFile(dir);","388","    }","389","","390","    \/**","391","     * Deletes a folder's contents, throwing the first exception encountered,","392","     * but having a go at deleting everything. i.e. it does not <em>stop<\/em>","393","     * on the first exception, but tries (to delete) everything once.","394","     *","395","     * @param directory","396","     * The directory whose contents will be deleted.","397","     * @throws The first exception encountered.","398","     *\/","399","    private static void tryOnceDeleteContentsRecursive(File directory) throws IOException {","400","        File[] directoryContents = directory.listFiles();","401","        if(directoryContents==null)","402","            return; \/\/ the directory didn't exist in the first place","403","        IOException firstCaught = null;","404","        for (File child : directoryContents) {","405","            try {","406","                tryOnceDeleteRecursive(child);","407","            } catch (IOException justCaught) {","408","                if( firstCaught==null) {","409","                    firstCaught = justCaught;","410","                }","411","            }","412","        }","413","        if( firstCaught!=null )","414","            throw firstCaught;","415","    }","416","","417","    \/**","418","     * Pauses between delete attempts, and says if it's ok to try again.","419","     * This does not wait if the wait time is zero or if we have tried","420","     * too many times already.","421","     * <p>","422","     * See {@link #WAIT_BETWEEN_DELETION_RETRIES} for details of","423","     * the pause duration.<br\/>","424","     * See {@link #GC_AFTER_FAILED_DELETE} for when {@link System#gc()} is called.","425","     * ","426","     * @return false if it is ok to continue trying to delete things, true if","427","     *         we were interrupted (and should stop now).","428","     *\/","429","    @SuppressFBWarnings(value = \"DM_GC\", justification = \"Garbage collection happens only when \"","430","            + \"GC_AFTER_FAILED_DELETE is true. It's an experimental feature in Jenkins.\")","431","    private static boolean pauseBetweenDeletes(int numberOfAttemptsSoFar) {","432","        long delayInMs;","433","        if( numberOfAttemptsSoFar>=DELETION_MAX ) return false;","434","        \/* If the Jenkins process had the file open earlier, and it has not","435","         * closed it then Windows won't let us delete it until the Java object","436","         * with the open stream is Garbage Collected, which can result in builds","437","         * failing due to \"file in use\" on Windows despite working perfectly","438","         * well on other OSs. *\/","439","        if (GC_AFTER_FAILED_DELETE) {","440","            System.gc();","441","        }","442","        if (WAIT_BETWEEN_DELETION_RETRIES>=0) {","443","            delayInMs = WAIT_BETWEEN_DELETION_RETRIES;","444","        } else {","445","            delayInMs = -numberOfAttemptsSoFar*WAIT_BETWEEN_DELETION_RETRIES;","446","        }","447","        if (delayInMs<=0)","448","            return Thread.interrupted();","449","        try {","450","            Thread.sleep(delayInMs);","451","            return false;","452","        } catch (InterruptedException e) {","453","            return true;","454","        }","455","    }","456","","457","    \/**","458","     * Creates a \"couldn't delete file\" message that explains how hard we tried.","459","     * See {@link #DELETION_MAX}, {@link #WAIT_BETWEEN_DELETION_RETRIES}","460","     * and {@link #GC_AFTER_FAILED_DELETE} for more details.","461","     *\/","462","    private static String deleteFailExceptionMessage(File whatWeWereTryingToRemove, int retryCount, boolean wasInterrupted) {","463","        StringBuilder sb = new StringBuilder();","464","        sb.append(\"Unable to delete '\");","465","        sb.append(whatWeWereTryingToRemove);","466","        sb.append(\"'. Tried \");","467","        sb.append(retryCount);","468","        sb.append(\" time\");","469","        if( retryCount!=1 ) sb.append('s');","470","        if( DELETION_MAX>1 ) {","471","            sb.append(\" (of a maximum of \");","472","            sb.append(DELETION_MAX);","473","            sb.append(')');","474","            if( GC_AFTER_FAILED_DELETE )","475","                sb.append(\" garbage-collecting\");","476","            if( WAIT_BETWEEN_DELETION_RETRIES!=0 && GC_AFTER_FAILED_DELETE )","477","                sb.append(\" and\");","478","            if( WAIT_BETWEEN_DELETION_RETRIES!=0 ) {","479","                sb.append(\" waiting \");","480","                sb.append(getTimeSpanString(Math.abs(WAIT_BETWEEN_DELETION_RETRIES)));","481","                if( WAIT_BETWEEN_DELETION_RETRIES<0 ) {","482","                    sb.append(\"-\");","483","                    sb.append(getTimeSpanString(Math.abs(WAIT_BETWEEN_DELETION_RETRIES)*DELETION_MAX));","484","                }","485","            }","486","            if( WAIT_BETWEEN_DELETION_RETRIES!=0 || GC_AFTER_FAILED_DELETE)","487","                sb.append(\" between attempts\");","488","        }","489","        if( wasInterrupted )","490","            sb.append(\". The delete operation was interrupted before it completed successfully\");","491","        sb.append('.');","492","        return sb.toString();","511","     * Checks if the given file represents a symlink.","515","         *  Windows Directory Junctions are effectively the same as Linux symlinks to directories.","516","         *  Unfortunately, the Java 7 NIO2 API function isSymbolicLink does not treat them as such.","517","         *  It thinks of them as normal directories.  To use the NIO2 API & treat it like a symlink,","518","         *  you have to go through BasicFileAttributes and do the following check:","519","         *     isSymbolicLink() || isOther()","520","         *  The isOther() call will include Windows reparse points, of which a directory junction is.","521","         *  It also includes includes devices, but reading the attributes of a device with NIO fails","522","         *  or returns false for isOther(). (i.e. named pipes such as \\\\.\\pipe\\JenkinsTestPipe return","523","         *  false for isOther(), and drives such as \\\\.\\PhysicalDrive0 throw an exception when","524","         *  calling readAttributes.","527","            Path path = fileToPath(file);","528","            BasicFileAttributes attrs = Files.readAttributes(path, BasicFileAttributes.class, LinkOption.NOFOLLOW_LINKS);","529","            if (attrs.isSymbolicLink()) {","530","                return true;","531","            } else if (attrs instanceof DosFileAttributes) {","532","                \/* Returns true for non-symbolic link reparse points and devices. We could call","533","                 * WindowsFileAttributes#isReparsePoint with reflection instead to exclude devices,","534","                 * but as mentioned in the above comment this does not appear to be an issue.","535","                 *\/","536","                return attrs.isOther();","537","            } else {","538","                return false;","539","            }","540","        } catch (NoSuchFileException e) {"],"delete":["31","import jenkins.util.io.PathRemover;","243","        newPathRemover().forceRemoveDirectoryContents(fileToPath(file));","254","        newPathRemover().forceRemoveFile(fileToPath(f));","266","        newPathRemover().forceRemoveRecursive(fileToPath(dir));","285","     * Checks if the given file represents a symlink. Unlike {@link Files#isSymbolicLink(Path)}, this method also","286","     * considers <a href=\"https:\/\/en.wikipedia.org\/wiki\/NTFS_junction_point\">NTFS junction points<\/a> as symbolic","287","     * links.","290","        return isSymlink(fileToPath(file));","291","    }","292","","293","    @Restricted(NoExternalUse.class)","294","    public static boolean isSymlink(@Nonnull Path path) {","295","        if (Files.isSymbolicLink(path)) return true;","297","        In Windows, a directory junction is not considered a symbolic link despite being nearly the same feature.","298","        To avoid relying directly on Windows-specific filesystem API calls, we can instead determine if a path is","299","        logically a symbolic link by comparing its absolute path to its real path.","302","            return path.toAbsolutePath().compareTo(path.toRealPath()) != 0;","303","        } catch (IOException ignored) {","1562","    private static PathRemover newPathRemover() {","1563","        return PathRemover.newRobustRemover(DELETION_MAX - 1, GC_AFTER_FAILED_DELETE, WAIT_BETWEEN_DELETION_RETRIES);","1564","    }","1565",""]}],"core\/src\/test\/java\/hudson\/UtilTest.java":[{"add":["29","import java.util.List;","34","import java.util.concurrent.Callable;","35","import java.util.concurrent.atomic.AtomicReference;","38","import java.io.FileInputStream;","40","import java.io.InputStream;","41","import java.nio.file.FileSystemException;","42","import java.nio.file.Files;","43","import java.nio.file.Path;","46","import static org.hamcrest.CoreMatchers.allOf;","47","import static org.hamcrest.CoreMatchers.containsString;","48","import static org.hamcrest.CoreMatchers.hasItem;","49","import static org.hamcrest.CoreMatchers.instanceOf;","55","import org.apache.commons.io.FileUtils;","59","import org.junit.Ignore;","68","import com.google.common.collect.Lists;","69","","194","        Assume.assumeTrue(!Functions.isWindows());","242","        Assume.assumeTrue(!Functions.isWindows());","284","    public void testDeleteFile() throws Exception {","285","        File f = tmp.newFile();","286","        \/\/ Test: File is deleted","287","        mkfiles(f);","288","        Util.deleteFile(f);","289","        assertFalse(\"f exists after calling Util.deleteFile\", f.exists());","290","    }","291","","292","    @Test","293","    public void testDeleteFile_onWindows() throws Exception {","294","        Assume.assumeTrue(Functions.isWindows());","295","        final int defaultDeletionMax = Util.DELETION_MAX;","296","        try {","297","            File f = tmp.newFile();","298","            \/\/ Test: If we cannot delete a file, we throw explaining why","299","            mkfiles(f);","300","            lockFileForDeletion(f);","301","            Util.DELETION_MAX = 1;","302","            try {","303","                Util.deleteFile(f);","304","                fail(\"should not have been deletable\");","305","            } catch (IOException x) {","306","                assertThat(calcExceptionHierarchy(x), hasItem(FileSystemException.class));","307","                assertThat(x.getMessage(), containsString(f.getPath()));","308","            }","309","        } finally {","310","            Util.DELETION_MAX = defaultDeletionMax;","311","            unlockFilesForDeletion();","312","        }","313","    }","314","","315","    @Test","316","    public void testDeleteFileReadOnly() throws Exception {","317","        \/\/ Removing the calls to Util#makeWritable in Util#tryOnceDeleteFile should cause this test to fail.","318","        Path file = tmp.newFolder().toPath().resolve(\"file.tmp\");","319","        Files.createDirectories(file.getParent());","320","        Files.createFile(file);","321","        \/\/ Using old IO so the test can run on Windows.","322","        file.getParent().toFile().setWritable(false);","323","        file.toFile().setWritable(false);","324","        Util.deleteFile(file.toFile());","325","        assertFalse(Files.exists(file));","326","    }","327","","328","    @Test","329","    public void testDeleteFileDoesNotExist() throws Exception {","330","        Path file = tmp.newFolder().toPath().resolve(\"file.tmp\");","331","        assertFalse(Files.exists(file));","332","        \/\/ Should not throw an exception.","333","        Util.deleteFile(file.toFile());","334","    }","335","","336","    @Test","337","    public void testDeleteContentsRecursive() throws Exception {","338","        final File dir = tmp.newFolder();","339","        final File d1 = new File(dir, \"d1\");","340","        final File d2 = new File(dir, \"d2\");","341","        final File f1 = new File(dir, \"f1\");","342","        final File d1f1 = new File(d1, \"d1f1\");","343","        final File d2f2 = new File(d2, \"d1f2\");","344","        \/\/ Test: Files and directories are deleted","345","        mkdirs(dir, d1, d2);","346","        mkfiles(f1, d1f1, d2f2);","347","        Util.deleteContentsRecursive(dir);","348","        assertTrue(\"dir exists\", dir.exists());","349","        assertFalse(\"d1 exists\", d1.exists());","350","        assertFalse(\"d2 exists\", d2.exists());","351","        assertFalse(\"f1 exists\", f1.exists());","352","    }","353","","354","    @Ignore(\"TODO often fails in CI\")","355","    @Test","356","    public void testDeleteContentsRecursive_onWindows() throws Exception {","357","        Assume.assumeTrue(Functions.isWindows());","358","        final File dir = tmp.newFolder();","359","        final File d1 = new File(dir, \"d1\");","360","        final File d2 = new File(dir, \"d2\");","361","        final File f1 = new File(dir, \"f1\");","362","        final File d1f1 = new File(d1, \"d1f1\");","363","        final File d2f2 = new File(d2, \"d1f2\");","364","        final int defaultDeletionMax = Util.DELETION_MAX;","365","        final int defaultDeletionWait = Util.WAIT_BETWEEN_DELETION_RETRIES;","366","        final boolean defaultDeletionGC = Util.GC_AFTER_FAILED_DELETE;","367","        try {","368","            \/\/ Test: If we cannot delete a file, we throw","369","            \/\/ but still deletes everything it can","370","            \/\/ even if we are not retrying deletes.","371","            mkdirs(dir, d1, d2);","372","            mkfiles(f1, d1f1, d2f2);","373","            lockFileForDeletion(d1f1);","374","            Util.GC_AFTER_FAILED_DELETE = false;","375","            Util.DELETION_MAX = 2;","376","            Util.WAIT_BETWEEN_DELETION_RETRIES = 0;","377","            try {","378","                Util.deleteContentsRecursive(dir);","379","                fail(\"Expected IOException\");","380","            } catch (IOException x) {","381","                assertFalse(\"d2 should not exist\", d2.exists());","382","                assertFalse(\"f1 should not exist\", f1.exists());","383","                assertFalse(\"d1f2 should not exist\", d2f2.exists());","384","                assertThat(x.getMessage(), containsString(dir.getPath()));","385","                assertThat(x.getMessage(), allOf(not(containsString(\"interrupted\")), containsString(\"Tried 2 times (of a maximum of 2).\"), not(containsString(\"garbage-collecting\")), not(containsString(\"wait\"))));","386","            }","387","        } finally {","388","            Util.DELETION_MAX = defaultDeletionMax;","389","            Util.WAIT_BETWEEN_DELETION_RETRIES = defaultDeletionWait;","390","            Util.GC_AFTER_FAILED_DELETE = defaultDeletionGC;","391","            unlockFilesForDeletion();","392","        }","393","    }","394","","395","    @Test","396","    public void testDeleteRecursive() throws Exception {","397","        final File dir = tmp.newFolder();","398","        final File d1 = new File(dir, \"d1\");","399","        final File d2 = new File(dir, \"d2\");","400","        final File f1 = new File(dir, \"f1\");","401","        final File d1f1 = new File(d1, \"d1f1\");","402","        final File d2f2 = new File(d2, \"d1f2\");","403","        \/\/ Test: Files and directories are deleted","404","        mkdirs(dir, d1, d2);","405","        mkfiles(f1, d1f1, d2f2);","406","        Util.deleteRecursive(dir);","407","        assertFalse(\"dir exists\", dir.exists());","408","    }","409","","410","    @Ignore(\"JENKINS-55016\")","411","    @Test","412","    public void testDeleteRecursive_onWindows() throws Exception {","413","        Assume.assumeTrue(Functions.isWindows());","414","        final File dir = tmp.newFolder();","415","        final File d1 = new File(dir, \"d1\");","416","        final File d2 = new File(dir, \"d2\");","417","        final File f1 = new File(dir, \"f1\");","418","        final File d1f1 = new File(d1, \"d1f1\");","419","        final File d2f2 = new File(d2, \"d1f2\");","420","        final int defaultDeletionMax = Util.DELETION_MAX;","421","        final int defaultDeletionWait = Util.WAIT_BETWEEN_DELETION_RETRIES;","422","        final boolean defaultDeletionGC = Util.GC_AFTER_FAILED_DELETE;","423","        try {","424","            \/\/ Test: If we cannot delete a file, we throw","425","            \/\/ but still deletes everything it can","426","            \/\/ even if we are not retrying deletes.","427","        \t\/\/ (And when we are not retrying deletes,","428","        \t\/\/ we do not do the \"between retries\" delay)","429","            mkdirs(dir, d1, d2);","430","            mkfiles(f1, d1f1, d2f2);","431","            lockFileForDeletion(d1f1);","432","            Util.GC_AFTER_FAILED_DELETE = false;","433","            Util.DELETION_MAX = 1;","434","            Util.WAIT_BETWEEN_DELETION_RETRIES = 10000; \/\/ long enough to notice","435","            long timeWhenDeletionStarted = System.currentTimeMillis();","436","            try {","437","                Util.deleteRecursive(dir);","438","                fail(\"Expected IOException\");","439","            } catch (IOException x) {","440","                long timeWhenDeletionEnded = System.currentTimeMillis();","441","                assertTrue(\"dir exists\", dir.exists());","442","                assertTrue(\"d1 exists\", d1.exists());","443","                assertTrue(\"d1f1 exists\", d1f1.exists());","444","                assertFalse(\"d2 should not exist\", d2.exists());","445","                assertFalse(\"f1 should not exist\", f1.exists());","446","                assertFalse(\"d1f2 should not exist\", d2f2.exists());","447","                assertThat(x.getMessage(), containsString(dir.getPath()));","448","                assertThat(x.getMessage(), allOf(not(containsString(\"interrupted\")), not(containsString(\"maximum of\")), not(containsString(\"garbage-collecting\"))));","449","                long actualTimeSpentDeleting = timeWhenDeletionEnded - timeWhenDeletionStarted;","450","                assertTrue(\"did not wait - took \" + actualTimeSpentDeleting + \"ms\", actualTimeSpentDeleting<1000L);","451","            }","452","            unlockFileForDeletion(d1f1);","453","            \/\/ Deletes get retried if they fail 1st time around,","454","            \/\/ allowing the operation to succeed on subsequent attempts.","455","            \/\/ Note: This is what bug JENKINS-15331 is all about.","456","            mkdirs(dir, d1, d2);","457","            mkfiles(f1, d1f1, d2f2);","458","            lockFileForDeletion(d2f2);","459","            Util.DELETION_MAX=4;","460","            Util.WAIT_BETWEEN_DELETION_RETRIES = 100;","461","            Thread unlockAfterDelay = new Thread(\"unlockFileAfterDelay\") {","462","                public void run() {","463","                    try {","464","                        Thread.sleep(Util.WAIT_BETWEEN_DELETION_RETRIES);","465","                        unlockFileForDeletion(d2f2);","466","                    } catch( Exception x ) { \/* ignored *\/ }","467","                }","468","            };","469","            unlockAfterDelay.start();","470","            Util.deleteRecursive(dir);","471","            assertFalse(\"dir should have been deleted\", dir.exists());","472","            unlockAfterDelay.join();","473","            \/\/ An interrupt aborts the delete and makes it fail, even","474","            \/\/ if we had been told to retry a lot.","475","            mkdirs(dir, d1, d2);","476","            mkfiles(f1, d1f1, d2f2);","477","            lockFileForDeletion(d1f1);","478","            Util.DELETION_MAX=10;","479","            Util.WAIT_BETWEEN_DELETION_RETRIES = -1000;","480","            Util.GC_AFTER_FAILED_DELETE = true;","481","            final AtomicReference<Throwable> thrown = new AtomicReference<Throwable>();","482","            Thread deleteToBeInterrupted = new Thread(\"deleteToBeInterrupted\") {","483","                public void run() {","484","                    try { Util.deleteRecursive(dir); }","485","                    catch( Throwable x ) { thrown.set(x); }","486","                }","487","            };","488","            deleteToBeInterrupted.start();","489","            deleteToBeInterrupted.interrupt();","490","            deleteToBeInterrupted.join(500);","491","            assertFalse(\"deletion stopped\", deleteToBeInterrupted.isAlive());","492","            assertTrue(\"d1f1 still exists\", d1f1.exists());","493","            unlockFileForDeletion(d1f1);","494","            Throwable deletionInterruptedEx = thrown.get();","495","            assertThat(deletionInterruptedEx, instanceOf(IOException.class));","496","            assertThat(deletionInterruptedEx.getMessage(), allOf(containsString(\"interrupted\"), containsString(\"maximum of \" + Util.DELETION_MAX), containsString(\"garbage-collecting\")));","497","        } finally {","498","            Util.DELETION_MAX = defaultDeletionMax;","499","            Util.WAIT_BETWEEN_DELETION_RETRIES = defaultDeletionWait;","500","            Util.GC_AFTER_FAILED_DELETE = defaultDeletionGC;","501","            unlockFilesForDeletion();","502","        }","503","    }","504","","505","    \/** Creates multiple directories. *\/","506","    private static void mkdirs(File... dirs) {","507","        for( File d : dirs ) {","508","            d.mkdir();","509","            assertTrue(d.getPath(), d.isDirectory());","510","        }","511","    }","512","","513","    \/** Creates multiple files, each containing their filename as text content. *\/","514","    private static void mkfiles(File... files) throws IOException {","515","        for( File f : files )","516","            FileUtils.write(f, f.getName());","517","    }","518","","519","    \/** Means of unlocking all the files we have locked, indexed by {@link File}. *\/","520","    private final Map<File, Callable<Void>> unlockFileCallables = new HashMap<File, Callable<Void>>();","521","","522","    \/** Prevents a file from being deleted, so we can stress the deletion code's retries. *\/","523","    private void lockFileForDeletion(File f) throws IOException, InterruptedException {","524","        assert !unlockFileCallables.containsKey(f) : f + \" is already locked.\" ;","525","        \/\/ Limitation: Only works on Windows. On unix we can delete anything we can create.","526","        \/\/ On unix, can't use \"chmod a-w\" on the dir as the code-under-test undoes that.","527","        \/\/ On unix, can't use \"chattr +i\" because that needs root.","528","        \/\/ On unix, can't use \"chattr +u\" because ext fs ignores it.","529","        \/\/ On Windows, can't use FileChannel.lock() because that doesn't block deletion","530","        \/\/ On Windows, we can't delete files that are open for reading, so we use that.","531","        \/\/ NOTE: This is a hack in any case as there is no guarantee that all Windows filesystems","532","        \/\/ will enforce blocking deletion on open files... just that the ones we normally","533","        \/\/ test with seem to block.","534","        assert Functions.isWindows();","535","        final InputStream s = new FileInputStream(f); \/\/ intentional use of FileInputStream","536","        unlockFileCallables.put(f, new Callable<Void>() {","537","            public Void call() throws IOException { s.close(); return null; };","538","        });","539","    }","540","","541","    \/** Undoes a call to {@link #lockFileForDeletion(File)}. *\/","542","    private void unlockFileForDeletion(File f) throws Exception {","543","        unlockFileCallables.remove(f).call();","544","    }","545","","546","    \/** Undoes all calls to {@link #lockFileForDeletion(File)}. *\/","547","    private void unlockFilesForDeletion() throws Exception {","548","        while( !unlockFileCallables.isEmpty() ) {","549","            unlockFileForDeletion(unlockFileCallables.keySet().iterator().next());","550","        }","551","    }","552","","553","    \/** Returns all classes in the exception hierarchy. *\/","554","    private static Iterable<Class<?>> calcExceptionHierarchy(Throwable t) {","555","        final List<Class<?>> result = Lists.newArrayList();","556","        for( ; t!=null ; t = t.getCause())","557","            result.add(t.getClass());","558","        return result;","559","    }","560","","561","    @Test","766","        try {","767","            Util.modeToPermissions(01777);","768","            fail(\"Did not detect invalid mode\");","769","        } catch (IOException e) {","770","            assertThat(e.getMessage(), startsWith(\"Invalid mode\"));","771","        }"],"delete":["47","import org.junit.rules.ExpectedException;","62","    @Rule public ExpectedException expectedException = ExpectedException.none();","63","","181","        Assume.assumeFalse(Functions.isWindows());","229","        Assume.assumeFalse(Functions.isWindows());","475","        expectedException.expectMessage(startsWith(\"Invalid mode\"));","476","        Util.modeToPermissions(01777);"]}],"core\/src\/test\/java\/hudson\/RemoveWindowsDirectoryJunctionTest.java":[{"add":[],"delete":["15","import org.jvnet.hudson.test.For;","18","@For(Util.class)","19","\/\/ https:\/\/superuser.com\/q\/343074"]}]}},"bf444887ac16cc802695827da0a0f30949aa0f1f":{"changes":{"test\/src\/test\/java\/hudson\/model\/ViewJobTest.java":"ADD","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/ViewJob.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/ViewJobTest.java":[{"add":[],"delete":[]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Deleting an external run did not immediately remove it from build list, leading to errors from log rotation.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-19377\">issue 19377<\/a>)"],"delete":["57","  <li class=>"]}],"core\/src\/main\/java\/hudson\/model\/ViewJob.java":[{"add":["35","import java.util.logging.Level;","36","import java.util.logging.Logger;","50","    private static final Logger LOGGER = Logger.getLogger(ViewJob.class.getName());","51","","132","        if (runs != null && !runs.remove(run)) {","133","            LOGGER.log(Level.WARNING, \"{0} did not contain {1} to begin with\", new Object[] {this, run});","134","        }"],"delete":["128","        \/\/ reload the info next time","129","        nextUpdate = 0;"]}]}},"f756ddae483a7c8f7cdaa4619e82145a1c63a99b":{"changes":{"core\/src\/main\/java\/hudson\/model\/FileParameterValue.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/FileParameterValue.java":[{"add":["108","                    locationFilePath.getParent().mkdirs();"],"delete":[]}]}},"dd84f0f5604000c349d80b691913b403a45381ff":{"changes":{"test\/src\/test\/java\/hudson\/console\/ConsoleAnnotatorTest.java":"MODIFY","core\/pom.xml":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Run\/console.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/TaskAction\/log.jelly":"MODIFY","core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":"MODIFY","core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/log.jelly":"MODIFY","core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Computer.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/TaskAction.java":"MODIFY","core\/src\/main\/java\/hudson\/console\/AnnotatedLargeText.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/console\/ConsoleAnnotatorTest.java":[{"add":["104","            WebRequestSettings req = new WebRequestSettings(new URL(getURL() + run.getUrl() + \"\/logText\/progressiveHtml\"+(start!=null?\"?start=\"+start:\"\")));"],"delete":["104","            WebRequestSettings req = new WebRequestSettings(new URL(getURL() + run.getUrl() + \"\/progressiveLog\"+(start!=null?\"?start=\"+start:\"\")));"]}],"core\/pom.xml":[{"add":["336","      <version>1.138<\/version>"],"delete":["336","      <version>1.137<\/version>"]}],"core\/src\/main\/resources\/hudson\/model\/Run\/console.jelly":[{"add":["60","         <t:progressiveText href=\"logText\/progressiveHtml\" idref=\"out\" spinner=\"spinner\" startOffset=\"${offset}\" \/>"],"delete":["60","         <t:progressiveText href=\"progressiveLog\" idref=\"out\" spinner=\"spinner\" startOffset=\"${offset}\" \/>"]}],"core\/src\/main\/resources\/hudson\/model\/TaskAction\/log.jelly":[{"add":["35","      <t:progressiveText href=\"progressiveHtml\" idref=\"out\" spinner=\"spinner\" \/>"],"delete":["35","      <t:progressiveText href=\"progressiveLog\" idref=\"out\" spinner=\"spinner\" \/>"]}],"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":[{"add":["275","            new AnnotatedLargeText<SCMAction>(getLogFile(),Charset.defaultCharset(),true,this).writeHtmlTo(0,out.asWriter());"],"delete":["275","            new AnnotatedLargeText<SCMAction>(getLogFile(),Charset.defaultCharset(),true,this).writeLogTo(0,out.asWriter());"]}],"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/log.jelly":[{"add":["33","        <t:progressiveText href=\"logText\/progressiveHtml\" idref=\"out\" spinner=\"spinner\" \/>"],"delete":["33","        <t:progressiveText href=\"progressiveLog\" idref=\"out\" spinner=\"spinner\" \/>"]}],"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["1013","        getLogText().writeHtmlTo(offset,out.asWriter());","1016","    \/**","1017","     * Used to URL-bind {@link AnnotatedLargeText}.","1018","     *\/","1019","    public AnnotatedLargeText getLogText() {","1510","    public void doBuildNumber(StaplerResponse rsp) throws IOException {","1549","     * @deprecated as of 1.352","1550","     *      Use {@code getLogText().doProgressiveText(req,rsp)}","1553","        getLogText().doProgressText(req,rsp);"],"delete":["1013","        createAnnotatedLargeText().writeLogTo(offset,out.asWriter());","1016","    private AnnotatedLargeText createAnnotatedLargeText() {","1507","    public void doBuildNumber( StaplerRequest req, StaplerResponse rsp ) throws IOException {","1548","        createAnnotatedLargeText().doProgressText(req,rsp);"]}],"core\/src\/main\/java\/hudson\/model\/Computer.java":[{"add":["168","    \/**","169","     * Used to URL-bind {@link AnnotatedLargeText}.","170","     *\/","171","    public AnnotatedLargeText<Computer> getLogText() {","172","        return new AnnotatedLargeText<Computer>(getLogFile(), Charset.defaultCharset(), false, this);","173","    }","174","","993","        getLogText().doProgressText(req,rsp);"],"delete":["986","        new AnnotatedLargeText<Computer>(getLogFile(), Charset.defaultCharset(), false, this).doProgressText(req,rsp);"]}],"core\/src\/main\/java\/hudson\/model\/TaskAction.java":[{"add":["117","     * Handles incremental log output.","118","     *\/","119","    public void doProgressiveHtml( StaplerRequest req, StaplerResponse rsp) throws IOException {","120","        AnnotatedLargeText text = obtainLog();","121","        if(text!=null) {","122","            text.doProgressiveHtml(req,rsp);","123","            return;","124","        }","125","        rsp.setStatus(HttpServletResponse.SC_OK);","126","    }","127","","128","    \/**"],"delete":[]}],"core\/src\/main\/java\/hudson\/console\/AnnotatedLargeText.java":[{"add":["33","import org.kohsuke.stapler.StaplerResponse;","35","import org.kohsuke.stapler.framework.io.CharSpool;","37","import org.kohsuke.stapler.framework.io.LineEndNormalizingWriter;","42","import javax.servlet.http.HttpServletResponse;","86","    public void doProgressiveHtml(StaplerRequest req, StaplerResponse rsp) throws IOException {","87","        req.setAttribute(\"html\",true);","88","        doProgressText(req,rsp);","89","    }","90","","91","    \/**","92","     * Aliasing what I think was a wrong name in {@link LargeText}","93","     *\/","94","    public void doProgressiveText(StaplerRequest req, StaplerResponse rsp) throws IOException {","95","        doProgressText(req,rsp);","96","    }","97","","98","    \/**","99","     * For reusing code between text\/html and text\/plain, we run them both through the same code path","100","     * and use this request attribute to differentiate. ","101","     *\/","102","    private boolean isHtml() {","103","        return Stapler.getCurrentRequest().getAttribute(\"html\")!=null;","104","    }","105","","106","    @Override","107","    protected void setContentType(StaplerResponse rsp) {","108","        rsp.setContentType(isHtml() ? \"text\/html;charset=UTF-8\" : \"text\/plain;charset=UTF-8\");","109","    }","110","","137","        if (isHtml())","138","            return writeHtmlTo(start, w);","139","        else","140","            return super.writeLogTo(start,w);","141","    }","142","","143","    public long writeHtmlTo(long start, Writer w) throws IOException {","151","            sym.init(Cipher.ENCRYPT_MODE, Hudson.getInstance().getSecretKeyAsAES128());"],"delete":["115","            sym.init(Cipher.ENCRYPT_MODE,Hudson.getInstance().getSecretKeyAsAES128());"]}]}},"71debc2b8942844c721d7849b48286dc13c3c8db":{"changes":{"core\/src\/test\/java\/hudson\/FilePathTest.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/FilePathTest.java":[{"add":["381","","382","    @Bug(13649)","383","    public void testMultiSegmentRelativePaths() throws Exception {","384","        FilePath winPath = new FilePath(new LocalChannel(null), \"c:\\\\app\\\\jenkins\\\\workspace\");","385","        FilePath nixPath = new FilePath(new LocalChannel(null), \"\/opt\/jenkins\/workspace\");","386","","387","        assertEquals(\"c:\\\\app\\\\jenkins\\\\workspace\\\\foo\\\\bar\\\\manchu\", new FilePath(winPath, \"foo\/bar\/manchu\").getRemote());","388","        assertEquals(\"c:\\\\app\\\\jenkins\\\\workspace\\\\foo\\\\bar\\\\manchu\", new FilePath(winPath, \"foo\\\\bar\/manchu\").getRemote());","389","        assertEquals(\"c:\\\\app\\\\jenkins\\\\workspace\\\\foo\\\\bar\\\\manchu\", new FilePath(winPath, \"foo\\\\bar\\\\manchu\").getRemote());","390","        assertEquals(\"\/opt\/jenkins\/workspace\/foo\/bar\/manchu\", new FilePath(nixPath, \"foo\\\\bar\\\\manchu\").getRemote());","391","        assertEquals(\"\/opt\/jenkins\/workspace\/foo\/bar\/manchu\", new FilePath(nixPath, \"foo\/bar\\\\manchu\").getRemote());","392","        assertEquals(\"\/opt\/jenkins\/workspace\/foo\/bar\/manchu\", new FilePath(nixPath, \"foo\/bar\/manchu\").getRemote());","393","    }"],"delete":[]}]}},"dca6c9a219f8215ff046f1176073c968f472a037":{"changes":{"core\/src\/main\/java\/hudson\/model\/View.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/View.java":[{"add":["89","            long rhs = that.lastChange.getTimeInMillis();","90","            long lhs = this.lastChange.getTimeInMillis();","91","            if(rhs>lhs) return 1;","92","            if(rhs<lhs) return -1;","93","            return 0;"],"delete":["89","            return that.lastChange.compareTo(this.lastChange);"]}],"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["810","            long lt = lhs.getTimestamp().getTimeInMillis();","811","            long rt = rhs.getTimestamp().getTimeInMillis();","812","            if(lt>rt)   return -1;","813","            if(lt<rt)   return 1;","814","            return 0;"],"delete":["810","            return -lhs.getTimestamp().compareTo(rhs.getTimestamp());"]}]}},"7c2e1b2ece1770874eedd69cf20142aad4b491b9":{"changes":{"pom.xml":"MODIFY"},"diff":{"pom.xml":[{"add":["183","        <version>3.4<\/version>"],"delete":["183","        <version>3.3<\/version>"]}]}},"eb1698c673fa69d2ca08b78511209f0caa13b055":{"changes":{"test\/src\/test\/java\/jenkins\/security\/ResourceDomainTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/security\/ResourceDomainRootAction.java":"MODIFY"},"diff":{"test\/src\/test\/java\/jenkins\/security\/ResourceDomainTest.java":[{"add":["289","    public void testColonUserName() throws Exception {","290","        j.jenkins.setSecurityRealm(j.createDummySecurityRealm());","291","        MockAuthorizationStrategy a = new MockAuthorizationStrategy();","292","        a.grant(Jenkins.READ).everywhere().toEveryone();","293","        j.jenkins.setAuthorizationStrategy(a);","294","","295","        JenkinsRule.WebClient webClient = j.createWebClient();","296","        webClient.setRedirectEnabled(true);","297","        webClient.login(\"foo:bar\");","298","","299","        Page page = webClient.goTo(\"userContent\/readme.txt\", \"text\/plain\");","300","        String resourceResponseUrl = page.getUrl().toString();","301","        Assert.assertEquals(\"resource response success\", 200, page.getWebResponse().getStatusCode());","302","        Assert.assertNull(\"no CSP headers\", page.getWebResponse().getResponseHeaderValue(\"Content-Security-Policy\"));","303","        Assert.assertTrue(\"Served from resource domain\", resourceResponseUrl.contains(RESOURCE_DOMAIN));","304","        Assert.assertTrue(\"Served from resource action\", resourceResponseUrl.contains(\"static-files\"));","305","    }","306","","307","    @Test"],"delete":[]}],"core\/src\/main\/java\/jenkins\/security\/ResourceDomainRootAction.java":[{"add":["197","        InternalResourceRequest(@Nonnull String browserUrl, @Nonnull String authenticationName) {","210","            if (Util.fixEmpty(authenticationName) != null) {","270","        Token (@Nonnull String path, @Nullable String username, @Nonnull Instant timestamp) {","277","            String value = timestamp.toEpochMilli() + \":\" + username.length() + \":\" + username + \":\" + path;","293","                String[] splits = rest.split(\"[:]\", 3);","294","                String epoch = splits[0];","295","                int authenticationNameLength = Integer.parseInt(splits[1]);","296","                String authenticationNameAndBrowserUrl = splits[2];","297","                String authenticationName = authenticationNameAndBrowserUrl.substring(0, authenticationNameLength);","298","                String browserUrl = authenticationNameAndBrowserUrl.substring(authenticationNameLength + 1);"],"delete":["197","        InternalResourceRequest(@Nonnull String browserUrl, String authenticationName) {","210","            if (authenticationName != null) {","270","        Token (String path, @Nullable String username, Instant timestamp) {","277","            String value = username + \":\" + timestamp.toEpochMilli() + \":\" + path;","293","                String[] splits = rest.split(\":\", 3);","294","                String authenticationName = Util.fixEmpty(splits[0]);","295","                String epoch = splits[1];","296","                String browserUrl = splits[2];"]}]}},"741be05517eb5158bb2f273fe077c57ab7448006":{"changes":{"cli\/src\/main\/java\/hudson\/cli\/SSHCLI.java":"MODIFY","cli\/src\/main\/java\/hudson\/cli\/FullDuplexHttpStream.java":"MODIFY","test\/src\/test\/java\/hudson\/cli\/CLITest.java":"MODIFY","cli\/src\/main\/java\/hudson\/cli\/CLI.java":"MODIFY"},"diff":{"cli\/src\/main\/java\/hudson\/cli\/SSHCLI.java":[{"add":["65","        CLI.verifyJenkinsConnection(conn);"],"delete":[]}],"cli\/src\/main\/java\/hudson\/cli\/FullDuplexHttpStream.java":[{"add":["76","        \/\/ As this transport mode is using POST, it is necessary to resolve possible redirections using GET first.","77","        HttpURLConnection con = (HttpURLConnection) base.openConnection();","78","        con.getInputStream().close();","79","        this.base = con.getURL();","82","        URL target = new URL(this.base, relativeTarget);","89","        con = (HttpURLConnection) target.openConnection();","104","            throw new CLI.NotTalkingToJenkinsException(\"There's no Jenkins running at \" + target + \", or is not serving the HTTP Duplex transport\");","163","            CLI.verifyJenkinsConnection(con);","164",""],"delete":["76","        this.base = base;","79","        URL target = new URL(base, relativeTarget);","86","        HttpURLConnection con = (HttpURLConnection) target.openConnection();","101","            throw new IOException(target + \" does not look like Jenkins, or is not serving the HTTP Duplex transport\");"]}],"test\/src\/test\/java\/hudson\/cli\/CLITest.java":[{"add":["26","import com.gargoylesoftware.htmlunit.WebResponse;","32","import hudson.model.UnprotectedRootAction;","34","import hudson.security.csrf.CrumbExclusion;","39","import java.io.PrintWriter;","44","","45","import jenkins.model.GlobalConfiguration;","64","import org.jvnet.hudson.test.TestExtension;","65","import org.kohsuke.stapler.HttpResponses;","66","import org.kohsuke.stapler.Stapler;","67","import org.kohsuke.stapler.StaplerProxy;","68","import org.kohsuke.stapler.StaplerRequest;","69","import org.kohsuke.stapler.StaplerResponse;","70","","71","import javax.servlet.FilterChain;","72","import javax.servlet.ServletException;","73","import javax.servlet.http.HttpServletRequest;","74","import javax.servlet.http.HttpServletResponse;","87","    private File home;","88","    private File jar;","89","","92","        home = tmp.newFolder();","115","        home = tempHome();","116","        grabCliJar();","117","","139","    private void grabCliJar() throws IOException {","140","        jar = tmp.newFile(\"jenkins-cli.jar\");","141","        FileUtils.copyURLToFile(r.jenkins.getJnlpJars(\"jenkins-cli.jar\").getURL(), jar);","142","    }","143","","147","        home = tempHome();","148","        grabCliJar();","149","","158","        doInterrupt(p, \"-remoting\", \"-i\", privkey.getAbsolutePath());","159","        doInterrupt(p, \"-ssh\", \"-user\", \"admin\", \"-i\", privkey.getAbsolutePath());","160","        doInterrupt(p, \"-http\", \"-auth\", \"admin:admin\");","162","    private void doInterrupt(FreeStyleProject p, String... modeArgs) throws Exception {","176","    @Test","177","    public void reportNotJenkins() throws Exception {","178","        home = tempHome();","179","        grabCliJar();","180","","181","        for (String transport: Arrays.asList(\"-remoting\", \"-http\", \"-ssh\")) {","182","","183","            String url = \"http:\/\/jenkins.io\";","184","            ByteArrayOutputStream baos = new ByteArrayOutputStream();","185","            int ret = new Launcher.LocalLauncher(StreamTaskListener.fromStderr()).launch().cmds(","186","                    \"java\", \"-Duser.home=\" + home, \"-jar\", jar.getAbsolutePath(), \"-s\", url, transport, \"-user\", \"asdf\", \"who-am-i\"","187","            ).stdout(baos).stderr(baos).join();","188","","189","            assertThat(baos.toString(), containsString(\"There's no Jenkins running at\"));","190","            assertNotEquals(0, ret);","191","        }","192","    }","193","","194","    @Test","195","    public void redirectToEndpointShouldBeFollowed() throws Exception {","196","        home = tempHome();","197","        grabCliJar();","198","","199","        \/\/ Enable CLI over SSH","200","        SSHD sshd = GlobalConfiguration.all().get(SSHD.class);","201","        sshd.setPort(0); \/\/ random","202","        sshd.start();","203","","204","        \/\/ Sanity check","205","        JenkinsRule.WebClient wc = r.createWebClient();","206","        wc.getOptions().setRedirectEnabled(false);","207","        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);","208","        WebResponse rsp = wc.goTo(\"cli-proxy\/\").getWebResponse();","209","        assertEquals(rsp.getContentAsString(), 302, rsp.getStatusCode());","210","        assertEquals(rsp.getContentAsString(), null, rsp.getResponseHeaderValue(\"X-Jenkins\"));","211","        assertEquals(rsp.getContentAsString(), null, rsp.getResponseHeaderValue(\"X-Jenkins-CLI-Port\"));","212","        assertEquals(rsp.getContentAsString(), null, rsp.getResponseHeaderValue(\"X-SSH-Endpoint\"));","213","","214","        for (String transport: Arrays.asList(\"-remoting\", \"-http\", \"-ssh\")) {","215","","216","            String url = r.getURL().toString() + \"cli-proxy\/\";","217","            ByteArrayOutputStream baos = new ByteArrayOutputStream();","218","            int ret = new Launcher.LocalLauncher(StreamTaskListener.fromStderr()).launch().cmds(","219","                    \"java\", \"-Duser.home=\" + home, \"-jar\", jar.getAbsolutePath(), \"-s\", url, transport, \"-user\", \"asdf\", \"who-am-i\"","220","            ).stdout(baos).stderr(baos).join();","221","","222","            \/\/assertThat(baos.toString(), containsString(\"There's no Jenkins running at\"));","223","            assertThat(baos.toString(), containsString(\"Authenticated as: anonymous\"));","224","            assertEquals(0, ret);","225","        }","226","    }","227","    @TestExtension(\"redirectToEndpointShouldBeFollowed\")","228","    public static final class CliProxyAction extends CrumbExclusion implements UnprotectedRootAction, StaplerProxy {","229","","230","        @Override public String getIconFileName() {","231","            return \"cli-proxy\";","232","        }","233","","234","        @Override public String getDisplayName() {","235","            return \"cli-proxy\";","236","        }","237","","238","        @Override public String getUrlName() {","239","            return \"cli-proxy\";","240","        }","241","","242","        @Override public Object getTarget() {","243","            throw doDynamic(Stapler.getCurrentRequest(), Stapler.getCurrentResponse());","244","        }","245","","246","        public HttpResponses.HttpResponseException doDynamic(StaplerRequest req, StaplerResponse rsp) {","247","            final String url = req.getRequestURIWithQueryString().replaceFirst(\"\/cli-proxy\", \"\");","248","            \/\/ Custom written redirect so no traces of Jenkins are present in headers","249","            return new HttpResponses.HttpResponseException() {","250","                @Override","251","                public void generateResponse(StaplerRequest req, StaplerResponse rsp, Object node) throws IOException, ServletException {","252","                    rsp.setHeader(\"Location\", url);","253","                    rsp.setContentType(\"text\/html\");","254","                    rsp.setStatus(302);","255","                    PrintWriter w = rsp.getWriter();","256","                    w.append(\"Redirect to \").append(url);","257","                }","258","            };","259","        }","260","","261","        @Override \/\/ Permit access to cli-proxy\/XXX without CSRF checks","262","        public boolean process(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws IOException, ServletException {","263","            chain.doFilter(request, response);","264","            return true;","265","        }","266","    }"],"delete":["72","        File home = tmp.newFolder();","95","        File home = tempHome();","99","        File jar = tmp.newFile(\"jenkins-cli.jar\");","100","        FileUtils.copyURLToFile(r.jenkins.getJnlpJars(\"jenkins-cli.jar\").getURL(), jar);","122","        File home = tempHome();","126","        File jar = tmp.newFile(\"jenkins-cli.jar\");","127","        FileUtils.copyURLToFile(r.jenkins.getJnlpJars(\"jenkins-cli.jar\").getURL(), jar);","133","        doInterrupt(jar, home, p, \"-remoting\", \"-i\", privkey.getAbsolutePath());","134","        doInterrupt(jar, home, p, \"-ssh\", \"-user\", \"admin\", \"-i\", privkey.getAbsolutePath());","135","        doInterrupt(jar, home, p, \"-http\", \"-auth\", \"admin:admin\");","137","    private void doInterrupt(File jar, File home, FreeStyleProject p, String... modeArgs) throws Exception {"]}],"cli\/src\/main\/java\/hudson\/cli\/CLI.java":[{"add":["308","            verifyJenkinsConnection(head);","318","     * Make sure the connection is open against Jenkins server.","319","     *","320","     * @param c The open connection.","321","     * @throws IOException in case of communication problem.","322","     * @throws NotTalkingToJenkinsException when connection is not made to Jenkins service.","323","     *\/","324","    \/*package*\/ static void verifyJenkinsConnection(URLConnection c) throws IOException {","325","        if (c.getHeaderField(\"X-Hudson\")==null && c.getHeaderField(\"X-Jenkins\")==null)","326","            throw new NotTalkingToJenkinsException(c);","327","    }","328","    \/*package*\/ static final class NotTalkingToJenkinsException extends IOException {","329","        public NotTalkingToJenkinsException(String s) {","330","            super(s);","331","        }","332","","333","        public NotTalkingToJenkinsException(URLConnection c) {","334","            super(\"There's no Jenkins running at \" + c.getURL().toString());","335","        }","336","    }","337","","338","    \/**","426","        } catch (NotTalkingToJenkinsException ex) {","427","            System.err.println(ex.getMessage());","428","            System.exit(-1);"],"delete":["308","            \/\/ we aren't finding headers we are expecting. Is this even running Jenkins?","309","            if (head.getHeaderField(\"X-Hudson\")==null && head.getHeaderField(\"X-Jenkins\")==null)","310","                throw new IOException(\"There's no Jenkins running at \"+url);"]}]}},"9cf38c5ad016dbaf9ea1ff786f7e0ca7c53ae7cd":{"changes":{"core\/src\/main\/java\/hudson\/maven\/MavenBuild.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/maven\/MavenBuild.java":[{"add":["316","            MavenModuleSetBuild pb = getParentBuild();","317","            if(pb!=null)","318","                pb.registerAsProjectAction(reporter);"],"delete":["316","            getParentBuild().registerAsProjectAction(reporter);"]}]}},"fef59606a8c25a4c66f6f31338f0a8c431abb36f":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":[{"add":["580","     * @param channel the channel to use; <strong>warning:<\/strong> callers are expected to have called {@link ChannelConfigurator} already.","581","     * @param launchLog Launch log. If not {@code null}, will receive launch log messages","582","     * @param listener Channel event listener to be attached (if not {@code null})","585","    public void setChannel(@Nonnull Channel channel,","586","                           @CheckForNull OutputStream launchLog,","587","                           @CheckForNull Channel.Listener listener) throws IOException, InterruptedException {","591","        final TaskListener taskListener = launchLog != null ? new StreamTaskListener(launchLog) : TaskListener.NULL;"],"delete":["580","     * @param channel the channel to use; <strong>warning:<\/strong> callers are expected to have called {@link ChannelConfigurator} already","583","    public void setChannel(Channel channel, OutputStream launchLog, Channel.Listener listener) throws IOException, InterruptedException {","587","        final TaskListener taskListener = new StreamTaskListener(launchLog);"]}]}},"18963ee9af2b98ce94eda799069d9135f6031a0e":{"changes":{"core\/pom.xml":"MODIFY","war\/src\/main\/webapp\/WEB-INF\/web.xml":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY","core\/src\/main\/java\/hudson\/security\/HudsonAuthenticationEntryPoint.java":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["44","    <stapler.version>1.189<\/stapler.version>"],"delete":["44","    <stapler.version>1.188<\/stapler.version>"]}],"war\/src\/main\/webapp\/WEB-INF\/web.xml":[{"add":["51","    <filter-name>compression-filter<\/filter-name>","52","    <filter-class>org.kohsuke.stapler.compression.CompressionFilter<\/filter-class>","53","  <\/filter>","54","  <filter>","117","    <filter-name>compression-filter<\/filter-name>","118","    <url-pattern>\/*<\/url-pattern>","119","  <\/filter-mapping>","120","  <filter-mapping>"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["2999","    \/**","3000","     * End point that intentionally throws an exception to test the error behaviour.","3001","     *\/","3002","    public void doException() {","3003","        throw new RuntimeException();","3004","    }","3005",""],"delete":[]}],"core\/src\/main\/java\/hudson\/security\/HudsonAuthenticationEntryPoint.java":[{"add":["84","                out = new PrintWriter(new OutputStreamWriter(rsp.getOutputStream()));"],"delete":["84","                OutputStream sout = rsp.getOutputStream();","85","\/\/                if (rsp.containsHeader(\"Content-Encoding\")) {","86","\/\/                    \/\/ we serve Jelly pages with Content-Encoding:gzip.","87","\/\/                    \/\/ ServletResponse doesn't provide means for us to check the value of the header,","88","\/\/                    \/\/ to make the matter worse, GZIPOutputStream writes a header right away,","89","\/\/                    \/\/ so by the time we get here we already have GZip header. Skip that part away by skipping first 10 bytes.","90","\/\/                    \/\/ this is a hack.","91","\/\/                    sout = new GZIPOutputStream(new ChopHeaderOutputStream(sout,10));","92","\/\/                }","93","                out = new PrintWriter(new OutputStreamWriter(sout));","112","","113","    private static class ChopHeaderOutputStream extends FilterOutputStream {","114","        private int count;","115","","116","        ChopHeaderOutputStream(OutputStream out, int count) {","117","            super(out);","118","            this.count = count;","119","        }","120","        ","121","        @Override","122","        public void write(byte[] b, int off, int len) throws IOException {","123","            int i = Math.min(len,count);","124","            count-=i;","125","            off+=i;","126","            len-=i;","127","","128","            if (len>0)","129","                out.write(b, off, len);","130","        }","131","","132","        @Override","133","        public void write(int b) throws IOException {","134","            if (count>0)","135","                count--;","136","            else","137","                out.write(b);","138","        }","139","    }"]}]}},"d75da5856fac34f19ddfe3e31baa3a110ef9b581":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Slave\/ComputerImpl\/slave-agent.jnlp.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Slave\/ComputerImpl\/slave-agent.jnlp.jelly":[{"add":["2","  <j:new var=\"h\" className=\"hudson.Functions\" \/>","12","        codebase=\"${rootURL}\/computer\/${h.encode(it.node.nodeName)}\/\">"],"delete":["11","        codebase=\"${rootURL}\/computer\/${it.node.nodeName}\/\">"]}]}},"4afcf32cecdcca3d4177c4d4031f44183ee71557":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/ComputerListener.java":"MODIFY","core\/src\/main\/java\/hudson\/slaves\/OfflineCause.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/ComputerListener.java":[{"add":["38","import javax.annotation.CheckForNull;","39","import javax.annotation.Nonnull;","40","","166","     *","167","     * @deprecated since TODO. Use {@link #onOffline(Computer, OfflineCause)} instead.","169","    @Deprecated","173","     * Called right after a {@link Computer} went offline.","174","     *","175","     * @since TODO","176","     *\/","177","    public void onOffline(@Nonnull Computer c, @CheckForNull OfflineCause cause) {","178","        onOffline(c);","179","    }","180","","181","    \/**"],"delete":[]}],"core\/src\/main\/java\/hudson\/slaves\/OfflineCause.java":[{"add":["57","        \/**","58","         * @since TODO","59","         *\/","60","        protected SimpleOfflineCause(Localizable description) {"],"delete":["57","        private SimpleOfflineCause(Localizable description) {"]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["361","Jenkins.IsRestarting=Jenkins is restarting"],"delete":[]}],"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":[{"add":["627","                cl.onOffline(this, offlineCause);"],"delete":["627","                cl.onOffline(this);"]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3331","    @Extension @Restricted(NoExternalUse.class)","3332","    public static class MasterRestartNotifyier extends RestartListener {","3333","","3334","        @Override","3335","        public void onRestart() {","3336","            Computer computer = Jenkins.getInstance().toComputer();","3337","            if (computer == null) return;","3338","            RestartCause cause = new RestartCause();","3339","            for (ComputerListener listener: ComputerListener.all()) {","3340","                listener.onOffline(computer, cause);","3341","            }","3342","        }","3343","","3344","        @Override","3345","        public boolean isReadyToRestart() throws IOException, InterruptedException {","3346","            return true;","3347","        }","3348","","3349","        private static class RestartCause extends OfflineCause.SimpleOfflineCause {","3350","            protected RestartCause() {","3351","                super(Messages._Jenkins_IsRestarting());","3352","            }","3353","        }","3354","    }","3355",""],"delete":[]}]}},"7ccf4cc031e6ff959f89b8608e61dcd54eaa65a4":{"changes":{"maven-plugin\/src\/main\/webapp\/private-repository_tr.html":"MODIFY","maven-plugin\/src\/main\/webapp\/private-repository.html":"MODIFY","maven-plugin\/src\/main\/webapp\/private-repository_de.html":"MODIFY","maven-plugin\/src\/main\/webapp\/private-repository_ja.html":"MODIFY","maven-plugin\/src\/main\/webapp\/private-repository_fr.html":"MODIFY"},"diff":{"maven-plugin\/src\/main\/webapp\/private-repository_tr.html":[{"add":["28","  <a href=\"http:\/\/jenkins.361315.n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">here<\/a>."],"delete":["28","  <a href=\"http:\/\/n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">here<\/a>."]}],"maven-plugin\/src\/main\/webapp\/private-repository.html":[{"add":["28","  <a href=\"http:\/\/jenkins.361315.n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">here<\/a>."],"delete":["28","  <a href=\"http:\/\/n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">here<\/a>."]}],"maven-plugin\/src\/main\/webapp\/private-repository_de.html":[{"add":["28","  werden, folgen Sie den Anweisungen <a href=\"http:\/\/jenkins.361315.n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">hier<\/a>."],"delete":["28","  werden, folgen Sie den Anweisungen <a href=\"http:\/\/n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">hier<\/a>."]}],"maven-plugin\/src\/main\/webapp\/private-repository_ja.html":[{"add":["24","   <a href=\"http:\/\/jenkins.361315.n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">??<\/a>????????"],"delete":["24","   <a href=\"http:\/\/n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">??<\/a>????????"]}],"maven-plugin\/src\/main\/webapp\/private-repository_fr.html":[{"add":["31","  <a href=\"http:\/\/jenkins.361315.n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">ici<\/a>."],"delete":["31","  <a href=\"http:\/\/n4.nabble.com\/Hudson-on-2-4-8-16-core-boxes-td371215.html#a371217\">ici<\/a>."]}]}},"3edb9fdcecedb4514e4b0396306cb0f115a0b321":{"changes":{"core\/src\/main\/java\/hudson\/security\/HudsonPrivateSecurityRealm.java":"MODIFY","war\/src\/main\/js\/pluginSetupWizardGui.js":"MODIFY","core\/src\/main\/resources\/hudson\/security\/HudsonPrivateSecurityRealm\/_entryForm.jelly":"MODIFY","war\/src\/main\/js\/api\/plugins.js":"MODIFY","core\/src\/main\/java\/hudson\/model\/UpdateSite.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/security\/HudsonPrivateSecurityRealm.java":[{"add":["360","        if(isMailerPluginPresent() && (si.email==null || !si.email.contains(\"@\")))","381","        if(isMailerPluginPresent()) {","382","            try {","383","                \/\/ legacy hack. mail support has moved out to a separate plugin","384","                Class<?> up = Jenkins.getInstance().pluginManager.uberClassLoader.loadClass(\"hudson.tasks.Mailer$UserProperty\");","385","                Constructor<?> c = up.getDeclaredConstructor(String.class);","386","                user.addProperty((UserProperty)c.newInstance(si.email));","387","            } catch (RuntimeException e) {","388","                throw e;","389","            } catch (Exception e) {","390","                throw new RuntimeException(e);","391","            }","396","    ","397","    public boolean isMailerPluginPresent() {","398","        try {","399","            \/\/ mail support has moved to a separate plugin","400","            return null != Jenkins.getInstance().pluginManager.uberClassLoader.loadClass(\"hudson.tasks.Mailer$UserProperty\");","401","        } catch (ClassNotFoundException e) {","402","            LOGGER.finer(\"Mailer plugin not present\");","403","        }","404","        return false;","405","    }"],"delete":["360","        if(si.email==null || !si.email.contains(\"@\"))","381","        try {","382","            \/\/ legacy hack. mail support has moved out to a separate plugin","383","            Class<?> up = Jenkins.getInstance().pluginManager.uberClassLoader.loadClass(\"hudson.tasks.Mailer$UserProperty\");","384","            Constructor<?> c = up.getDeclaredConstructor(String.class);","385","            user.addProperty((UserProperty)c.newInstance(si.email));","386","        } catch (RuntimeException e) {","387","            throw e;","388","        } catch (Exception e) {","389","            LOGGER.log(Level.WARNING, \"Failed to set the e-mail address\",e);"]}],"war\/src\/main\/js\/pluginSetupWizardGui.js":[{"add":["601","\t\t\t\tvar matches = [];","602","\t\t\t\t$containers.find('.title,.description').each(function() {","603","\t\t\t\t\tvar localMatches = findElementsWithText(this, text.toLowerCase(), function(d) { return d.toLowerCase(); });","604","\t\t\t\t\tif(localMatches.length > 0) {","605","\t\t\t\t\t\tmatches = matches.concat(localMatches);","606","\t\t\t\t\t}","607","\t\t\t\t});"],"delete":["601","\t\t\t\tvar matches = findElementsWithText($pl[0], text.toLowerCase(), function(d) { return d.toLowerCase(); });"]}],"core\/src\/main\/resources\/hudson\/security\/HudsonPrivateSecurityRealm\/_entryForm.jelly":[{"add":["24","<!-- tag file used by both signup.jelly and addUser.jelly -->","51","        <j:if test=\"${it.mailerPluginPresent}\">","56","        <\/j:if>"],"delete":["24","<!-- tag file sed by both signup.jelly and addUser.jelly -->"]}],"war\/src\/main\/js\/api\/plugins.js":[{"add":["21","    \"matrix-auth\",","40","            { \"name\": \"dashboard-view\" },","51","            { \"name\": \"build-name-setter\" },","57","            { \"name\": \"throttle-concurrents\" },","58","            { \"name\": \"timestamper\" },","59","            { \"name\": \"ws-cleanup\" }","74","            { \"name\": \"checkstyle\" },","75","            { \"name\": \"cobertura\" },","78","            { \"name\": \"sonar\" },","79","            { \"name\": \"warnings\" },","90","            { \"name\": \"conditional-buildstep\" },","91","            { \"name\": \"jenkins-multijob-plugin\" },","124","            { \"name\": \"matrix-auth\" },","127","            { \"name\": \"role-strategy\" },"],"delete":["21","    \/\/ \"matrix-auth\",","40","            \/\/ { \"name\": \"dashboard-view\" },","51","            \/\/ { \"name\": \"build-name-setter\" },","57","            \/\/ { \"name\": \"throttle-concurrents\" },","58","            { \"name\": \"timestamper\" }","59","            \/\/ { \"name\": \"ws-cleanup\" }","74","            \/\/ { \"name\": \"checkstyle\" },","75","            \/\/ { \"name\": \"cobertura\" },","78","            \/\/ { \"name\": \"sonar\" },","79","            \/\/ { \"name\": \"warnings\" },","90","            \/\/ { \"name\": \"conditional-buildstep\" },","91","            \/\/ { \"name\": \"jenkins-multijob-plugin\" },","124","            \/\/ { \"name\": \"matrix-auth\" },","127","            \/\/ { \"name\": \"role-strategy\" },"]}],"core\/src\/main\/java\/hudson\/model\/UpdateSite.java":[{"add":["636","                \/\/ Make sure there's a name attribute and that the optional value isn't true.","637","                if (get(depObj,\"name\")!=null) {"],"delete":["636","                \/\/ Make sure there's a name attribute, that that name isn't maven-plugin - we ignore that one -","637","                \/\/ and that the optional value isn't true.","638","                if (get(depObj,\"name\")!=null","639","                    && !get(depObj,\"name\").equals(\"maven-plugin\")) {"]}]}},"f9234b0498a8fef7bb2d91c65f6d2d5adbaa9378":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/Ant.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/ArgumentListBuilder.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/Ant.java":[{"add":["10","import hudson.util.ArgumentListBuilder;","58","        ArgumentListBuilder args = new ArgumentListBuilder();","69","        if(ai==null) {","70","            args.add(execName);","71","        } else {","77","            args.add(exec.getPath());","79","        args.addTokenized(normalizedTarget);","90","            args.prepend(\"cmd.exe\",\"\/C\");","91","            args.add(\"&&\",\"exit\",\"%%ERRORLEVEL%%\");","95","            int r = launcher.launch(args.toCommandArray(),env,listener.getLogger(),proj.getModuleRoot()).join();"],"delete":["57","        String cmd;","68","        if(ai==null)","69","            cmd = execName+' '+normalizedTarget;","70","        else {","76","            cmd = exec.getPath()+' '+normalizedTarget;","88","            cmd = \"cmd.exe \/C \"+cmd+\" && exit %%ERRORLEVEL%%\";","92","            int r = launcher.launch(cmd,env,listener.getLogger(),proj.getModuleRoot()).join();"]}],"core\/src\/main\/java\/hudson\/util\/ArgumentListBuilder.java":[{"add":["5","import java.util.Arrays;","20","    public ArgumentListBuilder prepend(String... args) {","21","        this.args.addAll(0, Arrays.asList(args));","22","        return this;","23","    }","24",""],"delete":[]}]}},"8f8ffe76e6d8eb82bf522835653010e8167bac7c":{"changes":{"war\/resources\/scripts\/combobox.js":"MODIFY"},"diff":{"war\/resources\/scripts\/combobox.js":[{"add":["116","\t\t\tif (self.isDropdownShowing) return false;","118","\t\t\treturn true;","124","                this.form.onsubmit = this.form.oldonsubmit;"],"delete":["117","\t\t\treturn ! self.isDropdownShowing;","123","\t\tthis.form.onsubmit = function() {","124","\t\t\tif (this.oldonsubmit) this.oldonsubmit();","125","\t\t\treturn true;","126","\t\t};"]}]}},"0b260dad8c26268f3fc01e1d6016712053645130":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["91","  <li class=bug>","92","    Fixed <code>NullPointerException<\/code> when <code>ArtifactPublisher<\/code> is called for a build with the undefined status.","93","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23526\">issue 23526<\/a>)","94","  <li class=bug>","95","    Fixed <code>NullPointerException<\/code> when &quot;properties&quot; element is missing in a job's configuration submission by JSON","96","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23437\">issue 23437<\/a>)"],"delete":[]}]}},"9fbd6d3a482643f4080fbb793c67323e8464b11c":{"changes":{"test\/src\/test\/groovy\/hudson\/model\/RunMapTest.groovy":"ADD","core\/src\/main\/java\/hudson\/model\/AbstractItem.java":"MODIFY","core\/src\/main\/java\/hudson\/cli\/UpdateJobCommand.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/RunMap.java":"MODIFY"},"diff":{"test\/src\/test\/groovy\/hudson\/model\/RunMapTest.groovy":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractItem.java":[{"add":["67","import javax.xml.transform.Source;","549","            updateByXml((Source)new StreamSource(req.getReader()));","558","     * @deprecated as of 1.473","559","     *      Use {@link #updateByXml(Source)}","562","        updateByXml((Source)source);","563","    }","564","","565","    \/**","566","     * Updates Job by its XML definition.","567","     *\/","568","    public void updateByXml(Source source) throws IOException {"],"delete":["548","            updateByXml(new StreamSource(req.getReader()));","557","     * Updates Job by its XML definition."]}],"core\/src\/main\/java\/hudson\/cli\/UpdateJobCommand.java":[{"add":["29","import javax.xml.transform.Source;","46","        job.updateByXml((Source)new StreamSource(stdin));"],"delete":["45","        job.updateByXml(new StreamSource(stdin));"]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["275","        if (this.builds==null)","276","            this.builds = new RunMap<R>();"],"delete":["275","        this.builds = new RunMap<R>();"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Updating job config.xml shouldn't clobber in-progress builds.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-12318\">issue 12318<\/a>)"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/RunMap.java":[{"add":["25","import com.google.common.collect.Maps;","26","","167","    \/**","168","     * This is the newest build (with the biggest build number)","169","     *\/","170","    public R newestValue() {","171","        SortedMap<Integer, R> _builds = builds;","172","        if (_builds.isEmpty())  return null;","173","        return _builds.get(firstKey());","174","    }","175","","176","    \/**","177","     * This is the oldest build (with the smallest build number)","178","     *\/","179","    public R oldestValue() {","180","        SortedMap<Integer, R> _builds = builds;","181","        if (_builds.isEmpty())  return null;","182","        return _builds.get(lastKey());","183","    }","184","","214","                \/\/ JENKINS-1461 sometimes create bogus data directories with impossible dates, such as year 0, April 31st,","235","        \/\/ keep all those that are building intact.","236","        Map<Integer,R> building = Maps.newHashMap();","237","        for (R b=newestValue(); b!=null && b.isBuilding(); b=b.getPreviousBuild()) {","238","            building.put(b.getNumber(), b);","239","        }","240","","256","        \/\/ overlay what's currently building on top of what's loaded","257","        builds.putAll(building);","258","        if (false) {","259","            \/\/ we probably aren't saving every little changes during the build to disk,","260","            \/\/ so it's risky to reload these from disk.","261","            for (R b : building.values()) {","262","                try {","263","                    b.reload();","264","                } catch (IOException e) {","265","                    e.printStackTrace();","266","                } catch (InstantiationError e) {","267","                    e.printStackTrace();","268","                }","269","            }","270","        }","271",""],"delete":["194","                \/\/ HUDSON-1461 sometimes create bogus data directories with impossible dates, such as year 0, April 31st,"]}]}},"4f6cae238549177b5306a05a2d1e83fcf2441353":{"changes":{"test\/src\/test\/java\/hudson\/util\/ProcessTreeKillerTest.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/util\/ProcessTreeKillerTest.java":[{"add":["115","            final String[] cmd = Functions.isWindows()","116","                    ? new String[]{\"ping\", \"-n\", \"100000\", \"localhost\"}","117","                    : new String[]{\"nohup\", \"sleep\", \"100000\"};","118","            proc = launcher.launch().envs(envvars).cmds(cmd).start();"],"delete":["93","        Assume.assumeFalse(\"This test does not involve windows\", Functions.isWindows());","116","            proc = launcher.launch().envs(envvars).cmds(\"nohup\", \"sleep\", \"100000\").start();"]}]}},"c52117a9bafa2bb4995674561e744aab28437e09":{"changes":{"war\/src\/main\/webapp\/css\/style.css":"MODIFY"},"diff":{"war\/src\/main\/webapp\/css\/style.css":[{"add":["1942","    min-width: 100%;","1943","    padding: 2em 2em;","1944","    display: inline-block;","1945","    width: auto;","1946","}","1947","@media screen and (min-width: 1024px) {","1948","    body.main-panel-only #main-panel {","1949","        padding: 2em 10%;","1950","    }","1951","}"],"delete":["1942","    max-width: 75em !important;","1943","}"]}]}},"354f3802430bf114869796279305177a0091aa70":{"changes":{"core\/src\/main\/java\/hudson\/model\/ParametersAction.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/ParametersAction.java":[{"add":["318","        Boolean shouldKeepFlag = SystemProperties.optBoolean(KEEP_UNDEFINED_PARAMETERS_SYSTEM_PROPERTY_NAME);","319","        if (shouldKeepFlag != null && shouldKeepFlag.booleanValue()) {","328","            } else if (shouldKeepFlag == null) {"],"delete":["318","        String shouldKeepFlag = SystemProperties.getString(KEEP_UNDEFINED_PARAMETERS_SYSTEM_PROPERTY_NAME);","319","        if (\"true\".equalsIgnoreCase(shouldKeepFlag)) {","328","            } else if (\"false\".equalsIgnoreCase(shouldKeepFlag)) {"]}]}},"049b55e9e526f2e92f77c74caf11ab067dddfd49":{"changes":{"core\/src\/main\/java\/hudson\/model\/Executor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Executor.java":[{"add":["10","import java.util.logging.Logger;","11","import java.util.logging.Level;","69","                    \/\/ clear the interrupt flag as a precaution.","70","                    \/\/ sometime an interrupt aborts a build but without clearing the flag.","71","                    \/\/ see issue #1583","72","                    Thread.interrupted();","73","","81","                    LOGGER.log(Level.SEVERE, \"Executor throw an exception unexpectedly\",e);","203","","204","    private static final Logger LOGGER = Logger.getLogger(Executor.class.getName());"],"delete":["6","import org.acegisecurity.Authentication;","75","                    e.printStackTrace();"]}]}},"173e66032d472a8543dd87e332925d72bd248440":{"changes":{"core\/src\/main\/resources\/hudson\/model\/AbstractItem\/configure-common.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/AbstractItem\/configure-common.jelly":[{"add":["45","  <j:if test=\"${!empty(app.slaves) || it.assignedLabel!=null}\">","67","<\/j:jelly>"],"delete":["45","  <j:if test=\"${!empty(app.slaves)}\">","67","<\/j:jelly>"]}]}},"6f6dce4bef25846d6efcbf75e1a3aa50bbe77d77":{"changes":{"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":"MODIFY"},"diff":{"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":[{"add":["1867","                p = findParent(e);","1870","                } else {","1871","                    addProperty(p, e.name.substring(r), e.value);","1873","                break;"],"delete":["1868","                    p = findParent(e);","1870","                    break;","1873","                \/\/ otherwise fall through"]}]}},"8093f904c4c9f4e9215012ad50d063f43eed41d9":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["142","                    new LocalProc(new String[]{\"rm\",\"-rf\",\"..\/lastSuccessful\"},new String[0],listener.getLogger(),getProject().getBuildDir()).join();"],"delete":["142","                    new LocalProc(new String[]{\"rm\",\"-f\",\"..\/lastSuccessful\"},new String[0],listener.getLogger(),getProject().getBuildDir()).join();"]}]}},"b39cc4d55e57e1fe028b95b2d878ee4dbabbdd91":{"changes":{"core\/src\/main\/java\/hudson\/Util.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Util.java":[{"add":["66","import java.nio.ByteBuffer;","748","                    ByteBuffer bytes = enc.encode(buf);","749","                    while (bytes.hasRemaining()) {","750","                        byte b = bytes.get();"],"delete":["747","                    for (byte b : enc.encode(buf).array()) {"]}]}},"6dd071eaa8dd20ac6734d1b54e05d0a4adb7599f":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/jenkins\/security\/SecurityListener.java":"MODIFY"},"diff":{"changelog.html":[{"add":["60","  <li class=rfe>","61","    Allow custom security realm plugins to fire events to <code>SecurityListener<\/code>s.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23417\">issue 23417<\/a>)"],"delete":[]}],"core\/src\/main\/java\/jenkins\/security\/SecurityListener.java":[{"add":["87","    \/** @since 1.569 *\/","103","    \/** @since 1.569 *\/","111","    \/** @since 1.569 *\/","119","    \/** @since 1.569 *\/","127","    \/** @since 1.569 *\/"],"delete":["37","import org.kohsuke.accmod.Restricted;","38","import org.kohsuke.accmod.restrictions.NoExternalUse;"]}]}},"d74520fd4e565ccbbd55a8645586c5f58239895e":{"changes":{"core\/src\/main\/java\/hudson\/model\/ListView.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/ListViewTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/ListView.java":[{"add":["434","            final Jenkins jenkins = Jenkins.getInstance();","435","            for (View view: jenkins.getViews()) {","436","                if (view instanceof ListView) {","437","                    renameViewItem(oldFullName, newFullName, jenkins, (ListView) view);","438","                }","439","            }","440","            for (Item g : jenkins.getAllItems()) {","445","                            renameViewItem(oldFullName, newFullName, vg, (ListView) v);","451","","452","        private void renameViewItem(String oldFullName, String newFullName, ViewGroup vg, ListView lv) {","453","            boolean needsSave;","454","            synchronized (lv) {","455","                Set<String> oldJobNames = new HashSet<String>(lv.jobNames);","456","                lv.jobNames.clear();","457","                for (String oldName : oldJobNames) {","458","                    lv.jobNames.add(Items.computeRelativeNamesAfterRenaming(oldFullName, newFullName, oldName, vg.getItemGroup()));","459","                }","460","                needsSave = !oldJobNames.equals(lv.jobNames);","461","            }","462","            if (needsSave) { \/\/ do not hold ListView lock at the time","463","                try {","464","                    lv.save();","465","                } catch (IOException x) {","466","                    Logger.getLogger(ListView.class.getName()).log(Level.WARNING, null, x);","467","                }","468","            }","469","        }","470","","472","            final Jenkins jenkins = Jenkins.getInstance();","473","            for (View view: jenkins.getViews()) {","474","                if (view instanceof ListView) {","475","                    deleteViewItem(item, jenkins, (ListView) view);","476","                }","477","            }","478","            for (Item g : jenkins.getAllItems()) {","483","                            deleteViewItem(item, vg, (ListView) v);","489","","490","        private void deleteViewItem(Item item, ViewGroup vg, ListView lv) {","491","            boolean needsSave;","492","            synchronized (lv) {","493","                needsSave = lv.jobNames.remove(item.getRelativeNameFrom(vg.getItemGroup()));","494","            }","495","            if (needsSave) {","496","                try {","497","                    lv.save();","498","                } catch (IOException x) {","499","                    Logger.getLogger(ListView.class.getName()).log(Level.WARNING, null, x);","500","                }","501","            }","502","        }"],"delete":["434","            for (Item g : Jenkins.getInstance().getAllItems()) {","439","                            ListView lv = (ListView) v;","440","                            boolean needsSave;","441","                            synchronized (lv) {","442","                                Set<String> oldJobNames = new HashSet<String>(lv.jobNames);","443","                                lv.jobNames.clear();","444","                                for (String oldName : oldJobNames) {","445","                                    lv.jobNames.add(Items.computeRelativeNamesAfterRenaming(oldFullName, newFullName, oldName, vg.getItemGroup()));","446","                                }","447","                                needsSave = !oldJobNames.equals(lv.jobNames);","448","                            }","449","                            if (needsSave) { \/\/ do not hold ListView lock at the time","450","                                try {","451","                                    g.save();","452","                                } catch (IOException x) {","453","                                    Logger.getLogger(ListView.class.getName()).log(Level.WARNING, null, x);","454","                                }","455","                            }","462","            for (Item g : Jenkins.getInstance().getAllItems()) {","467","                            ListView lv = (ListView) v;","468","                            boolean needsSave;","469","                            synchronized (lv) {","470","                                needsSave = lv.jobNames.remove(item.getRelativeNameFrom(vg.getItemGroup()));","471","                            }","472","                            if (needsSave) {","473","                                try {","474","                                    g.save();","475","                                } catch (IOException x) {","476","                                    Logger.getLogger(ListView.class.getName()).log(Level.WARNING, null, x);","477","                                }","478","                            }"]}],"test\/src\/test\/java\/hudson\/model\/ListViewTest.java":[{"add":["28","","33","","38","","40","","141","    @Bug(23893)","142","    @Test public void renameJobContainedInTopLevelView() throws Exception {","143","        ListView view = new ListView(\"view\", j.jenkins);","144","        j.jenkins.addView(view);","145","        FreeStyleProject job = j.createFreeStyleProject(\"old_name\");","146","        view.add(job);","147","","148","        assertTrue(view.contains(job));","149","        assertTrue(view.jobNamesContains(job));","150","","151","        job.renameTo(\"new_name\");","152","","153","        assertFalse(\"old job name is still contained: \" + view.jobNames, view.jobNames.contains(\"old_name\"));","154","        assertTrue(view.contains(job));","155","        assertTrue(view.jobNamesContains(job));","156","    }","157","","158","    @Test public void renameContainedJob() throws Exception {","159","        MockFolder folder = j.createFolder(\"folder\");","160","        ListView view = new ListView(\"view\", folder);","161","        folder.addView(view);","162","","163","        FreeStyleProject job = folder.createProject(FreeStyleProject.class, \"old_name\");","164","        view.add(job);","165","","166","        assertTrue(view.contains(job));","167","        assertTrue(view.jobNamesContains(job));","168","","169","        job.renameTo(\"new_name\");","170","","171","        assertFalse(\"old job name is still contained\", view.jobNames.contains(\"old_name\"));","172","        assertTrue(view.contains(job));","173","        assertTrue(view.jobNamesContains(job));","174","    }","175","","176","    @Bug(23893)","177","    @Test public void deleteJobContainedInTopLevelView() throws Exception {","178","        ListView view = new ListView(\"view\", j.jenkins);","179","        j.jenkins.addView(view);","180","        FreeStyleProject job = j.createFreeStyleProject(\"project\");","181","        view.add(job);","182","","183","        assertTrue(view.contains(job));","184","        assertTrue(view.jobNamesContains(job));","185","","186","        job.delete();","187","","188","        assertFalse(view.contains(job));","189","        assertFalse(view.jobNamesContains(job));","190","    }","191","","192","    @Test public void deleteContainedJob() throws Exception {","193","        MockFolder folder = j.createFolder(\"folder\");","194","        ListView view = new ListView(\"view\", folder);","195","        folder.addView(view);","196","        FreeStyleProject job = folder.createProject(FreeStyleProject.class, \"project\");","197","        view.add(job);","198","","199","        assertTrue(view.contains(job));","200","        assertTrue(view.jobNamesContains(job));","201","","202","        job.delete();","203","","204","        assertFalse(view.contains(job));","205","        assertFalse(view.jobNamesContains(job));","206","    }"],"delete":[]}]}},"57fced93596b1f8bd69f00f154430a11530393de":{"changes":{"core\/src\/main\/resources\/lib\/layout\/breadcrumbs.js":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/layout\/breadcrumbs.js":[{"add":["63","            if (cfg.post) {","64","                crumb.appendToForm(form);","65","            }"],"delete":[]}]}},"fa4ec0a0e3665987df4aace51a9b5f76aef0375a":{"changes":{"test\/src\/test\/java\/jenkins\/security\/ResourceDomainTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/security\/ResourceDomainRootAction.java":"MODIFY"},"diff":{"test\/src\/test\/java\/jenkins\/security\/ResourceDomainTest.java":[{"add":["5","import hudson.FilePath;","9","import hudson.model.UnprotectedRootAction;","21","import org.jvnet.hudson.test.TestExtension;","22","import org.kohsuke.stapler.HttpResponse;","24","import javax.annotation.CheckForNull;","26","import java.time.Instant;","287","","288","    @Test","289","    public void testRedirectUrls() throws Exception {","290","        ResourceDomainRootAction rootAction = ResourceDomainRootAction.get();","291","        String url = rootAction.getRedirectUrl(new ResourceDomainRootAction.Token(\"foo\", \"bar\", Instant.now()), \"foo bar baz\");","292","        Assert.assertFalse(\"urlencoded\", url.contains(\" \"));","293","    }","294","","295","    @Test","296","    @Issue(\"JENKINS-59849\")","297","    public void testUrlEncoding() throws Exception {","298","        FreeStyleProject project = j.createFreeStyleProject();","299","        project.getBuildersList().add(new CreateFileBuilder(\"This has spaces and is 100% evil.html\", \"<html><body>the content<\/body><\/html>\"));","300","        project.save();","301","","302","        j.buildAndAssertSuccess(project);","303","","304","        JenkinsRule.WebClient webClient = j.createWebClient();","305","        webClient.setThrowExceptionOnFailingStatusCode(false);","306","        webClient.setRedirectEnabled(true);","307","","308","        HtmlPage page = webClient.getPage(project, \"ws\/This%20has%20spaces%20and%20is%20100%25%20evil.html\");","309","        Assert.assertEquals(\"page is found\", 200, page.getWebResponse().getStatusCode());","310","        Assert.assertTrue(\"page content is as expected\", page.getWebResponse().getContentAsString().contains(\"the content\"));","311","","312","        URL url = page.getUrl();","313","        Assert.assertTrue(\"page is served by resource domain\", url.toString().contains(\"\/static-files\/\"));","314","    }","315","","316","    @Test","317","    @Issue(\"JENKINS-59849\")","318","    public void testMoreUrlEncoding() throws Exception {","319","        JenkinsRule.WebClient webClient = j.createWebClient();","320","        webClient.setThrowExceptionOnFailingStatusCode(false);","321","        webClient.setRedirectEnabled(true);","322","","323","        Page page = webClient.goTo(\"100%25%20evil\/%20100%25%20evil%20content%20.html\");","324","        Assert.assertEquals(\"page is found\", 200, page.getWebResponse().getStatusCode());","325","        Assert.assertTrue(\"page content is as expected\", page.getWebResponse().getContentAsString().contains(\"this is the content\"));","326","","327","        URL url = page.getUrl();","328","        Assert.assertTrue(\"page is served by resource domain\", url.toString().contains(\"\/static-files\/\"));","329","    }","330","","331","    @TestExtension","332","    public static class RootActionImpl implements UnprotectedRootAction {","333","","334","        @CheckForNull","335","        @Override","336","        public String getIconFileName() {","337","            return null;","338","        }","339","","340","        @CheckForNull","341","        @Override","342","        public String getDisplayName() {","343","            return null;","344","        }","345","","346","        @CheckForNull","347","        @Override","348","        public String getUrlName() {","349","            return \"100% evil\";","350","        }","351","","352","        public HttpResponse doDynamic() throws Exception {","353","            Jenkins jenkins = Jenkins.get();","354","            FilePath tempDir = jenkins.getRootPath().createTempDir(\"root\", \"tmp\");","355","            tempDir.child(\" 100% evil content .html\").write(\"this is the content\", \"UTF-8\");","356","            return new DirectoryBrowserSupport(jenkins, tempDir, \"title\", \"\", false);","357","        }","358","    }"],"delete":[]}],"core\/src\/main\/java\/jenkins\/security\/ResourceDomainRootAction.java":[{"add":["25","import com.google.common.annotations.VisibleForTesting;","54","import java.util.stream.Collectors;","151","        return resourceRootUrl + getUrlName() + \"\/\" + token.encode() + Arrays.stream(restOfPath.split(\"[\/]\")).map(Util::rawEncode).collect(Collectors.joining(\"\/\"));","169","        final String dbsFile = req.getOriginalRestOfPath();","226","                    String path = requestUrlSuffix + Arrays.stream(restOfPath.split(\"[\/]\")).map(Util::rawEncode).collect(Collectors.joining(\"\/\"));","227","                    Stapler.getCurrent().invoke(req, rsp, Jenkins.get(), path);","268","","269","        @VisibleForTesting","270","        Token (String path, @Nullable String username, Instant timestamp) {","285","                byte[] byteValue = Base64.getUrlDecoder().decode(value);"],"delete":["149","        return resourceRootUrl + getUrlName() + \"\/\" + token.encode() + restOfPath;","167","        final String dbsFile = req.getRestOfPath();","224","                    Stapler.getCurrent().invoke(req, rsp, Jenkins.get(), requestUrlSuffix + restOfPath);","265","        private Token (String path, @Nullable String username, Instant timestamp) {","279","            byte[] byteValue = Base64.getUrlDecoder().decode(value);"]}]}},"9379d1fefc49fbe8cf11bb96290a9924a6eb38cc":{"changes":{"core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["509","            for (Executor e : c.getOneOffExecutors()) {","510","                if(e.getCurrentExecutable()==this) {","511","                    return e;","512","                }","513","            }"],"delete":[]}]}},"e80fd6148f6472dd4f7bda35b8fd4b22399ffe79":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["438","                FilePath rootPath = n.getRootPath();","439","                if (rootPath == null) {","440","                    throw new AbortException(n.getDisplayName() + \" seems to be offline\");","441","                }","443","                return Lease.createDummyLease(rootPath.child(getEnvironment(listener).expand(customWorkspace)));","446","            FilePath ws = n.getWorkspaceFor((TopLevelItem) getProject());","447","            if (ws == null) {","448","                throw new AbortException(n.getDisplayName() + \" seems to be offline\");","449","            }","450","            return wsl.allocate(ws, getBuild());"],"delete":["439","                return Lease.createDummyLease(n.getRootPath().child(getEnvironment(listener).expand(customWorkspace)));","442","            return wsl.allocate(n.getWorkspaceFor((TopLevelItem)getProject()), getBuild());"]}]}},"c1d2c945465d30efb63de7abce51d95289170e63":{"changes":{"war\/src\/main\/webapp\/WEB-INF\/web.xml":"MODIFY"},"diff":{"war\/src\/main\/webapp\/WEB-INF\/web.xml":[{"add":["196","  <mime-mapping>","197","    <extension>webm<\/extension>","198","    <mime-type>video\/webm<\/mime-type>","199","  <\/mime-mapping>"],"delete":[]}]}},"eb7a23f9b6b6c74d99676a70d0eda1fe5a003cdb":{"changes":{"core\/src\/main\/java\/hudson\/ExtensionComponent.java":"MODIFY","changelog.html":"MODIFY","ui-samples-plugin\/src\/main\/java\/jenkins\/plugins\/ui_samples\/DropdownList.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/ExtensionComponent.java":[{"add":["28","import java.util.logging.Level;","29","import java.util.logging.Logger;","42","    private static final Logger LOG = Logger.getLogger(ExtensionComponent.class.getName());","95","            try {","96","                return Util.fixNull(((Descriptor)this.instance).getDisplayName()).compareTo(Util.fixNull(((Descriptor)that.instance).getDisplayName()));","97","            } catch (RuntimeException x) {","98","                LOG.log(Level.WARNING, null, x);","99","            } catch (LinkageError x) {","100","                LOG.log(Level.WARNING, null, x);","101","            }","103","        return this.instance.getClass().getName().compareTo(that.instance.getClass().getName());"],"delete":["92","            return Util.fixNull(((Descriptor)this.instance).getDisplayName()).compareTo(Util.fixNull(((Descriptor)that.instance).getDisplayName()));","93","        } else {","94","            return this.instance.getClass().getName().compareTo(that.instance.getClass().getName());"]}],"changelog.html":[{"add":["68","  <li class=bug>","69","    <code>hpi:run<\/code> failed due to <code>IllegalAccessError<\/code>s.","70","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-14983\">issue 14983<\/a>)"],"delete":["68","  <li class=>"]}],"ui-samples-plugin\/src\/main\/java\/jenkins\/plugins\/ui_samples\/DropdownList.java":[{"add":["57","    public static abstract class Fruit implements ExtensionPoint, Describable<Fruit> {","59","        protected Fruit(String name) { this.name = name; }"],"delete":["57","    public static class Fruit implements ExtensionPoint, Describable<Fruit> {","59","        private Fruit(String name) { this.name = name; }"]}]}},"9f53cf3dbed5b5c86d448372c0cd27266ae75ca8":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["369","            Result r = null;","397","                                return (r = Result.FAILURE);","477","                            r = process.call(builder);","478","                            return r;","485","                        if (r != null) {","486","                            setResult(r);","487","                        }","500","                return r;"],"delete":["396","                                return Result.FAILURE;","476","                            return process.call(builder);","495","                return null;"]}]}},"2c4516dcf2db59727eec9180886fa39cc9f78a1a":{"changes":{"core\/src\/main\/java\/hudson\/Util.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Util.java":[{"add":["304","        try {","305","            deleteFile(dir);","306","        } catch (IOException e) {","307","            \/\/ if some of the child directories are big, it might take long enough to delete that","308","            \/\/ it allows others to create new files, causing problemsl ike JENKINS-10113","309","            \/\/ so give it one more attempt before we give up.","310","            if(!isSymlink(dir))","311","                deleteContentsRecursive(dir);","312","            deleteFile(dir);","313","        }"],"delete":["304","        deleteFile(dir);"]}]}},"dae53088b71d78346d235b8c3bb783c583dd4d52":{"changes":{"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":"MODIFY","core\/src\/main\/resources\/jenkins\/model\/Jenkins\/_scriptText.jelly":"MODIFY","core\/src\/main\/resources\/lib\/layout\/view.jelly":"MODIFY"},"diff":{"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":[{"add":["40","import com.gargoylesoftware.htmlunit.TextPage;","332","    @Issue(\"JENKINS-58548\")","333","    public void testDoScriptTextDoesNotOutputExtraWhitespace() throws Exception {","334","        j.jenkins.setSecurityRealm(j.createDummySecurityRealm());","335","        WebClient wc = j.createWebClient().login(\"admin\");","336","        TextPage page = wc.getPage(new WebRequest(wc.createCrumbedUrl(\"scriptText?script=print 'hello'\"), HttpMethod.POST));","337","        assertEquals(\"hello\", page.getContent());","338","    }","339","","340","    @Test"],"delete":[]}],"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/_scriptText.jelly":[{"add":["28","<j:jelly xmlns:j=\"jelly:core\" xmlns:l=\"\/lib\/layout\">","32","<\/j:jelly>"],"delete":["28","<st:compress xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:l=\"\/lib\/layout\">","32","<\/st:compress>"]}],"core\/src\/main\/resources\/lib\/layout\/view.jelly":[{"add":["37","    <!-- JENKINS-58548: avoid using a JEXL expression here as it outputs untrimmed whitespace -->","38","    <j:invoke on=\"${h}\" method=\"initPageVariables\">","39","        <j:arg value=\"${context}\"\/>","40","    <\/j:invoke>"],"delete":["37","    ${h.initPageVariables(context)}"]}]}},"7110ddb7d2a2f141a6887ffe352526db91046867":{"changes":{"core\/src\/main\/java\/hudson\/cli\/CLICommand.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/cli\/CLICommand.java":[{"add":["474","        Jenkins j = Jenkins.getInstance();","475","        if (j!=null) {\/\/ only when running on the master","476","            cls.put(j.getPluginManager().uberClassLoader);","478","            ResourceNameIterator servicesIter =","479","                new DiscoverServiceNames(cls).findResourceNames(OptionHandler.class.getName());","480","            final ResourceClassIterator itr =","481","                new DiscoverClasses(cls).findResourceClasses(servicesIter);","483","            while(itr.hasNext()) {","484","                Class h = itr.nextResourceClass().loadClass();","485","                Class c = Types.erasure(Types.getTypeArgument(Types.getBaseClass(h, OptionHandler.class), 0));","486","                CmdLineParser.registerHandler(c,h);","487","            }"],"delete":["474","        cls.put(Jenkins.getInstance().getPluginManager().uberClassLoader);","476","        ResourceNameIterator servicesIter =","477","            new DiscoverServiceNames(cls).findResourceNames(OptionHandler.class.getName());","478","        final ResourceClassIterator itr =","479","            new DiscoverClasses(cls).findResourceClasses(servicesIter);","481","        while(itr.hasNext()) {","482","            Class h = itr.nextResourceClass().loadClass();","483","            Class c = Types.erasure(Types.getTypeArgument(Types.getBaseClass(h, OptionHandler.class), 0));","484","            CmdLineParser.registerHandler(c,h);"]}]}},"fad3f7db48e4184221469fbbb0edc2163e26ac0f":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["481","      <version>1.20<\/version>"],"delete":["481","      <version>1.19<\/version>"]}],"changelog.html":[{"add":["57","  <li class=rfe>","58","    Jenkins can now kill Win32 processes from Win64 JVMs.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-23410\">issue 23410<\/a>)"],"delete":[]}]}},"0b8febbdc3a927839a7505fa361dc8e38cafc635":{"changes":{"test\/src\/test\/java\/hudson\/tasks\/MavenTest.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/tasks\/MavenTest.java":[{"add":["224","        \/\/ This test implements legacy behavior, when Build Variables are injected by default","225","        project.getBuildersList().add(new Maven(\"--help\", null, null, properties, null,","226","                false, null, null, true));"],"delete":["224","        project.getBuildersList().add(new Maven(\"--help\",null,null,properties,null));"]}]}},"27d1a03866e468d2d9b630f636e53ec7804e4ade":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["201","      <version>1.4<\/version>"],"delete":["201","      <version>1.3<\/version>"]}],"changelog.html":[{"add":["61","    Fixed a bug in the compatibility transformer (since 1.527) that causes <tt>VerifyError<\/\/t> in Ivy plugin and possibly others.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-19383\">issue 19383<\/a>)","63","  <li class=bug>"],"delete":[]}]}},"a5d848bcec45100ca4f12303a8c619664f2eb945":{"changes":{"core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/lazy\/LazyBuildMixIn.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["1447","    public void delete() throws IOException {","1452","        ","1453","        RunListener.fireDeleted(this);","1454","","1455","        synchronized (this) { \/\/ avoid holding a lock while calling plugin impls of onDeleted","1456","        \/\/ if we have a symlink, delete it, too","1457","        File link = new File(project.getBuildDir(), String.valueOf(getNumber()));","1458","        link.delete();","1459","","1478","        }"],"delete":["1447","    public synchronized void delete() throws IOException {","1448","        RunListener.fireDeleted(this);","1449","","1450","        \/\/ if we have a symlink, delete it, too","1451","        File link = new File(project.getBuildDir(), String.valueOf(getNumber()));","1452","        link.delete();","1453",""]}],"changelog.html":[{"add":["60","  <li class='major bug'>","61","    Deadlocks in concurrent builds under some conditions since 1.556.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22560\">issue 22560<\/a>)"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["157","    private transient final LazyBuildMixIn.RunMixIn<P,R> runMixIn = new LazyBuildMixIn.RunMixIn<P,R>() {","158","        @Override protected R asRun() {","159","            return _this();","160","        }","161","    };","179","    @Override public final LazyBuildMixIn.RunMixIn<P,R> getRunMixIn() {"],"delete":["73","import java.text.MessageFormat;","158","    private transient LazyBuildMixIn.RunMixIn<P,R> runMixIn;","176","    @Override public final synchronized LazyBuildMixIn.RunMixIn<P,R> getRunMixIn() {","177","        if (runMixIn == null) {","178","            runMixIn = new LazyBuildMixIn.RunMixIn<P,R>() {","179","                @Override protected R asRun() {","180","                    return _this();","181","                }","182","            };","183","        }"]}],"core\/src\/main\/java\/jenkins\/model\/lazy\/LazyBuildMixIn.java":[{"add":["282","     * Stateful but should be held in a {@code transient final} field."],"delete":["282","     * Stateful but should be held in a {@code transient} field."]}]}},"6d921a9557fd0f34539ee807fc1352509499f95c":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenSiteArchiver.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenSiteArchiver.java":[{"add":["103","        final String moduleRoot;","105","            moduleRoot = build.execute(new BuildCallable<String, IOException>() {","107","                public String call(MavenBuild mavenBuild) throws IOException, InterruptedException {","108","                    return mavenBuild.getParentBuild().getModuleRoot().getRemote();","115","        final File remoteWorkspaceDir = new File(moduleRoot);"],"delete":["103","        final FilePath moduleRoot;","105","            moduleRoot = build.execute(new BuildCallable<FilePath, IOException>() {","107","                public FilePath call(MavenBuild mavenBuild) throws IOException, InterruptedException {","108","                    return mavenBuild.getParentBuild().getModuleRoot();","115","        final File remoteWorkspaceDir = new File(moduleRoot.getRemote());"]}]}},"1ab11ea121749d41416ac4d0a27ace9f479c886e":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["121","      <version>build-217-jenkins-14<\/version>"],"delete":["121","      <version>build-217-jenkins-11<\/version>"]}]}},"0d955259d8880e02452f23e422e5272e6ab26153":{"changes":{"core\/src\/main\/java\/hudson\/security\/GlobalMatrixAuthorizationStrategy.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/security\/GlobalMatrixAuthorizationStrategy.java":[{"add":["302","                try {","303","                    sr.loadUserByUsername(v);","304","                    return FormValidation.respond(Kind.OK, makeImg(\"person.png\")+ev);","305","                } catch (UserMayOrMayNotExistException e) {","306","                    \/\/ undecidable, meaning the user may exist","307","                    return FormValidation.respond(Kind.OK, ev);","308","                } catch (UsernameNotFoundException e) {","309","                    \/\/ fall through next","310","                } catch (DataAccessException e) {","311","                    \/\/ fall through next","312","                } catch (AuthenticationException e) {","313","                    \/\/ other seemingly unexpected error.","314","                    return FormValidation.error(e,\"Failed to test the validity of the user name \"+v);","315","                }","317","                try {","318","                    sr.loadGroupByGroupname(v);","319","                    return FormValidation.respond(Kind.OK, makeImg(\"user.png\") +ev);","320","                } catch (UserMayOrMayNotExistException e) {","321","                    \/\/ undecidable, meaning the group may exist","322","                    return FormValidation.respond(Kind.OK, ev);","323","                } catch (UsernameNotFoundException e) {","324","                    \/\/ fall through next","325","                } catch (DataAccessException e) {","326","                    \/\/ fall through next","327","                } catch (AuthenticationException e) {","328","                    \/\/ other seemingly unexpected error.","329","                    return FormValidation.error(e,\"Failed to test the validity of the group name \"+v);","330","                }","332","                \/\/ couldn't find it. it doesn't exist","333","                return FormValidation.respond(Kind.ERROR, makeImg(\"error.png\") +ev);","334","            } catch (Exception e) {","335","                \/\/ if the check fails miserably, we still want the user to be able to see the name of the user,","336","                \/\/ so use 'ev' as the message","337","                return FormValidation.error(e,ev);","338","            }"],"delete":["302","                sr.loadUserByUsername(v);","303","                return FormValidation.respond(Kind.OK, makeImg(\"person.png\")+ev);","304","            } catch (UserMayOrMayNotExistException e) {","305","                \/\/ undecidable, meaning the user may exist","306","                return FormValidation.respond(Kind.OK, ev);","307","            } catch (UsernameNotFoundException e) {","308","                \/\/ fall through next","309","            } catch (DataAccessException e) {","310","                \/\/ fall through next","311","            } catch (AuthenticationException e) {","312","                \/\/ other seemingly unexpected error.","313","                return FormValidation.error(e,\"Failed to test the validity of the user name \"+v);","314","            }","316","            try {","317","                sr.loadGroupByGroupname(v);","318","                return FormValidation.respond(Kind.OK, makeImg(\"user.png\") +ev);","319","            } catch (UserMayOrMayNotExistException e) {","320","                \/\/ undecidable, meaning the group may exist","321","                return FormValidation.respond(Kind.OK, ev);","322","            } catch (UsernameNotFoundException e) {","323","                \/\/ fall through next","324","            } catch (DataAccessException e) {","325","                \/\/ fall through next","326","            } catch (AuthenticationException e) {","327","                \/\/ other seemingly unexpected error.","328","                return FormValidation.error(e,\"Failed to test the validity of the group name \"+v);","329","            }","331","            \/\/ couldn't find it. it doesn't exist","332","            return FormValidation.respond(Kind.ERROR, makeImg(\"error.png\") +ev);"]}],"changelog.html":[{"add":["58","    Failure to check the username\/groupname in the matrix security shouldn't hide the user name","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9519\">issue 9519<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"c718516adfddeb10cbf616ce37c619cc6bbafd53":{"changes":{"pom.xml":"MODIFY"},"diff":{"pom.xml":[{"add":["181","        <version>2.60<\/version>"],"delete":["181","        <version>2.59<\/version>"]}]}},"d735f5e03bee81ee4eef94c2b3f8de9fe1196057":{"changes":{"src\/findbugs\/findbugs-excludes.xml":"MODIFY"},"diff":{"src\/findbugs\/findbugs-excludes.xml":[{"add":[],"delete":["14","","15","  <!-- exclude medium and low priorities -->","16","  <!--TODO: Cleanup code and remove filtering of medium-priority issues-->","17","  <Match>","18","    <Priority value=\"2\"\/>","19","  <\/Match>","20","  <Match>","21","    <Priority value=\"3\"\/>","22","  <\/Match>"]}]}},"a5febd7666fd78542d45428505cc62c067315c43":{"changes":{"core\/src\/main\/java\/hudson\/util\/PluginServletFilter.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/PluginServletFilter.java":[{"add":["27","import java.util.ArrayList;","151","            \/\/ While we could rely on the current implementation of list being a CopyOnWriteArrayList","152","            \/\/ safer to just take an explicit copy of the list and operate on the copy","153","            for (Filter f: new ArrayList<>(instance.list)) {","154","                instance.list.remove(f);","155","                \/\/ remove from the list even if destroy() fails as a failed destroy is still a destroy","159","                    LOGGER.log(Level.WARNING, \"Filter \" + f + \" propagated an exception from its destroy method\",","160","                            e);","166","            }","167","            \/\/ if some fool adds a filter while we are terminating, we should just log the fact","168","            if (!instance.list.isEmpty()) {","169","                LOGGER.log(Level.SEVERE, \"The following filters appear to have been added during clean up: {0}\",","170","                        instance.list);"],"delete":["150","            for (Iterator<Filter> iterator = instance.list.iterator(); iterator.hasNext(); ) {","151","                Filter f = iterator.next();","155","                    LOGGER.log(Level.WARNING, \"Filter \" + f + \" propagated an exception from its destroy method\", e);","161","                iterator.remove();"]}]}},"79f9896ec4e3bf2b84d2e945ecaf46a00781301d":{"changes":{"core\/src\/main\/resources\/hudson\/model\/View\/newJob.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/View\/newJob.jelly":[{"add":["24","          <input type=\"radio\" name=\"mode\" value=\"copyJob\" onchange=\"$('ok').disabled=false\" \/>"],"delete":["24","          <input type=\"radio\" name=\"mode\" value=\"copyJob\" \/>"]}]}},"3dbf30f8ef2f9aa789d44a8f206ade35aebbeaf7":{"changes":{"\/dev\/null":"DELETE"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}]}},"1d5dbd8a035d497d7c4794a68d767f2c1527f600":{"changes":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":[{"add":["113","            if (marker.exists() && marker.readToString().equals(id)) {","115","            }","116","            expectedLocation.deleteRecursive();","131","            marker.write(id, null);"],"delete":["113","            if(marker.exists())","129","            marker.touch(System.currentTimeMillis());"]}]}},"7bf6c5ca6e09ce2add22e0685db63da658b5fe17":{"changes":{"core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["242","    protected static final ThreadLocal<SimpleDateFormat> ID_FORMATTER = new IDFormatterProvider();","243","    private static final class IDFormatterProvider extends ThreadLocal<SimpleDateFormat> {"],"delete":["242","    protected static final ThreadLocal<SimpleDateFormat> ID_FORMATTER =","243","            new ThreadLocal<SimpleDateFormat>() {"]}]}},"941559c98cfe0d046ac432e2bc86d5219d1b4043":{"changes":{"test\/src\/test\/java\/hudson\/console\/ConsoleAnnotatorTest.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/UnbufferedBase64InputStream.java":"MODIFY","core\/src\/main\/java\/hudson\/console\/PlainTextConsoleOutputStream.java":"ADD","core\/src\/main\/java\/hudson\/console\/ConsoleNote.java":"MODIFY","core\/src\/main\/java\/hudson\/console\/AnnotatedLargeText.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/console\/ConsoleAnnotatorTest.java":[{"add":["92","    @Bug(6034)","93","    public void testConsoleAnnotationFilterOut() throws Exception {","94","        FreeStyleProject p = createFreeStyleProject();","95","        p.getBuildersList().add(new TestBuilder() {","96","            public boolean perform(AbstractBuild<?, ?> build, Launcher launcher, BuildListener listener) throws InterruptedException, IOException {","97","                listener.getLogger().print(\"abc\\n\");","98","                listener.getLogger().print(HyperlinkNote.encodeTo(\"http:\/\/infradna.com\/\",\"def\")+\"\\n\");","99","                return true;","100","            }","101","        });","103","        FreeStyleBuild b = buildAndAssertSuccess(p);","104","","105","        \/\/ make sure we see the annotation","106","        HtmlPage rsp = createWebClient().getPage(b, \"console\");","107","        assertEquals(1,rsp.selectNodes(\"\/\/A[@href='http:\/\/infradna.com\/']\").size());","108","","109","        \/\/ make sure raw console output doesn't include the garbage","110","        TextPage raw = (TextPage)createWebClient().goTo(b.getUrl()+\"consoleText\",\"text\/plain\");","111","        System.out.println(raw.getContent());","112","        assertTrue(raw.getContent().contains(\"\\nabc\\ndef\\n\"));","113","    }"],"delete":[]}],"core\/src\/main\/java\/hudson\/util\/UnbufferedBase64InputStream.java":[{"add":["58","","59","    @Override","60","    public long skip(long n) throws IOException {","61","        long r=0;","62","        while (n>0) {","63","            int ch = read();","64","            if (ch<0)   break;","65","            n--; r++;","66","        }","67","        return r;","68","    }"],"delete":[]}],"core\/src\/main\/java\/hudson\/console\/PlainTextConsoleOutputStream.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/console\/ConsoleNote.java":[{"add":["32","import hudson.util.IOUtils;","225","    \/**","226","     * Skips the encoded console note.","227","     *\/","228","    public static void skip(DataInputStream in) throws IOException {","229","        byte[] preamble = new byte[PREAMBLE.length];","230","        in.readFully(preamble);","231","        if (!Arrays.equals(preamble,PREAMBLE))","232","            return;    \/\/ not a valid preamble","233","","234","        DataInputStream decoded = new DataInputStream(new UnbufferedBase64InputStream(in));","235","        int sz = decoded.readInt();","236","        IOUtils.skip(decoded,sz);","237","","238","        byte[] postamble = new byte[POSTAMBLE.length];","239","        in.readFully(postamble);","240","    }","241",""],"delete":[]}],"core\/src\/main\/java\/hudson\/console\/AnnotatedLargeText.java":[{"add":["46","import java.io.OutputStream;","47","import java.io.OutputStreamWriter;","146","    @Override","147","    public long writeLogTo(long start, OutputStream out) throws IOException {","148","        return super.writeLogTo(start, new PlainTextConsoleOutputStream(out));","149","    }","150",""],"delete":[]}]}},"2f59ffc475dc73a9a9cd5a7596819f3242c22f6f":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":[{"add":["296","            this.record = compact(record);","307","            record = compact(r);","341","            record = compact(record);","348","        \/** Share data structure with other builds, mainly those of the same job. *\/","349","        private PackedMap<String,String> compact(Map<String,String> record) {","350","            Map<String,String> b = new HashMap<String,String>();","352","                b.put(e.getKey().intern(), e.getValue().intern());","354","            return PackedMap.of(b);"],"delete":["296","            this.record = PackedMap.of(record);","297","            compact();","308","            record = PackedMap.of(r);","310","            compact();","343","            compact();","350","        private void compact() {","351","            \/\/ share data structure with nearby builds, but to keep lazy loading efficient,","352","            \/\/ don't go back the history forever.","353","            if (rand.nextInt(2)!=0) {","354","                Run pb = build.getPreviousBuild();","355","                if (pb!=null) {","356","                    FingerprintAction a = pb.getAction(FingerprintAction.class);","357","                    if (a!=null)","358","                        compact(a);","359","                }","360","            }","361","        }","362","","363","        \/**","364","         * Reuse string instances from another {@link FingerprintAction} to reduce memory footprint.","365","         *\/","366","        protected void compact(FingerprintAction a) {","367","            Map<String,String> intern = new HashMap<String, String>(); \/\/ string intern map","368","            for (Entry<String, String> e : a.record.entrySet()) {","369","                intern.put(e.getKey(),e.getKey());","370","                intern.put(e.getValue(),e.getValue());","371","            }","372","","373","            Map<String,String> b = new HashMap<String, String>();","375","                String k = intern.get(e.getKey());","376","                if (k==null)    k = e.getKey();","377","","378","                String v = intern.get(e.getValue());","379","                if (v==null)    v = e.getValue();","380","","381","                b.put(k,v);","383","","384","            record = PackedMap.of(b);"]}],"changelog.html":[{"add":["58","    Fingerprint compaction aggravated lazy-loading performance issues.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-19392\">issue 19392<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"dc94b7d0633c0a6e5375bdf1bec2b9dede461da3":{"changes":{"core\/src\/main\/java\/hudson\/Util.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/StreamCopyThread.java":"MODIFY","core\/src\/main\/java\/hudson\/Proc.java":"MODIFY","cli\/src\/main\/java\/hudson\/cli\/CLI.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/io\/ZipArchiver.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Util.java":[{"add":["453","        while((len=in.read(buf))>=0)","564","                while(in.read(buffer)>=0)"],"delete":["453","        while((len=in.read(buf))>0)","564","                while(in.read(buffer)>0)"]}],"core\/src\/main\/java\/hudson\/util\/StreamCopyThread.java":[{"add":["59","                while ((len = in.read(buf)) >= 0)"],"delete":["59","                while ((len = in.read(buf)) > 0)"]}],"core\/src\/main\/java\/hudson\/Proc.java":[{"add":["401","                        while ((len = in.read(buf)) >= 0) {"],"delete":["401","                        while ((len = in.read(buf)) > 0) {"]}],"cli\/src\/main\/java\/hudson\/cli\/CLI.java":[{"add":["302","            while (is.read(buf) >= 0) {","309","                while (es.read(buf) >= 0) {"],"delete":["302","            while (is.read(buf) > 0) {","309","                while (es.read(buf) > 0) {"]}],"core\/src\/main\/java\/hudson\/util\/io\/ZipArchiver.java":[{"add":["73","            while((len=in.read(buf))>=0)"],"delete":["73","            while((len=in.read(buf))>0)"]}]}},"16143d03259372fabc3121d9e00e9bd91f6fca7d":{"changes":{"core\/src\/main\/java\/hudson\/lifecycle\/UnixLifecycle.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/lifecycle\/UnixLifecycle.java":[{"add":["81","        String exe = args.get(0);"],"delete":["81","        String exe = Daemon.getCurrentExecutable();"]}]}},"4278804582b34f123414bde521bd91b009d8e353":{"changes":{"core\/src\/main\/java\/hudson\/triggers\/Trigger.java":"MODIFY","test\/src\/test\/java\/hudson\/triggers\/TriggerTest.java":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/triggers\/Trigger.java":[{"add":["92","            if (spec != null) {","93","                this.tabs = CronTabList.create(spec, Hash.from(project.getFullName()));","94","            } else {","95","                LOGGER.log(Level.WARNING, \"The job {0} has a null crontab spec which is incorrect\", job.getFullName());","96","            }","287","                        LOGGER.log(Level.WARNING, \"The job {0} has a syntactically incorrect config and is missing the cron spec for a trigger\", p.getFullName());"],"delete":["92","            this.tabs = CronTabList.create(spec, Hash.from(project.getFullName()));","283","                            LOGGER.log(Level.WARNING, \"The job {0} has a syntactically incorrect config and is missing the cron spec for a trigger\", p.getFullName());"]}],"test\/src\/test\/java\/hudson\/triggers\/TriggerTest.java":[{"add":[],"delete":[]}]}},"6d904f5c195fe63e340afd19d18579a321fd5d5b":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":"MODIFY"},"diff":{"changelog.html":[{"add":["68","    If artifact archiving failed with an I\/O error, the build nonetheless was considered to be a success.","69","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-2058\">issue 2058<\/a>)","70","  <li class=bug>"],"delete":[]}],"core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":[{"add":["138","            build.setResult(Result.FAILURE);"],"delete":[]}]}},"921359c1257a3e30aa46e491c2c00817b838e52c":{"changes":{"core\/src\/main\/java\/hudson\/scheduler\/BaseParser.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scheduler\/BaseParser.java":[{"add":["38","    private static final int[] LOWER_BOUNDS = new int[] {0,0,1,1,0};"],"delete":["38","    private static final int[] LOWER_BOUNDS = new int[] {0,0,1,0,0};"]}],"changelog.html":[{"add":["61","  <li class=bug>","62","    month should not be 0.","63","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-12356\">issue 12356<\/a>)"],"delete":[]}]}},"46aa755267010c8dffb85c8c7a42079340cd2731":{"changes":{"maven-agent\/pom.xml":"MODIFY","test\/pom.xml":"MODIFY","remoting\/pom.xml":"MODIFY","test\/src\/test\/java\/hudson\/util\/FormFieldValidatorTest.java":"MODIFY","debian\/changelog":"MODIFY","war\/resources\/scripts\/hudson-behavior.js":"MODIFY","core\/pom.xml":"MODIFY","test\/src\/test\/resources\/hudson\/util\/FormFieldValidatorTest\/BrokenFormValidatorBuilder\/config.jelly":"ADD","maven-interceptor\/pom.xml":"MODIFY","pom.xml":"MODIFY","war\/pom.xml":"MODIFY","core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":"MODIFY"},"diff":{"maven-agent\/pom.xml":[{"add":["29","    <version>1.295-SNAPSHOT<\/version>"],"delete":["29","    <version>1.294-SNAPSHOT<\/version>"]}],"test\/pom.xml":[{"add":["29","    <version>1.295-SNAPSHOT<\/version>"],"delete":["29","    <version>1.294-SNAPSHOT<\/version>"]}],"remoting\/pom.xml":[{"add":["29","    <version>1.295-SNAPSHOT<\/version>"],"delete":["29","    <version>1.294-SNAPSHOT<\/version>"]}],"test\/src\/test\/java\/hudson\/util\/FormFieldValidatorTest.java":[{"add":["26","import hudson.tasks.Builder;","27","import hudson.tasks.BuildStepDescriptor;","28","import hudson.tasks.Publisher;","29","import hudson.util.FormFieldValidatorTest.BrokenFormValidatorBuilder.DescriptorImpl;","44","","45","    public static class BrokenFormValidatorBuilder extends Builder {","46","        public static final class DescriptorImpl extends BuildStepDescriptor {","47","            public boolean isApplicable(Class jobType) {","48","                return true;","49","            }","50","","51","            public void doCheckXyz() {","52","                throw new Error(\"doCheckXyz is broken\");","53","            }","54","","55","            public String getDisplayName() {","56","                return \"I have broken form field validation\";","57","            }","58","        }","59","    }","60","","61","    \/**","62","     * Make sure that the validation methods are really called by testing a negative case.","63","     *\/","64","    @Bug(3382)","65","    public void testNegative() throws Exception {","66","        DescriptorImpl d = new DescriptorImpl();","67","        Publisher.all().add(d);","68","        try {","69","            FreeStyleProject p = createFreeStyleProject();","70","            new WebClient().getPage(p,\"configure\");","71","            fail(\"should have failed\");","72","        } catch(AssertionError e) {","73","            if(e.getMessage().contains(\"doCheckXyz is broken\"))","74","                ; \/\/ expected","75","            else","76","                throw e;","77","        } finally {","78","            Publisher.all().remove(d);","79","        }","80","    }","81",""],"delete":[]}],"debian\/changelog":[{"add":["0","hudson (1.294) unstable; urgency=low","1","","2","  * See http:\/\/hudson.dev.java.net\/changelog.html for more details.","3","","4"," -- Kohsuke Kawaguchi <kk@kohsuke.org>  Sat, 28 Mar 2009 14:43:37 -0700","5",""],"delete":[]}],"war\/resources\/scripts\/hudson-behavior.js":[{"add":["46","    \/\/ conceptually boolean, but doing so create concurrency problem.","47","    \/\/ that is, during unit tests, the AJAX.send works synchronously, so","48","    \/\/ the onComplete happens before the send method returns. On a real environment,","49","    \/\/ more likely it's the other way around. So setting a boolean flag to true or false","50","    \/\/ won't work.","51","    inProgress : 0,","80","        if (this.inProgress>0)  return;","88","                FormChecker.inProgress--;","92","        this.inProgress++;"],"delete":["46","    inProgress : false,","75","        if (this.inProgress)  return;","83","                FormChecker.inProgress = false;","87","        this.inProgress = true;"]}],"core\/pom.xml":[{"add":["29","    <version>1.295-SNAPSHOT<\/version>"],"delete":["29","    <version>1.294-SNAPSHOT<\/version>"]}],"test\/src\/test\/resources\/hudson\/util\/FormFieldValidatorTest\/BrokenFormValidatorBuilder\/config.jelly":[{"add":[],"delete":[]}],"maven-interceptor\/pom.xml":[{"add":["29","    <version>1.295-SNAPSHOT<\/version>"],"delete":["29","    <version>1.294-SNAPSHOT<\/version>"]}],"pom.xml":[{"add":["35","  <version>1.295-SNAPSHOT<\/version>"],"delete":["35","  <version>1.294-SNAPSHOT<\/version>"]}],"war\/pom.xml":[{"add":["29","    <version>1.295-SNAPSHOT<\/version>"],"delete":["29","    <version>1.294-SNAPSHOT<\/version>"]}],"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":[{"add":["1120","        public FormValidation doCvsPassCheck(@QueryParameter String value) {","1123","            if(!Hudson.getInstance().hasPermission(Hudson.ADMINISTER))"],"delete":["1120","        public FormValidation doCvsPassCheck(@AncestorInPath AbstractProject project, @QueryParameter String value) {","1123","            if(!project.hasPermission(Item.CONFIGURE))"]}]}},"03ca63c62c1f3e20f405b655bbc610ed21931a86":{"changes":{"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/RunLoadCounter.java":"ADD"},"diff":{"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/RunLoadCounter.java":[{"add":[],"delete":[]}]}},"3c877a40bc5657bc3d418302ac10fffa0ecd2f36":{"changes":{".github\/PULL_REQUEST_TEMPLATE.md":"MODIFY"},"diff":{".github\/PULL_REQUEST_TEMPLATE.md":[{"add":["0","<!-- Comment: ","1","A great PR typically begins with the line below.","2","Replace XXXXX with the numeric part of the issue's id you created on JIRA.","3","Please note that if you want your changes backported into LTS, you will need to create a JIRA ticket for it. Read https:\/\/jenkins.io\/download\/lts\/#backporting-process for more.","4","-->"],"delete":[]}]}},"ac03723ba5cb036d9cc02540a8c7d1ffd84c8403":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["202","      <version>1.8<\/version>","634","      <\/plugin>"],"delete":["202","      <version>1.7<\/version>","634","      <\/plugin>    "]}]}},"58a5d2249deb2abfa6e0c4e7854ac2fc2f3fc1b7":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["868","                scm = NullChangeLogParser.INSTANCE;                "],"delete":["129","     * Maybe null, for historical reason, in which case CVS is assumed.","599","                \/\/ for historical reasons, null in the scm field means CVS, so we need to explicitly set this to something","600","                \/\/ in case check out fails and leaves a broken changelog.xml behind.","601","                \/\/ see http:\/\/www.nabble.com\/CVSChangeLogSet.parse-yields-SAXParseExceptions-when-parsing-bad-*AccuRev*-changelog.xml-files-td22213663.html","872","                \/\/ for historical reason, null means CVS.","873","                try {","874","                    Class<?> c = Jenkins.getInstance().getPluginManager().uberClassLoader.loadClass(\"hudson.scm.CVSChangeLogParser\");","875","                    scm = (ChangeLogParser)c.newInstance();","876","                } catch (ClassNotFoundException e) {","877","                    \/\/ if CVS isn't available, fall back to something non-null.","878","                    scm = NullChangeLogParser.INSTANCE;","879","                } catch (InstantiationException e) {","880","                    scm = NullChangeLogParser.INSTANCE;","881","                    throw (Error)new InstantiationError().initCause(e);","882","                } catch (IllegalAccessException e) {","883","                    scm = NullChangeLogParser.INSTANCE;","884","                    throw (Error)new IllegalAccessError().initCause(e);","885","                }"]}]}},"a834807dc9988d37a8e3fc3f344f4f317fd756cf":{"changes":{"test\/pom.xml":"MODIFY"},"diff":{"test\/pom.xml":[{"add":["183","          <!-- Usually a dependency of ant, but some people seem to have an incomplete ant POM. See JENKINS-11416 -->"],"delete":[]}]}},"30712a19a15dbd3c4484065ebdd85c2b991f5d4c":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["74","  <li class=\"bug\">","75","    Retrieve tool installer metadata from all update sites.","76","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-32328\">issue 32328<\/a>)"],"delete":[]}]}},"66ec7029c66cc11b6513a6699880ae6cf0aa58ad":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["91","      <version>4.5-20180827.050220-1<\/version>"],"delete":["91","      <version>4.4<\/version>"]}]}},"a6766763c16333b2bd79f913f7a8ad97d980a9fd":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/resources\/lib\/layout\/layout.jelly":"MODIFY"},"diff":{"changelog.html":[{"add":["57","  <li class=rfe>","58","    Added 'no-store' to the 'Cache-Control' header to avoid accidental information leak through local cache backup","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-24337\">issue 24337<\/a>)"],"delete":["57","  <li class=>"]}],"core\/src\/main\/resources\/lib\/layout\/layout.jelly":[{"add":["56","<st:setHeader name=\"Cache-Control\" value=\"no-cache,no-store,must-revalidate\" \/>"],"delete":["56","<st:setHeader name=\"Cache-Control\" value=\"no-cache,must-revalidate\" \/>"]}]}},"c733b24be79d4c6b12110107fda832bce2e6f08d":{"changes":{"changelog.html":"MODIFY","pom.xml":"MODIFY"},"diff":{"changelog.html":[{"add":["58","    Fixed a possible race condition in the remoting layer.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-14909\">issue 14909<\/a>)","60","  <li class=bug>"],"delete":[]}],"pom.xml":[{"add":["192","        <version>2.17<\/version>"],"delete":["192","        <version>2.16<\/version>"]}]}},"6ecc65978a350841fddf63bcdb024c0eb1797f28":{"changes":{"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":[{"add":["873","                    Matcher m = CVSROOT_PSERVER_PATTERN.matcher(v);","874","","877","                        if(!m.matches()) {","889","                        if(m.group(2)==null) {\/\/ if password is not specified in CVSROOT ","890","                            String cvspass = getCvspassFile();","891","                            File passfile;","892","                            if(cvspass.equals(\"\")) {","893","                                passfile = new File(new File(System.getProperty(\"user.home\")),\".cvspass\");","894","                            } else {","895","                                passfile = new File(cvspass);","896","                            }","898","                            if(passfile.exists()) {","899","                                \/\/ It's possible that we failed to locate the correct .cvspass file location,","900","                                \/\/ so don't report an error if we couldn't locate this file.","901","                                \/\/","902","                                \/\/ if this is explicitly specified, then our system config page should have","903","                                \/\/ reported an error.","904","                                if(!scanCvsPassFile(passfile, v)) {","905","                                    error(\"It doesn't look like this CVSROOT has its password set.\" +","906","                                        \" Would you like to set it now?\");","907","                                    return;","908","                                }","946","            Pattern.compile(\":(ext|pserver):[^@:]+(:[^@:]+)?@[^:]+:(\\\\d+:)?.+\");"],"delete":["875","                        if(!CVSROOT_PSERVER_PATTERN.matcher(v).matches()) {","887","                        String cvspass = getCvspassFile();","888","                        File passfile;","889","                        if(cvspass.equals(\"\")) {","890","                            passfile = new File(new File(System.getProperty(\"user.home\")),\".cvspass\");","891","                        } else {","892","                            passfile = new File(cvspass);","893","                        }","895","                        if(passfile.exists()) {","896","                            \/\/ It's possible that we failed to locate the correct .cvspass file location,","897","                            \/\/ so don't report an error if we couldn't locate this file.","898","                            \/\/","899","                            \/\/ if this is explicitly specified, then our system config page should have","900","                            \/\/ reported an error.","901","                            if(!scanCvsPassFile(passfile, v)) {","902","                                error(\"It doesn't look like this CVSROOT has its password set.\" +","903","                                    \" Would you like to set it now?\");","904","                                return;","942","            Pattern.compile(\":(ext|pserver):[^@:]+@[^:]+:(\\\\d+:)?.+\");"]}]}},"82d751b788e1553dbff6c649428e2ab9cdd1de0d":{"changes":{"core\/src\/main\/resources\/hudson\/tasks\/junit\/CaseResult\/index_nl.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/tasks\/junit\/CaseResult\/index_nl.properties":[{"add":["22","skippedFor=Overgeslagen voor de laatste {0} {0,choice,0#bouwpogingen|1#bouwpoging|1<bouwpogingen}","23","failingFor=Gefaald voor de laatste {0} {0,choice,0#bouwpogingen|1#bouwpoging|1<bouwpogingen}"],"delete":["22","skippedFor=Overgeslagen voor de laaste {0} {0,choice,0#bouwpogingen|1#bouwpoging|1<bouwpogingen}","23","failingFor=Gefaald voor de laaste {0} {0,choice,0#bouwpogingen|1#bouwpoging|1<bouwpogingen}"]}]}},"3e856e6889478228b7c5683ce466b0495cb55f49":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["58","    Handle AbortException publisher status in the same way as deprecated false boolean status","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-26964\">issue 26964<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"22e729cc0b3d17bbee99597bdedb6a7ee571d29d":{"changes":{"core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["1953","        final Map<PluginWrapper,Plugin> store = new ConcurrentHashMap<PluginWrapper,Plugin>();"],"delete":["119","import java.util.Hashtable;","1954","        final Map<PluginWrapper,Plugin> store = new Hashtable<PluginWrapper,Plugin>();"]}]}},"5f655a59b6d263061d6c5c1d05ac8d5d1d1d391f":{"changes":{"core\/src\/main\/java\/hudson\/lifecycle\/UnixLifecycle.java":"MODIFY","core\/src\/main\/java\/hudson\/lifecycle\/WindowsServiceLifecycle.java":"MODIFY","core\/src\/main\/java\/hudson\/lifecycle\/SolarisSMFLifecycle.java":"MODIFY","core\/src\/main\/java\/hudson\/WebAppMain.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/lifecycle\/UnixLifecycle.java":[{"add":["30","import java.util.logging.Level;","31","import java.util.logging.Logger;","69","        Jenkins jenkins = Jenkins.getInstanceOrNull(); \/\/ guard against repeated concurrent calls to restart","70","        try {","71","            if (jenkins != null) {","72","                jenkins.cleanUp();","73","            }","74","        } catch (Exception e) {","75","            LOGGER.log(Level.SEVERE, \"Failed to clean up. Restart will continue.\", e);","76","        }","105","","106","    private static final Logger LOGGER = Logger.getLogger(UnixLifecycle.class.getName());"],"delete":["67","        Jenkins h = Jenkins.getInstanceOrNull(); \/\/ guard against repeated concurrent calls to restart","68","        if (h != null)","69","            h.cleanUp();"]}],"core\/src\/main\/java\/hudson\/lifecycle\/WindowsServiceLifecycle.java":[{"add":["119","        Jenkins jenkins = Jenkins.getInstanceOrNull();","120","        try {","121","            if (jenkins != null) {","122","                jenkins.cleanUp();","123","            }","124","        } catch (Exception e) {","125","            LOGGER.log(Level.SEVERE, \"Failed to clean up. Restart will continue.\", e);","126","        }","127",""],"delete":[]}],"core\/src\/main\/java\/hudson\/lifecycle\/SolarisSMFLifecycle.java":[{"add":["28","import java.util.logging.Level;","29","import java.util.logging.Logger;","42","        Jenkins jenkins = Jenkins.getInstanceOrNull(); \/\/ guard against repeated concurrent calls to restart","43","        try {","44","            if (jenkins != null) {","45","                jenkins.cleanUp();","46","            }","47","        } catch (Exception e) {","48","            LOGGER.log(Level.SEVERE, \"Failed to clean up. Restart will continue.\", e);","49","        }","52","","53","    private static final Logger LOGGER = Logger.getLogger(SolarisSMFLifecycle.class.getName());"],"delete":["40","        Jenkins h = Jenkins.getInstanceOrNull(); \/\/ guard against repeated concurrent calls to restart","41","        if (h != null)","42","            h.cleanUp();"]}],"core\/src\/main\/java\/hudson\/WebAppMain.java":[{"add":["378","            try {","379","                if (instance != null) {","380","                    instance.cleanUp();","381","                }","382","            } catch (Exception e) {","383","                LOGGER.log(Level.SEVERE, \"Failed to clean up. Restart will continue.\", e);","384","            }","385","","386","            terminated = true;"],"delete":["377","            terminated = true;","379","            if (instance != null)","380","                instance.cleanUp();"]}]}},"f3d31af0516c4163c898dc0a9442e3f15f770d5b":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["60","  <li class=bug>","61","    NPE when running Maven 3 jobs with -T.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-11458\">issue 11458<\/a>)"],"delete":[]}]}},"f043975fc897444880e7d21ca45bdf65b24e813d":{"changes":{"core\/src\/test\/java\/hudson\/MarkupTextTest.java":"MODIFY","core\/src\/main\/java\/hudson\/MarkupText.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/MarkupTextTest.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi","96","    public void testPreEscape() {","97","        MarkupText text = new MarkupText(\"Line\\n2   & 3\\n<End>\\n\");","98","        assertEquals(\"Line\\n2   &amp; 3\\n&lt;End>\\n\", text.toString(true));","99","        text.addMarkup(4, \"<hr\/>\");","100","        assertEquals(\"Line<hr\/>\\n2   &amp; 3\\n&lt;End>\\n\", text.toString(true));","101","    }","102",""],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi"]}],"core\/src\/main\/java\/hudson\/MarkupText.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi","269","            return preEscape? Util.xmlEscape(text) : Util.escape(text);  \/\/ the most common case"],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi","269","            return Util.escape(text);    \/\/ the most common case"]}]}},"61d46127be97545368b6a95bf0cb05d01aa80663":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["518","      <version>1.9<\/version>"],"delete":["518","      <version>1.8<\/version>"]}],"changelog.html":[{"add":["68","    <code>BindException<\/code> when using <code>--daemon<\/code> with JMX.","69","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-14529\">issue 14529<\/a>)","70","  <li class=bug>"],"delete":[]}]}},"22d9db09d56c1caa2a8a3e008e6bd29f5c9ed395":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["121","      <version>1.5.1<\/version>"],"delete":["121","      <version>1.5<\/version>"]}]}},"5bb021e0bd808ee34263a0860c022a38fe47eff1":{"changes":{"core\/src\/main\/java\/hudson\/cli\/InstallPluginCommand.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/cli\/InstallPluginCommand.java":[{"add":["77","        if (sources.size() > 1 && name != null) {","78","            throw new IllegalArgumentException(\"-name is incompatible with multiple sources\");","79","        }","80","","87","                    String n = name != null ? name : f.getBaseName();","88","                    f.copyTo(getTargetFilePath(n));","90","                        pm.dynamicLoad(getTargetFile(n));","99","                String n;","100","                if (name != null) {","101","                    n = name;","102","                } else {","103","                    n = u.getPath();","104","                    n = n.substring(n.lastIndexOf('\/') + 1);","105","                    n = n.substring(n.lastIndexOf('\\\\') + 1);","106","                    int idx = n.lastIndexOf('.');","107","                    if (idx > 0) {","108","                        n = n.substring(0, idx);","109","                    }","111","                getTargetFilePath(n).copyFrom(u);","113","                    pm.dynamicLoad(getTargetFile(n));","159","    private static FilePath getTargetFilePath(String name) {","160","        return new FilePath(getTargetFile(name));","163","    private static File getTargetFile(String name) {"],"delete":["83","                    if (name==null)","84","                        name = f.getBaseName();","85","                    f.copyTo(getTargetFilePath());","87","                        pm.dynamicLoad(getTargetFile());","96","                if (name==null) {","97","                    name = u.getPath();","98","                    name = name.substring(name.lastIndexOf('\/')+1);","99","                    name = name.substring(name.lastIndexOf('\\\\')+1);","100","                    int idx = name.lastIndexOf('.');","101","                    if (idx>0)  name = name.substring(0,idx);","103","                getTargetFilePath().copyFrom(u);","105","                    pm.dynamicLoad(getTargetFile());","151","    private FilePath getTargetFilePath() {","152","        return new FilePath(getTargetFile());","155","    private File getTargetFile() {"]}]}},"bddbb8d6be6fc1f6ecb43eb87bf4c9c4db202e71":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["114","                <resolveArtifact groupId=\"org.jvnet.hudson.plugins\" artifactId=\"subversion\" version=\"1.2\" type=\"hpi\" tofile=\"${basedir}\/target\/generated-resources\/WEB-INF\/plugins\/subversion.hpi\" \/>"],"delete":["114","                <resolveArtifact groupId=\"org.jvnet.hudson.plugins\" artifactId=\"subversion\" version=\"1.1\" type=\"hpi\" tofile=\"${basedir}\/target\/generated-resources\/WEB-INF\/plugins\/subversion.hpi\" \/>"]}]}},"e761d80f4d53a0f368fa8e9fbb06f01db247f8cc":{"changes":{"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/FakeChangeLogSCM.java":"ADD","test\/src\/test\/groovy\/hudson\/model\/AbstractBuildTest.groovy":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY"},"diff":{"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/FakeChangeLogSCM.java":[{"add":[],"delete":[]}],"test\/src\/test\/groovy\/hudson\/model\/AbstractBuildTest.groovy":[{"add":["32","import org.jvnet.hudson.test.ExtractResourceWithChangesSCM","33","import org.jvnet.hudson.test.FakeChangeLogSCM","34","import org.jvnet.hudson.test.FailureBuilder","35","import org.jvnet.hudson.test.UnstableBuilder","67","","68","    def assertCulprits(AbstractBuild b, Collection<String> expectedIds) {","69","        assertEquals(expectedIds as Set, b.culprits*.id as Set);","70","    }","71","","72","    void testCulprits() {","73","","74","        def p = createFreeStyleProject();","75","        def scm = new FakeChangeLogSCM()","76","        p.scm = scm","77","","78","        \/\/ 1st build, successful, no culprits","79","        scm.addChange().withAuthor(\"alice\")","80","        def b = assertBuildStatus(Result.SUCCESS,p.scheduleBuild2(0).get())","81","        assertCulprits(b,[\"alice\"])","82","","83","        \/\/ 2nd build","84","        scm.addChange().withAuthor(\"bob\")","85","        p.buildersList.add(new FailureBuilder())","86","        b = assertBuildStatus(Result.FAILURE,p.scheduleBuild2(0).get())","87","        assertCulprits(b,[\"bob\"])","88","","89","        \/\/ 3rd build. bob continues to be in culprit","90","        scm.addChange().withAuthor(\"charlie\")","91","        b = assertBuildStatus(Result.FAILURE,p.scheduleBuild2(0).get())","92","        assertCulprits(b,[\"bob\",\"charlie\"])","93","","94","        \/\/ 4th build, unstable. culprit list should continue","95","        scm.addChange().withAuthor(\"dave\")","96","        p.buildersList.replaceBy([new UnstableBuilder()])","97","        b = assertBuildStatus(Result.UNSTABLE,p.scheduleBuild2(0).get())","98","        assertCulprits(b,[\"bob\",\"charlie\",\"dave\"])","99","","100","        \/\/ 5th build, unstable. culprit list should continue","101","        scm.addChange().withAuthor(\"eve\")","102","        b = assertBuildStatus(Result.UNSTABLE,p.scheduleBuild2(0).get())","103","        assertCulprits(b,[\"bob\",\"charlie\",\"dave\",\"eve\"])","104","","105","        \/\/ 6th build, success, accumulation continues up to this point","106","        scm.addChange().withAuthor(\"fred\")","107","        p.buildersList.replaceBy([])","108","        b = assertBuildStatus(Result.SUCCESS,p.scheduleBuild2(0).get())","109","        assertCulprits(b,[\"bob\",\"charlie\",\"dave\",\"eve\",\"fred\"])","110","","111","        \/\/ 7th build, back to empty culprits","112","        scm.addChange().withAuthor(\"george\")","113","        b = assertBuildStatus(Result.SUCCESS,p.scheduleBuild2(0).get())","114","        assertCulprits(b,[\"george\"])","115","    }"],"delete":[]}],"changelog.html":[{"add":["63","  <li class=bug>","64","    \"include culprits\" should treat unstable and failure as the same","65","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-4617\">issue 4617<\/a>)"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["271","                if (pr!=null && pr.isWorseThan(Result.SUCCESS)) {"],"delete":["271","                if (pr!=null && pr.isWorseThan(Result.UNSTABLE)) {"]}]}},"0c7e7bbc55a24cfa24ac835fd32d31a6e4e8243b":{"changes":{"core\/src\/main\/java\/hudson\/init\/impl\/InstallUncaughtExceptionHandler.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/init\/impl\/InstallUncaughtExceptionHandler.java":[{"add":["22","","23","    private static final Logger LOGGER = Logger.getLogger(InstallUncaughtExceptionHandler.class.getName());","24","","30","                if (rsp.isCommitted()) {","31","                    LOGGER.log(Level.WARNING, null, e);","32","                    return;","33","                }","47","            LOGGER.log(Level.FINE, \"Successfully installed a global UncaughtExceptionHandler.\");","50","            LOGGER.log(Level.SEVERE,","72","","73","    private InstallUncaughtExceptionHandler() {}","74",""],"delete":["40","            DefaultUncaughtExceptionHandler.LOGGER.log(Level.FINE, \"Successfully installed a global UncaughtExceptionHandler.\");","43","            DefaultUncaughtExceptionHandler.LOGGER.log(Level.SEVERE, ","55","        private static final Logger LOGGER = Logger.getLogger(InstallUncaughtExceptionHandler.class.getName());","56",""]}]}},"38953b88698e9ec784a399dbb7af9dd1eae0507e":{"changes":{"core\/src\/main\/resources\/hudson\/security\/LDAPSecurityRealm\/config.jelly":"MODIFY","core\/src\/main\/java\/hudson\/security\/LDAPSecurityRealm.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/security\/LDAPSecurityRealm\/config.jelly":[{"add":["3","            checkUrl=\"'${rootURL}\/securityRealms\/LDAPSecurityRealm\/serverCheck?server='+escape(this.value)+'&amp;managerDN='+escape(this.form.elements['ldap.managerDN'].value)+'&amp;managerPassword='+escape(this.form.elements['ldap.managerPassword'].value)\"\/>","16","      <f:textbox name=\"ldap.managerDN\" value=\"${instance.managerDN}\"","17","      checkUrl=\"'${rootURL}\/securityRealms\/LDAPSecurityRealm\/serverCheck?server='+escape(this.form.elements['ldap.server'].value)+'&amp;managerDN='+escape(this.value)+'&amp;managerPassword='+escape(this.form.elements['ldap.managerPassword'].value)\" ","18","      \/>","21","      <f:password name=\"ldap.managerPassword\" value=\"${instance.managerPassword}\" ","22","      checkUrl=\"'${rootURL}\/securityRealms\/LDAPSecurityRealm\/serverCheck?server='+escape(this.form.elements['ldap.server'].value)+'&amp;managerDN='+escape(this.form.elements['ldap.managerDN'].value)+'&amp;managerPassword='+escape(this.value)\" ","23","      \/>"],"delete":["3","            checkUrl=\"'${rootURL}\/securityRealms\/LDAPSecurityRealm\/serverCheck?server='+escape(this.value)\"\/>","16","      <f:textbox name=\"ldap.managerDN\" value=\"${instance.managerDN}\" \/>","19","      <f:password name=\"ldap.managerPassword\" value=\"${instance.managerPassword}\" \/>"]}],"core\/src\/main\/java\/hudson\/security\/LDAPSecurityRealm.java":[{"add":["229","        public void doServerCheck(StaplerRequest req, StaplerResponse rsp, @QueryParameter(\"server\") final String server,","230","        \t\t@QueryParameter(\"managerDN\") final String managerDN,","231","        \t\t@QueryParameter(\"managerPassword\") final String managerPassword","232","        \t\t) throws IOException, ServletException {","236","                        Hashtable<String,String> props = new Hashtable<String,String>();","237","                        if(managerDN!=null && managerDN.trim().length() > 0  && !\"undefined\".equals(managerDN)) {","238","                            props.put(Context.SECURITY_PRINCIPAL,managerDN);","239","                        }","240","                        if(managerPassword!=null && managerPassword.trim().length() > 0 && !\"undefined\".equals(managerPassword)) {","241","                            props.put(Context.SECURITY_PRINCIPAL,managerPassword);","242","                        }","243","                        DirContext ctx = LdapCtxFactory.getLdapCtxInstance(\"ldap:\/\/\"+server+'\/', props);"],"delete":["229","        public void doServerCheck(StaplerRequest req, StaplerResponse rsp, @QueryParameter(\"server\") final String server) throws IOException, ServletException {","233","                        DirContext ctx = LdapCtxFactory.getLdapCtxInstance(\"ldap:\/\/\"+server+'\/', new Hashtable());"]}]}},"3276602d13ae35edae8d98828f02fa3e6e2f528e":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["163","      <version>1.3<\/version>"],"delete":["163","      <version>1.2<\/version>"]}],"changelog.html":[{"add":["71","  <li class=rfe>","72","    Integrated codemirror v2.38.","73","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22582\">issue 22582<\/a>)"],"delete":[]}]}},"f967feaca9836eb4295b588482d2fba27e59e8c1":{"changes":{"core\/src\/main\/java\/hudson\/FilePath.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/FilePath.java":[{"add":["509","                    f.setLastModified(e.getTime());"],"delete":["501","                    f.setLastModified(e.getTime());"]}]}},"76ad914ecffccd59a4f3a9cc2f0451a3828b9b83":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":[{"add":["92","        ","102","","103","            String artifacts = build.getEnvironment(listener).expand(this.artifacts);"],"delete":["92",""]}]}},"cba29b60aad39c7990699f0e635510f9dbd7237e":{"changes":{"core\/src\/main\/java\/hudson\/model\/User.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/User.java":[{"add":["482","    public void doRssAll(StaplerRequest req, StaplerResponse rsp) throws IOException, ServletException {","483","        rss(req, rsp, \" all builds\", RunList.fromRuns(getBuilds()), Run.FEED_ADAPTER);","486","    public void doRssFailed(StaplerRequest req, StaplerResponse rsp) throws IOException, ServletException {","487","        rss(req, rsp, \" regression builds\", RunList.fromRuns(getBuilds()).regressionOnly(), Run.FEED_ADAPTER);","490","    public void doRssLatest(StaplerRequest req, StaplerResponse rsp) throws IOException, ServletException {","491","        final List<Run> lastBuilds = new ArrayList<Run>();","492","        for (final TopLevelItem item : Hudson.getInstance().getItems()) {","493","            if (!(item instanceof Job)) continue;","494","            for (Run r = ((Job) item).getLastBuild(); r != null; r = r.getPreviousBuild()) {","495","                if (!(r instanceof AbstractBuild)) continue;","496","                final AbstractBuild b = (AbstractBuild) r;","497","                if (b.hasParticipant(this)) {","498","                    lastBuilds.add(b);","499","                    break;","500","                }","501","            }","502","        }","503","        rss(req, rsp, \" latest build\", RunList.fromRuns(lastBuilds), Run.FEED_ADAPTER_LATEST);","506","    private void rss(StaplerRequest req, StaplerResponse rsp, String suffix, RunList runs, FeedAdapter adapter)","507","            throws IOException, ServletException {","508","        RSS.forwardToRss(getDisplayName()+ suffix, getUrl(), runs.newBuilds(), adapter, req, rsp);","509","    }"],"delete":["33","import hudson.tasks.Mailer;","57","import java.util.Calendar;","484","    public void doRssAll( StaplerRequest req, StaplerResponse rsp ) throws IOException, ServletException {","485","        rss(req, rsp, \" all builds\", RunList.fromRuns(getBuilds()));","488","    public void doRssFailed( StaplerRequest req, StaplerResponse rsp ) throws IOException, ServletException {","489","        rss(req, rsp, \" regression builds\", RunList.fromRuns(getBuilds()).regressionOnly());","492","    private void rss(StaplerRequest req, StaplerResponse rsp, String suffix, RunList runs) throws IOException, ServletException {","493","        RSS.forwardToRss(getDisplayName()+ suffix, getUrl(),","494","            runs.newBuilds(), FEED_ADAPTER, req, rsp );","515","    \/**","516","     * {@link FeedAdapter} to produce build status summary in the feed.","517","     *\/","518","    public static final FeedAdapter<Run> FEED_ADAPTER = new FeedAdapter<Run>() {","519","        public String getEntryTitle(Run entry) {","520","            return entry+\" : \"+entry.getBuildStatusSummary().message;","521","        }","522","","523","        public String getEntryUrl(Run entry) {","524","            return entry.getUrl();","525","        }","526","","527","        public String getEntryID(Run entry) {","528","            return \"tag:\"+entry.getParent().getName()+':'+entry.getId();","529","        }","530","","531","        public String getEntryDescription(Run entry) {","532","            \/\/ TODO: provide useful details","533","            return null;","534","        }","535","","536","        public Calendar getEntryTimestamp(Run entry) {","537","            return entry.getTimestamp();","538","        }","539","","540","        public String getEntryAuthor(Run entry) {","541","            return Mailer.descriptor().getAdminAddress();","542","        }","543","    };","544","","545",""]}],"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["1788","            return entry+\" (\"+entry.getBuildStatusSummary().message+\")\";"],"delete":["1788","            return entry+\" (\"+entry.getResult()+\")\";"]}]}},"3f81160bb7081ce8400bcabf85ff5f160e3cd6c1":{"changes":{"core\/src\/main\/resources\/lib\/hudson\/buildListTable.jelly":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_ru.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_zh_TW.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_ko.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_pt_BR.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_sv_SE.properties":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_it.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_nb_NO.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_es.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_zh_CN.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_fr.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_de.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_tr.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_da.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_ja.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildListTable_nl.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/hudson\/buildListTable.jelly":[{"add":["40","      <th initialSortDir=\"up\">${Time Since}<\/th>"],"delete":["40","      <th initialSortDir=\"up\">${%Date}<\/th>"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_ru.properties":[{"add":["24","Time\\ Since=\\u0414\\u0430\\u0442\\u0430"],"delete":["24","Date=\\u0414\\u0430\\u0442\\u0430"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_zh_TW.properties":[{"add":["24","Time\\ Since=\\u65E5\\u671F"],"delete":["24","Date=\\u65E5\\u671F"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_ko.properties":[{"add":["24","Time\\ Since=\\uB0A0\\uC790"],"delete":["24","Date=\\uB0A0\\uC790"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_pt_BR.properties":[{"add":["22","Time\\ Since=Data"],"delete":["22","Date=Data"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_sv_SE.properties":[{"add":["23","Time\\ Since=Datum"],"delete":["23","Date=Datum"]}],"changelog.html":[{"add":["78","  <li class=bug>","79","    Build list tables had \"Date\" as column label, but actual content of the column was \"Time Since\".","80","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9102\">issue 9102<\/a>)"],"delete":[]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_it.properties":[{"add":["24","Time\\ Since=Data"],"delete":["24","Date=Data"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_nb_NO.properties":[{"add":["24","Time\\ Since=Dato"],"delete":["24","Date=Dato"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_es.properties":[{"add":["23","Time\\ Since=Fecha"],"delete":["23","Date=Fecha"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_zh_CN.properties":[{"add":["24","Time\\ Since=\\u65e5\\u671f"],"delete":["24","Date=\\u65e5\\u671f"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_fr.properties":[{"add":["22","Time\\ Since=Date"],"delete":["22","Date=Date"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_de.properties":[{"add":["22","Time\\ Since=Datum"],"delete":["22","Date=Datum"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_tr.properties":[{"add":["22","Time\\ Since=Tarih"],"delete":["22","Date=Tarih"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_da.properties":[{"add":["24","Time\\ Since=Dato"],"delete":["24","Date=Dato"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_ja.properties":[{"add":["23","Time\\ Since=\\u6642\\u671F"],"delete":["23","Date=\\u6642\\u671F"]}],"core\/src\/main\/resources\/lib\/hudson\/buildListTable_nl.properties":[{"add":["23","Time\\ Since=Datum"],"delete":["23","Date=Datum"]}]}},"7c91c402a7c491d51f776178898ee473989ab6c9":{"changes":{"changelog.html":"MODIFY","test\/src\/main\/java\/org\/jvnet\/hudson\/test\/JenkinsRule.java":"MODIFY","core\/src\/main\/resources\/lib\/layout\/layout.jelly":"MODIFY","test\/src\/test\/java\/lib\/layout\/LayoutTest.java":"ADD"},"diff":{"changelog.html":[{"add":["57","  <li class=bug>","58","    <code>\/login<\/code> offers link to <code>\/opensearch.xml<\/code> which anonymous users cannot retrieve.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-21254\">issue 21254<\/a>)"],"delete":["57","  <li class=>"]}],"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/JenkinsRule.java":[{"add":["32","import com.gargoylesoftware.htmlunit.WebResponse;","209","import javax.annotation.CheckForNull;","254","     * Where in the {@link Server} is Jenkins deployed?","257","     * Unlike {@link WebClient#getContextPath} this is not a complete URL.","259","    public String contextPath = \"\/jenkins\";","1918","         * Requests an HTML page within Jenkins.","1921","         *      Relative path within Jenkins. Starts without '\/'.","1933","        \/**","1934","         * Requests a page within Jenkins.","1935","         *","1936","         * @param relative","1937","         *      Relative path within Jenkins. Starts without '\/'.","1938","         *      For example, \"job\/test\/\" to go to a job top page.","1939","         * @param expectedContentType the expected {@link WebResponse#getContentType}, or null to do no such check","1940","         *\/","1941","        public Page goTo(String relative, @CheckForNull String expectedContentType) throws IOException, SAXException {","1944","            if (expectedContentType != null) {","1945","                assertThat(p.getWebResponse().getContentType(), is(expectedContentType));","1946","            }","1950","        \/** Loads a page as XML. Useful for testing Jenkins's XML API, in concert with","1983","         * <p>This is actually the same as {@link #getURL} and should not be confused with {@link #contextPath}."],"delete":["252","     * Where in the {@link Server} is Hudson deployed?","256","    protected String contextPath = \"\/jenkins\";","1915","         * Requests a page within Hudson.","1918","         *      Relative path within Hudson. Starts without '\/'.","1930","        public Page goTo(String relative, String expectedContentType) throws IOException, SAXException {","1933","            assertThat(p.getWebResponse().getContentType(), is(expectedContentType));","1937","        \/** Loads a page as XML. Useful for testing Hudson's xml api, in concert with"]}],"core\/src\/main\/resources\/lib\/layout\/layout.jelly":[{"add":["134","    <l:hasPermission permission=\"${app.READ}\">","135","      <link rel=\"search\" type=\"application\/opensearchdescription+xml\" href=\"${rootURL}\/opensearch.xml\" title=\"Jenkins\" \/>","136","    <\/l:hasPermission>"],"delete":["134","    <link rel=\"search\" type=\"application\/opensearchdescription+xml\" href=\"${rootURL}\/opensearch.xml\" title=\"Jenkins\" \/>"]}],"test\/src\/test\/java\/lib\/layout\/LayoutTest.java":[{"add":[],"delete":[]}]}},"7cb81ee826e41d5f70c73bd2992bb249eccd90f7":{"changes":{"core\/src\/main\/resources\/lib\/form\/textarea.jelly":"MODIFY","core\/src\/main\/resources\/lib\/form\/advanced.jelly":"MODIFY","core\/src\/main\/resources\/lib\/form\/expandableTextbox.jelly":"MODIFY","core\/src\/main\/resources\/lib\/form\/checkbox.jelly":"MODIFY","core\/src\/main\/resources\/lib\/form\/textbox.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/textarea.jelly":[{"add":["93","  <j:if test=\"${customizedFields != null and attrs.field != null and value != default}\">"],"delete":["93","  <j:if test=\"${customizedFields != null and value != default}\">"]}],"core\/src\/main\/resources\/lib\/form\/advanced.jelly":[{"add":["60","                  {","61","                      var span = $$('${id}');","62","                      if (span != null) {","63","                          span.style.display = '';","64","                      } else if (console &amp;&amp; console.log) {","65","                          console.log('no element ${id} for ${customizedFields}');","66","                      }","67","                  }"],"delete":["60","                $$('${id}').style.display = '';"]}],"core\/src\/main\/resources\/lib\/form\/expandableTextbox.jelly":[{"add":["73","            <j:if test=\"${customizedFields != null and attrs.field != null and (value ?: '') != ''}\">"],"delete":["73","            <j:if test=\"${customizedFields != null and (value ?: '') != ''}\">"]}],"core\/src\/main\/resources\/lib\/form\/checkbox.jelly":[{"add":["72","  <j:if test=\"${customizedFields != null and attrs.field != null and value != default}\">"],"delete":["72","  <j:if test=\"${customizedFields != null and value != default}\">"]}],"core\/src\/main\/resources\/lib\/form\/textbox.jelly":[{"add":["86","  <j:if test=\"${customizedFields != null and attrs.field != null and value != default}\">"],"delete":["86","  <j:if test=\"${customizedFields != null and value != default}\">"]}]}},"a1e70fa37295b915723d7034178b597a63f0b575":{"changes":{"core\/src\/main\/java\/hudson\/util\/FormFieldValidator.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/FormFieldValidator.java":[{"add":["192","                if(ws==null || !ws.exists()) {\/\/ no workspace. can't check"],"delete":["192","                if(!ws.exists()) {\/\/ no workspace. can't check"]}]}},"cb2ced734edc6ace59f5efd8dadbdaed0588a90d":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["89","  <li class='major rfe'>","90","    Updated JDK installer to reflect changes in Oracle download server","91","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10511\">issue 10511<\/a>)"],"delete":[]}]}},"72e0b9c53a15306e0a7b7117100f4d1b7ec250b8":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY","pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["192","      <version>2.0.31<\/version>"],"delete":["192","      <version>2.0.23<\/version>"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Jenkins CLI doesn't handle arguments with equal signs","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-21160\">issue 21160<\/a>)","60","  <li class=bug>","61","    master\/slave communication ping reacts badly if a clock jumps.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-21251\">issue 21251<\/a>)","63","  <li class=rfe>","64","    JNLP slaves can now connect to master through HTTP proxy.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-6167\">issue 21251<\/a>)"],"delete":["57","  <li class=>"]}],"pom.xml":[{"add":["178","        <version>2.50<\/version>"],"delete":["178","        <version>2.49<\/version>"]}]}},"28335690e0b2535cdd76cc778ffdc45a5c4f67ac":{"changes":{"core\/src\/main\/resources\/hudson\/PluginManager\/_table.js":"MODIFY","core\/src\/main\/java\/hudson\/PluginWrapper.java":"MODIFY","war\/src\/main\/webapp\/css\/style.css":"MODIFY","core\/src\/main\/resources\/hudson\/PluginManager\/installed.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/PluginManager\/_table.js":[{"add":["175","                var pluginMetadata = pluginTRs[i].jenkinsPluginMetadata;","176","                if (pluginTRs[i].hasClassName('has-dependants-but-disabled')) {","177","                    if (pluginMetadata.enableInput.checked) {","178","                        pluginTRs[i].removeClassName('has-dependants-but-disabled');","179","                        }","180","                }"],"delete":[]}],"core\/src\/main\/java\/hudson\/PluginWrapper.java":[{"add":["567","            if (dependency == null || !dependency.isActive()) {"],"delete":["567","            if (dependency == null) {"]}],"war\/src\/main\/webapp\/css\/style.css":[{"add":["1351","#plugins tr.has-dependants-but-disabled .enable input {","1352","  pointer-events: auto;","1353","  opacity: 1.0;","1354","  visibility: visible;","1355","}","1356",""],"delete":[]}],"core\/src\/main\/resources\/hudson\/PluginManager\/installed.jelly":[{"add":["70","                <tr class=\"plugin ${p.hasDependants()?'has-dependants':''} ${(p.hasDependants() &amp;&amp; !p.enabled)?'has-dependants-but-disabled':''} ${p.isDeleted()?'deleted':''}\" data-plugin-id=\"${p.shortName}\" data-plugin-name=\"${p.displayName}\">"],"delete":["70","                <tr class=\"plugin ${p.hasDependants()?'has-dependants':''} ${p.isDeleted()?'deleted':''}\" data-plugin-id=\"${p.shortName}\" data-plugin-name=\"${p.displayName}\">"]}]}},"cb3f713122030b0ec5097b286d4e9e566a34a90a":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["51","      <version>1.35.1<\/version>"],"delete":["51","      <version>1.34<\/version>"]}]}},"d4dd6d8e7b1543fc251b94c1ead87a7a19dfa08f":{"changes":{"core\/src\/main\/resources\/lib\/hudson\/buildHealth.jelly":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/hudson\/buildHealth.jelly":[{"add":["33","    <j:set var=\"healthReports\" value=\"${job.buildHealthReports}\"\/>","42","            <j:choose>","43","              <j:when  test=\"${!empty(healthReports)}\">","44","                <a href=\"${empty(link)?'#':link}\" style=\"${attrs.style}\">","45","                    <img src=\"${rootURL}${buildHealth.getIconUrl(iconSize)}\"","46","                         alt=\"${buildHealth.score}%\" class=\"icon${iconSize}\"\/>","47","                <\/a>","48","              <\/j:when>","49","              <j:otherwise>","50","                 <img src=\"${rootURL}${buildHealth.getIconUrl(iconSize)}\"","51","                      alt=\"${buildHealth.score}%\" class=\"icon${iconSize}\"\/>","52","               <\/j:otherwise>","53","             <\/j:choose>  "],"delete":["41","            <a href=\"${empty(link)?'#':link}\" style=\"${attrs.style}\">","42","                <img src=\"${rootURL}${buildHealth.getIconUrl(iconSize)}\"","43","                     alt=\"${buildHealth.score}%\" class=\"icon${iconSize}\"\/>","44","            <\/a>","46","        <j:set var=\"healthReports\" value=\"${job.buildHealthReports}\"\/>"]}],"changelog.html":[{"add":["65","  <li class=bug>","66","    404 when clicking in the weather report column of a build that hasn't yet been run.","67","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9532\">issue 9532<\/a>)"],"delete":[]}]}},"72f37e414533c02624f9deffc85a2b50f03905e6":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["70","  <li class='major bug'>","71","    Fixed unnecessary eager loading of build records in certain code path."],"delete":["70","  <li class=\"bug\">","71","    AbstractLazyLoadRunMap.iterator() calls .all()","89","  <li class=bug>","90","    Fixed \"... looks to have already been deleted\" bug in LogRotator","91","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22395\">issue 22395<\/a>)","92","  <li class='major bug'>","93","    Fixed unnecessary eager loading of build records in certain code path.","94","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18065\">issue 18065<\/a>)"]}]}},"b4bd4fee5f8fb2431cf4e3d26215ada5ea2674f3":{"changes":{"core\/src\/main\/java\/hudson\/scm\/SubversionSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/SubversionSCM.java":[{"add":["40","import org.xml.sax.helpers.LocatorImpl;","146","        \/\/ work around for http:\/\/svnkit.com\/tracker\/view.php?id=175","147","        th.setDocumentLocator(DUMMY_LOCATOR);","670","    private static final LocatorImpl DUMMY_LOCATOR = new LocatorImpl();","671","","672","    static {","673","        new Initializer();","674","        DUMMY_LOCATOR.setLineNumber(-1);","675","        DUMMY_LOCATOR.setColumnNumber(-1);","676","    }"],"delete":["667","    static { new Initializer(); }"]}]}},"eec307511c80112274d27f2a840d9f96cda784d3":{"changes":{"core\/src\/main\/java\/hudson\/model\/CheckPoint.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/JUnitResultArchiver.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/BuildStepMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/CheckPoint.java":[{"add":["30","import javax.annotation.Nonnull;","144","        Run.waitForCheckpoint(this, null, null);","145","    }","146","","147","    \/**","148","     * Like {@link #block()} but allows for richer logging.","149","     * @param listener an optional listener to which","150","     * @param waiter a description of what component is requesting the wait, such as {@link Descriptor#getDisplayName}","151","     * @throws InterruptedException if the build is aborted while waiting","152","     * @since 1.528","153","     *\/","154","    public void block(@Nonnull BuildListener listener, @Nonnull String waiter) throws InterruptedException {","155","        Run.waitForCheckpoint(this, listener, waiter);"],"delete":["143","        Run.waitForCheckpoint(this);"]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["207","Run._is_waiting_for_a_checkpoint_on_={0} is waiting for a checkpoint on {1}"],"delete":[]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/JUnitResultArchiver.java":[{"add":["158","\t\t\tCHECKPOINT.block(listener, getDescriptor().getDisplayName());"],"delete":["158","\t\t\tCHECKPOINT.block();"]}],"core\/src\/main\/java\/hudson\/tasks\/BuildStepMonitor.java":[{"add":["6","import hudson.model.Describable;","25","            if (bs instanceof Describable) {","26","                cp.block(listener, ((Describable) bs).getDescriptor().getDisplayName());","27","            } else {","28","                cp.block();","29","            }","39","            if (bs instanceof Describable) {","40","                CheckPoint.COMPLETED.block(listener, ((Describable) bs).getDescriptor().getDisplayName());","41","            } else {","42","                CheckPoint.COMPLETED.block();","43","            }"],"delete":["24","            cp.block();","34","            CheckPoint.COMPLETED.block();"]}],"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["1405","    \/*package*\/ static void waitForCheckpoint(CheckPoint id, @CheckForNull BuildListener listener, @CheckForNull String waiter) throws InterruptedException {","1415","            if(runner.checkpoints.waitForCheckPoint(id, listener, waiter))","1451","            protected synchronized boolean waitForCheckPoint(CheckPoint identifier, @CheckForNull BuildListener listener, @CheckForNull String waiter) throws InterruptedException {","1454","                t.setName(oldName + \" : waiting for \" + identifier + \" on \" + getFullDisplayName() + \" from \" + waiter);","1456","                    boolean first = true;","1457","                    while (!allDone && !checkpoints.contains(identifier)) {","1458","                        if (first && listener != null && waiter != null) {","1459","                            listener.getLogger().println(Messages.Run__is_waiting_for_a_checkpoint_on_(waiter, getFullDisplayName()));","1460","                        }","1462","                        first = false;","1463","                    }"],"delete":["1405","    \/*package*\/ static void waitForCheckpoint(CheckPoint id) throws InterruptedException {","1415","            if(runner.checkpoints.waitForCheckPoint(id))","1451","            protected synchronized boolean waitForCheckPoint(CheckPoint identifier) throws InterruptedException {","1454","                t.setName(oldName+\" : waiting for \"+identifier+\" on \"+getFullDisplayName());","1456","                    while(!allDone && !checkpoints.contains(identifier))"]}]}},"720db118a808c04f2ae04dc36582ce7dd5031b9b":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["221","      <version>1.5<\/version>"],"delete":["221","      <version>1.4<\/version>"]}]}},"688eb6ab5d0a0623ac256447387ec264b4704bd4":{"changes":{"core\/src\/main\/java\/hudson\/util\/io\/TarArchiver.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/IOUtils.java":"MODIFY","changelog.html":"MODIFY","core\/src\/test\/java\/hudson\/util\/io\/TarArchiverTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/io\/TarArchiver.java":[{"add":["28","import hudson.os.PosixException;","68","        try {","69","            int mode = IOUtils.mode(link);","70","            if (mode != -1) {","71","                e.setMode(mode);","72","            }","73","        } catch (PosixException x) {","74","            \/\/ ignore","75","        }"],"delete":["67","        int mode = IOUtils.mode(link);","68","        if (mode!=-1)   e.setMode(mode);"]}],"core\/src\/main\/java\/hudson\/util\/IOUtils.java":[{"add":["4","import hudson.os.PosixException;","118","     * Gets the mode of a file\/directory, if appropriate.","119","     * @return a file mode, or -1 if not on Unix","120","     * @throws PosixException if the file could not be statted, e.g. broken symlink","122","    public static int mode(File f) throws PosixException {"],"delete":["117","     * Gets the mode of a file\/directory, if appropriate. Returns -1 if not on Unix.","119","    public static int mode(File f) {"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    <code>TarArchiver.visitSymlink<\/code> can throw undeclared <code>PosixException<\/code>.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-14922\">issue 14922<\/a>)"],"delete":[]}],"core\/src\/test\/java\/hudson\/util\/io\/TarArchiverTest.java":[{"add":["28","import hudson.Util;","29","import hudson.model.TaskListener;","30","import hudson.util.NullStream;","40","","95","","96","    @Bug(14922)","97","    @Test public void brokenSymlinks() throws Exception {","98","        assumeTrue(!Functions.isWindows());","99","        File dir = Util.createTempDir();","100","        Util.createSymlink(dir, \"nonexistent\", \"link\", TaskListener.NULL);","101","        new FilePath(dir).tar(new NullStream(), \"**\");","102","    }","103",""],"delete":["36","\/**","37"," * @author Kohsuke Kawaguchi","38"," *\/"]}]}},"0268b988d5c88cd29be12ed25e95d5bc448c2840":{"changes":{"core\/src\/main\/java\/hudson\/widgets\/HistoryWidget.java":"MODIFY","core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/index.jelly":"MODIFY","core\/src\/main\/java\/hudson\/widgets\/BuildHistoryWidget.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/widgets\/HistoryWidget.java":[{"add":["116","    \/**","117","     * Calculates the first transient build record. Everything >= this will be discarded when AJAX call is made.","118","     *","119","     * @param historyPageFilter","120","     *      The history page filter containing the list of builds.","121","     * @return","122","     *      The history page filter that was passed in.","123","     *\/","124","    @SuppressWarnings(\"unchecked\")","125","    protected HistoryPageFilter updateFirstTransientBuildKey(HistoryPageFilter historyPageFilter) {","126","        updateFirstTransientBuildKey(historyPageFilter.runs);","127","        return historyPageFilter;","128","    }","129","","182","        return updateFirstTransientBuildKey(historyPageFilter);"],"delete":["168","        return historyPageFilter;","240","        updateFirstTransientBuildKey(page.runs);"]}],"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/index.jelly":[{"add":["121","    updateBuildHistory(\"${it.baseUrl}\/buildHistory\/ajax\", ${it.nextBuildNumberToFetch ?: it.owner.nextBuildNumber});"],"delete":["121","      updateBuildHistory(\"${it.baseUrl}\/buildHistory\/ajax\",${it.owner.nextBuildNumber});"]}],"core\/src\/main\/java\/hudson\/widgets\/BuildHistoryWidget.java":[{"add":["79","        return updateFirstTransientBuildKey(historyPageFilter);"],"delete":["79","        return historyPageFilter;"]}]}},"d675a1c7b49a79fa8cf62e2e7f9831124d6536c2":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["260","      <version>1.53<\/version>"],"delete":["260","      <version>1.52<\/version>"]}]}},"f6bd1f306d9b8bf20ff78fb84ae19a07b3fb5c12":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["58","  <li class=bug>","59","    MavenBuild does not respect the \"alternate settings\" value of its parent MavenModuleSetBuild","60","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-8670\">issue 8670<\/a>)"],"delete":["58","  <li class=>"]}]}},"c35f3ba75ce8a5a33b7efc8f760ec7e5bf8c9228":{"changes":{"core\/src\/main\/java\/hudson\/Util.java":"MODIFY","core\/src\/test\/java\/jenkins\/util\/io\/PathRemoverTest.java":"MODIFY","core\/src\/test\/java\/hudson\/UtilTest.java":"MODIFY","core\/src\/test\/java\/hudson\/FilePathTest.java":"MODIFY","core\/src\/test\/java\/hudson\/RemoveWindowsDirectoryJunctionTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Util.java":[{"add":["25","import com.google.common.annotations.VisibleForTesting;","1281","     * Creates an NTFS junction point if supported. Similar to symbolic links, NTFS provides junction points which","1282","     * provide different features than symbolic links. This method is primarily useful for unit testing on Windows.","1283","     * @param junction NTFS junction point to create","1284","     * @param target target directory to junction","1285","     * @return the newly created junction point","1286","     * @throws IOException if the call to mklink exits with a non-zero status code","1287","     * @throws InterruptedException if the call to mklink is interrupted before completing","1288","     * @throws AssertionError if this method is called on a non-Windows platform","1289","     *\/","1290","    static @Nonnull File createJunction(@Nonnull File junction, @Nonnull File target) throws IOException, InterruptedException {","1291","        if (!Functions.isWindows()) throw new AssertionError(\"Cannot create junctions on non-Windows platforms\");","1292","        String command = \"mklink \/J \" + escapeCmdArgument(junction.getAbsolutePath()) + ' ' + escapeCmdArgument(target.getAbsolutePath());","1293","        Process process = new ProcessBuilder(\"cmd.exe\", \"\/C\", command).start();","1294","        int result = process.waitFor();","1295","        if (result != 0) throw new IOException(\"Command `\" + command + \"` failed with status code \" + result);","1296","        return junction;","1297","    }","1298","","1299","    private static final Pattern CMD_METACHARS = Pattern.compile(\"[()%!^\\\"<>&|]\");","1300","","1301","    \/**","1302","     * Escapes a Windows cmd argument. Cmd supports escaping characters with carats which simplifies nested escapes.","1303","     * @param arg argument to escape","1304","     * @return the quoted argument for use in cmd.exe","1305","     * @see <a href=\"https:\/\/blogs.msdn.microsoft.com\/twistylittlepassagesallalike\/2011\/04\/23\/everyone-quotes-command-line-arguments-the-wrong-way\/>Everyone quotes command line arguments the wrong way<\/a>","1306","     *\/","1307","    @VisibleForTesting","1308","    static String escapeCmdArgument(String arg) {","1309","        return CMD_METACHARS.matcher('\"' + arg + '\"').replaceAll(\"^$0\");","1310","    }","1311","","1312","    \/**"],"delete":[]}],"core\/src\/test\/java\/jenkins\/util\/io\/PathRemoverTest.java":[{"add":["162","    @Issue(\"JENKINS-55448\")","163","    public void testForceRemoveFile_DotsInPath() throws IOException {","164","        Path folder = tmp.newFolder().toPath();","165","        File test = tmp.newFile(\"test\");","166","        touchWithFileName(test);","167","        Path path = folder.resolve(\"..\/test\");","168","","169","        PathRemover remover = PathRemover.newSimpleRemover();","170","        remover.forceRemoveFile(path);","171","","172","        assertTrue(\"Unable to delete file: \" + path, Files.notExists(path));","173","        assertFalse(test.exists());","174","        assertTrue(\"Should not have deleted directory: \" + folder, Files.exists(folder));","175","    }","176","","177","    @Test","178","    @Issue(\"JENKINS-55448\")","179","    public void testForceRemoveFile_ParentIsSymbolicLink() throws IOException {","180","        Path realParent = tmp.newFolder().toPath();","181","        Path path = realParent.resolve(\"test-file\");","182","        touchWithFileName(path.toFile());","183","        Path symParent = Files.createSymbolicLink(tmp.getRoot().toPath().resolve(\"sym-parent\"), realParent);","184","        Path toDelete = symParent.resolve(\"test-file\");","185","","186","        PathRemover remover = PathRemover.newSimpleRemover();","187","        remover.forceRemoveFile(toDelete);","188","","189","        assertTrue(\"Unable to delete file: \" + toDelete, Files.notExists(toDelete));","190","        assertTrue(\"Should not have deleted directory: \" + realParent, Files.exists(realParent));","191","        assertTrue(\"Should not have deleted symlink: \" + symParent, Files.exists(symParent, LinkOption.NOFOLLOW_LINKS));","192","    }","193","","194","    @Test"],"delete":[]}],"core\/src\/test\/java\/hudson\/UtilTest.java":[{"add":["26","import java.nio.file.Files;","27","import java.nio.file.Path;","260","    public void testEscapeCmdArgument() {","261","        String raw = \"hello \\\"\\\\world&\";","262","        String expected = \"^\\\"hello ^\\\"\\\\world^&^\\\"\";","263","        String actual = Util.escapeCmdArgument(raw);","264","        assertEquals(expected, actual);","265","    }","266","","267","    @Test","270","        File targetDir = tmp.newFolder(\"targetDir\");","272","        File junction = Util.createJunction(new File(d, \"junction\"), targetDir);","273","        assertTrue(Util.isSymlink(junction));","274","    }","275","","276","    @Test","277","    @Issue(\"JENKINS-55448\")","278","    public void testIsSymlink_ParentIsJunction() throws IOException, InterruptedException {","279","        Assume.assumeTrue(\"Uses Windows-specific features\", Functions.isWindows());","280","        File targetDir = tmp.newFolder();","281","        File file = new File(targetDir, \"test-file\");","282","        new FilePath(file).touch(System.currentTimeMillis());","283","        File dir = tmp.newFolder();","284","        File junction = Util.createJunction(new File(dir, \"junction\"), targetDir);","285","","286","        assertTrue(Util.isSymlink(junction));","287","        assertFalse(Util.isSymlink(file));","288","    }","289","","290","    @Test","291","    @Issue(\"JENKINS-55448\")","292","    public void testIsSymlink_ParentIsSymlink() throws IOException, InterruptedException {","293","        File folder = tmp.newFolder();","294","        File file = new File(folder, \"test-file\");","295","        new FilePath(file).touch(System.currentTimeMillis());","296","        Path link = tmp.getRoot().toPath().resolve(\"sym-link\");","297","        Path pathWithSymlinkParent = Files.createSymbolicLink(link, folder.toPath()).resolve(\"test-file\");","298","        assertTrue(Util.isSymlink(link));","299","        assertFalse(Util.isSymlink(pathWithSymlinkParent));"],"delete":["260","        tmp.newFolder(\"targetDir\");","262","        Process p = new ProcessBuilder()","263","                .directory(d)","264","                .command(\"cmd.exe\", \"\/C\", \"mklink \/J junction ..\\\\targetDir\")","265","                .start();","266","        Assume.assumeThat(\"unable to create junction\", p.waitFor(), is(0));","267","        assertTrue(Util.isSymlink(new File(d, \"junction\")));"]}],"core\/src\/test\/java\/hudson\/FilePathTest.java":[{"add":["838","        File junction = Util.createJunction(toDelete.resolve(\"junction\").toFile(), targetDir.toFile());","845","        assertFalse(\"could not delete junction\", junction.exists());"],"delete":["838","        Process p = new ProcessBuilder()","839","                .directory(toDelete.toFile())","840","                .command(\"cmd.exe\", \"\/C\", \"mklink \/J junction ..\\\\targetDir\")","841","                .start();","842","        assumeThat(\"unable to create junction\", p.waitFor(), is(0));"]}],"core\/src\/test\/java\/hudson\/RemoveWindowsDirectoryJunctionTest.java":[{"add":["34","        File j1 = Util.createJunction(tmp.getRoot(), subdir1);"],"delete":["5","import static org.junit.Assert.assertEquals;","35","        File j1 = makeJunction(tmp.getRoot(), subdir1);","41","    private File makeJunction(File baseDir, File pointToDir) throws Exception {","42","       File junc = new File(baseDir, \"test Junction\");","43","       String cmd = \"mklink \/J \\\"\" + junc.getPath() + \"\\\" \\\"\" + pointToDir.getPath() + \"\\\"\";","44","       ProcessBuilder pb = new ProcessBuilder(\"cmd.exe\", \"\/C\", cmd);","45","       pb.inheritIO();","46","       Process p = pb.start();","47","       assertEquals(\"Running mklink failed (cmd=\" + cmd + \")\", 0, p.waitFor());","48","       return junc;","49","    }"]}]}},"f97a7437fbf46cfd95d87ca3b9a629b5c20cab96":{"changes":{"core\/src\/main\/resources\/hudson\/model\/BuildTimelineWidget\/control.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/BuildTimelineWidget\/control.jelly":[{"add":[],"delete":["80","                date:           d,"]}]}}}