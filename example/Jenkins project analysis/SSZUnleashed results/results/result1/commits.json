{"aad53296de3603014d07224b8816c62265315963":{"changes":{"core\/src\/main\/java\/hudson\/DependencyRunner.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/DependencyRunner.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi,","4"," * Brian Westrich, Jean-Baptiste Quenot","28","import hudson.security.ACL;","36","import org.acegisecurity.Authentication;","37","import org.acegisecurity.context.SecurityContextHolder;","55","        Authentication saveAuth = SecurityContextHolder.getContext().getAuthentication();","56","        SecurityContextHolder.getContext().setAuthentication(ACL.SYSTEM);","57","","58","        try {","59","            Set<AbstractProject> topLevelProjects = new HashSet<AbstractProject>();","60","            \/\/ Get all top-level projects","61","            LOGGER.fine(\"assembling top level projects\");","62","            for (AbstractProject p : Hudson.getInstance().getAllItems(AbstractProject.class))","63","                if (p.getUpstreamProjects().size() == 0) {","64","                    LOGGER.fine(\"adding top level project \" + p.getName());","65","                    topLevelProjects.add(p);","66","                } else {","67","                    LOGGER.fine(\"skipping project since not a top level project: \" + p.getName());","68","                }","69","            populate(topLevelProjects);","70","            for (AbstractProject p : polledProjects) {","71","                    LOGGER.fine(\"running project in correct dependency order: \" + p.getName());","72","                runnable.run(p);","74","        } finally {","75","            SecurityContextHolder.getContext().setAuthentication(saveAuth);","88","            LOGGER.fine(\"adding project \" + p.getName());"],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Brian Westrich, Jean-Baptiste Quenot","51","        Set<AbstractProject> topLevelProjects = new HashSet<AbstractProject>();","52","        \/\/ Get all top-level projects","53","    \tLOGGER.fine(\"assembling top level projects\");","54","        for (AbstractProject p : Hudson.getInstance().getAllItems(","55","                    AbstractProject.class))","56","            if (p.getUpstreamProjects().size() == 0) {","57","            \tLOGGER.fine(\"adding top level project \" + p.getName());","58","                topLevelProjects.add(p);","59","            } else { ","60","            \tLOGGER.fine(\"skipping project since not a top level project: \" ","61","            \t\t\t+ p.getName());","63","        populate(topLevelProjects);","64","        for (AbstractProject p : polledProjects) {","65","        \tLOGGER.fine(\"running project in correct dependency order: \" + p.getName());","66","            runnable.run(p);","79","        \tLOGGER.fine(\"adding project \" + p.getName());"]}]}},"0d9beb20ab86a522d019df6dc6e467c3184f0b5b":{"changes":{"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/entry.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/entry.jelly":[{"add":["62","            <!-- Check CANCEL permission for Project, Admin permission otherwise -->","63","            <j:if test=\"${empty(it.widget.owner.CANCEL) ? h.hasPermission(app.ADMINISTER) : it.widget.owner.hasPermission(it.widget.owner.CANCEL)}\">"],"delete":["62","            <!-- Check ABORT permission for Project, Admin permission otherwise -->","63","            <j:if test=\"${empty(it.widget.owner.ABORT) ? h.hasPermission(app.ADMINISTER) : it.widget.owner.hasPermission(it.widget.owner.ABORT)}\">"]}]}},"3af3a27116ccec048ce9eb61f947d74e0fe37611":{"changes":{"core\/src\/main\/resources\/lib\/hudson\/buildCaption.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/widgets\/BuildHistoryWidget\/entries.properties":"ADD","core\/src\/main\/resources\/lib\/hudson\/executors.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/entry.jelly":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/queue.properties":"MODIFY","core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/entry.properties":"ADD","core\/src\/main\/resources\/lib\/hudson\/executors.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/buildCaption.properties":"ADD","core\/src\/main\/resources\/lib\/layout\/stopButton.jelly":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/queue.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/hudson\/buildCaption.jelly":[{"add":["39","              <l:stopButton href=\"stop\" confirm=\"${%confirm(it.fullDisplayName)}\" alt=\"[${%cancel}]\"\/>"],"delete":["39","              <l:stopButton href=\"stop\" alt=\"[${%cancel}]\"\/>"]}],"core\/src\/main\/resources\/hudson\/widgets\/BuildHistoryWidget\/entries.properties":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/lib\/hudson\/executors.jelly":[{"add":["112","                    <l:stopButton href=\"${rootURL}\/${c.url}${url}\/stop\" confirm=\"${%confirm(exe.fullDisplayName)}\" alt=\"${%terminate this build}\"  \/>"],"delete":["112","                    <l:stopButton href=\"${rootURL}\/${c.url}${url}\/stop\" alt=\"${%terminate this build}\"\/>"]}],"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/entry.jelly":[{"add":["63","            <j:if test=\"${empty(it.widget.owner.ABORT) ? h.hasPermission(app.ADMINISTER) : it.widget.owner.hasPermission(it.widget.owner.ABORT)}\">","64","              <l:stopButton href=\"${link}stop\" alt=\"[cancel]\" confirm=\"${%confirm(build.fullDisplayName)}\" \/>"],"delete":["63","\t    <j:if test=\"${empty(it.widget.owner.ABORT) ? h.hasPermission(app.ADMINISTER) : it.widget.owner.hasPermission(it.widget.owner.ABORT)}\">","64","              <l:stopButton href=\"${link}stop\" alt=\"[cancel]\"\/>"]}],"core\/src\/main\/resources\/lib\/hudson\/queue.properties":[{"add":["2","WaitingFor=Waiting for {0}","3","confirm=Are you sure you want to cancel the queued run of {0}?"],"delete":["2","WaitingFor=Waiting for {0}"]}],"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/entry.properties":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/lib\/hudson\/executors.properties":[{"add":["0","Computers=master{0,choice,0#|1# + {0,number} computer ({1} of {2} executors)|1< + {0,number} computers ({1} of {2} executors)}","1","confirm=Are you sure you want to abort {0}?"],"delete":["0","Computers=master{0,choice,0#|1# + {0,number} computer ({1} of {2} executors)|1< + {0,number} computers ({1} of {2} executors)}"]}],"core\/src\/main\/resources\/lib\/hudson\/buildCaption.properties":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/lib\/layout\/stopButton.jelly":[{"add":["35","        <st:attribute name=\"confirm\" use=\"optional\">","36","            If defined, the user will be asked for confirmation first, and the value will be used as question.","37","        <\/st:attribute>","39","    <j:choose>","40","      <j:when test=\"${confirm == null}\">","41","        <a class=\"stop-button-link\" href=\"${href}\" onclick='new Ajax.Request(\"${href}\"); return false;'>","42","          <l:icon class=\"icon-stop icon-sm\"\/>","43","        <\/a>","44","      <\/j:when>","45","      <j:otherwise>","46","          <a class=\"stop-button-link\" href=\"${href}\" onclick='if(confirm(\"${confirm}\"))new Ajax.Request(\"${href}\"); return false;'>","47","            <l:icon class=\"icon-stop icon-sm\"\/>","48","          <\/a>","49","      <\/j:otherwise>","50","    <\/j:choose>"],"delete":["36","    <a class=\"stop-button-link\" href=\"${href}\" onclick=\"new Ajax.Request(this.href); return false\">","37","        <l:icon class=\"icon-stop icon-sm\"\/>","38","    <\/a>"]}],"core\/src\/main\/resources\/lib\/hudson\/queue.jelly":[{"add":["93","                <l:stopButton href=\"${rootURL}\/queue\/cancelItem?id=${item.id}\" confirm=\"${%confirm(item.task.fullDisplayName)}\" alt=\"cancel this build\"\/>"],"delete":["93","                <l:stopButton href=\"${rootURL}\/queue\/cancelItem?id=${item.id}\" alt=\"cancel this build\"\/>"]}]}},"c064d88a3b418e4cc6e3a75b4faa7db4c69880f2":{"changes":{"core\/src\/main\/java\/jenkins\/model\/JenkinsLocationConfiguration.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/JenkinsLocationConfiguration.java":[{"add":["43","    \/**","44","     * Gets local configuration.","45","     * ","46","     * @return {@code null} if the {@link GlobalConfiguration#all()} list does not contain this extension.","47","     *         Most likely it means that the Jenkins instance has not been fully loaded yet.","48","     *\/"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["2328","     * @return {@code null} if this parameter is not configured by the user and the calling thread is not in an HTTP request; ","2329","     *                      otherwise the returned URL will always have the trailing {@code \/}","2330","     * @throws IllegalStateException {@link JenkinsLocationConfiguration} cannot be retrieved.","2331","     *                      Jenkins instance may be not ready, or there is an extension loading glitch.","2335","    public @Nullable String getRootUrl() throws IllegalStateException {","2336","        final JenkinsLocationConfiguration config = JenkinsLocationConfiguration.get();","2337","        if (config == null) {","2338","            \/\/ Try to get standard message if possible","2339","            final Jenkins j = Jenkins.getInstance();","2340","            throw new IllegalStateException(\"Jenkins instance \" + j + \" has been successfully initialized, but JenkinsLocationConfiguration is undefined.\");","2341","        }","2342","        String url = config.getUrl();"],"delete":["2328","     * @return null if this parameter is not configured by the user and the calling thread is not in an HTTP request; otherwise the returned URL will always have the trailing {@code \/}","2332","    public @Nullable String getRootUrl() {","2333","        String url = JenkinsLocationConfiguration.get().getUrl();"]}]}},"d30e2ab9b1c5117cc79beb8868ca7be7e7506dcf":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/Maven.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/Maven.java":[{"add":["3","import hudson.FilePath.FileCallable;","4","import hudson.Functions;","11","import hudson.remoting.VirtualChannel;","13","import hudson.util.FormFieldValidator;","21","import java.util.StringTokenizer;","61","    \/**","62","     * Looks for <tt>pom.xlm<\/tt> or <tt>project.xml<\/tt> to determine the maven executable","63","     * name.","64","     *\/","65","    private static final class DecideDefaultMavenCommand implements FileCallable<String> {","66","        \/\/ command line arguments.","67","        private final String arguments;","69","        public DecideDefaultMavenCommand(String arguments) {","70","            this.arguments = arguments;","71","        }","72","","73","        public String invoke(File ws, VirtualChannel channel) throws IOException {","74","            String seed=null;","75","","76","            \/\/ check for the -f option","77","            StringTokenizer tokens = new StringTokenizer(arguments);","78","            while(tokens.hasMoreTokens()) {","79","                String t = tokens.nextToken();","80","                if(t.equals(\"-f\") && tokens.hasMoreTokens()) {","81","                    File file = new File(ws,tokens.nextToken());","82","                    if(!file.exists())","83","                        continue;   \/\/ looks like an error, but let the execution fail later","84","                    if(file.isDirectory())","85","                        \/\/ in M1, you specify a directory in -f","86","                        seed = \"maven\";","87","                    else","88","                        \/\/ in M2, you specify a POM file name.","89","                        seed = \"mvn\";","90","                    break;","91","                }","92","            }","93","","94","            if(seed==null) {","95","                if(new File(ws,\"pom.xml\").exists())","96","                    seed = \"mvn\";","97","                else","98","                    \/\/ err on Maven 1 to be closer to the behavior in < 1.81","99","                    seed = \"maven\";","100","            }","101","","102","            if(Functions.isWindows())","103","                seed += \".bat\";","104","            return seed;","105","        }","106","    }","107","","108","    public boolean perform(Build build, Launcher launcher, BuildListener listener) throws IOException, InterruptedException {","109","        Project proj = build.getProject();","116","            String execName = proj.getWorkspace().act(new DecideDefaultMavenCommand(normalizedTarget));"],"delete":["9","import hudson.util.FormFieldValidator;","57","    public boolean perform(Build build, Launcher launcher, BuildListener listener) {","58","        Project proj = build.getProject();","60","        String execName;","61","        if(launcher.isUnix())","62","            execName = \"maven\";","63","        else","64","            execName = \"maven.bat\";"]}]}},"73c4de32cae7bb405433c546be636dbb2dc83ec8":{"changes":{"\/dev\/null":"DELETE","core\/src\/main\/resources\/dsld\/eclipse.dsld":"ADD"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/dsld\/eclipse.dsld":[{"add":[],"delete":[]}]}},"55aef4bb5c5c00cb7f76afb087defc67e9c19dbb":{"changes":{"core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi, Stephen Connolly, Tom Huybrechts","50","import org.kohsuke.stapler.HttpResponses;","495","    public HttpResponse doProxyConfigure(","499","            @QueryParameter(\"proxy.password\") String password) throws IOException {","507","        } else try {","508","            hudson.proxy = new ProxyConfiguration(server,Integer.parseInt(Util.fixNull(port)),","511","        } catch (NumberFormatException nfe) {","512","            return HttpResponses.error(StaplerResponse.SC_BAD_REQUEST,","513","                    new IllegalArgumentException(\"Invalid proxy port: \" + port, nfe));","515","        return new HttpRedirect(\"advanced\");"],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Stephen Connolly, Tom Huybrechts","494","    public void doProxyConfigure(","498","            @QueryParameter(\"proxy.password\") String password,","499","            StaplerResponse rsp) throws IOException {","507","        } else {","508","            hudson.proxy = new ProxyConfiguration(server,Integer.parseInt(Util.fixEmptyAndTrim(port)),","512","        rsp.sendRedirect(\".\/advanced\");"]}]}},"1689f6b7a21fc910a186e092227780c614ed7443":{"changes":{"core\/src\/main\/java\/hudson\/TcpSlaveAgentListener.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/TcpSlaveAgentListener.java":[{"add":["172","                client.setSoTimeout(1000); \/\/ waking the acceptor loop should be quick"],"delete":[]}]}},"82aca6421da3c4f889d79a34197157928d5c4436":{"changes":{"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/config.jelly":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":"MODIFY","core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/config.properties":"ADD","core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-defaultExcludes.groovy":"ADD","core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-caseSensitive.html":"ADD","core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-excludes.html":"ADD","core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":"MODIFY","core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-defaultExcludes.properties":"ADD"},"diff":{"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/config.jelly":[{"add":["28","  <f:advanced>","29","    <f:entry title=\"${%Excludes}\" field=\"excludes\">","30","      <f:textbox \/>","31","    <\/f:entry>","32","    <f:entry field=\"defaultExcludes\" >","33","      <f:checkbox title=\"${%defaultExcludes}\" default=\"true\"\/>","34","    <\/f:entry>","35","    <f:entry field=\"caseSensitive\" >","36","      <f:checkbox title=\"${%caseSensitive}\" default=\"true\"\/>","37","    <\/f:entry>","38","  <\/f:advanced>"],"delete":[]}],"core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":[{"add":["61","import org.kohsuke.stapler.DataBoundSetter;","95","    \/**","96","     * Default null 'excludes' pattern as in Ant.","97","     *\/","98","    private String excludes = null;","99","","100","    \/**","101","     * Default ant exclusion","102","     *\/","103","    private Boolean defaultExcludes = true;","104","","105","    \/**","106","     * Indicate whether include and exclude patterns should be considered as case sensitive","107","     *\/","108","    private Boolean caseSensitive = true;","109","","117","    @DataBoundSetter public void setExcludes(String excludes) {","118","        this.excludes = Util.fixEmpty(excludes);","119","    }","120","","121","    @DataBoundSetter public void setDefaultExcludes(boolean defaultExcludes) {","122","        this.defaultExcludes = defaultExcludes;","123","    }","124","","125","    @DataBoundSetter public void setCaseSensitive(boolean caseSensitive) {","126","        this.caseSensitive = caseSensitive;","127","    }","128","","139","    public String getExcludes() {","140","        return excludes;","141","    }","142","","143","    public boolean getDefaultExcludes() {","144","        return defaultExcludes;","145","    }","146","","147","    public boolean getCaseSensitive() {","148","        return caseSensitive;","149","    }","150","","151","    \/**","152","     * We ensure that fields are initialized to","153","     * default values after deserialization.","154","     *\/","155","    private Object readResolve() {","156","        if(defaultExcludes == null) {","157","            defaultExcludes = true;","158","        }","159","        if(caseSensitive == null) {","160","            caseSensitive = true;","161","        }","162","        return this;","163","    }","164","","269","        private final String excludes;","270","        private final boolean defaultExcludes;","271","        private final boolean caseSensitive;","274","        FindRecords(String targets, String excludes, boolean defaultExcludes, boolean caseSensitive, long buildTimestamp) {","276","            this.excludes = excludes;","277","            this.defaultExcludes = defaultExcludes;","278","            this.caseSensitive = caseSensitive;","286","            FileSet src = Util.createFileSet(baseDir, targets, excludes);","287","            src.setDefaultexcludes(defaultExcludes);","288","            src.setCaseSensitive(caseSensitive);","314","        for (Record r : ws.act(new FindRecords(targets, excludes, defaultExcludes, caseSensitive, build.getTimeInMillis()))) {"],"delete":["217","        FindRecords(String targets, long buildTimestamp) {","226","            FileSet src = Util.createFileSet(baseDir,targets);","252","        for (Record r : ws.act(new FindRecords(targets, build.getTimeInMillis()))) {"]}],"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/config.properties":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-defaultExcludes.groovy":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-caseSensitive.html":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-excludes.html":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":[{"add":["236","                    Fingerprinter f = new Fingerprinter(artifacts);","237","                    f.setExcludes(excludes);","238","                    f.setDefaultExcludes(defaultExcludes);","239","                    f.setCaseSensitive(caseSensitive);","240","                    f.perform(build, ws, launcher, listener);"],"delete":["236","                    new Fingerprinter(artifacts).perform(build, ws, launcher, listener);"]}],"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/help-defaultExcludes.properties":[{"add":[],"delete":[]}]}},"decf902ab797b1ef5f5fb8f5c1651520c0fe33f2":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY"},"diff":{"changelog.html":[{"add":["61","    Linkage errors in notifiers could leak workspace leases.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-21622\">issue 21622<\/a>)","63","  <li class=bug>"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["714","                        reportError(bs, e, listener, phase);","715","                    } catch (LinkageError e) {","716","                        reportError(bs, e, listener, phase);","722","        private void reportError(BuildStep bs, Throwable e, BuildListener listener, boolean phase) {","723","            String msg = \"Publisher \" + bs.getClass().getName() + \" aborted due to exception\";","724","            e.printStackTrace(listener.error(msg));","725","            LOGGER.log(WARNING, msg, e);","726","            if (phase) {","727","                setResult(Result.FAILURE);","728","            }","729","        }","730",""],"delete":["714","                        String msg = \"Publisher \" + bs.getClass().getName() + \" aborted due to exception\";","715","                        e.printStackTrace(listener.error(msg));","716","                        LOGGER.log(WARNING, msg, e);","717","                        if (phase) {","718","                            setResult(Result.FAILURE);","719","                        }"]}]}},"31cd4d3d788a8dc28d0109e47971a0db84afaea0":{"changes":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":"MODIFY","core\/pom.xml":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":[{"add":["146","    private final int softkillWaitSeconds = 2 * 60; \/\/ processes get at most 2 minutes to respond to SIGTERM (JENKINS-17116)","147","","505","            \/\/ Firstly try to kill the root process gracefully, then do a forcekill if it does not help (algorithm is described in JENKINS-17116)","506","            killSoftly();","518","            \/\/ Firstly try to kill it gracefully, then do a forcekill if it does not help (algorithm is described in JENKINS-17116)","519","            killSoftly();","524","        private void killSoftly() throws InterruptedException {","525","            \/\/ send Ctrl+C to the process","526","            try {","527","                if (!p.sendCtrlC()) {","528","                    return;","529","                }","530","            }","531","            catch (WinpException e) {","532","                if (LOGGER.isLoggable(Level.FINE)) {","533","                    LOGGER.log(Level.FINE, \"Failed to send CTRL+C to pid=\" + getPid(), e);","534","                }","535","                return;","536","            }","537","","538","            \/\/ after that wait for it to cease to exist","539","            long deadline = System.nanoTime() + softkillWaitSeconds * 1000000000;","540","            int sleepTime = 10; \/\/ initially we sleep briefly, then sleep up to 1sec","541","            do {","542","                if (!p.isRunning()) {","543","                    break;","544","                }","545","","546","                Thread.sleep(sleepTime);","547","                sleepTime = Math.min(sleepTime * 2, 1000);","548","            } while (System.nanoTime() < deadline);","549","        }","550","","759","                \/\/ after sending SIGTERM, wait for the process to cease to exist","760","                long deadline = System.nanoTime() + softkillWaitSeconds * 1000000000;","761","                int sleepTime = 10; \/\/ initially we sleep briefly, then sleep up to 1sec","762","                do {","763","                    File f = getFile(\"status\");","764","                    if (!f.exists()) {","765","                        break; \/\/ status is gone, process therefore as well","766","                    }","767","","768","                    Thread.sleep(sleepTime);","769","                    sleepTime = Math.min(sleepTime * 2, 1000);","770","                } while (System.nanoTime() < deadline);"],"delete":[]}],"core\/pom.xml":[{"add":["517","      <version>1.27<\/version>"],"delete":["517","      <version>1.26<\/version>"]}]}},"ef9c30c665c4a5c59e1a1af54072b95831eed831":{"changes":{"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":[{"add":["29","import hudson.security.*;","30","import hudson.tasks.BuildTrigger;","41","","42","import jenkins.model.Jenkins;","43","import org.acegisecurity.context.SecurityContext;","44","import org.acegisecurity.context.SecurityContextHolder;","52","import java.util.Collections;","53","import java.util.HashMap;","54","import java.util.Map;","55","import java.util.Set;","296","","297","    @Bug(13502)","298","    public void testHandleBuildTrigger() throws Exception {","299","        Project u = createFreeStyleProject(\"u\"),","300","                d = createFreeStyleProject(\"d\"),","301","                e = createFreeStyleProject(\"e\");","302","","303","        u.addPublisher(new BuildTrigger(\"d\", Result.SUCCESS));","304","","305","        jenkins.setSecurityRealm(createDummySecurityRealm());","306","        ProjectMatrixAuthorizationStrategy authorizations = new ProjectMatrixAuthorizationStrategy();","307","        jenkins.setAuthorizationStrategy(authorizations);","308","","309","        authorizations.add(Jenkins.ADMINISTER, \"admin\");","310","        authorizations.add(Jenkins.READ, \"user\");","311","","312","        \/\/ user can READ u and CONFIGURE e","313","        Map<Permission, Set<String>> permissions = new HashMap<Permission, Set<String>>();","314","        permissions.put(Job.READ, Collections.singleton(\"user\"));","315","        u.addProperty(new AuthorizationMatrixProperty(permissions));","316","","317","        permissions = new HashMap<Permission, Set<String>>();","318","        permissions.put(Job.CONFIGURE, Collections.singleton(\"user\"));","319","        e.addProperty(new AuthorizationMatrixProperty(permissions));","320","","321","        User user = User.get(\"user\");","322","        SecurityContext sc = ACL.impersonate(user.impersonate());","323","        try {","324","            e.convertUpstreamBuildTrigger(Collections.<AbstractProject>emptySet());","325","        } finally {","326","            SecurityContextHolder.setContext(sc);","327","        }","328","","329","        assertEquals(1, u.getPublishersList().size());","330","    }"],"delete":["29","import hudson.security.GlobalMatrixAuthorizationStrategy;"]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["65","import hudson.security.ACL;","91","import org.acegisecurity.context.SecurityContext;","92","import org.acegisecurity.context.SecurityContextHolder;","752","        convertUpstreamBuildTrigger(upstream);","762","    \/**","763","     * Reflect the submission of the pseudo 'upstream build trigger'.","764","     *\/","765","    \/* package *\/ void convertUpstreamBuildTrigger(Set<AbstractProject> upstream) throws IOException {","766","","767","        SecurityContext saveCtx = ACL.impersonate(ACL.SYSTEM);","768","        try {","769","            for (AbstractProject<?,?> p : Jenkins.getInstance().getAllItems(AbstractProject.class)) {","770","                \/\/ Don't consider child projects such as MatrixConfiguration:","771","                if (!p.isConfigurable()) continue;","772","                boolean isUpstream = upstream.contains(p);","773","                synchronized(p) {","774","                    \/\/ does 'p' include us in its BuildTrigger?","775","                    DescribableList<Publisher,Descriptor<Publisher>> pl = p.getPublishersList();","776","                    BuildTrigger trigger = pl.get(BuildTrigger.class);","777","                    List<AbstractProject> newChildProjects = trigger == null ? new ArrayList<AbstractProject>():trigger.getChildProjects(p);","778","                    if(isUpstream) {","779","                        if(!newChildProjects.contains(this))","780","                            newChildProjects.add(this);","781","                    } else {","782","                        newChildProjects.remove(this);","783","                    }","784","","785","                    if(newChildProjects.isEmpty()) {","786","                        pl.remove(BuildTrigger.class);","787","                    } else {","788","                        \/\/ here, we just need to replace the old one with the new one,","789","                        \/\/ but there was a regression (we don't know when it started) that put multiple BuildTriggers","790","                        \/\/ into the list. For us not to lose the data, we need to merge them all.","791","                        List<BuildTrigger> existingList = pl.getAll(BuildTrigger.class);","792","                        BuildTrigger existing;","793","                        switch (existingList.size()) {","794","                        case 0:","795","                            existing = null;","796","                            break;","797","                        case 1:","798","                            existing = existingList.get(0);","799","                            break;","800","                        default:","801","                            pl.removeAll(BuildTrigger.class);","802","                            Set<AbstractProject> combinedChildren = new HashSet<AbstractProject>();","803","                            for (BuildTrigger bt : existingList)","804","                                combinedChildren.addAll(bt.getChildProjects(p));","805","                            existing = new BuildTrigger(new ArrayList<AbstractProject>(combinedChildren),existingList.get(0).getThreshold());","806","                            pl.add(existing);","807","                            break;","808","                        }","809","","810","                        if(existing!=null && existing.hasSame(p,newChildProjects))","811","                            continue;   \/\/ no need to touch","812","                        pl.replace(new BuildTrigger(newChildProjects,","813","                            existing==null? Result.SUCCESS:existing.getThreshold()));","814","                    }","815","                }","816","            }","817","        } finally {","818","            SecurityContextHolder.setContext(saveCtx);","819","        }","820","    }","821","","822","    \/**"],"delete":["750","        \/\/ reflect the submission of the pseudo 'upstream build trriger'.","751","        \/\/ this needs to be done after we release the lock on 'this',","752","        \/\/ or otherwise we could dead-lock","753","","754","        for (AbstractProject<?,?> p : Jenkins.getInstance().getAllItems(AbstractProject.class)) {","755","            \/\/ Don't consider child projects such as MatrixConfiguration:","756","            if (!p.isConfigurable()) continue;","757","            boolean isUpstream = upstream.contains(p);","758","            synchronized(p) {","759","                \/\/ does 'p' include us in its BuildTrigger? ","760","                DescribableList<Publisher,Descriptor<Publisher>> pl = p.getPublishersList();","761","                BuildTrigger trigger = pl.get(BuildTrigger.class);","762","                List<AbstractProject> newChildProjects = trigger == null ? new ArrayList<AbstractProject>():trigger.getChildProjects(p);","763","                if(isUpstream) {","764","                    if(!newChildProjects.contains(this))","765","                        newChildProjects.add(this);","766","                } else {","767","                    newChildProjects.remove(this);","768","                }","769","","770","                if(newChildProjects.isEmpty()) {","771","                    pl.remove(BuildTrigger.class);","772","                } else {","773","                    \/\/ here, we just need to replace the old one with the new one,","774","                    \/\/ but there was a regression (we don't know when it started) that put multiple BuildTriggers","775","                    \/\/ into the list.","776","                    \/\/ for us not to lose the data, we need to merge them all.","777","                    List<BuildTrigger> existingList = pl.getAll(BuildTrigger.class);","778","                    BuildTrigger existing;","779","                    switch (existingList.size()) {","780","                    case 0:","781","                        existing = null;","782","                        break;","783","                    case 1:","784","                        existing = existingList.get(0);","785","                        break;","786","                    default:","787","                        pl.removeAll(BuildTrigger.class);","788","                        Set<AbstractProject> combinedChildren = new HashSet<AbstractProject>();","789","                        for (BuildTrigger bt : existingList)","790","                            combinedChildren.addAll(bt.getChildProjects(p));","791","                        existing = new BuildTrigger(new ArrayList<AbstractProject>(combinedChildren),existingList.get(0).getThreshold());","792","                        pl.add(existing);","793","                        break;","794","                    }","795","","796","                    if(existing!=null && existing.hasSame(p,newChildProjects))","797","                        continue;   \/\/ no need to touch","798","                    pl.replace(new BuildTrigger(newChildProjects,","799","                        existing==null?Result.SUCCESS:existing.getThreshold()));","800","                }","801","            }","802","        }","811","\t\/**"]}],"changelog.html":[{"add":["75","  <li class=bug>","76","    Fix dependency graph computation when upstream build trigger is involved","77","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-13502\">issue 13502<\/a>)"],"delete":[]}]}},"7228af5bb1c4f9058bd35be50a7f9239f4345e04":{"changes":{"core\/src\/main\/java\/hudson\/Util.java":"MODIFY","core\/src\/main\/java\/jenkins\/util\/io\/PathRemover.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Util.java":[{"add":["1581","     * The number of additional times we will attempt to delete files\/directory trees","1583","     * Specifying a value less than 0 is invalid and will be treated as if","1584","     * a value of 0 (i.e. one attempt, no retries) was specified.","1595","    static int DELETION_RETRIES = Math.max(0, SystemProperties.getInteger(Util.class.getName() + \".maxFileDeletionRetries\", 2));","1600","     * This has no effect unless {@link #DELETION_RETRIES} is non-zero.","1613","     * {@link #DELETION_RETRIES} is non zero.","1634","        return PathRemover.newFilteredRobustRemover(pathChecker, DELETION_RETRIES, GC_AFTER_FAILED_DELETE, WAIT_BETWEEN_DELETION_RETRIES);"],"delete":["1581","     * The number of times we will attempt to delete files\/directory trees","1583","     * Specifying a value less than 1 is invalid and will be treated as if","1584","     * a value of 1 (i.e. one attempt, no retries) was specified.","1595","    static int DELETION_MAX = Math.max(1, SystemProperties.getInteger(Util.class.getName() + \".maxFileDeletionRetries\", 3));","1600","     * This has no effect unless {@link #DELETION_MAX} is non-zero.","1613","     * {@link #DELETION_MAX} is greater than 1.","1634","        return PathRemover.newFilteredRobustRemover(pathChecker, DELETION_MAX - 1, GC_AFTER_FAILED_DELETE, WAIT_BETWEEN_DELETION_RETRIES);"]}],"core\/src\/main\/java\/jenkins\/util\/io\/PathRemover.java":[{"add":["63","        return new PathRemover(new PausingGCRetryStrategy(Math.max(maxRetries, 0), gcAfterFailedRemove, waitBetweenRetries), pathChecker);"],"delete":["63","        return new PathRemover(new PausingGCRetryStrategy(Math.max(maxRetries, 1), gcAfterFailedRemove, waitBetweenRetries), pathChecker);"]}]}},"88c2d8ed043011ed7d3889776725477df5b58156":{"changes":{"test\/src\/test\/resources\/lib\/form\/FormTest\/InputsCanSetAutocomplete\/index.jelly":"ADD","core\/src\/main\/resources\/lib\/form\/form.jelly":"MODIFY","test\/src\/test\/java\/lib\/form\/FormTest.java":"ADD","test\/src\/test\/resources\/lib\/form\/FormTest\/AutocompleteOffByDefault\/index.jelly":"ADD","test\/src\/test\/resources\/lib\/form\/FormTest\/AutocompleteOnWhenTrue\/index.jelly":"ADD"},"diff":{"test\/src\/test\/resources\/lib\/form\/FormTest\/InputsCanSetAutocomplete\/index.jelly":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/lib\/form\/form.jelly":[{"add":["50","    <st:attribute name=\"autocomplete\">","51","      Optional attribute for allowing browsers to perform auto complete or pre-fill the form from history.","52","      Default: false","53","    <\/st:attribute>","55","  <form action=\"${action}\" method=\"${method}\" enctype=\"${attrs.enctype}\" name=\"${name}\" target=\"${attrs.target}\" autocomplete=\"${attrs.autocomplete==true?'on':'off'}\">"],"delete":["51","  <form action=\"${action}\" method=\"${method}\" enctype=\"${attrs.enctype}\" name=\"${name}\" target=\"${attrs.target}\">"]}],"test\/src\/test\/java\/lib\/form\/FormTest.java":[{"add":[],"delete":[]}],"test\/src\/test\/resources\/lib\/form\/FormTest\/AutocompleteOffByDefault\/index.jelly":[{"add":[],"delete":[]}],"test\/src\/test\/resources\/lib\/form\/FormTest\/AutocompleteOnWhenTrue\/index.jelly":[{"add":[],"delete":[]}]}},"0d8667e8ffc790abf22d0dfff7f3f975c76a553a":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Job\/buildHistory.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Job\/buildHistory.jelly":[{"add":["32","    <j:set var=\"url\" value=\"${h.getNearestAncestorUrl(request,it)}\"\/>","34","      <j:set var=\"link\" value=\"${url}\/${build.number}\/\" \/>"],"delete":["33","      <j:set var=\"link\" value=\"${rootURL}\/${it.url}${build.number}\/\" \/>"]}]}},"01a47af8b699ca7cb07a240446e8ed5aaca7aceb":{"changes":{"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":[{"add":["24","import hudson.util.*;","125","        this.flatten = !legacy && getAllModulesNormalized().length==1;","496","            throw new IOException2(e);"],"delete":["24","import hudson.util.ArgumentListBuilder;","25","import hudson.util.ByteBuffer;","26","import hudson.util.ForkOutputStream;","27","import hudson.util.FormFieldValidator;","66","import java.util.StringTokenizer;","129","        this.flatten = !legacy && new StringTokenizer(module).countTokens()==1;","500","            throw new IOException(e);"]}]}},"c4dffa48bb59c2cdcc411a20b808579fa68a7057":{"changes":{"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/ParametersAction\/index.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/widgets\/HistoryWidget\/index.jelly":[{"add":["3","Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi,","4","Seiji Sogabe, id:cactusman, Yahoo! Inc.","24","<?jelly escape-by-default='true'?>","28","    <j:invokeStatic var=\"currentThread\" className=\"java.lang.Thread\" method=\"currentThread\"\/>","29","    <j:invoke var=\"jobClass\" on=\"${currentThread.contextClassLoader}\" method=\"loadClass\">","31","    <\/j:invoke>"],"delete":["3","Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi, Seiji Sogabe, id:cactusman, Yahoo! Inc.","23","","27","    <j:invokeStatic var=\"jobClass\" className=\"java.lang.Class\" method=\"forName\">","29","    <\/j:invokeStatic>"]}],"core\/src\/main\/resources\/hudson\/model\/ParametersAction\/index.jelly":[{"add":["3","Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi,","4","Seiji Sogabe, Tom Huybrechts","24","<?jelly escape-by-default='true'?>","26","    xmlns:l=\"\/lib\/layout\" xmlns:t=\"\/lib\/hudson\" xmlns:f=\"\/lib\/form\"","27","    xmlns:i=\"jelly:fmt\" xmlns:p=\"\/lib\/hudson\/project\">","28","  <l:layout title=\"${it.displayName}\">","29","    <j:invokeStatic var=\"currentThread\" className=\"java.lang.Thread\" method=\"currentThread\" \/>","30","    <j:invoke var=\"buildClass\" on=\"${currentThread.contextClassLoader}\" method=\"loadClass\">","31","      <j:arg value=\"hudson.model.AbstractBuild\" \/>","32","    <\/j:invoke>","33","    <j:set var=\"build\" value=\"${request.findAncestorObject(buildClass)}\" \/>","44","  <\/l:layout>"],"delete":["3","Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Seiji Sogabe, Tom Huybrechts","23","","25","\txmlns:l=\"\/lib\/layout\" xmlns:t=\"\/lib\/hudson\" xmlns:f=\"\/lib\/form\"","26","\txmlns:i=\"jelly:fmt\" xmlns:p=\"\/lib\/hudson\/project\">","27","\t<l:layout title=\"${it.displayName}\">","28","\t\t<j:invokeStatic var=\"buildClass\" className=\"java.lang.Class\" method=\"forName\">","29","\t\t\t<j:arg value=\"hudson.model.AbstractBuild\" \/>","30","\t\t<\/j:invokeStatic>","31","\t\t<j:set var=\"build\" value=\"${request.findAncestorObject(buildClass)}\" \/>","42","\t<\/l:layout>"]}]}},"18efa58abf2ef977c1ad168c5f245606d5385193":{"changes":{"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/manage.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/manage.jelly":[{"add":["55","          <j:set var=\"iconUrl\" value=\"${icon.startsWith('\/') ? resURL+icon : imagesURL + '\/48x48\/' + icon}\" \/>","56","          ${taskTags!=null and attrs.contextMenu!='false' ? taskTags.add(m.urlName, iconUrl, m.displayName, m.requiresPOST, m.requiresConfirmation) : null}"],"delete":["58","                <j:set var=\"iconUrl\" value=\"${icon.startsWith('\/') ? resURL+icon : imagesURL + '\/48x48\/' + icon}\" \/>","69","                <j:set var=\"iconUrl\" value=\"${icon.startsWith('\/') ? resURL+icon : imagesURL + '\/48x48\/' + icon}\" \/>","80","                <j:set var=\"iconUrl\" value=\"${icon.startsWith('\/') ? resURL+icon : imagesURL + '\/48x48\/' + icon}\" \/>"]}]}},"2dbf8c5bce22f557834f5802cc379566addb9b7a":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["70","  <li class=bug>","71","    Jenkins kicks off the wrong downstream builds for Maven.","72","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-15367\">issue 15367<\/a>)"],"delete":[]}]}},"c1b9b29356c11400b16ef87a91fbcce9505a1434":{"changes":{"changelog.html":"MODIFY","war\/pom.xml":"MODIFY"},"diff":{"changelog.html":[{"add":["45","  <li class=bug>","46","    When run as \"java -jar jenkins.war\", \"~\/.hudson\" was still used as default.","47","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-8658\">issue 8658<\/a>)"],"delete":[]}],"war\/pom.xml":[{"add":["111","                <resolveArtifact groupId=\"org.jenkins-ci\" artifactId=\"executable-war\" version=\"1.18\" type=\"jar\" property=\"executable-war.jar\" \/>"],"delete":["111","                <resolveArtifact groupId=\"org.jvnet.hudson\" artifactId=\"executable-war\" version=\"1.18-SNAPSHOT\" type=\"jar\" property=\"executable-war.jar\" \/>"]}]}},"0ba505b60ca86d6b103b070a690a98ae6fef8c5d":{"changes":{"core\/src\/main\/java\/hudson\/model\/Executor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Executor.java":[{"add":["144","        if (Thread.currentThread() == this) {","145","            \/\/ If you catch an InterruptedException the \"correct\" options are limited to one of two choices:","146","            \/\/   1. Propagate the exception;","147","            \/\/   2. Restore the Thread.currentThread().interrupted() flag","148","            \/\/ The JVM locking support assumes such behaviour.","149","            \/\/ Evil Jenkins overrides the interrupt() method so that when a different thread interrupts this thread","150","            \/\/ we abort the build.","151","            \/\/ but that causes JENKINS-28690 style deadlocks when the correctly written code does","152","            \/\/","153","            \/\/ try {","154","            \/\/   ... some long running thing ...","155","            \/\/ } catch (InterruptedException e) {","156","            \/\/   ... some tidy up","157","            \/\/   \/\/ restore interrupted flag","158","            \/\/   Thread.currentThread().interrupted();","159","            \/\/ }","160","            \/\/","161","            \/\/ What about why we do not set the Result.ABORTED on this branch?","162","            \/\/ That is a good question to ask, the answer is that the only time a thread should be restoring","163","            \/\/ its own interrupted flag is when that thread has already been interrupted by another thread","164","            \/\/ as such we should assume that the result has already been applied. If that assumption were","165","            \/\/ incorrect, then the Run.execute's catch (InterruptedException) block will either set the result","166","            \/\/ or have been escaped - in which case the result of the run has been sealed anyway so it does not","167","            \/\/ matter.","168","            super.interrupt();","169","        } else {","170","            interrupt(Result.ABORTED);","171","        }"],"delete":["144","        interrupt(Result.ABORTED);"]}]}},"b14ba46a141b21d5f45679d2871376d8b12583d2":{"changes":{"core\/src\/main\/java\/jenkins\/security\/ClassFilterImpl.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/security\/ClassFilterImpl.java":[{"add":["231","            if (loc.endsWith(\"\/target\/classes\/\") || loc.matches(\".+\/build\/classes\/[^\/]+\/main\/\")) {","236","                if (loc.endsWith(\"\/target\/test-classes\/\") || loc.endsWith(\"-tests.jar\") || loc.matches(\".+\/build\/classes\/[^\/]+\/test\/\")) {"],"delete":["231","            if (loc.endsWith(\"\/target\/classes\/\")) {","236","                if (loc.endsWith(\"\/target\/test-classes\/\") || loc.endsWith(\"-tests.jar\")) {"]}]}},"72e7f2a499a834f0e32894a39377b87003a6ba9a":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Job\/buildHistory.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Job\/buildHistory.jelly":[{"add":["8","  <j:set var=\"url\" value=\"${h.getNearestAncestorUrl(request,it)}\"\/>","9","","11","    &lt;div style='float:right'>(&lt;a href='${url}\/buildTimeTrend'>trend&lt;\/a>)&lt;\/div>Build History"],"delete":["9","    &lt;div style='float:right'>(&lt;a href='buildTimeTrend'>trend&lt;\/a>)&lt;\/div>Build History","32","    <j:set var=\"url\" value=\"${h.getNearestAncestorUrl(request,it)}\"\/>"]}]}},"af67ae868e0d150e4d73e48a301c831bc2732b0c":{"changes":{"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/MasterComputer\/_api.jelly":"ADD"},"diff":{"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/MasterComputer\/_api.jelly":[{"add":[],"delete":[]}]}},"2ad427f6c3d187c5b330151b85e1a578e340cf2a":{"changes":{"changelog.html":"MODIFY","pom.xml":"MODIFY"},"diff":{"changelog.html":[{"add":["79","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18436\">issue 18436<\/a>)","80","  <li class=bug>","81","    Fixed a regression in remoting since 1.519 that caused FindBugs plugins to break.","82","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18349\">issue 18349<\/a>,","83","     <a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18405\">issue 18405<\/a>)","86","<\/ul>"],"delete":["79","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18436\">issue 18436<\/a>) <\/ul>"]}],"pom.xml":[{"add":["177","        <version>2.26<\/version>"],"delete":["177","        <version>2.25<\/version>"]}]}},"be08867788568e807d85deeffbf7e6fb00a32481":{"changes":{"core\/src\/main\/java\/hudson\/ProxyConfiguration.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/ProxyConfiguration.java":[{"add":["136","        authenticator = newAuthenticator();","137","    }","138","","139","    private Authenticator newAuthenticator() {","140","        return new Authenticator() {","229","        authenticator = newAuthenticator();"],"delete":["136","        authenticator = new Authenticator() {"]}]}},"027931a8a123cb866279ba98609137816a41d40a":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["67","  <li class=bug>","68","    maven-failsafe-plugin tests not recognized anymore","69","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-16696\">issue 16696<\/a>)"],"delete":[]}]}},"216f5c6a45ed4f5e592817ed6192d5b5fc1dee24":{"changes":{"test\/src\/test\/java\/hudson\/tasks\/FingerprinterTest.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/FingerprintCleanupThread.java":"MODIFY","changelog.html":"MODIFY","core\/src\/test\/java\/hudson\/model\/FingerprintTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Fingerprint.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/tasks\/FingerprinterTest.java":[{"add":["26","import hudson.Util;","33","import hudson.model.FingerprintCleanupThread;","42","import java.util.Arrays;","44","import java.util.HashSet;","47","","48","import hudson.util.StreamTaskListener;","283","","284","    @SuppressWarnings(\"unchecked\")","285","    @Bug(18417)","286","    @Test","287","    public void fingerprintCleanup() throws Exception {","288","        \/\/ file names shouldn't matter","289","        FreeStyleProject p1 = createFreeStyleProjectWithFingerprints(singleContents, singleFiles);","290","        FreeStyleProject p2 = createFreeStyleProjectWithFingerprints(singleContents, singleFiles2);","291","        FreeStyleProject p3 = createFreeStyleProjectWithFingerprints(singleContents, singleFiles);","292","","293","        j.assertBuildStatusSuccess(p1.scheduleBuild2(0));","294","        j.assertBuildStatusSuccess(p2.scheduleBuild2(0));","295","        j.assertBuildStatusSuccess(p3.scheduleBuild2(0));","296","","297","        Fingerprint f = j.jenkins._getFingerprint(Util.getDigestOf(singleContents[0]+\"\\n\"));","298","        assertEquals(3,f.getUsages().size());","299","","300","        assertEquals(Arrays.asList(p1), p2.getUpstreamProjects());","301","        assertEquals(Arrays.asList(p1), p3.getUpstreamProjects());","302","        assertEquals(new HashSet(Arrays.asList(p2,p3)), new HashSet(p1.getDownstreamProjects()));","303","","304","        \/\/ discard the p3 records","305","        p3.delete();","306","        new FingerprintCleanupThread().execute(StreamTaskListener.fromStdout());","307","","308","        \/\/ records for p3 should have been deleted now","309","        assertEquals(2,f.getUsages().size());","310","        assertEquals(Arrays.asList(p1), p2.getUpstreamProjects());","311","        assertEquals(Arrays.asList(p2), p1.getDownstreamProjects());","312","","313","","314","        \/\/ do a new build in p2 #2 that points to a separate fingerprints","315","        p2.getBuildersList().clear();","316","        p2.getPublishersList().clear();","317","        addFingerprinterToProject(p2,singleContents2,singleFiles2);","318","        j.assertBuildStatusSuccess(p2.scheduleBuild2(0));","319","","320","        \/\/ another garbage collection that gets rid of p2 records from the fingerprint","321","        p2.getBuildByNumber(1).delete();","322","        new FingerprintCleanupThread().execute(StreamTaskListener.fromStdout());","323","","324","        assertEquals(1,f.getUsages().size());","325","    }","326",""],"delete":[]}],"core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":[{"add":["160","                for (FingerprintAction action : build.getActions(FingerprintAction.class)) {","161","                    for (AbstractProject key : action.getDependencies().keySet()) {"],"delete":["160","                List<FingerprintAction> fingerprints = build.getActions(FingerprintAction.class);","161","                for (FingerprintAction action : fingerprints) {","162","                    Map<AbstractProject,Integer> deps = action.getDependencies();","163","                    for (AbstractProject key : deps.keySet()) {"]}],"core\/src\/main\/java\/hudson\/model\/FingerprintCleanupThread.java":[{"add":["63","    public void execute(TaskListener listener) {","105","            } else {","106","                \/\/ get the fingerprint in the official map so have the changes visible to Jenkins","107","                \/\/ otherwise the mutation made in FingerprintMap can override our trimming.","108","                fp = Jenkins.getInstance()._getFingerprint(fp.getHashString());","109","                return fp.trim();","113","            return false;"],"delete":["63","    protected void execute(TaskListener listener) {","109","        return false;"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Clean up fingerprint records that correspond to the deleted build recods","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18417\">issue 18417<\/a>)"],"delete":["57","  <li class=>"]}],"core\/src\/test\/java\/hudson\/model\/FingerprintTest.java":[{"add":["125","    @Test","126","    public void retainAll1() {","127","        RangeSet x = new RangeSet();","128","        RangeSet y = new RangeSet();","129","","130","        x.addAll(1,2,3, 10,11,       20);","131","        y.addAll(  2,      11,12, 19,20,21);","132","","133","        assertTrue(x.retainAll(y));","134","","135","        RangeSet z = new RangeSet();","136","        z.addAll(2,11,20);","137","","138","        assertEquals(x,z);","139","    }","140","","141","    @Test","142","    public void retainAll2() {","143","        RangeSet x = new RangeSet();","144","        RangeSet y = new RangeSet();","145","","146","        x.addAll(1,2,3,4,5,6,7,8,9,10,      13,14,15,16,17,18,19,20);","147","        y.addAll(  2,3,  5,6,    9,10,11,12,13,   15,16,   18,19);","148","","149","        assertTrue(x.retainAll(y));","150","","151","        RangeSet z = new RangeSet();","152","        z.addAll(2,3,5,6,9,10,13,15,16,18,19);","153","","154","        assertEquals(x,z);","155","    }","156","","157","    @Test","158","    public void retainAll3() {","159","        RangeSet x = new RangeSet();","160","        RangeSet y = new RangeSet();","161","","162","        x.addAll(1,2,3,4,5);","163","","164","        assertTrue(x.retainAll(y));","165","        assertTrue(x.isEmpty());","166","    }","167","","168","    @Test","169","    public void removeAll1() {","170","        RangeSet x = new RangeSet();","171","        RangeSet y = new RangeSet();","172","","173","        x.addAll(1,2,3, 10,11,       20);","174","        y.addAll(  2,      11,12, 19,20,21);","175","","176","        assertTrue(x.removeAll(y));","177","","178","        RangeSet z = new RangeSet();","179","        z.addAll(1,3,10);","180","","181","        assertEquals(x,z);","182","    }","183","","184","    @Test","185","    public void removeAll2() {","186","        RangeSet x = new RangeSet();","187","        RangeSet y = new RangeSet();","188","","189","        x.addAll(1,2,3,4,5,6,7,8,9,10,      13,14,15,16,17,18,19,20);","190","        y.addAll(  2,3,  5,6,    9,10,11,12,13,   15,16,   18,19);","191","","192","        assertTrue(x.removeAll(y));","193","","194","        RangeSet z = new RangeSet();","195","        z.addAll(1,4,7,8,14,17,20);","196","","197","        assertEquals(x,z);","198","    }","199","","200","    @Test","201","    public void removeAll3() {","202","        RangeSet x = new RangeSet();","203","        RangeSet y = new RangeSet();","204","","205","        x.addAll(1,2,3,4,5);","206","","207","        assertFalse(x.removeAll(y));","208","    }","209",""],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/Fingerprint.java":[{"add":["252","         * Returns true if two {@link Range}s do not share any common integer.","253","         *\/","254","        public boolean isDisjoint(Range that) {","255","            return this.end<=that.start || that.end<=this.start;","256","        }","257","","258","        \/**","266","         * If this range contains every int that's in the other range, return true","267","         *\/","268","        public boolean contains(Range that) {","269","            return this.start<=that.start && that.end<=this.end;","270","        }","271","","272","        \/**","281","","282","        \/**","283","         * Returns the {@link Range} that represents the intersection of the two.","284","         *\/","285","        public Range intersect(Range that) {","286","            assert !isDisjoint(that);","287","            return new Range(","288","                Math.max(this.start, that.start),","289","                Math.min(this.end, that.end));","290","        }","291","","292","        @Override","293","        public boolean equals(Object o) {","294","            if (this == o) return true;","295","            if (o == null || getClass() != o.getClass()) return false;","296","","297","            Range that = (Range) o;","298","            return start == that.start && end == that.end;","299","","300","        }","301","","302","        @Override","303","        public int hashCode() {","304","            return 31 * start + end;","305","        }","309","     * Set of {@link Range}s. Mutable.","324","        private RangeSet(Range initial) {","325","            this();","326","            ranges.add(initial);","327","        }","328","","416","        public synchronized void addAll(int... n) {","417","            for (int i : n)","418","                add(i);","419","        }","420","","421","","477","        \/**","478","         * Updates this range set by the intersection of this range and the given range.","479","         *","480","         * @return true if this range set was modified as a result.","481","         *\/","482","        public synchronized boolean retainAll(RangeSet that) {","483","            List<Range> intersection = new ArrayList<Range>();","484","","485","            int lhs=0,rhs=0;","486","            while(lhs<this.ranges.size() && rhs<that.ranges.size()) {","487","                Range lr = this.ranges.get(lhs);","488","                Range rr = that.ranges.get(rhs);","489","","490","                if(lr.end<=rr.start) {\/\/ lr has no overlap with that.ranges","491","                    lhs++;","492","                    continue;","493","                }","494","                if(rr.end<=lr.start) {\/\/ rr has no overlap with this.ranges","495","                    rhs++;","496","                    continue;","497","                }","498","","499","                \/\/ overlap. figure out the intersection","500","                Range v = lr.intersect(rr);","501","                intersection.add(v);","502","","503","                \/\/ move on to the next pair","504","                if (lr.end<rr.end) {","505","                    lhs++;","506","                } else {","507","                    rhs++;","508","                }","509","            }","510","","511","            boolean same = this.ranges.equals(intersection);","512","","513","            if (!same) {","514","                this.ranges.clear();","515","                this.ranges.addAll(intersection);","516","                return true;","517","            } else {","518","                return false;","519","            }","520","        }","521","","522","        \/**","523","         * Updates this range set by removing all the values in the given range set.","524","         *","525","         * @return true if this range set was modified as a result.","526","         *\/","527","        public synchronized boolean removeAll(RangeSet that) {","528","            boolean modified = false;","529","            List<Range> sub = new ArrayList<Range>();","530","","531","            int lhs=0,rhs=0;","532","            while(lhs<this.ranges.size() && rhs<that.ranges.size()) {","533","                Range lr = this.ranges.get(lhs);","534","                Range rr = that.ranges.get(rhs);","535","","536","                if(lr.end<=rr.start) {\/\/ lr has no overlap with that.ranges. lr stays","537","                    sub.add(lr);","538","                    lhs++;","539","                    continue;","540","                }","541","                if(rr.end<=lr.start) {\/\/ rr has no overlap with this.ranges","542","                    rhs++;","543","                    continue;","544","                }","545","","546","                \/\/ some overlap between lr and rr","547","                assert !lr.isDisjoint(rr);","548","                modified = true;","549","","550","                if (rr.contains(lr)) {","551","                    \/\/ lr completely removed by rr","552","                    lhs++;","553","                    continue;","554","                }","555","","556","                \/\/ we want to look at A and B below, if they are non-null.","557","                \/\/ |------------| lr","558","                \/\/     |-----|    rr","559","                \/\/   A         B","560","                \/\/","561","                \/\/ note that lr and rr could be something like or the other way around","562","                \/\/ |------------| lr","563","                \/\/         |------------| rr","564","                \/\/     A             (no B)","565","","566","                if (lr.start<rr.start) {\/\/ if A is non-empty, that will stay","567","                    Range a = new Range(lr.start, rr.start);","568","                    sub.add(a);","569","                }","570","","571","                if (rr.end<lr.end) {\/\/ if B is non-empty","572","                    \/\/ we still need to check that with that.ranges, so keep it in the place of lr.","573","                    \/\/ how much of them will eventually stay is up to the remainder of that.ranges","574","                    this.ranges.set(lhs,new Range(rr.end,lr.end));","575","                    rhs++;","576","                } else {","577","                    \/\/ if B is empty, we are done considering lr","578","                    lhs++;","579","                }","580","            }","581","","582","            if (!modified)  return false;   \/\/ no changes","583","","584","            \/\/ whatever that remains in lhs will survive","585","            sub.addAll(this.ranges.subList(lhs,this.ranges.size()));","586","","587","            this.ranges.clear();","588","            this.ranges.addAll(sub);","589","            return true;","590","        }","591","","602","        @Override","603","        public boolean equals(Object o) {","604","            if (this == o) return true;","605","            if (o == null || getClass() != o.getClass()) return false;","606","","607","            return ranges.equals(((RangeSet) o).ranges);","608","","609","        }","610","","611","        @Override","612","        public int hashCode() {","613","            return ranges.hashCode();","614","        }","615","","893","        add(b.getParent().getFullName(), b.getNumber());","944","     * Trim off references to non-existent builds and jobs, thereby making the fingerprint smaller.","945","     *","946","     * @return true","947","     *      if this record was modified.","948","     *\/","949","    public synchronized boolean trim() throws IOException {","950","        boolean modified = false;","951","","952","        for (Entry<String,RangeSet> e : new Hashtable<String,RangeSet>(usages).entrySet()) {\/\/ copy because we mutate","953","            Job j = Jenkins.getInstance().getItemByFullName(e.getKey(),Job.class);","954","            if(j==null) {\/\/ no such job any more. recycle the record","955","                modified = true;","956","                usages.remove(e.getKey());","957","                continue;","958","            }","959","","960","            Run firstBuild = j.getFirstBuild();","961","            if(firstBuild==null) {\/\/ no builds. recycle the whole record","962","                modified = true;","963","                usages.remove(e.getKey());","964","                continue;","965","            }","966","","967","            RangeSet cur = e.getValue();","968","","969","            \/\/ builds that are around without the keepLog flag on are normally clustered together (in terms of build #)","970","            \/\/ so our basic strategy is to discard everything up to the first ephemeral build, except those builds","971","            \/\/ that are marked as kept","972","            RangeSet kept = new RangeSet();","973","            Run r = firstBuild;","974","            while (r!=null && r.isKeepLog()) {","975","                kept.add(r.getNumber());","976","                r = r.getNextBuild();","977","            }","978","","979","            if (r==null) {","980","                \/\/ all the build records are permanently kept ones, so we'll just have to keep 'kept' out of whatever currently in 'cur'","981","                modified |= cur.retainAll(kept);","982","            } else {","983","                \/\/ otherwise we are ready to discard [0,r.number) except those marked as 'kept'","984","                RangeSet discarding =  new RangeSet(new Range(-1,r.getNumber()));","985","                discarding.removeAll(kept);","986","                modified |= cur.removeAll(discarding);","987","            }","988","","989","            if (cur.isEmpty()) {","990","                usages.remove(e.getKey());","991","                modified = true;","992","            }","993","        }","994","","995","        if (modified)","996","            save();","997","","998","        return modified;","999","    }","1000","","1001","","1002","    \/**"],"delete":["270","     * Set of {@link Range}s.","714","        add(b.getParent().getFullName(),b.getNumber());"]}]}},"a614cd5b05b3c8cbcb8970ea439b2a1315252f58":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/CauseAction.java":"MODIFY","core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/FingerprintAction\/index.jelly":"MODIFY","core\/src\/main\/java\/hudson\/model\/RunAction.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/RunAction2.java":"ADD","core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/Fingerprinter.java":[{"add":["76","import jenkins.model.RunAction2;","294","    public static final class FingerprintAction implements RunAction2 {","296","        private transient AbstractBuild build;","297","        ","310","            compact();","318","            compact();","344","        @Override public void onLoad(Run<?,?> r) {","345","            build = (AbstractBuild) r;","346","            compact();","347","        }","348","","349","        @Override public void onAttached(Run<?,?> r) {","350","            \/\/ for historical reasons this setup is done in the constructor instead","351","        }","352","","353","        private void compact() {"],"delete":["46","import hudson.model.RunAction;","294","    public static final class FingerprintAction implements RunAction {","295","        ","296","        private AbstractBuild build;","310","            onLoad();   \/\/ make compact","318","            onLoad();","344","        public void onLoad() {","345","            if (build == null) {","346","                return;","347","            }","348","            if (build.getParent() == null) {","349","                logger.warning(\"JENKINS-16845: broken FingerprintAction record\");","350","                build = null;","351","                return;","352","            }","365","        public void onAttached(Run r) {","366","        }","367","","368","        public void onBuildComplete() {","369","        }","370","","440","            if (build == null) {","441","                \/\/ Broken, do not do anything.","442","                return r;","443","            }","444",""]}],"core\/src\/main\/java\/hudson\/model\/CauseAction.java":[{"add":["37","import jenkins.model.RunAction2;","40","public class CauseAction implements FoldableAction, RunAction2 {","108","    @Override public void onLoad(Run<?,?> r) {","115","    @Override public void onAttached(Run<?,?> owner) {"],"delete":["39","public class CauseAction implements FoldableAction, RunAction {","107","    public void onLoad() {","108","        \/\/ noop","109","    }","110","","111","    public void onBuildComplete() {","118","    public void onAttached(Run owner) {"]}],"core\/src\/main\/resources\/hudson\/tasks\/Fingerprinter\/FingerprintAction\/index.jelly":[{"add":["32","    <st:include it=\"${it.build}\" page=\"sidepanel.jelly\"\/>"],"delete":["32","    <j:if test=\"${it.build != null}\">","33","      <st:include it=\"${it.build}\" page=\"sidepanel.jelly\"\/>","34","    <\/j:if> <!-- else broken -->"]}],"core\/src\/main\/java\/hudson\/model\/RunAction.java":[{"add":["25","import jenkins.model.RunAction2;","26","","28"," * @deprecated Use {@link RunAction2} instead: {@link #onLoad} does not work well with lazy loading if you are trying to persist the owner; and {@link #onBuildComplete} was never called.","30","@Deprecated"],"delete":["26"," * Optional interface for {@link Action}s that add themselves to {@link Run}.","27"," *","28"," * @author Kohsuke Kawaguchi"]}],"core\/src\/main\/java\/jenkins\/model\/RunAction2.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["122","import jenkins.model.RunAction2;","317","    @SuppressWarnings(\"deprecation\")","319","        for (Action a : getActions()) {","320","            if (a instanceof RunAction2) {","321","                ((RunAction2) a).onLoad(this);","322","            } else if (a instanceof RunAction) {","324","            }","325","        }","342","    @SuppressWarnings(\"deprecation\")","346","        if (a instanceof RunAction2) {","347","            ((RunAction2) a).onAttached(this);","348","        } else if (a instanceof RunAction) {","350","        }"],"delete":["317","        for (Action a : getActions())","318","            if (a instanceof RunAction)","339","        if (a instanceof RunAction)"]}],"changelog.html":[{"add":["60","  <li class='major bug'>","61","    Fingerprint action deserialization problem fixed.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-17125\">issue 17125<\/a>)"],"delete":[]}]}},"b3b4ccb0f23bf1769d91ee7535d054ef1937953e":{"changes":{"test\/pom.xml":"MODIFY","test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":"MODIFY","test\/src\/main\/java\/org\/jvnet\/hudson\/test\/HudsonTestCase.java":"MODIFY","maven-plugin\/pom.xml":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenArtifactRecord.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenArtifact.java":"MODIFY","test\/src\/test\/java\/hudson\/maven\/RedeployPublisherTest.java":"MODIFY"},"diff":{"test\/pom.xml":[{"add":["57","        <version>1.7<\/version>","167","    <dependency>","168","      <groupId>junit<\/groupId>","169","      <artifactId>junit<\/artifactId>","170","      <version>4.8.2<\/version>","171","    <\/dependency>"],"delete":["57","        <version>1.6<\/version>","197","      <groupId>junit<\/groupId>","198","      <artifactId>junit<\/artifactId>","199","      <version>3.8.1<\/version>","200","    <\/dependency>","201","    <dependency>"]}],"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":[{"add":["58","        configRoundtrip((Item)project);"],"delete":["58","        configRoundtrip(project);"]}],"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/HudsonTestCase.java":[{"add":["25","import hudson.ClassicPluginStrategy;","26","import hudson.CloseProofOutputStream;","27","import hudson.DNSMultiCast;","28","import hudson.DescriptorExtensionList;","29","import hudson.EnvVars;","30","import hudson.ExtensionList;","31","import hudson.FilePath;","32","import hudson.Functions;","33","import hudson.Launcher.LocalLauncher;","34","import hudson.Main;","35","import hudson.PluginManager;","37","import hudson.WebAppMain;","38","import hudson.matrix.MatrixBuild;","39","import hudson.matrix.MatrixProject;","40","import hudson.matrix.MatrixRun;","41","import hudson.maven.MavenBuild;","42","import hudson.maven.MavenEmbedder;","43","import hudson.maven.MavenModule;","44","import hudson.maven.MavenModuleSet;","45","import hudson.maven.MavenModuleSetBuild;","46","import hudson.model.AbstractBuild;","47","import hudson.model.AbstractProject;","48","import hudson.model.Computer;","49","import hudson.model.Describable;","50","import hudson.model.Descriptor;","51","import hudson.model.DownloadService;","52","import hudson.model.Executor;","53","import hudson.model.FreeStyleBuild;","54","import hudson.model.FreeStyleProject;","55","import hudson.model.Hudson;","56","import hudson.model.Item;","57","import hudson.model.JDK;","58","import hudson.model.Job;","59","import hudson.model.Label;","60","import hudson.model.Node;","61","import hudson.model.Node.Mode;","63","import hudson.model.Result;","64","import hudson.model.RootAction;","65","import hudson.model.Run;","66","import hudson.model.Saveable;","67","import hudson.model.TaskListener;","68","import hudson.model.UpdateSite;","69","import hudson.model.User;","70","import hudson.model.View;","71","import hudson.remoting.Which;","78","import hudson.slaves.ComputerConnector;","79","import hudson.slaves.ComputerListener;","84","import hudson.tasks.Builder;","85","import hudson.tasks.Mailer;","86","import hudson.tasks.Mailer.DescriptorImpl;","87","import hudson.tasks.Maven;","89","import hudson.tasks.Publisher;","90","import hudson.tools.ToolProperty;","96","import java.beans.PropertyDescriptor;","106","import java.lang.reflect.Method;","112","import java.util.Arrays;","113","import java.util.Collections;","120","import java.util.concurrent.CountDownLatch;","134","","141","import org.apache.commons.beanutils.PropertyUtils;","156","import org.kohsuke.stapler.Stapler;","177","import com.gargoylesoftware.htmlunit.DefaultCssErrorHandler;","181","import com.gargoylesoftware.htmlunit.html.DomNode;","182","import com.gargoylesoftware.htmlunit.html.HtmlButton;","183","import com.gargoylesoftware.htmlunit.html.HtmlElement;","184","import com.gargoylesoftware.htmlunit.html.HtmlForm;","185","import com.gargoylesoftware.htmlunit.html.HtmlInput;","186","import com.gargoylesoftware.htmlunit.html.HtmlPage;","187","import com.gargoylesoftware.htmlunit.javascript.HtmlUnitContextFactory;","188","import com.gargoylesoftware.htmlunit.javascript.host.xml.XMLHttpRequest;","305","        DescriptorImpl desc = Mailer.descriptor();","306","        \/\/ prevent NPE with eclipse ","307","        if (desc != null) Mailer.descriptor().setHudsonUrl(null);","763","        configRoundtrip((Item)p);","773","        configRoundtrip((Item)p);"],"delete":["25","import com.gargoylesoftware.htmlunit.DefaultCssErrorHandler;","26","import com.gargoylesoftware.htmlunit.javascript.HtmlUnitContextFactory;","27","import com.gargoylesoftware.htmlunit.javascript.host.xml.XMLHttpRequest;","28","import hudson.*;","30","import hudson.model.*;","36","import hudson.slaves.ComputerConnector;","37","import hudson.tasks.Builder;","38","import hudson.tasks.Publisher;","39","import hudson.tools.ToolProperty;","40","import hudson.remoting.Which;","41","import hudson.Launcher.LocalLauncher;","42","import hudson.matrix.MatrixProject;","43","import hudson.matrix.MatrixBuild;","44","import hudson.matrix.MatrixRun;","45","import hudson.maven.MavenModuleSet;","46","import hudson.maven.MavenEmbedder;","47","import hudson.model.Node.Mode;","52","import hudson.tasks.Mailer;","53","import hudson.tasks.Maven;","70","import java.lang.reflect.Method;","81","import java.util.Arrays;","82","import java.util.Collections;","91","import java.beans.PropertyDescriptor;","97","","108","import org.apache.commons.beanutils.PropertyUtils;","123","import org.kohsuke.stapler.Stapler;","146","import com.gargoylesoftware.htmlunit.html.*;","147","import hudson.maven.MavenBuild;","148","import hudson.maven.MavenModule;","149","import hudson.maven.MavenModuleSetBuild;","150","import hudson.slaves.ComputerListener;","151","import java.util.concurrent.CountDownLatch;","267","        Mailer.descriptor().setHudsonUrl(null);","723","        configRoundtrip(p);","733","        configRoundtrip(p);"]}],"maven-plugin\/pom.xml":[{"add":["181","      <groupId>org.jenkins-ci.lib<\/groupId>","182","      <artifactId>lib-jenkins-maven-artifact-manager<\/artifactId>","183","      <version>1.1<\/version>"],"delete":["181","      <groupId>org.jvnet.hudson<\/groupId>","182","      <artifactId>hudson-maven-artifact-manager<\/artifactId>","183","      <version>1.0<\/version>"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenArtifactRecord.java":[{"add":["115","        boolean uniqueVersion = true;","116","        if (!deploymentRepository.isUniqueVersion()) {","117","            if (maven3orLater) {","118","                logger.println(\"uniqueVersion == false is not anymore supported in maven 3\");","119","            } else {","120","                ((WrappedArtifactRepository) deploymentRepository).setUniqueVersion( false );","121","                uniqueVersion = false;","122","            }","123","        } else {","132","        ","133","        ArtifactDeployer deployer = embedder.lookup(ArtifactDeployer.class,uniqueVersion ? \"default\":\"maven2\");","134","        ","135","        deployer.deploy( main.getFile(), main, deploymentRepository, embedder.getLocalRepository() );","136","        ","137","        \/\/deployMavenArtifact( main, deploymentRepository, embedder, uniqueVersion );","142","            deployer.deploy( a.getFile(), a, deploymentRepository, embedder.getLocalRepository() );","145","    ","146","    ","147","    "],"delete":["115","        if (!deploymentRepository.isUniqueVersion() && maven3orLater) {","116","            logger.println(\"uniqueVersion == false is not anymore supported in maven 3\");","125","        deployMavenArtifact( main, deploymentRepository, embedder );","130","            deployMavenArtifact( a, deploymentRepository, embedder );","133","","134","    protected void deployMavenArtifact(Artifact artifact, ArtifactRepository deploymentRepository, MavenEmbedder embedder) ","135","        throws ArtifactDeploymentException, ComponentLookupException {","136","        ","137","        ArtifactDeployer deployer = embedder.lookup(ArtifactDeployer.class,\"maven2\");","138","        deployer.deploy(artifact.getFile(),artifact,deploymentRepository,embedder.getLocalRepository());","139","    }"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenArtifact.java":[{"add":["32","","33","import org.apache.maven.RepositoryUtils;","152","        ","164","       "],"delete":[]}],"test\/src\/test\/java\/hudson\/maven\/RedeployPublisherTest.java":[{"add":["29","import org.apache.commons.lang.StringUtils;","38","import java.util.Arrays;","120","","127","                System.out.print( \"deployed file \" + name );","128","                return name.contains( \"-bin.tar.gz\" ) || name.endsWith( \".jar\" ) || name.endsWith( \"-bin.zip\" );","131","        System.out.println(\"deployed files \" + Arrays.asList( files ));","134","        for (String file : files) {","135","            if (file.endsWith( \"-bin.tar.gz\" )) {","136","                String ver = StringUtils.remove( file, \"-bin.tar.gz\" );","137","                ver = ver.substring( ver.length() - 1, ver.length() );","138","                assertEquals(\"-bin.tar.gz not ended with 1 , file \" + file , \"1\", ver);","139","            }","140","            if (file.endsWith( \".jar\" )) {","141","                String ver = StringUtils.remove( file, \".jar\" );","142","                ver = ver.substring( ver.length() - 1, ver.length() );","143","                assertEquals(\".jar not ended with 1 , file \" + file , \"1\", ver);","144","            }            ","145","            if (file.endsWith( \"-bin.zip\" )) {","146","                String ver = StringUtils.remove( file, \"-bin.zip\" );","147","                ver = ver.substring( ver.length() - 1, ver.length() );","148","                assertEquals(\"-bin.zip not ended with 1 , file \" + file , \"1\", ver);","149","            }            ","150","        }        ","151","        ","203","                return name.contains( \"-bin.tar.gz\" ) || name.endsWith( \".jar\" ) || name.endsWith( \"-bin.zip\" );","206","        System.out.println(\"deployed files \" + Arrays.asList( files ));","209","        for (String file : files) {","210","            if (file.endsWith( \"-bin.tar.gz\" )) {","211","                String ver = StringUtils.remove( file, \"-bin.tar.gz\" );","212","                ver = ver.substring( ver.length() - 1, ver.length() );","213","                assertEquals(\"-bin.tar.gz not ended with 1 , file \" + file , \"1\", ver);","214","            }","215","            if (file.endsWith( \".jar\" )) {","216","                String ver = StringUtils.remove( file, \".jar\" );","217","                ver = ver.substring( ver.length() - 1, ver.length() );","218","                assertEquals(\".jar not ended with 1 , file \" + file , \"1\", ver);","219","            }            ","220","            if (file.endsWith( \"-bin.zip\" )) {","221","                String ver = StringUtils.remove( file, \"-bin.zip\" );","222","                ver = ver.substring( ver.length() - 1, ver.length() );","223","                assertEquals(\"-bin.zip not ended with 1 , file \" + file , \"1\", ver);","224","            }            ","225","        }"],"delete":["124","                return name.endsWith( \"tar.gz\" );","180","                return name.endsWith( \"tar.gz\" );"]}]}},"acf79efc8e178bac0e3d16b80226be4ec19501e6":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":[{"add":["9","import org.kohsuke.stapler.export.ExportedBean;","10","import org.kohsuke.stapler.export.Exported;","72","            return new MemoryUsage2(MemoryMonitor.get().monitor());","78","    \/**","79","     * Memory Usage.","80","     *","81","     * <p>","82","     * {@link MemoryUsage} + stapler annotations.","83","     *\/","84","    @ExportedBean","85","    public static class MemoryUsage2 extends MemoryUsage {","86","        public MemoryUsage2(MemoryUsage mem) {","87","            super(mem.totalPhysicalMemory, mem.availablePhysicalMemory, mem.totalSwapSpace, mem.availableSwapSpace);","88","        }","89","","90","        \/**","91","         * Total physical memory of the system, in bytes.","92","         *\/","93","        @Exported","94","        public long getTotalPhysicalMemory() {","95","            return totalPhysicalMemory;","96","        }","97","","98","        \/**","99","         * Of the total physical memory of the system, available bytes.","100","         *\/","101","        @Exported","102","        public long getAvailablePhysicalMemory() {","103","            return availablePhysicalMemory;","104","        }","105","","106","        \/**","107","         * Total number of swap space in bytes.","108","         *\/","109","        @Exported","110","        public long getTotalSwapSpace() {","111","            return totalSwapSpace;","112","        }","113","","114","        \/**","115","         * Available swap space in bytes.","116","         *\/","117","        @Exported","118","        public long getAvailableSwapSpace() {","119","            return availableSwapSpace;","120","        }","121","    }","122",""],"delete":["70","            return MemoryMonitor.get().monitor();"]}]}},"01d5fbc2e06d76db1501ad3e24691c2643a9acd7":{"changes":{"core\/src\/main\/java\/hudson\/model\/UpdateSite.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/UpdateSite.java":[{"add":["599","        \/**","600","         * Optional dependencies of this plugin.","601","         *\/","602","        @Exported","603","        public final Map<String,String> optionalDependencies = new HashMap<String,String>();","604","","619","                    && !get(depObj,\"name\").equals(\"maven-plugin\")) {","620","                    if (get(depObj, \"optional\").equals(\"false\")) {","621","                        dependencies.put(get(depObj, \"name\"), get(depObj, \"version\"));","622","                    } else {","623","                        optionalDependencies.put(get(depObj, \"name\"), get(depObj, \"version\"));","624","                    }","702","            for(Map.Entry<String,String> e : optionalDependencies.entrySet()) {","703","                Plugin depPlugin = Jenkins.getInstance().getUpdateCenter().getPlugin(e.getKey());","704","                if (depPlugin == null) {","705","                    continue;","706","                }","707","                VersionNumber requiredVersion = new VersionNumber(e.getValue());","708","","709","                PluginWrapper current = depPlugin.getInstalled();","710","","711","                \/\/ If the optional dependency plugin is installed, is the version we depend on newer than","712","                \/\/ what's installed? If so, upgrade.","713","                if (current != null && current.isOlderThan(requiredVersion)) {","714","                    deps.add(depPlugin);","715","                }","716","            }","717",""],"delete":["613","                    && !get(depObj,\"name\").equals(\"maven-plugin\")","614","                    && get(depObj,\"optional\").equals(\"false\")) {","615","                    dependencies.put(get(depObj,\"name\"), get(depObj,\"version\"));"]}]}},"5df3f74b4e7700d5f51243ced4c97fdc209c6fb2":{"changes":{"core\/src\/main\/java\/jenkins\/model\/PeepholePermalink.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/PeepholePermalink.java":[{"add":["105","        } catch (NumberFormatException e) { ","106","            LOGGER.log(Level.WARNING, \"Failed to parse the build number in the permalink cache:\" + f, e);","107","            \/\/ if we fail to read the cache, fall back to the re-computation"],"delete":[]}]}},"87d9a6e413c11eda69f7c2966c3f2a5f97381585":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/Computer.java":"MODIFY"},"diff":{"changelog.html":[{"add":["61","  <li class=bug>","62","    <code>\/computer\/*\/doDelete<\/code> should try harder to remove even \u201Czombie\u201D <code>Computer<\/code>s.","63","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-15369\">issue 15369<\/a>)"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/Computer.java":[{"add":["1178","        if (node != null) {","1179","            Jenkins.getInstance().removeNode(node);","1180","        } else {","1181","            AbstractCIBase app = Jenkins.getInstance();","1182","            app.removeComputer(this);"],"delete":["1178","        if (node == null) {","1179","            throw new IOException(\"Cannot delete \" + nodeName + \" since it does not still exist\");","1181","        Jenkins.getInstance().removeNode(node);"]}]}},"320eea930e27330a38f32b4feb3a9cc2287054e5":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","test\/src\/test\/java\/hudson\/maven\/ResultExposingBuilder.java":"ADD","changelog.html":"MODIFY","test\/src\/test\/java\/hudson\/maven\/MavenProjectTest.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["600","                            if(e==null){","601","                                setResult(r = Result.FAILURE);","602","                                return r;","603","                            }","612","                    \t\tsetResult(r = FAILURE);","617","                    \t\tsetResult(r = FAILURE);"],"delete":["600","                            if(e==null)","601","                                return (r = Result.FAILURE);","610","                    \t\tr = FAILURE;","615","                    \t\tr = FAILURE;"]}],"test\/src\/test\/java\/hudson\/maven\/ResultExposingBuilder.java":[{"add":[],"delete":[]}],"changelog.html":[{"add":["76","  <li class=bug>","77","    Wrong build result in post build steps after failed pre build step in maven projects.","78","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-17177\">issue 17177<\/a>)     "],"delete":[]}],"test\/src\/test\/java\/hudson\/maven\/MavenProjectTest.java":[{"add":["166","    ","167","    @Bug(17177)","168","    public void testCorrectResultInPostStepAfterFailedPreBuildStep() throws Exception {","169","        MavenModuleSet p = createSimpleProject();","170","        MavenInstallation mi = configureDefaultMaven();","171","        p.setMaven(mi.getName());","172","        p.setGoals(\"initialize\");","173","        ","174","        Shell pre = new Shell(\"exit 1\"); \/\/ must fail to simulate scenario!","175","        p.getPrebuilders().add(pre);","176","        ResultExposingBuilder resultExposer = new ResultExposingBuilder();","177","        p.getPostbuilders().add(resultExposer);","178","        ","179","        assertBuildStatus(Result.FAILURE, p.scheduleBuild2(0).get());","180","        assertEquals(\"The result passed to the post build step was not the one from the pre build step\", Result.FAILURE, resultExposer.getResult());","181","    }","182","    "],"delete":[]}]}},"ebd71116c15b97fd3e855a738fbfdef387cd6e3c":{"changes":{"test\/src\/test\/java\/hudson\/LauncherTest.java":"MODIFY","core\/src\/main\/java\/hudson\/Launcher.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/TaskListener.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/LauncherTest.java":[{"add":["25","import hudson.console.LineTransformationOutputStream;","28","import hudson.model.BuildListener;","36","import hudson.remoting.Channel;","42","import hudson.util.StreamTaskListener;","43","import java.io.ByteArrayOutputStream;","44","import java.io.File;","45","import java.io.FileOutputStream;","47","import java.io.OutputStream;","48","import java.io.PrintStream;","49","import java.nio.charset.StandardCharsets;","53","import org.apache.commons.io.FileUtils;","54","import static org.hamcrest.Matchers.*;","55","import static org.junit.Assert.*;","56","import static org.junit.Assume.*;","169","    @Issue(\"JENKINS-52729\")","170","    @Test public void remotable() throws Exception {","171","        File log = new File(rule.jenkins.root, \"log\");","172","        TaskListener listener = new RemotableBuildListener(log);","173","        Launcher.ProcStarter ps = rule.createOnlineSlave().createLauncher(listener).launch();","174","        if (Functions.isWindows()) {","175","            ps.cmds(\"cmd\", \"\/c\", \"echo\", \"hello\");","176","        } else {","177","            ps.cmds(\"echo\", \"hello\");","178","        }","179","        assertEquals(0, ps.stdout(listener).join());","180","        assertThat(FileUtils.readFileToString(log, StandardCharsets.UTF_8).replace(\"\\r\\n\", \"\\n\"),","181","            containsString(\"[master ? slave0] $ \" + (Functions.isWindows() ? \"cmd \/c \" : \"\") + \"echo hello\\n\" +","182","                           \"[master ? slave0] hello\"));","183","    }","184","    private static class RemotableBuildListener implements BuildListener {","185","        private static final long serialVersionUID = 1;","186","        \/** location of log file streamed to by multiple sources *\/","187","        private final File logFile;","188","        \/** records allocation & deserialization history; e.g., {@code master ? agentName} *\/","189","        private final String id;","190","        private transient PrintStream logger;","191","        RemotableBuildListener(File logFile) {","192","            this(logFile, \"master\");","193","        }","194","        private RemotableBuildListener(File logFile, String id) {","195","            this.logFile = logFile;","196","            this.id = id;","197","        }","198","        @Override public PrintStream getLogger() {","199","            if (logger == null) {","200","                final OutputStream fos;","201","                try {","202","                    fos = new FileOutputStream(logFile, true);","203","                    logger = new PrintStream(new LineTransformationOutputStream() {","204","                        @Override protected void eol(byte[] b, int len) throws IOException {","205","                            fos.write((\"[\" + id + \"] \").getBytes(StandardCharsets.UTF_8));","206","                            fos.write(b, 0, len);","207","                        }","208","                    }, true, \"UTF-8\");","209","                } catch (IOException x) {","210","                    throw new AssertionError(x);","211","                }","212","            }","213","            return logger;","214","        }","215","        private Object writeReplace() {","216","            Thread.dumpStack();","217","            String name = Channel.current().getName();","218","            return new RemotableBuildListener(logFile, id + \" ? \" + name);","219","        }","220","    }","221","","222","    @Issue(\"JENKINS-52729\")","223","    @Test public void multipleStdioCalls() throws Exception {","224","        Node master = rule.jenkins;","225","        Node agent = rule.createOnlineSlave();","226","        for (Node node : new Node[] {master, agent}) {","227","            assertMultipleStdioCalls(\"first TaskListener then OutputStream\", node, false, (ps, os1, os2, os2Listener) -> {","228","                ps.stdout(os2Listener).stdout(os1);","229","                assertEquals(os1, ps.stdout());","230","            }, false);","231","            assertMultipleStdioCalls(\"first OutputStream then TaskListener\", node, false, (ps, os1, os2, os2Listener) -> {","232","                ps.stdout(os1).stdout(os2Listener);","233","                assertEquals(os2Listener.getLogger(), ps.stdout());","234","            }, true);","235","            assertMultipleStdioCalls(\"stdout then stderr\", node, true, (ps, os1, os2, os2Listener) -> {","236","                ps.stdout(os1).stderr(os2);","237","                assertEquals(os1, ps.stdout());","238","                assertEquals(os2, ps.stderr());","239","            }, true);","240","            assertMultipleStdioCalls(\"stderr then stdout\", node, true, (ps, os1, os2, os2Listener) -> {","241","                ps.stdout(os1).stderr(os2);","242","                assertEquals(os1, ps.stdout());","243","                assertEquals(os2, ps.stderr());","244","            }, true);","245","        }","246","    }","247","    @FunctionalInterface","248","    private interface ProcStarterCustomizer {","249","        void run(Launcher.ProcStarter ps, OutputStream os1, OutputStream os2, TaskListener os2Listener) throws Exception;","250","    }","251","    private void assertMultipleStdioCalls(String message, Node node, boolean emitStderr, ProcStarterCustomizer psCustomizer, boolean outputIn2) throws Exception {","252","        message = node.getDisplayName() + \": \" + message;","253","        Launcher launcher = node.createLauncher(StreamTaskListener.fromStderr());","254","        Launcher.ProcStarter ps = launcher.launch();","255","        assumeFalse(\"should not be platform-dependent, not bothering for now\", Functions.isWindows());","256","        if (emitStderr) {","257","            ps.cmds(\"sh\", \"-c\", \"echo hello >&2\").quiet(true);","258","        } else {","259","            ps.cmds(\"echo\", \"hello\");","260","        }","261","        ByteArrayOutputStream baos1 = new ByteArrayOutputStream();","262","        ByteArrayOutputStream baos2 = new ByteArrayOutputStream();","263","        TaskListener listener = new StreamTaskListener(baos2);","264","        psCustomizer.run(ps, baos1, baos2, listener);","265","        assertEquals(message, 0, ps.join());","266","        if (outputIn2) {","267","            assertThat(message, baos2.toString(), containsString(\"hello\"));","268","            assertThat(message, baos1.toString(), isEmptyString());","269","        } else {","270","            assertThat(message, baos1.toString(), containsString(\"hello\"));","271","            assertThat(message, baos2.toString(), isEmptyString());","272","        }","273","    }","274",""],"delete":[]}],"core\/src\/main\/java\/hudson\/Launcher.java":[{"add":["168","        private TaskListener stdoutListener;","169","        @CheckForNull","289","            stdoutListener = null;","296","         * @param out Task listener (must be safely remotable)","300","            stdout = out.getLogger();","301","            stdoutListener = out;","302","            return this;","497","            rhs.stdoutListener = stdoutListener;","1049","            final OutputStream out = ps.stdout == null || ps.stdoutListener != null ? null : new RemoteOutputStream(new CloseProofOutputStream(ps.stdout));","1057","                return new ProcImpl(getChannel().call(new RemoteLaunchCallable(ps.commands, ps.masks, ps.envs, in, ps.reverseStdin, out, ps.reverseStdout, err, ps.reverseStderr, ps.quiet, workDir, listener, ps.stdoutListener)));","1273","        private final @CheckForNull TaskListener stdoutListener;","1281","                boolean quiet, @CheckForNull String workDir, @Nonnull TaskListener listener, @CheckForNull TaskListener stdoutListener) {","1290","            this.stdoutListener = stdoutListener;","1300","            ps.cmds(cmd).masks(masks).envs(env).stdin(in).stderr(err).quiet(quiet);","1301","            if (stdoutListener != null) {","1302","                ps.stdout(stdoutListener.getLogger());","1303","            } else {","1304","                ps.stdout(out);","1305","            }"],"delete":["293","         * @param out Task listener","297","            return stdout(out.getLogger());","1043","            final OutputStream out = ps.stdout == null ? null : new RemoteOutputStream(new CloseProofOutputStream(ps.stdout));","1051","                return new ProcImpl(getChannel().call(new RemoteLaunchCallable(ps.commands, ps.masks, ps.envs, in, ps.reverseStdin, out, ps.reverseStdout, err, ps.reverseStderr, ps.quiet, workDir, listener)));","1274","                boolean quiet, @CheckForNull String workDir, @Nonnull TaskListener listener) {","1292","            ps.cmds(cmd).masks(masks).envs(env).stdin(in).stdout(out).stderr(err).quiet(quiet);"]}],"core\/src\/main\/java\/hudson\/model\/TaskListener.java":[{"add":["27","import hudson.remoting.Channel;","62"," *","63"," * <p>","64"," * Implementations are generally expected to be remotable via {@link Channel}."],"delete":["61"," * All the {@link TaskListener} implementations passed to plugins from Hudson core are remotable."]}]}},"3c5d7cc38aace954e08fbe4968427db132d30a2d":{"changes":{"war\/src\/main\/webapp\/css\/style.css":"MODIFY","changelog.html":"MODIFY"},"diff":{"war\/src\/main\/webapp\/css\/style.css":[{"add":["879","  z-index: 1000;"],"delete":["879","  z-index: 999;"]}],"changelog.html":[{"add":["57","\t<li class=bug>","58"," \t\tNew Breadcrumb bar covers search suggestions","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-13195\">issue 13195<\/a>)  "],"delete":[]}]}},"d98716dfbad96f566938b90a5a8b50ce9765575b":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["575","        File oldBuildDir = getBuildDir();","577","        File newBuildDir = getBuildDir();","578","        if (oldBuildDir.isDirectory() && !newBuildDir.isDirectory()) {","579","            if (!oldBuildDir.renameTo(newBuildDir)) {","580","                throw new IOException(\"failed to rename \" + oldBuildDir + \" to \" + newBuildDir);","581","            }","582","        }","583","    }","584","","585","    @Override public synchronized void delete() throws IOException, InterruptedException {","586","        super.delete();","587","        Util.deleteRecursive(getBuildDir());"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":[{"add":["356","    @Bug(17138)","357","    public void testExternalBuildDirectoryRenameDelete() throws Exception {","358","        HtmlForm form = new WebClient().goTo(\"configure\").getFormByName(\"config\");","359","        File builds = createTmpDir();","360","        form.getInputByName(\"_.rawBuildsDir\").setValueAttribute(builds + \"\/${ITEM_FULL_NAME}\");","361","        submit(form);","362","        assertEquals(builds + \"\/${ITEM_FULL_NAME}\", jenkins.getRawBuildsDir());","363","        FreeStyleProject p = jenkins.createProject(MockFolder.class, \"d\").createProject(FreeStyleProject.class, \"prj\");","364","        FreeStyleBuild b = p.scheduleBuild2(0).get();","365","        File oldBuildDir = new File(builds, \"d\/prj\");","366","        assertEquals(new File(oldBuildDir, b.getId()), b.getRootDir());","367","        assertTrue(b.getRootDir().isDirectory());","368","        p.renameTo(\"proj\");","369","        File newBuildDir = new File(builds, \"d\/proj\");","370","        assertEquals(new File(newBuildDir, b.getId()), b.getRootDir());","371","        assertTrue(b.getRootDir().isDirectory());","372","        p.delete();","373","        assertFalse(b.getRootDir().isDirectory());","374","    }","375",""],"delete":[]}],"changelog.html":[{"add":["70","    External build directories not updated by job rename\/delete.","71","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-17138\">issue 17138<\/a>)","72","  <li class=bug>"],"delete":[]}]}},"3170a1bc153bc12c68d0ac90ae5b701e2c9ec81d":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractItem.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractItem.java":[{"add":["422","                        LOGGER.log(Level.FINER, \"irrelevant {0} for {1} from {2}\", new Object[] {view.getViewName(), this, uri});"],"delete":["422","                        LOGGER.log(Level.FINER, \"irrelevant {0} for {1} from {2}\", new Object[] {last.getObject(), this, uri});"]}]}},"dd4fac9c242f796b24936903441e26c23cafa20d":{"changes":{"war\/resources\/WEB-INF\/web.xml":"MODIFY"},"diff":{"war\/resources\/WEB-INF\/web.xml":[{"add":["54","  <filter>","55","    <filter-name>plugins-filter<\/filter-name>","56","    <filter-class>hudson.util.PluginServletFilter<\/filter-class>","57","  <\/filter>","58","","105","  <!--","106","    HUDSON-1235 suggests containers interprt '*' as \"all roles defined in web.xml\"","107","    as opposed to \"all roles defined in the security realm\", so we need to list some","108","    common names in the hope that users will have at least one of those roles.","109","  -->","113","  <security-role>","114","    <role-name>user<\/role-name>","115","  <\/security-role>","116","  <security-role>","117","    <role-name>hudson<\/role-name>","118","  <\/security-role>"],"delete":["50","","55","  ","93","  ","94","  <filter>","95","    <filter-name>plugins-filter<\/filter-name>","96","    <filter-class>hudson.util.PluginServletFilter<\/filter-class>","97","  <\/filter>","103","  <!-- Uncomment this if you are protecting your entire hudson setup","104","  \tfrom public view.  See note above about the filter.","105","  <filter-mapping>","106","    <filter-name>change-headers-filter<\/filter-name>","107","    <!- This path should match the value of:","108","    \t\t\/security-constraint\/web-resource-collection\/url-pattern","109","     ->","110","    <url-pattern>\/*<\/url-pattern>","111","  <\/filter-mapping>","112","  -->","113","  ","119","    <!-- admins can add\/remove\/configure projects -->"]}]}},"4edbb06b2564e3a7ee53d95fc8a10838ca148da7":{"changes":{"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/slave-agent.jnlp.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/slaves\/JNLPLauncher\/config.jelly":"MODIFY","test\/src\/main\/java\/org\/jvnet\/hudson\/test\/HudsonTestCase.java":"MODIFY","core\/src\/main\/resources\/hudson\/slaves\/JNLPLauncher\/help-vmargs.html":"ADD","core\/src\/main\/java\/hudson\/slaves\/JNLPLauncher.java":"MODIFY","test\/src\/test\/java\/hudson\/slaves\/JNLPLauncherTest.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/slave-agent.jnlp.jelly":[{"add":["51","            <j2se version=\"1.5+\" java-vm-args=\"${it.launcher.vmargs} -Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=${port}\" \/>","54","            <j2se version=\"1.5+\" java-vm-args=\"${it.launcher.vmargs}\"\/>"],"delete":["51","            <j2se version=\"1.5+\" java-vm-args=\"-Xdebug -Xrunjdwp:transport=dt_socket,server=y,address=${port}\" \/>","54","            <j2se version=\"1.5+\" \/>"]}],"core\/src\/main\/resources\/hudson\/slaves\/JNLPLauncher\/config.jelly":[{"add":["29","    <f:entry title=\"${%JVM options}\" field=\"vmargs\">","30","      <f:textbox \/>","31","    <\/f:entry>"],"delete":[]}],"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/HudsonTestCase.java":[{"add":["76","import java.lang.reflect.Field;","582","            Object lp,rp;","583","            if(pd==null) {","584","                \/\/ field?","585","                try {","586","                    Field f1 = lhs.getClass().getField(p);","587","                    Field f2 = rhs.getClass().getField(p);","588","                    lp = f1.get(lhs);","589","                    rp = f2.get(rhs);","590","                } catch (NoSuchFieldException e) {","591","                    assertNotNull(\"No such property \"+p+\" on \"+lhs.getClass(),pd);","592","                    return;","593","                }","594","            } else {","595","                lp = PropertyUtils.getProperty(lhs, p);","596","                rp = PropertyUtils.getProperty(rhs, p);","597","            }"],"delete":["581","            assertNotNull(\"No such property \"+p+\" on \"+lhs.getClass(),pd);","582","            Object lp = PropertyUtils.getProperty(lhs, p);","583","            Object rp = PropertyUtils.getProperty(rhs, p);"]}],"core\/src\/main\/resources\/hudson\/slaves\/JNLPLauncher\/help-vmargs.html":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/slaves\/JNLPLauncher.java":[{"add":["51","    \/**","52","     * Additional JVM arguments. Can be null.","53","     * @since 1.297","54","     *\/","55","    public final String vmargs;","56","","58","    public JNLPLauncher(String tunnel, String vmargs) {","60","        this.vmargs = Util.fixEmptyAndTrim(vmargs);","64","        this(null,null);"],"delete":["52","    public JNLPLauncher(String tunnel) {","57","        this(null);"]}],"test\/src\/test\/java\/hudson\/slaves\/JNLPLauncherTest.java":[{"add":["143","","144","    public void testConfigRoundtrip() throws Exception {","145","        DumbSlave s = createSlave();","146","        JNLPLauncher original = new JNLPLauncher(\"a\", \"b\");","147","        s.setLauncher(original);","148","        HtmlPage p = new WebClient().getPage(s, \"configure\");","149","        submit(p.getFormByName(\"config\"));","150","        assertEqualBeans(original,s.getLauncher(),\"tunnel,vmargs\");","151","    }"],"delete":[]}]}},"e41e9c7964a02d097bb61c47d4d2f27969b2cd85":{"changes":{"core\/src\/main\/java\/hudson\/model\/User.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/User.java":[{"add":["28","import hudson.Functions;","274","        if (Functions.isWindows()) id = id.replace(':','_');","275",""],"delete":["273","        "]}]}},"91b99483a895f899e93c815eba61d4752c363668":{"changes":{"core\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["374","                    for(AbstractProject down : Hudson.getInstance().getDependencyGraph().getDownstream(getProject())) {","375","                        listener.getLogger().println(Messages.MavenBuild_Triggering(down.getName()));","376","                        down.scheduleBuild();","377","                    }"],"delete":["374","                    HashSet<AbstractProject> downstreams = new HashSet<AbstractProject>(project.modules.values());","375","                    downstreams.add(project);","376","                    for (ProxyImpl2 p : proxies.values())","377","                        p.owner().scheduleDownstreamBuilds(listener,downstreams);"]}]}},"ac62af3cc18ba66efd4ae4d81fbfeeff28dec9e3":{"changes":{"core\/src\/main\/java\/hudson\/Functions.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Functions.java":[{"add":["311","        if(s==null)     return false;"],"delete":[]}]}},"f356b78ea03309517b112bb46442287f81a4531d":{"changes":{"core\/src\/test\/java\/hudson\/util\/XStream2Test.java":"MODIFY","core\/src\/test\/resources\/hudson\/util\/runMatrix.xml":"ADD","core\/src\/main\/java\/hudson\/util\/xstream\/ImmutableListConverter.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/util\/XStream2Test.java":[{"add":["28","import hudson.matrix.MatrixRun;","38","import jenkins.model.CauseOfInterruption;","39","import jenkins.model.InterruptedBuildAction;","40","","43"," * @author Kohsuke Kawaguchi, Mike Dillon, Alan Harder, Richard Mortimer","244","","245","    \/**","246","     * Unmarshall a matrix build.xml result.","247","     * (JENKINS-10903)","248","     *\/","249","    public void testUnMarshalRunMatrix() {","250","        InputStream is = XStream2Test.class.getResourceAsStream(\"runMatrix.xml\");","251","        MatrixRun result = (MatrixRun) Run.XSTREAM.fromXML(is);","252","        assertNotNull(result);","253","        assertNotNull(result.getActions());","254","        assertEquals(2, result.getActions().size());","255","        InterruptedBuildAction action = (InterruptedBuildAction) result.getActions().get(1);","256","        assertNotNull(action.getCauses());","257","        assertEquals(1, action.getCauses().size());","258","        CauseOfInterruption.UserInterruption cause =","259","            (CauseOfInterruption.UserInterruption) action.getCauses().get(0);","260","        assertNotNull(cause);","261","    }"],"delete":["39"," * @author Kohsuke Kawaguchi, Mike Dillon, Alan Harder"]}],"core\/src\/test\/resources\/hudson\/util\/runMatrix.xml":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/util\/xstream\/ImmutableListConverter.java":[{"add":["33","import com.thoughtworks.xstream.mapper.CannotResolveClassException;","36","import hudson.util.RobustReflectionConverter;","37","","66","        String resolvesTo = reader.getAttribute(\"resolves-to\");","67","        if (\"com.google.common.collect.ImmutableList$SerializedForm\".equals(resolvesTo)) {","68","            \/\/ Skip into the elements element. This has the real children.","69","            List items = new ArrayList();","70","            if (reader.hasMoreChildren()) {","71","                reader.moveDown();","72","\t            \/\/ read the individual items from xml into a list","73","\t            while (reader.hasMoreChildren()) {","74","\t                reader.moveDown();","75","\t                try {","76","\t                    Object item = readItem(reader, context, items);","77","\t                    items.add(item);","78","\t                } catch (CannotResolveClassException e) {","79","\t                    RobustReflectionConverter.addErrorInContext(context, e);","80","\t                } catch (LinkageError e) {","81","\t                    RobustReflectionConverter.addErrorInContext(context, e);","82","\t                }","83","\t                reader.moveUp();","84","\t            }","85","","86","                \/\/ move back up past the elements element.","87","                reader.moveUp();","88","            }","89","            return ImmutableList.copyOf(items);","90","        } else {","91","            return ImmutableList.copyOf((List)super.unmarshal(reader, context));","92","        }"],"delete":["63","        return ImmutableList.copyOf((List)super.unmarshal(reader, context));"]}],"changelog.html":[{"add":["72","  <li class=bug>","73","    Cancelling a parent multi-config build produce deserializable build.xml","74","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10903\">issue 10903<\/a>)"],"delete":[]}]}},"0d63e6a8fad9f76532e5dc167c1275465e27e8a1":{"changes":{"test\/src\/test\/java\/hudson\/model\/RSSTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/RSS.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/RSSTest.java":[{"add":[],"delete":["44","    \/\/TODO remove the @Ignore ","45","    \/\/ Seems the XML parser on the CI machine is different \/ more picky than the one on my machine, will be covered by JENKINS-59231 to improve the code coverage","47","    @Ignore(\"XML parser too picky on CI\")","78","    \/\/TODO remove the @Ignore ","79","    \/\/ Seems the XML parser on the CI machine is different \/ more picky than the one on my machine, will be covered by JENKINS-59231 to improve the code coverage","81","    @Ignore(\"XML parser too picky on CI\")"]}],"core\/src\/main\/java\/hudson\/model\/RSS.java":[{"add":["84","        if (flavor.equals(\"atom\")) {","85","            rsp.setContentType(\"application\/atom+xml; charset=UTF-8\");","86","        } else {","87","            rsp.setContentType(\"text\/xml; charset=UTF-8\");","88","        }","89",""],"delete":[]}]}},"7c620e9fd321029e05f7cc994d3da1dde48411f7":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["114","      <version>build217-jenkins-5<\/version>"],"delete":["114","      <version>build217-jenkins-3<\/version>"]}],"changelog.html":[{"add":["57","  <li class=\"bug\">","58","    SSH slave connections die after the slave outputs 4MB of stderr, usually during findbugs analysis","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22938\">issue 22938<\/a>)"],"delete":["57","  <li class=>"]}]}},"44096c0d1496134d13819226354d4a1949f9f0ee":{"changes":{"core\/src\/main\/java\/hudson\/Util.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/Util.java":[{"add":[],"delete":["1011","                if (r!=0)   errmsg = LIBC.strerror(r);"]}]}},"5aa32c8681410eccfabf68397692f2402e615a48":{"changes":{"core\/src\/main\/resources\/hudson\/model\/queue\/CauseOfBlockage\/BecauseLabelIsOffline\/summary.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/queue\/CauseOfBlockage\/BecauseLabelIsOffline\/summary.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","core\/src\/main\/java\/hudson\/model\/queue\/CauseOfBlockage.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/queue\/CauseOfBlockage\/BecauseLabelIsOffline\/summary.jelly":[{"add":["26","  <j:choose>","27","    <j:when test=\"${it.label.isEmpty()}\">","28","      <st:structuredMessageFormat key=\"description_no_nodes\">","29","        <st:structuredMessageArgument>","30","          <a href=\"${rootURL}\/label\/${it.label.name}\" class=\"model-link\">${it.label.name}<\/a>","31","        <\/st:structuredMessageArgument>","32","      <\/st:structuredMessageFormat>","33","    <\/j:when>","34","    <j:otherwise>","35","      <st:structuredMessageFormat key=\"description\">","36","        <st:structuredMessageArgument>","37","          <a href=\"${rootURL}\/label\/${it.label.name}\" class=\"model-link\">${it.label.name}<\/a>","38","        <\/st:structuredMessageArgument>","39","      <\/st:structuredMessageFormat>","40","    <\/j:otherwise>","41","  <\/j:choose>"],"delete":["26","  <st:structuredMessageFormat key=\"description\">","27","    <st:structuredMessageArgument>","28","      <a href=\"${rootURL}\/label\/${it.label.name}\" class=\"model-link\">${it.label.name}<\/a>","29","    <\/st:structuredMessageArgument>","30","  <\/st:structuredMessageFormat>"]}],"core\/src\/main\/resources\/hudson\/model\/queue\/CauseOfBlockage\/BecauseLabelIsOffline\/summary.properties":[{"add":["23","description=All nodes of label \\u2018{0}\\u2019 are offline","24","description_no_nodes=There are no nodes with the label \\u2018{0}\\u2019"],"delete":["23","description=All nodes of label \\u2018{0}\\u2019 are offline"]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["191","Queue.LabelHasNoNodes=There are no nodes with the label \\u2018{0}\\u2019"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/queue\/CauseOfBlockage.java":[{"add":["116","            if (label.isEmpty()) {","117","                return Messages.Queue_LabelHasNoNodes(label.getName());","118","            } else {","119","                return Messages.Queue_AllNodesOffline(label.getName());","120","            }"],"delete":["116","            return Messages.Queue_AllNodesOffline(label.getName());"]}]}},"2c37b1d1ba5fbfcba6c82e58dcff14b382fc80cb":{"changes":{"test\/src\/test\/resources\/jenkins\/model\/GlobalBuildDiscarderTest\/testLoading\/jenkins.model.GlobalBuildDiscarderConfiguration.xml":"ADD","core\/src\/main\/java\/jenkins\/model\/GlobalBuildDiscarderConfiguration.java":"MODIFY","test\/src\/test\/resources\/jenkins\/model\/GlobalBuildDiscarderTest\/testLoadingWithDiscarders\/jenkins.model.GlobalBuildDiscarderConfiguration.xml":"ADD","test\/src\/test\/java\/jenkins\/model\/GlobalBuildDiscarderTest.java":"MODIFY"},"diff":{"test\/src\/test\/resources\/jenkins\/model\/GlobalBuildDiscarderTest\/testLoading\/jenkins.model.GlobalBuildDiscarderConfiguration.xml":[{"add":[],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/GlobalBuildDiscarderConfiguration.java":[{"add":["50","    public GlobalBuildDiscarderConfiguration() {","51","        load();","52","    }","53",""],"delete":[]}],"test\/src\/test\/resources\/jenkins\/model\/GlobalBuildDiscarderTest\/testLoadingWithDiscarders\/jenkins.model.GlobalBuildDiscarderConfiguration.xml":[{"add":[],"delete":[]}],"test\/src\/test\/java\/jenkins\/model\/GlobalBuildDiscarderTest.java":[{"add":["7","import hudson.util.DescribableList;","11","import org.jvnet.hudson.test.Issue;","13","import org.jvnet.hudson.test.recipes.LocalData;","20","    @LocalData","21","    @Issue(\"JENKINS-61688\")","22","    public void testLoading() throws Exception {","23","        Assert.assertEquals(0, GlobalBuildDiscarderConfiguration.get().getConfiguredBuildDiscarders().size());","24","    }","25","","26","    @Test","27","    @LocalData","28","    @Issue(\"JENKINS-61688\")","29","    public void testLoadingWithDiscarders() throws Exception {","30","        final DescribableList<GlobalBuildDiscarderStrategy, GlobalBuildDiscarderStrategyDescriptor> configuredBuildDiscarders = GlobalBuildDiscarderConfiguration.get().getConfiguredBuildDiscarders();","31","        Assert.assertEquals(2, configuredBuildDiscarders.size());","32","        Assert.assertNotNull(configuredBuildDiscarders.get(JobGlobalBuildDiscarderStrategy.class));","33","        Assert.assertEquals(5, ((LogRotator)configuredBuildDiscarders.get(SimpleGlobalBuildDiscarderStrategy.class).getDiscarder()).getNumToKeep());","34","    }","35","","36","    @Test"],"delete":[]}]}},"fe9b035b2db257a891cce09561756031db763628":{"changes":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/FormValidation.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","core\/src\/main\/java\/hudson\/model\/Slave.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Node\/help-numExecutors.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":[{"add":["1425","        public FormValidation doCheckNumExecutors(@QueryParameter String value) {","1426","            return FormValidation.validateNonNegativeInteger(value);","1427","        }","1428",""],"delete":[]}],"core\/src\/main\/java\/hudson\/util\/FormValidation.java":[{"add":["301","                return error(hudson.model.Messages.Hudson_NotANonNegativeNumber());","302","            return ok();","303","        } catch (NumberFormatException e) {","304","            return error(hudson.model.Messages.Hudson_NotANumber());","305","        }","306","    }","307","","308","    \/**","309","     * Makes sure that the given string is a positive integer.","310","     *\/","311","    public static FormValidation validatePositiveInteger(String value) {","312","        try {","313","            if(Integer.parseInt(value)<=0)"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["90","Hudson.NotANonNegativeNumber=Number may not be negative"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/Slave.java":[{"add":["429","            return FormValidation.validatePositiveInteger(value);"],"delete":["429","            return FormValidation.validateNonNegativeInteger(value);"]}],"core\/src\/main\/resources\/hudson\/model\/Node\/help-numExecutors.html":[{"add":["12","  from doing any building on its own.  Slaves may not have zero executors, but may be","13","  temporarily disabled using the button on the slave's status page.","14","<\/div>"],"delete":["12","  to do any build on its own.","13","<\/div>"]}]}},"4f0ca16b01abcd5ac84a9259736c2d96b1712354":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/NodeProvisioner.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/NodeProvisioner.java":[{"add":["219","                            try {","220","                                Node node = f.future.get();","221","                                for (CloudProvisioningListener cl : CloudProvisioningListener.all()) {","222","                                    cl.onComplete(f, node);","223","                                }","224","    ","225","                                jenkins.addNode(node);","226","                                LOGGER.log(Level.INFO,","227","                                        \"{0} provisioning successfully completed. \" ","228","                                                + \"We have now {1,number,integer} computer(s)\",","229","                                        new Object[]{f.displayName, jenkins.getComputers().length});","230","                            } catch (InterruptedException e) {","231","                                throw new AssertionError(e); \/\/ since we confirmed that the future is already done","232","                            } catch (ExecutionException e) {","233","                                LOGGER.log(Level.WARNING, \"Provisioned slave \" + f.displayName + \" failed to launch\",","234","                                        e.getCause());","235","                                for (CloudProvisioningListener cl : CloudProvisioningListener.all()) {","236","                                    cl.onFailure(f, e.getCause());","237","                                }","238","                            } catch (IOException e) {","239","                                LOGGER.log(Level.WARNING, \"Provisioned slave \" + f.displayName + \" failed to launch\", ","240","                                        e);","241","                                for (CloudProvisioningListener cl : CloudProvisioningListener.all()) {","242","                                    cl.onFailure(f, e);","243","                                }","244","                            } catch (Error e) {","245","                                \/\/ we are not supposed to try and recover from Errors","246","                                throw e;","247","                            } catch (Throwable e) {","248","                                LOGGER.log(Level.SEVERE, \"Unexpected uncaught exception encountered while \" ","249","                                        + \"processing provisioned slave \" + f.displayName, e);","250","                            } finally {","251","                                itr.remove();","252","                                f.spent();","253","                            }"],"delete":["215","                    List<PlannedNode> completedLaunches = new ArrayList<PlannedNode>();","220","                            completedLaunches.add(f);","221","                            itr.remove();","227","                    for (PlannedNode f : completedLaunches) {","228","                        try {","229","                            Node node = f.future.get();","230","                            for (CloudProvisioningListener cl : CloudProvisioningListener.all()) {","231","                                cl.onComplete(f, node);","232","                            }","233","","234","                            jenkins.addNode(node);","235","                            LOGGER.log(Level.INFO,","236","                                    \"{0} provisioning successfully completed. We have now {1,number,integer} computer\"","237","                                            + \"(s)\",","238","                                    new Object[]{f.displayName, jenkins.getComputers().length});","239","                        } catch (InterruptedException e) {","240","                            throw new AssertionError(e); \/\/ since we confirmed that the future is already done","241","                        } catch (ExecutionException e) {","242","                            LOGGER.log(Level.WARNING, \"Provisioned slave \" + f.displayName + \" failed to launch\",","243","                                    e.getCause());","244","                            for (CloudProvisioningListener cl : CloudProvisioningListener.all()) {","245","                                cl.onFailure(f, e.getCause());","246","                            }","247","                        } catch (IOException e) {","248","                            LOGGER.log(Level.WARNING, \"Provisioned slave \" + f.displayName + \" failed to launch\", e);","249","                            for (CloudProvisioningListener cl : CloudProvisioningListener.all()) {","250","                                cl.onFailure(f, e);","251","                            }","252","                        } finally {","253","                            f.spent();","254","                        }","255","                    }","256",""]}]}},"33101a3a01d3ec716a8c81eee97bbccde0c3793e":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["174","            Node node = computer.getNode(); \/\/ TODO should this rather be getBuiltOn()? Cf. JENKINS-18898"],"delete":["174","            Node node = computer.getNode();"]}]}},"2d44c63d7006cc3e7c26b220cb4e7cf660451991":{"changes":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":"MODIFY","core\/pom.xml":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tools\/JDKInstaller.java":[{"add":["307","                IOUtils.copy(new RetryableHttpStream(src) {","308","                    @Override","309","                    protected HttpURLConnection connect() throws IOException {","310","                        return (HttpURLConnection) ProxyConfiguration.open(url);","311","                    }","312","                }, out);"],"delete":["307","                IOUtils.copy(new RetryableHttpStream(src), out);"]}],"core\/pom.xml":[{"add":["793","      <version>1.1<\/version>"],"delete":["793","      <version>1.0<\/version>"]}]}},"2836ae459c376b92dacc6ac01ed4b6e8633d733b":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["58","\tFixed extra ' character in french translation.","59","\t(<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9197\">issue 9197<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"b653dc264df74bfc95d5aa7e937be106b7e2786e":{"changes":{"core\/src\/main\/resources\/hudson\/ProxyConfiguration\/help-name_pt_BR.html":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/ProxyConfiguration\/help-name_pt_BR.html":[{"add":["8","  Deixar este campo vazio","9","  faz com que o Jenkins tente conectar &#224; internet diretamente."],"delete":["8","  O valor que voc&#234; colocar aqui ser&#225; atribu&#237;do a propriedade de sistema <tt>http.proxyHost<\/tt>. Deixar este campo vazio","9","  deixa esta propriedade sem atribui&#231;&#227;o, o que significa que o Jenkins tentar&#225; conectar ao host externo diretamente."]}]}},"ab16e52519260c0e9398f15256ed8061a4c00bf0":{"changes":{"test\/src\/test\/java\/jenkins\/I18nTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/util\/ResourceBundleUtil.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/HttpResponses.java":"MODIFY"},"diff":{"test\/src\/test\/java\/jenkins\/I18nTest.java":[{"add":["25","import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;","34","import org.jvnet.hudson.test.Issue;","53","        try {","54","            JSONObject response = jenkinsRule.getJSON(\"i18n\/resourceBundle?baseName=com.acme.XyzWhatever\").getJSONObject();","55","        } catch (FailingHttpStatusCodeException e) {","56","            Assert.assertNotNull(e);","57","            Assert.assertTrue(e.getMessage().contains(\"com.acme.XyzWhatever\"));","58","        }","59","    }","60","","61","    @Issue(\"JENKINS-35270\")","62","    @Test","63","    public void test_baseName_plugin() throws IOException, SAXException {","64","        \/\/ ssh-slaves plugin is installed by default","65","        JSONObject response = jenkinsRule.getJSON(\"i18n\/resourceBundle?baseName=hudson.plugins.sshslaves.Messages\").getJSONObject();","66","        Assert.assertEquals(\"ok\", response.getString(\"status\"));","67","        JSONObject data = response.getJSONObject(\"data\");","68","        Assert.assertEquals(\"The launch timeout must be a number.\", data.getString(\"SSHConnector.LaunchTimeoutMustBeANumber\"));"],"delete":["51","        JSONObject response = jenkinsRule.getJSON(\"i18n\/resourceBundle?baseName=com.acme.XyzWhatever\").getJSONObject();","52","        Assert.assertEquals(\"error\", response.getString(\"status\"));","53","        Assert.assertTrue(response.getString(\"message\").contains(\"com.acme.XyzWhatever\"));"]}],"core\/src\/main\/java\/jenkins\/util\/ResourceBundleUtil.java":[{"add":["29","import javax.annotation.CheckForNull;","31","import hudson.PluginWrapper;","32","import java.util.logging.Logger;","38","import jenkins.model.Jenkins;","48","    private static final Logger logger = Logger.getLogger(\"jenkins.util.ResourceBundle\");","79","        ResourceBundle bundle = getBundle(baseName, locale, Jenkins.class.getClassLoader());","80","        if (bundle == null) {","81","            \/\/ Not in Jenkins core. Check the plugins.","82","            Jenkins jenkins = Jenkins.getInstance(); \/\/ will never return null","83","            if (jenkins != null) {","84","                for (PluginWrapper plugin : jenkins.getPluginManager().getPlugins()) {","85","                    bundle = getBundle(baseName, locale, plugin.classLoader);","86","                    if (bundle != null) {","87","                        break;","88","                    }","89","                }","90","            }","91","        }","92","        if (bundle == null) {","93","            throw new MissingResourceException(\"Can't find bundle for base name \"","94","                    + baseName + \", locale \" + locale, baseName + \"_\" + locale, \"\");","95","        }","103","    \/**","104","     * Get a plugin bundle using the supplied Locale and classLoader","105","     *","106","     * @param baseName The bundle base name.","107","     * @param locale The Locale.","108","     * @param classLoader The classLoader","109","     * @return The bundle JSON.","110","     *\/","111","    private static @CheckForNull ResourceBundle getBundle(@Nonnull String baseName, @Nonnull Locale locale, @Nonnull ClassLoader classLoader) {","112","        try {","113","            return ResourceBundle.getBundle(baseName, locale, classLoader);","114","        } catch (MissingResourceException e) {","115","            \/\/ fall through and return null.","116","            logger.warning(e.getMessage());","117","        }","118","        return null;","119","    }","120","","121","    \/**","122","     * Create a JSON representation of a resource bundle","123","     *","124","     * @param bundle The resource bundle.","125","     * @return The bundle JSON.","126","     *\/"],"delete":["74","        ResourceBundle bundle = ResourceBundle.getBundle(baseName, locale);"]}],"core\/src\/main\/java\/hudson\/util\/HttpResponses.java":[{"add":["31","import javax.annotation.CheckForNull;"],"delete":[]}]}},"b074b1aa19193dfaf317dfc86e4d3d4f23236965":{"changes":{"core\/src\/main\/resources\/hudson\/diagnosis\/OldDataMonitor\/manage.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/diagnosis\/OldDataMonitor\/manage.jelly":[{"add":["37","          <j:when test=\"${item.value!=''}\">","42","              <td>","43","                <j:choose>","44","                  <j:when test=\"${item.value.isOld(150)}\">","45","                    <b title=\"${%Very old version}\">${item.value}<\/b>","46","                  <\/j:when>","47","                  <j:otherwise>","48","                    ${item.value}","49","                  <\/j:otherwise>","50","                <\/j:choose>","51","              <\/td>"],"delete":["36","        <j:set var=\"range\" value=\"${item.value}\"\/>","38","          <j:when test=\"${range!=''}\">","39","            <j:if test=\"${range.isOld(150)}\"><j:set var=\"range\"><b>${range}<\/b><\/j:set><\/j:if>","44","              <td>${range}<\/td>"]}]}},"03ee6519cc1d3070ae4682804d1b85c720b129de":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["67","    Run parameters should show display name if set, rather than build numbers."],"delete":["67","    Run parameters should display in human readable form rather than build numbers."]}]}},"10c56deb0289120f6040d74532bf0a2672ace444":{"changes":{"core\/src\/main\/java\/hudson\/scm\/SCM.java":"MODIFY","core\/src\/main\/java\/hudson\/scm\/RepositoryBrowser.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/ApiTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/SCM.java":[{"add":["122","    @Exported(name=\"browser\")"],"delete":["100","    @Exported","123","    @Exported"]}],"core\/src\/main\/java\/hudson\/scm\/RepositoryBrowser.java":[{"add":["36","import org.kohsuke.stapler.export.ExportedBean;","57","@ExportedBean"],"delete":["28","import hudson.tasks.BuildWrapper;"]}],"test\/src\/test\/java\/hudson\/model\/ApiTest.java":[{"add":["27","import hudson.scm.CVSSCM;","28","import hudson.scm.browsers.ViewCVS;","29","import java.lang.reflect.Field;","30","import java.net.URL;","88","    @Bug(4760)","91","        assertBuildStatusSuccess(p.scheduleBuild2(0).get());","92","        CVSSCM scm = new CVSSCM(\":pserver:nowhere.net\/cvs\/foo\", \".\", null, null, true, true, false, null);","93","        p.setScm(scm);","94","        Field repositoryBrowser = scm.getClass().getDeclaredField(\"repositoryBrowser\");","95","        repositoryBrowser.setAccessible(true);","96","        repositoryBrowser.set(scm, new ViewCVS(new URL(\"http:\/\/nowhere.net\/viewcvs\/\")));","98","        new WebClient().goTo(p.getUrl()+\"api\/xml?depth=999\", \"application\/xml\");"],"delete":[]}]}},"4c2f865770286e120c3fbc2a470159f5c1346511":{"changes":{"core\/src\/main\/resources\/hudson\/model\/PermalinkProjectAction\/Permalink\/link_pl.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/PermalinkProjectAction\/Permalink\/link_pl.properties":[{"add":["22","format={0} ({1}), {2} temu"],"delete":["22","format=0} ({1}), {2} temu"]}]}},"89ce85dfc88b21cdb7a8bc95d89b24259b987d19":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/JobTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["1212","            if (validRename(name, newName)) {","1213","                newName = newName.trim();","1234","    private boolean validRename(String oldName, String newName) {","1235","        if (newName == null) {","1236","            return false;","1237","        }","1238","        boolean noChange = oldName.equals(newName);","1239","        boolean spaceAdded = oldName.equals(newName.trim());","1240","        return !noChange && !spaceAdded;","1241","    }","1242",""],"delete":["1212","            if (newName != null && !newName.equals(name)) {"]}],"test\/src\/test\/java\/hudson\/model\/JobTest.java":[{"add":["4"," * Copyright (c) 2015 Christopher Simons","28","import com.gargoylesoftware.htmlunit.html.HtmlForm;","33","import hudson.Functions;","37","import java.text.MessageFormat;","48","import org.jvnet.hudson.test.JenkinsRule.WebClient;","52","import static org.hamcrest.Matchers.endsWith;","53","import static org.junit.Assert.*;","54","import static org.junit.Assume.assumeFalse;","55","","296","    @Issue(\"JENKINS-30502\")","297","    @Test","298","    public void testRenameTrimsLeadingSpace() throws Exception {","299","        tryRename(\"myJob1\", \" foo\", \"foo\", false);","300","    }","301","","302","    @Issue(\"JENKINS-30502\")","303","    @Test","304","    public void testRenameTrimsTrailingSpace() throws Exception {","305","        tryRename(\"myJob2\", \"foo \", \"foo\", false);","306","    }","307","","308","    @Issue(\"JENKINS-30502\")","309","    @Test","310","    public void testAllowTrimmingByUser() throws Exception {","311","        assumeFalse(\"Unix-only test.\", Functions.isWindows());","312","        tryRename(\"myJob3 \", \"myJob3\", \"myJob3\", false);","313","    }","314","","315","    @Issue(\"JENKINS-30502\")","316","    @Test","317","    public void testRenameWithLeadingSpaceTrimsLeadingSpace() throws Exception {","318","        assumeFalse(\"Unix-only test.\", Functions.isWindows());","319","        tryRename(\" myJob4\", \" foo\", \"foo\", false);","320","    }","321","","322","    @Issue(\"JENKINS-30502\")","323","    @Test","324","    public void testRenameWithLeadingSpaceTrimsTrailingSpace()","325","            throws Exception {","326","        assumeFalse(\"Unix-only test.\", Functions.isWindows());","327","        tryRename(\" myJob5\", \"foo \", \"foo\", false);","328","    }","329","","330","    @Issue(\"JENKINS-30502\")","331","    @Test","332","    public void testRenameWithTrailingSpaceTrimsTrailingSpace()","333","            throws Exception {","334","        assumeFalse(\"Unix-only test.\", Functions.isWindows());","335","        tryRename(\"myJob6 \", \"foo \", \"foo\", false);","336","    }","337","","338","    @Issue(\"JENKINS-30502\")","339","    @Test","340","    public void testRenameWithTrailingSpaceTrimsLeadingSpace()","341","            throws Exception {","342","        assumeFalse(\"Unix-only test.\", Functions.isWindows());","343","        tryRename(\"myJob7 \", \" foo\", \"foo\", false);","344","    }","345","","346","    @Issue(\"JENKINS-30502\")","347","    @Test","348","    public void testDoNotAutoTrimExistingUntrimmedNames() throws Exception {","349","        assumeFalse(\"Unix-only test.\", Functions.isWindows());","350","        tryRename(\"myJob8 \", \"myJob8 \", null, true);","351","    }","352","","353","    private void tryRename(String initialName, String submittedName,","354","            String correctResult, boolean shouldSkipConfirm) throws Exception {","355","        j.jenkins.setCrumbIssuer(null);","356","","357","        FreeStyleProject job = j.createFreeStyleProject(initialName);","358","        WebClient wc = j.createWebClient();","359","        HtmlForm form = wc.getPage(job, \"configure\").getFormByName(\"config\");","360","        form.getInputByName(\"name\").setValueAttribute(submittedName);","361","        HtmlPage resultPage = j.submit(form);","362","","363","        String urlTemplate;","364","        if (shouldSkipConfirm) {","365","            urlTemplate = \"\/job\/{0}\/\";","366","        } else {","367","            urlTemplate = \"\/job\/{0}\/rename?newName={1}\";","368","        }","369","","370","        String urlString = MessageFormat.format(","371","                urlTemplate, initialName, correctResult).replace(\" \", \"%20\");","372","","373","        assertThat(resultPage.getUrl().toString(), endsWith(urlString));","374","    }"],"delete":["39","import static org.junit.Assert.*;"]}]}},"bb265c5e95b0fe39128720b903914236962db41b":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["114","      <version>build217-jenkins-3<\/version>"],"delete":["114","      <version>build214-jenkins-3<\/version>"]}],"changelog.html":[{"add":["60","  <li class='major bug'>","61","    Upgrade Trilead SSH client library to version that does not cause connection loss when","62","    there is a lot of logging on the build slave and the performance improvements in","63","    ssh-slaves 0.27+ are enabled (","64","    <a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18836\">issue 18836<\/a>,","65","    <a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18879\">issue 18879<\/a>,","66","    <a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-19619\">issue 19619<\/a>)"],"delete":[]}]}},"7bef2e44aef54bc76235fee4970a52f6f0456f49":{"changes":{"core\/src\/main\/resources\/jenkins\/split-plugin-cycles.txt":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/split-plugin-cycles.txt":[{"add":[],"delete":["12","","13","apache-httpcomponents-client-4-api jdk-tool"]}]}},"991e7f8fdd02db0d05256b4a7c81c40d742a1f29":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":[{"add":["166","        if(!forceReconnect && isConnecting())","168","        if(forceReconnect && isConnecting())","290","            public void onClosed(Channel c, IOException cause) {","292","                \/\/ Orderly shutdown will have null exception","293","                if (cause!=null) offlineCause = new ChannelTermination(cause);","461","        if(constructed!=null) {","462","            if (node instanceof Slave)","463","                ((Slave)node).getRetentionStrategy().check(this);","464","            else","465","                connect(false);","466","        }"],"delete":["166","        if(!forceReconnect && lastConnectActivity!=null)","168","        if(forceReconnect && lastConnectActivity!=null)","290","            public void onClosed(Channel c,IOException cause) {","292","                offlineCause = new ChannelTermination(cause);","460","        if(constructed!=null)","461","            connect(false);"]}]}},"ca067fd2732d480f637175f072ed0ecdb5d3478c":{"changes":{"test\/src\/test\/java\/hudson\/model\/DirectoryBrowserSupportTest.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/DirectoryBrowserSupportTest.java":[{"add":["173","        File file = File.createTempFile(\"DirectoryBrowserSupport\", \"zipDownload\");"],"delete":["173","        File file = new File(\"\/home\/ogondza\/zipfile\");\/\/File.createTempFile(\"DirectoryBrowserSupport\", \"zipDownload\");"]}]}},"735713801b130fe247cf17bbca7b4561e41b1d13":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/ArchitectureMonitor.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/Node.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/AbstractAsyncNodeMonitorDescriptor.java":"ADD","core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/FilePath.java":"MODIFY","core\/src\/test\/java\/hudson\/slaves\/NodeListTest.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Slave.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/ResponseTimeMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/ClockMonitor.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/AbstractNodeMonitorDescriptor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/TemporarySpaceMonitor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/ArchitectureMonitor.java":[{"add":["40","    public static final class DescriptorImpl extends AbstractAsyncNodeMonitorDescriptor<String> {","41","        @Override","42","        protected Callable<String, IOException> createCallable(Computer c) {","43","            return new GetArchTask();","58","    private static class GetArchTask implements Callable<String,IOException> {"],"delete":["40","    public static final class DescriptorImpl extends AbstractNodeMonitorDescriptor<String> {","41","        protected String monitor(Computer c) throws IOException, InterruptedException {","42","            return c.getChannel().call(new GetArchTask());","57","    private static class GetArchTask implements Callable<String,RuntimeException> {"]}],"changelog.html":[{"add":["57","  <li class=rfe>","58","    Node monitoring now happens concurrently across all the slaves, so it'll be affected less by problematic slaves.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18438\">issue 18438<\/a>)"],"delete":["57","  <li class=>"]}],"core\/src\/main\/java\/hudson\/model\/Node.java":[{"add":["37","import hudson.remoting.Callable;","448","    public ClockDifference getClockDifference() throws IOException, InterruptedException {","449","        VirtualChannel channel = getChannel();","450","        if(channel==null)","451","            throw new IOException(getNodeName()+\" is offline\");","452","","453","        return channel.call(getClockDifferenceCallable());","454","    }","455","","456","    \/**","457","     * Returns a {@link Callable} that when run on the channel, estimates the clock difference.","458","     *","459","     * @return","460","     *      always non-null.","461","     * @sine 1.522","462","     *\/","463","    public abstract Callable<ClockDifference,IOException> getClockDifferenceCallable();"],"delete":["447","    public abstract ClockDifference getClockDifference() throws IOException, InterruptedException;"]}],"core\/src\/main\/java\/hudson\/node_monitors\/AbstractAsyncNodeMonitorDescriptor.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":[{"add":["80","    public static final AbstractNodeMonitorDescriptor<MemoryUsage> DESCRIPTOR = new AbstractAsyncNodeMonitorDescriptor<MemoryUsage>() {","81","        @Override","82","        protected MonitorTask createCallable(Computer c) {","83","            return new MonitorTask();"],"delete":["80","    public static final AbstractNodeMonitorDescriptor<MemoryUsage> DESCRIPTOR = new AbstractNodeMonitorDescriptor<MemoryUsage>() {","81","        protected MemoryUsage monitor(Computer c) throws IOException, InterruptedException {","82","            return c.getChannel().call(new MonitorTask());"]}],"core\/src\/main\/java\/hudson\/FilePath.java":[{"add":["72","import java.io.InterruptedIOException;","1002","     * Takes a {@link FilePath}+{@link FileCallable} pair and returns the equivalent {@link Callable}.","1003","     * When executing the resulting {@link Callable}, it executes {@link FileCallable#act(FileCallable)}","1004","     * on this {@link FilePath}.","1005","     *","1006","     * @since 1.522","1007","     *\/","1008","    public <V> Callable<V,IOException> asCallableWith(final FileCallable<V> task) {","1009","        return new Callable<V,IOException>() {","1010","            @Override","1011","            public V call() throws IOException {","1012","                try {","1013","                    return act(task);","1014","                } catch (InterruptedException e) {","1015","                    throw (IOException)new InterruptedIOException().initCause(e);","1016","                }","1017","            }","1018","            private static final long serialVersionUID = 1L;","1019","        };","1020","    }","1021","","1022","    \/**"],"delete":[]}],"core\/src\/test\/java\/hudson\/slaves\/NodeListTest.java":[{"add":["26","import hudson.remoting.Callable;","101","        @Override","102","        public Callable<ClockDifference, IOException> getClockDifferenceCallable() {"],"delete":["100","        public ClockDifference getClockDifference() throws IOException, InterruptedException {"]}],"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":[{"add":["49","public abstract class DiskSpaceMonitorDescriptor extends AbstractAsyncNodeMonitorDescriptor<DiskSpace> {"],"delete":["49","public abstract class DiskSpaceMonitorDescriptor extends AbstractNodeMonitorDescriptor<DiskSpace> {"]}],"core\/src\/main\/java\/hudson\/model\/Slave.java":[{"add":["58","import hudson.util.TimeUnit2;","254","    @Override","255","    public Callable<ClockDifference,IOException> getClockDifferenceCallable() {","256","        return new GetClockDifference1();","427","     * Obtains the clock difference between this side and that side of the channel.","428","     *","429","     * <p>","430","     * This is a hack to wrap the whole thing into a simple {@link Callable}.","431","     *","432","     * <ol>","433","     *     <li>When the callable is sent to remote, we capture the time (on this side) in {@link GetClockDifference2#startTime}","434","     *     <li>When the other side receives the callable it is {@link GetClockDifference2}.","435","     *     <li>We capture the time on the other side and {@link GetClockDifference3} gets sent from the other side","436","     *     <li>When it's read on this side as a return value, it morphs itself into {@link ClockDifference}.","437","     * <\/ol>","439","    private static final class GetClockDifference1 implements Callable<ClockDifference,IOException> {","440","        public ClockDifference call() {","441","            \/\/ this method must be being invoked locally, which means the clock is in sync","442","            return new ClockDifference(0);","443","        }","444","","445","        private Object writeReplace() {","446","            return new GetClockDifference2();","452","    private static final class GetClockDifference2 implements Callable<GetClockDifference3,IOException> {","453","        \/**","454","         * Capture the time on the master when this object is sent to remote, which is when","455","         * {@link GetClockDifference1#writeReplace()} is run.","456","         *\/","457","        private final long startTime = System.nanoTime();","458","","459","        public GetClockDifference3 call() {","460","            return new GetClockDifference3(startTime);","461","        }","462","","463","        private static final long serialVersionUID = 1L;","464","    }","465","","466","    private static final class GetClockDifference3 implements Serializable {","467","        private final long remoteTime = System.nanoTime();","468","        private final long startTime;","469","","470","        public GetClockDifference3(long startTime) {","471","            this.startTime = startTime;","472","        }","473","","474","        private Object readResolve() {","475","            long endTime = System.nanoTime();","476","            return new ClockDifference(TimeUnit2.NANOSECONDS.toMillis((startTime + endTime)\/2-remoteTime));","477","        }","478","    }","479",""],"delete":["32","import hudson.remoting.VirtualChannel;","254","    public ClockDifference getClockDifference() throws IOException, InterruptedException {","255","        VirtualChannel channel = getChannel();","256","        if(channel==null)","257","            throw new IOException(getNodeName()+\" is offline\");","258","","259","        long startTime = System.currentTimeMillis();","260","        long slaveTime = channel.call(new GetSystemTime());","261","        long endTime = System.currentTimeMillis();","262","","263","        return new ClockDifference((startTime+endTime)\/2 - slaveTime);","434","     * Obtains the system clock.","436","    private static final class GetSystemTime implements Callable<Long,RuntimeException> {","437","        public Long call() {","438","            return System.currentTimeMillis();"]}],"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitor.java":[{"add":["29","import hudson.remoting.Callable;","67","        @Override","68","        protected Callable<DiskSpace, IOException> createCallable(Computer c) {","72","            return p.asCallableWith(new GetUsableSpace());"],"delete":["66","        @Override protected DiskSpace monitor(Computer c) throws IOException, InterruptedException {","70","            return p.act(new GetUsableSpace());"]}],"core\/src\/main\/java\/hudson\/node_monitors\/ResponseTimeMonitor.java":[{"add":["31","import hudson.util.ClockDifference;","38","import java.io.Serializable;","39","import java.util.Map;","40","import java.util.Map.Entry;","55","    public static final AbstractNodeMonitorDescriptor<Data> DESCRIPTOR = new AbstractAsyncNodeMonitorDescriptor<Data>() {","56","        @Override","57","        protected Callable<Data,IOException> createCallable(Computer c) {","58","            return new Step1(get(c));","59","        }","61","        @Override","62","        protected Map<Computer, Data> monitor() throws InterruptedException {","63","            Map<Computer, Data> base = super.monitor();","64","            for (Entry<Computer, Data> e : base.entrySet()) {","65","                Computer c = e.getKey();","66","                Data d = e.getValue();","67","                if (d ==null) {","68","                    \/\/ if we failed to monitor, put in the special value that indicates a failure","69","                    e.setValue(d=new Data(get(c),-1L));","70","                }","72","                if(d.hasTooManyTimeouts() && !isIgnored()) {","73","                    \/\/ unlike other monitors whose failure still allow us to communicate with the slave,","74","                    \/\/ the failure in this monitor indicates that we are just unable to make any requests","75","                    \/\/ to this slave. So we should severe the connection, as opposed to marking it temporarily","76","                    \/\/ off line, which still keeps the underlying channel open.","77","                    c.disconnect(d);","78","                    LOGGER.warning(Messages.ResponseTimeMonitor_MarkedOffline(c.getName()));","79","                }","81","            return base;","94","    private static final class Step1 implements Callable<Data,IOException> {","95","        private Data cur;","96","","97","        private Step1(Data cur) {","98","            this.cur = cur;","99","        }","100","","101","        public Data call() {","102","            \/\/ this method must be being invoked locally, which means the roundtrip time is zero and zero forever","103","            return new Data(cur,0);","104","        }","105","","106","        private Object writeReplace() {","107","            return new Step2(cur);","108","        }","109","","110","        private static final long serialVersionUID = 1L;","111","    }","112","","113","    private static final class Step2 implements Callable<Step3,IOException> {","114","        private final Data cur;","115","        private final long start = System.nanoTime();","116","","117","        public Step2(Data cur) {","118","            this.cur = cur;","119","        }","120","","121","        public Step3 call() {","122","            \/\/ this method must be being invoked locally, which means the roundtrip time is zero and zero forever","123","            return new Step3(cur,start);","124","        }","125","","126","        private static final long serialVersionUID = 1L;","127","    }","128","","129","    private static final class Step3 implements Serializable {","130","        private final Data cur;","131","        private final long start;","132","","133","        private Step3(Data cur, long start) {","134","            this.cur = cur;","135","            this.start = start;","136","        }","137","","138","        private Object readResolve() {","139","            long end = System.nanoTime();","140","            return new Data(cur,TimeUnit2.NANOSECONDS.toMillis(end-start));","141","        }","142","","143","        private static final long serialVersionUID = 1L;","144","    }","145","","150","    public static final class Data extends OfflineCause implements Serializable {"],"delete":["51","    public static final AbstractNodeMonitorDescriptor<Data> DESCRIPTOR = new AbstractNodeMonitorDescriptor<Data>() {","52","        protected Data monitor(Computer c) throws IOException, InterruptedException {","53","            Data old = get(c);","54","            Data d;","56","            long start = System.nanoTime();","57","            Future<String> f = c.getChannel().callAsync(new NoopTask());","58","            try {","59","                f.get(TIMEOUT, TimeUnit.MILLISECONDS);","60","                long end = System.nanoTime();","61","                d = new Data(old,TimeUnit2.NANOSECONDS.toMillis(end-start));","62","            } catch (ExecutionException e) {","63","                throw new IOException2(e.getCause());    \/\/ I don't think this is possible","64","            } catch (TimeoutException e) {","65","                \/\/ special constant to indicate that the processing timed out.","66","                d = new Data(old,-1L);","67","            }","69","            if(d.hasTooManyTimeouts() && !isIgnored()) {","70","                \/\/ unlike other monitors whose failure still allow us to communicate with the slave,","71","                \/\/ the failure in this monitor indicates that we are just unable to make any requests","72","                \/\/ to this slave. So we should severe the connection, as opposed to marking it temporarily","73","                \/\/ off line, which still keeps the underlying channel open.","74","                c.disconnect(d);","75","                LOGGER.warning(Messages.ResponseTimeMonitor_MarkedOffline(c.getName()));","77","            return d;","94","    public static final class Data extends OfflineCause {","155","    }","156","","157","    private static class NoopTask implements Callable<String,RuntimeException> {","158","        public String call() {","159","            return null;","160","        }"]}],"core\/src\/main\/java\/hudson\/node_monitors\/ClockMonitor.java":[{"add":["27","import hudson.remoting.Callable;","49","    public static final AbstractNodeMonitorDescriptor<ClockDifference> DESCRIPTOR = new AbstractAsyncNodeMonitorDescriptor<ClockDifference>() {","50","        @Override","51","        protected Callable<ClockDifference,IOException> createCallable(Computer c) {","54","            return n.getClockDifferenceCallable();"],"delete":["48","    public static final AbstractNodeMonitorDescriptor<ClockDifference> DESCRIPTOR = new AbstractNodeMonitorDescriptor<ClockDifference>() {","49","        protected ClockDifference monitor(Computer c) throws IOException, InterruptedException {","52","            return n.getClockDifference();"]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["128","import hudson.remoting.Callable;","1963","    @Override","1964","    public Callable<ClockDifference, IOException> getClockDifferenceCallable() {","1965","        return new Callable<ClockDifference, IOException>() {","1966","            public ClockDifference call() throws IOException {","1967","                return new ClockDifference(0);","1968","            }","1969","        };","1970","    }","1971",""],"delete":[]}],"core\/src\/main\/java\/hudson\/node_monitors\/AbstractNodeMonitorDescriptor.java":[{"add":["36","import java.util.Collections;","54","    \/**","55","     * @deprecated as of 1.522","56","     *      Extend from {@link AbstractAsyncNodeMonitorDescriptor}","57","     *\/","62","    \/**","63","     * @deprecated as of 1.522","64","     *      Extend from {@link AbstractAsyncNodeMonitorDescriptor}","65","     *\/","70","    \/**","71","     * @deprecated as of 1.522","72","     *      Extend from {@link AbstractAsyncNodeMonitorDescriptor}","73","     *\/","78","    \/**","79","     * @deprecated as of 1.522","80","     *      Extend from {@link AbstractAsyncNodeMonitorDescriptor}","81","     *\/","126","     * Performs monitoring across the board.","127","     *","128","     * @return","129","     *      For all the computers, report the monitored values.","130","     *\/","131","    protected Map<Computer,T> monitor() throws InterruptedException {","132","        Map<Computer,T> data = new HashMap<Computer,T>();","133","        for( Computer c : Jenkins.getInstance().getComputers() ) {","134","            try {","135","                Thread.currentThread().setName(\"Monitoring \"+c.getDisplayName()+\" for \"+getDisplayName());","136","","137","                if(c.getChannel()==null)","138","                    data.put(c,null);","139","                else","140","                    data.put(c,monitor(c));","141","            } catch (RuntimeException e) {","142","                LOGGER.log(Level.WARNING, \"Failed to monitor \"+c.getDisplayName()+\" for \"+getDisplayName(), e);","143","            } catch (IOException e) {","144","                LOGGER.log(Level.WARNING, \"Failed to monitor \"+c.getDisplayName()+\" for \"+getDisplayName(), e);","145","            } catch (InterruptedException e) {","146","                throw (InterruptedException)new InterruptedException(\"Node monitoring \"+c.getDisplayName()+\" for \"+getDisplayName()+\" aborted.\").initCause(e);","147","            }","148","        }","149","        return data;","150","    }","151","","152","    \/**","260","        private \/*final*\/ Map<Computer,T> data = Collections.emptyMap();","281","                data=monitor();"],"delete":["216","        private final Map<Computer,T> data = new HashMap<Computer,T>();","237","","238","                for( Computer c : Jenkins.getInstance().getComputers() ) {","239","                    try {","240","                        setName(\"Monitoring \"+c.getDisplayName()+\" for \"+getDisplayName());","241","","242","                        if(c.getChannel()==null)","243","                            data.put(c,null);","244","                        else","245","                            data.put(c,monitor(c));","246","                    } catch (RuntimeException e) {","247","                        LOGGER.log(Level.WARNING, \"Failed to monitor \"+c.getDisplayName()+\" for \"+getDisplayName(), e);","248","                    } catch (IOException e) {","249","                        LOGGER.log(Level.WARNING, \"Failed to monitor \"+c.getDisplayName()+\" for \"+getDisplayName(), e);","250","                    } catch (InterruptedException e) {","251","                        LOGGER.log(Level.FINE,\"Node monitoring \"+c.getDisplayName()+\" for \"+getDisplayName()+\" aborted.\",e);","252","                        return; \/\/ we are told to die","253","                    }","254","                }"]}],"core\/src\/main\/java\/hudson\/node_monitors\/TemporarySpaceMonitor.java":[{"add":["30","import hudson.remoting.Callable;","69","        @Override","70","        protected Callable<DiskSpace,IOException> createCallable(Computer c) {","74","            return p.asCallableWith(new GetTempSpace());"],"delete":["68","        @Override protected DiskSpace monitor(Computer c) throws IOException, InterruptedException {","72","            return p.act(new GetTempSpace());"]}]}},"b68aaa65f322f7dea271b844966cf582e67c876e":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["69","    \"Alternate settings file\" build parameter is getting cleaned after job execution","70","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10955\">issue 10955<\/a>)","71","  <li class=bug>"],"delete":[]}]}},"b90b20227e7e2497856404a1ca4e771e282504ff":{"changes":{"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":[{"add":["60","import org.jvnet.hudson.test.MockFolder;","332","","333","    @Bug(17137)","334","    public void testExternalBuildDirectorySymlinks() throws Exception {","335","        \/\/ XXX when using JUnit 4 add: Assume.assumeFalse(Functions.isWindows()); \/\/ symlinks may not be available","336","        HtmlForm form = new WebClient().goTo(\"configure\").getFormByName(\"config\");","337","        File builds = createTmpDir();","338","        form.getInputByName(\"_.rawBuildsDir\").setValueAttribute(builds + \"\/${ITEM_FULL_NAME}\");","339","        submit(form);","340","        assertEquals(builds + \"\/${ITEM_FULL_NAME}\", jenkins.getRawBuildsDir());","341","        FreeStyleProject p = jenkins.createProject(MockFolder.class, \"d\").createProject(FreeStyleProject.class, \"p\");","342","        FreeStyleBuild b1 = p.scheduleBuild2(0).get();","343","        File link = new File(p.getRootDir(), \"lastStable\");","344","        assertTrue(link.exists());","345","        assertEquals(b1.getRootDir().getAbsolutePath(), Util.resolveSymlink(link));","346","        FreeStyleBuild b2 = p.scheduleBuild2(0).get();","347","        assertTrue(link.exists());","348","        assertEquals(b2.getRootDir().getAbsolutePath(), Util.resolveSymlink(link));","349","        b2.delete();","350","        assertTrue(link.exists());","351","        assertEquals(b1.getRootDir().getAbsolutePath(), Util.resolveSymlink(link));","352","        b1.delete();","353","        assertFalse(link.exists());","354","    }","355",""],"delete":[]}],"changelog.html":[{"add":["67","    Permalinks created in the wrong place when using external build directories.","68","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-17137\">issue 17137<\/a>)","69","  <li class=bug>"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["496","            new File(getProject().getRootDir(), name).delete();","500","        String target;","501","        if (getProject().getBuildDir().equals(new File(getProject().getRootDir(), \"builds\"))) {","502","            target = \"builds\/\" + getId();","503","        } else {","504","            target = getRootDir().getAbsolutePath();","505","        }","506","        Util.createSymlink(getProject().getRootDir(), target, name, listener);"],"delete":["496","            new File(getProject().getBuildDir(), \"..\/\"+name).delete();","500","        Util.createSymlink(getProject().getBuildDir(),\"builds\/\"+getId(),\"..\/\"+name,listener);"]}]}},"af07d8a2154be20bdef97ccd956ac8151a80ce27":{"changes":{"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/HudsonTestCase.java":"MODIFY","core\/src\/main\/resources\/hudson\/search\/Search\/search-failed.jelly":"MODIFY","test\/src\/test\/java\/hudson\/search\/SearchTest.java":"MODIFY"},"diff":{"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/HudsonTestCase.java":[{"add":["479","        return new WebClient().search(q);","787","        public HtmlPage search(String q) throws IOException, SAXException {","788","            HtmlPage top = goTo(\"\");","789","            HtmlForm search = top.getFormByName(\"search\");","790","            search.getInputByName(\"q\").setValueAttribute(q);","791","            return (HtmlPage)search.submit(null);","792","        }","793",""],"delete":["479","        HtmlPage top = new WebClient().goTo(\"\");","480","        HtmlForm search = top.getFormByName(\"search\");","481","        search.getInputByName(\"q\").setValueAttribute(q);","482","        return search.submit(null);"]}],"core\/src\/main\/resources\/hudson\/search\/Search\/search-failed.jelly":[{"add":["29","  <l:layout title=\"Search for '${h.escape(q)}'\">","31","      <h1>Search for '${h.escape(q)}'<\/h1>"],"delete":["29","  <l:layout title=\"Search for '${q}'\">","31","      <h1>Search for '${q}'<\/h1>"]}],"test\/src\/test\/java\/hudson\/search\/SearchTest.java":[{"add":["26","import com.gargoylesoftware.htmlunit.Page;","27","import com.gargoylesoftware.htmlunit.AlertHandler;","29","import org.jvnet.hudson.test.Bug;","46","","47","    \/**","48","     * Makes sure the script doesn't execute.","49","     *\/","50","    @Bug(3415)","51","    public void testXSS() throws Exception {","52","        try {","53","            WebClient wc = new WebClient();","54","            wc.setAlertHandler(new AlertHandler() {","55","                public void handleAlert(Page page, String message) {","56","                    throw new AssertionError();","57","                }","58","            });","59","            wc.search(\"<script>alert('script');<\/script>\");","60","            fail(\"404 expected\");","61","        } catch (FailingHttpStatusCodeException e) {","62","            assertEquals(404,e.getResponse().getStatusCode());","63","        }","64","    }"],"delete":[]}]}},"58afb04f9df8849789c6146026c7f670dde2930c":{"changes":{"core\/src\/main\/resources\/lib\/form\/checkbox.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/checkbox.jelly":[{"add":["46","    <st:attribute name=\"readonly\">","47","      If set to true, this will take precedence over the onclick attribute and prevent the state of the checkbox from being changed.","48","    <\/st:attribute>","68","         onclick=\"${attrs.readonly=='true' ? 'return false;' : attrs.onclick}\" id=\"${attrs.id}\" class=\"${attrs.negative!=null ? 'negative' : null} ${attrs.checkUrl!=null?'validated':''}\""],"delete":["65","         onclick=\"${attrs.onclick}\" id=\"${attrs.id}\" class=\"${attrs.negative!=null ? 'negative' : null} ${attrs.checkUrl!=null?'validated':''}\""]}]}},"80d17f5a68739eafc27d5a3fd003b7eee4cfe8f3":{"changes":{"test\/src\/test\/java\/hudson\/security\/SecurityRealmTest.java":"ADD","core\/src\/main\/java\/hudson\/security\/SecurityRealm.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/security\/SecurityRealmTest.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/security\/SecurityRealm.java":[{"add":["404","            \/\/ source: https:\/\/stackoverflow.com\/a\/3414217","405","            rsp.setHeader(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");","406","            rsp.setHeader(\"Pragma\", \"no-cache\");","407","            rsp.setHeader(\"Expires\", \"0\");"],"delete":["404","            rsp.addHeader(\"Cache-Control\", \"no-cache\");"]}]}},"dca86078c36fbc8aeeefec22d8483c9e8bbcd986":{"changes":{"core\/src\/main\/java\/hudson\/model\/Descriptor.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/ParametersDefinitionPropertyTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Node.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Descriptor.java":[{"add":["74","import java.util.IdentityHashMap;","563","        BindInterceptor oldInterceptor = req.getBindInterceptor();","565","            if (!(oldInterceptor instanceof NewInstanceBindInterceptor)) {","566","                req.setBindInterceptor(new NewInstanceBindInterceptor(oldInterceptor));","567","            }","568","","592","        } finally {","593","            req.setBindInterceptor(oldInterceptor);","598","     * Ensures that calls to {@link StaplerRequest#bindJSON(Class, JSONObject)} from {@link #newInstance(StaplerRequest, JSONObject)} recurse properly.","599","     * {@code doConfigSubmit}-like methods will wind up calling {@code newInstance} directly","600","     * or via {@link #newInstancesFromHeteroList(StaplerRequest, Object, Collection)},","601","     * which consult any custom {@code newInstance} overrides for top-level {@link Describable} objects.","602","     * But for nested describable objects Stapler would know nothing about {@code newInstance} without this trick.","603","     *\/","604","    @SuppressWarnings({\"unchecked\", \"rawtypes\"})","605","    private static class NewInstanceBindInterceptor extends BindInterceptor {","606","","607","        private final BindInterceptor oldInterceptor;","608","        private final Map<JSONObject,Boolean> processed = new IdentityHashMap<>();","609","","610","        NewInstanceBindInterceptor(BindInterceptor oldInterceptor) {","611","            LOGGER.log(Level.FINE, \"new interceptor delegating to {0}\", oldInterceptor);","612","            this.oldInterceptor = oldInterceptor;","613","        }","614","","615","        @Override","616","        public Object instantiate(Class actualType, JSONObject json) {","617","            if (Modifier.isAbstract(actualType.getModifiers())) {","618","                LOGGER.log(Level.FINE, \"ignoring abstract {0} {1}\", new Object[] {actualType, json});","619","                return oldInterceptor.instantiate(actualType, json);","620","            }","621","            if (!Describable.class.isAssignableFrom(actualType)) {","622","                LOGGER.log(Level.FINE, \"ignoring non-Describable {0} {1}\", new Object[] {actualType, json});","623","                return oldInterceptor.instantiate(actualType, json);","624","            }","625","            if (Boolean.TRUE.equals(processed.put(json, true))) {","626","                LOGGER.log(Level.FINE, \"already processed {0} {1}\", new Object[] {actualType, json});","627","                return oldInterceptor.instantiate(actualType, json);","628","            }","629","            LOGGER.log(Level.FINE, \"switching to newInstance {0} {1}\", new Object[] {actualType, json});","630","            try {","631","                return Jenkins.getActiveInstance().getDescriptor(actualType).newInstance(Stapler.getCurrentRequest(), json);","632","            } catch (Exception x) {","633","                LOGGER.log(Level.WARNING, \"falling back to default instantiation \" + actualType + \" \" + json, x);","634","                \/\/ If nested objects are not using newInstance, bindJSON will wind up throwing the same exception anyway,","635","                \/\/ so logging above will result in a duplicated stack trace.","636","                \/\/ However if they *are* then this is the only way to find errors in that newInstance.","637","                \/\/ Normally oldInterceptor.instantiate will just return DEFAULT, not actually do anything,","638","                \/\/ so we cannot try calling the default instantiation and then decide which problem to report.","639","                return oldInterceptor.instantiate(actualType, json);","640","            }","641","        }","642","","643","        @Override","644","        public Object onConvert(Type targetType, Class targetTypeErasure, Object jsonSource) {","645","            if (jsonSource instanceof JSONObject) {","646","                LOGGER.log(Level.FINE, \"potentially converting {0} {1} {2}\", new Object[] {targetType, targetTypeErasure, jsonSource});","647","                return instantiate(targetTypeErasure, (JSONObject) jsonSource);","648","            } else {","649","                LOGGER.log(Level.FINE, \"ignoring non-object {0}\", jsonSource);","650","                return oldInterceptor.onConvert(targetType, targetTypeErasure, jsonSource);","651","            }","652","        }","653","","654","    }","655","","656","    \/**"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/ParametersDefinitionPropertyTest.java":[{"add":[],"delete":["30","import org.junit.Ignore;","42","    @Ignore(\"TODO after 600b1f0 (#1888): NoStaplerConstructorException: There's no @DataBoundConstructor on any constructor of class hudson.model.ParametersDefinitionPropertyTest$KrazyParameterDefinition\")"]}],"core\/src\/main\/java\/hudson\/model\/Node.java":[{"add":["59","import java.util.concurrent.atomic.AtomicReference;","473","        final AtomicReference<BindInterceptor> old = new AtomicReference<>();","474","        old.set(req.setBindListener(new BindInterceptor() {","477","                if (jsonForProperties != jsonSource) {","478","                    return old.get().onConvert(targetType, targetTypeErasure, jsonSource);","479","                }","491","        }));","496","            req.setBindListener(old.get());"],"delete":["472","        BindInterceptor old = req.setBindListener(new BindInterceptor() {","475","                if (jsonForProperties!=jsonSource)  return DEFAULT;","487","        });","492","            req.setBindListener(old);"]}]}},"17b4a46f3d31a20bdc4ac8c6b61fe797f5d827ce":{"changes":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/HudsonTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi,","4"," * Erik Ramfelt, Koichi Fujikawa, Red Hat, Inc., Seiji Sogabe,","5"," * Stephen Connolly, Tom Huybrechts, Yahoo! Inc., Alan Harder","1260","        if (name != null && !name.equals(primaryView)) {","1261","            \/\/ Fallback to subview of primary view if it is a ViewGroup","1262","            View pv = getPrimaryView();","1263","            if (pv instanceof ViewGroup)","1264","                return ((ViewGroup)pv).getView(name);","1265","        }"],"delete":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi, Erik Ramfelt, Koichi Fujikawa, Red Hat, Inc.,","4"," * Seiji Sogabe, Stephen Connolly, Tom Huybrechts, Yahoo! Inc., Alan Harder","1259","        \/\/ Fallback to subview of primary view if it is a ViewGroup","1260","        View pv = getPrimaryView();","1261","        if (pv instanceof ViewGroup)","1262","            return ((ViewGroup)pv).getView(name);"]}],"test\/src\/test\/java\/hudson\/model\/HudsonTest.java":[{"add":["40","import org.jvnet.hudson.test.Bug;","46","import java.lang.reflect.Field;","174","","175","    \/**","176","     * Verify null\/invalid primaryView setting doesn't result in infinite loop.","177","     *\/","178","    @Bug(6938)","179","    public void testInvalidPrimaryView() throws Exception {","180","        Field pv = Hudson.class.getDeclaredField(\"primaryView\");","181","        pv.setAccessible(true);","182","        String value = null;","183","        pv.set(hudson, value);","184","        assertNull(\"null primaryView\", hudson.getView(value));","185","        value = \"some bogus name\";","186","        pv.set(hudson, value);","187","        assertNull(\"invalid primaryView\", hudson.getView(value));","188","    }"],"delete":[]}]}},"2b9fbcdefaadd2bb62f6d1e35d1790a047f4207f":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/Ant.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/Ant.java":[{"add":["60","        if(launcher.isUnix())","62","        else","63","            execName = \"ant.bat\";","83","        if(!launcher.isUnix()) {"],"delete":["60","        if(onWindows)","61","            execName = \"ant.bat\";","62","        else","83","        if(onWindows) {","230","","231","    private static final boolean onWindows = File.separatorChar == '\\\\';"]}]}},"bf7eb802d9b4535927dca89a41f62fc24d1c409f":{"changes":{"\/dev\/null":"DELETE","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenProcessFactory.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/Maven3ProcessFactory.java":"MODIFY","changelog.html":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/AbstractMavenProcessFactory.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/Maven31ProcessFactory.java":"MODIFY"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenProcessFactory.java":[{"add":["40","import java.io.InputStream;","42","import java.net.URLConnection;","58","    protected String getMavenAgentClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","60","            classPathEntry(slaveRoot, Main.class, \"maven-agent\", listener)","61","                + ( getLauncher().isUnix() ? \":\" : \";\" );","62","        if (slaveRoot == null) { \/\/ master","63","            String classWorldsJar = getLauncher().getChannel().call(new GetClassWorldsJar(mvn.getHome(),listener));","64","            classPath += classWorldsJar;","65","        } else {","66","            \/\/ copy classworlds 1.1 for maven2 builds","67","            \/\/ if this line fails during the unit test from IDE, it means you need to \"mvn compile\" maven-plugin","68","            \/\/ TODO why would we not pick it up using GetClassWorldsJar like we do for M2 on master or M3 anywhere?","69","            FilePath jar = slaveRoot.child(\"classworlds.jar\");","70","            \/\/ copied to root of this JAR using dependency:generate-resources:","71","            URLConnection conn = MavenProcessFactory.class.getClassLoader().getResource(\"classworlds.jar\").openConnection();","72","            if (jar.lastModified() > conn.getLastModified()) {","73","                listener.getLogger().println(\"classworlds.jar already up to date\");","74","            } else {","75","                InputStream in = conn.getInputStream();","76","                try {","77","                    jar.copyFrom(in);","78","                } finally {","79","                    in.close();","80","                }","81","                listener.getLogger().println(\"Copied classworlds.jar\");","82","            }","83","            classPath += jar.getRemote();","84","        }","93","    protected String getMavenInterceptorClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","94","        return classPathEntry(slaveRoot, hudson.maven.agent.AbortException.class, \"maven-interceptor\", listener);","99","            FilePath slaveRoot, BuildListener listener) throws IOException,","102","            return classPathEntry(slaveRoot, Maven21Interceptor.class, \"maven2.1-interceptor\", listener);"],"delete":["35","import hudson.remoting.Which;","57","    protected String getMavenAgentClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot,BuildListener listener) throws IOException, InterruptedException {","58","        String classWorldsJar = getLauncher().getChannel().call(new GetClassWorldsJar(mvn.getHome(),listener));","60","            ( isMaster ? Which.jarFile( Main.class ).getAbsolutePath()","61","                            : slaveRoot.child( \"maven-agent.jar\" ).getRemote() )","62","                + ( getLauncher().isUnix() ? \":\" : \";\" )","63","                + ( isMaster ? classWorldsJar : slaveRoot.child( \"classworlds.jar\" ).getRemote() );","72","    protected String getMavenInterceptorClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException {","73","        return isMaster?","74","            Which.jarFile(hudson.maven.agent.AbortException.class).getAbsolutePath():","75","            slaveRoot.child(\"maven-interceptor.jar\").getRemote();","80","            boolean isMaster, FilePath slaveRoot) throws IOException,","83","            return isMaster?","84","                Which.jarFile(Maven21Interceptor.class).getAbsolutePath():","85","                slaveRoot.child(\"maven2.1-interceptor.jar\").getRemote();"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/Maven3ProcessFactory.java":[{"add":["56","    protected String getMavenAgentClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","59","        return classPathEntry(slaveRoot, Maven3Main.class, \"maven3-agent\", listener) +","69","    protected String getMavenInterceptorClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","70","        return classPathEntry(slaveRoot, Maven3Launcher.class, \"maven3-interceptor\", listener);","73","    protected String getMavenInterceptorCommonClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","74","        return classPathEntry(slaveRoot, HudsonMavenExecutionResult.class, \"maven3-interceptor-commons\", listener);","79","            FilePath slaveRoot, BuildListener listener) throws IOException,"],"delete":["33","import hudson.remoting.Which;","57","    protected String getMavenAgentClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot,BuildListener listener) throws IOException, InterruptedException {","60","        return (isMaster? Which.jarFile(Maven3Main.class).getAbsolutePath():slaveRoot.child(\"maven3-agent.jar\").getRemote())+","70","    protected String getMavenInterceptorClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException {","71","        return isMaster?","72","                Which.jarFile(Maven3Launcher.class).getAbsolutePath():","73","                slaveRoot.child(\"maven3-interceptor.jar\").getRemote();","76","    protected String getMavenInterceptorCommonClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException {","77","        return isMaster?","78","            Which.jarFile(HudsonMavenExecutionResult.class).getAbsolutePath():","79","            slaveRoot.child(\"maven3-interceptor-commons.jar\").getRemote();","84","            boolean isMaster, FilePath slaveRoot) throws IOException,"]}],"changelog.html":[{"add":["58","    Send Maven agent JARs to slaves on demand, not unconditionally upon connection.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-16261\">issue 16261<\/a>)","60","  <li class=bug>"],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/AbstractMavenProcessFactory.java":[{"add":["35","import java.io.PrintStream;","45","import org.apache.tools.ant.Project;","46","import org.apache.tools.ant.taskdefs.Zip;","362","        args.add(getMavenAgentClassPath(mvn, slaveRoot, listener));","379","        args.add(getMavenInterceptorClassPath(mvn, slaveRoot, listener));","381","        String mavenInterceptorCommonClasspath = getMavenInterceptorCommonClassPath(mvn, slaveRoot, listener);","390","        String interceptorOverride = getMavenInterceptorOverride(mvn, slaveRoot, listener);","401","    protected abstract String getMavenAgentClassPath(MavenInstallation mvn, FilePath slaveRoot,BuildListener listener) throws IOException, InterruptedException;","406","    protected abstract String getMavenInterceptorClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException;","412","    protected String getMavenInterceptorCommonClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","419","    protected abstract String getMavenInterceptorOverride(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException;","499","     * Copies a Maven-related JAR to the slave on demand.","500","     * Can also be used when run on master.","501","     * @param root the FS root of the slave (null means running on master)","502","     * @param representative a representative class present in the JAR","503","     * @param seedName the basename of the JAR","504","     * @param listener a listener for any problems","505","     * @return the (local or remote) absolute path of the JAR","506","     * @throws IOException in case copying fails","507","     * @throws InterruptedException in case copying is interrupted","508","     * @since 1.530","509","     *\/","510","    protected final String classPathEntry(FilePath root, Class<?> representative, String seedName, TaskListener listener) throws IOException, InterruptedException {","511","        if (root == null) { \/\/ master","512","            return Which.jarFile(representative).getAbsolutePath();","513","        } else {","514","            return copyJar(listener.getLogger(), root, representative, seedName).getRemote();","515","        }","516","    }","517","    \/**","518","     * Copies a jar file from the master to slave.","519","     *\/","520","    static FilePath copyJar(PrintStream log, FilePath dst, Class<?> representative, String seedName) throws IOException, InterruptedException {","521","        \/\/ in normal execution environment, the master should be loading 'representative' from this jar, so","522","        \/\/ in that way we can find it.","523","        File jar = Which.jarFile(representative);","524","        FilePath copiedJar = dst.child(seedName + \".jar\");","525","","526","        if (jar.isDirectory()) {","527","            \/\/ but during the development and unit test environment, we may be picking the class up from the classes dir","528","            Zip zip = new Zip();","529","            zip.setBasedir(jar);","530","            File t = File.createTempFile(seedName, \"jar\");","531","            t.delete();","532","            zip.setDestFile(t);","533","            zip.setProject(new Project());","534","            zip.execute();","535","            jar = t;","536","        } else if (copiedJar.lastModified() > jar.lastModified()) {","537","            log.println(seedName + \".jar already up to date\");","538","            return copiedJar;","539","        }","540","","541","        new FilePath(jar).copyTo(copiedJar);","542","        log.println(\"Copied \" + seedName + \".jar\");","543","        return copiedJar;","544","    }","545","","546","    \/**"],"delete":["359","        args.add(getMavenAgentClassPath(mvn,isMaster,slaveRoot,listener));","376","        args.add(getMavenInterceptorClassPath(mvn,isMaster,slaveRoot));","378","        String mavenInterceptorCommonClasspath = getMavenInterceptorCommonClassPath( mvn, isMaster, slaveRoot );","387","        String interceptorOverride = getMavenInterceptorOverride(mvn,isMaster,slaveRoot);","398","    protected abstract String getMavenAgentClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot,BuildListener listener) throws IOException, InterruptedException;","403","    protected abstract String getMavenInterceptorClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException;","409","    protected String getMavenInterceptorCommonClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException {","416","    protected abstract String getMavenInterceptorOverride(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException;"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/Maven31ProcessFactory.java":[{"add":["59","    protected String getMavenAgentClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","61","        String path = classPathEntry(slaveRoot, Maven31Main.class, \"maven31-agent\", listener) +","92","    protected String getMavenInterceptorClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","93","        return classPathEntry(slaveRoot, Maven31Interceptor.class, \"maven31-interceptor\", listener);","96","    protected String getMavenInterceptorCommonClassPath(MavenInstallation mvn, FilePath slaveRoot, BuildListener listener) throws IOException, InterruptedException {","97","        return classPathEntry(slaveRoot, HudsonMavenExecutionResult.class, \"maven3-interceptor-commons\", listener);"],"delete":["31","import hudson.remoting.Which;","60","    protected String getMavenAgentClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot,BuildListener listener) throws IOException, InterruptedException {","62","        String path = (isMaster? Which.jarFile(Maven31Main.class).getAbsolutePath():slaveRoot.child(\"maven31-agent.jar\").getRemote())+","93","    protected String getMavenInterceptorClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException {","94","        String path = isMaster?","95","                Which.jarFile(Maven31Interceptor.class).getAbsolutePath():","96","                slaveRoot.child(\"maven31-interceptor.jar\").getRemote();","97","","98","        return path;","101","    protected String getMavenInterceptorCommonClassPath(MavenInstallation mvn,boolean isMaster,FilePath slaveRoot) throws IOException, InterruptedException {","102","        String path = isMaster?","103","            Which.jarFile(HudsonMavenExecutionResult.class).getAbsolutePath():","104","            slaveRoot.child(\"maven3-interceptor-commons.jar\").getRemote();","105","","106","        return path;"]}]}},"7f4014c74047d96b1557eae09d06853fd841beb4":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/JobTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["621","            if (!newBuildDir.getParentFile().isDirectory()) {","622","                newBuildDir.getParentFile().mkdirs();","623","            }"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/JobTest.java":[{"add":["279","    @Bug(19764)","280","    @Test public void testRenameWithCustomBuildsDirWithSubdir() throws Exception {","281","        j.jenkins.setRawBuildsDir(\"${JENKINS_HOME}\/builds\/${ITEM_FULL_NAME}\/builds\");","282","        final FreeStyleProject p = j.createFreeStyleProject();","283","        p.scheduleBuild2(0).get();","284","        p.renameTo(\"different-name\");","285","    }","286",""],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["2016","    @Restricted(NoExternalUse.class)","2017","    public void setRawBuildsDir(String buildsDir) {","2018","        this.buildsDir = buildsDir;","2019","    }","2020",""],"delete":[]}]}},"89bd7cd551f54bbf85a63b741ef506efd1df7b50":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["63","  <li class=bug>","64","    After an unsuccessful Maven incremental build, make sure that all modules are deployed on the next successful one.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-5121\">issue 5121<\/a>)"],"delete":[]}]}},"32b53335c6cdb9971f880db126f763ecbdc46e45":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","test\/src\/test\/java\/hudson\/maven\/MavenEnvironmentContributingActionTest.java":"ADD"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["40","import hudson.model.EnvironmentContributingAction;","616","                            Collection<? extends Action> actionsFromWrapper = w.getProjectActions(project);","617","                            for (Action action : actionsFromWrapper) {","618","                                if(action instanceof EnvironmentContributingAction){ \/\/ #17555","619","                                    ((EnvironmentContributingAction) action).buildEnvVars(MavenModuleSetBuild.this, envVars);","620","                                }","621","                            }                            "],"delete":[]}],"test\/src\/test\/java\/hudson\/maven\/MavenEnvironmentContributingActionTest.java":[{"add":[],"delete":[]}]}},"e03ba7dc6ba3753ed18d0de02133734ab171fb21":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY","core\/src\/main\/java\/hudson\/util\/CyclicGraphDetector.java":"MODIFY","pom.xml":"MODIFY","plugins\/pom.xml":"MODIFY"},"diff":{"changelog.html":[{"add":["73","  <li class=bug>","74","    Fixed the initialization order of plugins","75","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9960\">issue 9960<\/a>)"],"delete":[]}],"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["71","import java.util.ListIterator;","214","                            g.followedBy().attains(PLUGINS_LISTED).add(\"Checking cyclic dependencies\", new Executable() {","220","                                        CyclicGraphDetector<PluginWrapper> cgd = new CyclicGraphDetector<PluginWrapper>() {","224","                                                addTo(p.getDependencies(), next);","225","                                                addTo(p.getOptionalDependencies(), next);","232","                                                    if (p != null)","236","                                        };","237","                                        cgd.run(getPlugins());","238","","239","                                        \/\/ obtain topologically sorted list and overwrite the list","240","                                        ListIterator<PluginWrapper> litr = plugins.listIterator();","241","                                        for (PluginWrapper p : cgd.getSorted()) {","242","                                            litr.next();","243","                                            litr.set(p);","244","                                            if(p.isActive())","245","                                                activePlugins.add(p);","246","                                        }"],"delete":["190","                                            if(p.isActive())","191","                                                activePlugins.add(p);","215","                            g.requires(PLUGINS_PREPARED).add(\"Checking cyclic dependencies\",new Executable() {","221","                                        new CyclicGraphDetector<PluginWrapper>() {","225","                                                addTo(p.getDependencies(),next);","226","                                                addTo(p.getOptionalDependencies(),next);","233","                                                    if (p!=null)","237","                                        }.run(getPlugins());","242","                                    Collections.sort(plugins);"]}],"core\/src\/main\/java\/hudson\/util\/CyclicGraphDetector.java":[{"add":["4","import java.util.ArrayList;","5","import java.util.Collection;","7","import java.util.LinkedHashSet;","22","    private final List<N> topologicalOrder = new ArrayList<N>();","23","","30","     * Returns all the nodes in the topologically sorted order.","31","     * That is, if there's an edge a->b, b always come earlier than a.","32","     *\/","33","    public List<N> getSorted() {","34","        return topologicalOrder;","35","    }","36","","37","    \/**","58","        topologicalOrder.add(p);"],"delete":[]}],"pom.xml":[{"add":["29","    <version>1.21<\/version>"],"delete":["29","    <version>1.18<\/version>"]}],"plugins\/pom.xml":[{"add":["6","    <version>1.21<\/version>","157","        <groupId>org.codehaus.gmaven<\/groupId>"],"delete":["6","    <version>1.18<\/version>","157","        <groupId>org.codehaus.groovy.maven<\/groupId>"]}]}},"a06acd9096ccab8e802389138fa52a9472359d1b":{"changes":{"core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["105","import org.kohsuke.stapler.*;","823","","824","        \/\/ RUN may be accessed using permalinks, as \"\/lastSuccessful\" or other, so try to retrieve this base URL","825","        \/\/ looking for \"this\" in the current request ancestors","826","        \/\/ @see also {@link AbstractItem#getUrl}","827","        StaplerRequest req = Stapler.getCurrentRequest();","828","        if (req != null) {","829","            String seed = Functions.getNearestAncestorUrl(req,this);","830","            if(seed!=null) {","831","                \/\/ trim off the context path portion and leading '\/', but add trailing '\/'","832","                return seed.substring(req.getContextPath().length()+1)+'\/';","833","            }","834","        }","835",""],"delete":["105","import org.kohsuke.stapler.HttpResponse;","106","import org.kohsuke.stapler.HttpResponses;","107","import org.kohsuke.stapler.QueryParameter;","108","import org.kohsuke.stapler.StaplerRequest;","109","import org.kohsuke.stapler.StaplerResponse;"]}]}},"ebc59a7ae6d5ca3ea6f492ab9bd98edda63344a5":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["58","    Workspaces mixed when launching multiple concurrent builds.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-11825\">issue 11825<\/a>)","60","  <li class=bug>"],"delete":[]}]}},"eec37460daf0ff4c42adb82d3c66629bc4e85223":{"changes":{"changelog.html":"MODIFY","cli\/src\/main\/java\/hudson\/cli\/CLI.java":"MODIFY"},"diff":{"changelog.html":[{"add":["62","    Confusing error message when the --username option is used on the system with the .ssh directory.","63","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-11873\">issue 11873<\/a>)","64","  <li class=bug>"],"delete":[]}],"cli\/src\/main\/java\/hudson\/cli\/CLI.java":[{"add":["321","                    System.err.println(\"Failed to authenticate with your SSH keys.\");","322","                    LOGGER.log(FINE,\"Failed to authenticate with your SSH keys.\",e);"],"delete":["321","                    System.err.println(\"Failed to authenticate with your SSH keys. Proceeding with anonymous access\");","322","                    LOGGER.log(FINE,\"Failed to authenticate with your SSH keys. Proceeding with anonymous access\",e);"]}]}},"25841a1bd959e4c327e6919e5382792a1dca7c47":{"changes":{"core\/src\/main\/resources\/hudson\/triggers\/SlowTriggerAdminMonitor\/message.groovy":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/triggers\/SlowTriggerAdminMonitor\/message.groovy":[{"add":["27","            tam.errors.each { trigger, val ->"],"delete":["27","            tam.errors.each { String trigger, SlowTriggerAdminMonitor.Value val ->"]}]}},"299a556ed44133f6dce27b89993a661494aa0c44":{"changes":{"core\/src\/main\/java\/hudson\/util\/FormValidation.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/FormValidation.java":[{"add":["358","        rsp.setContentType(\"text\/html;charset=UTF-8\");"],"delete":["29","import hudson.scm.CVSSCM;","359","        rsp.setContentType(\"text\/html\");"]}]}},"c914c034fa13b1c6d51a000f8fdc91647987f7ed":{"changes":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":[{"add":["783","    \/**","784","     * @deprecated","785","     *      Used only for mapping jobs to URL in a case-insensitive fashion.","786","     *\/","787","    public TopLevelItem getJobCaseInsensitive(String name) {","788","        for (Entry<String, TopLevelItem> e : items.entrySet()) {","789","            if(e.getKey().equalsIgnoreCase(name))","790","                return e.getValue();","791","        }","792","        return null;","793","    }","794",""],"delete":[]}]}},"136aeb86a4e2ffcfa5ec988dc02da6063643dc4a":{"changes":{"core\/src\/test\/java\/hudson\/model\/UpdateCenterTest.java":"ADD","core\/src\/main\/java\/hudson\/model\/UpdateCenter.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/model\/UpdateCenterTest.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/UpdateCenter.java":[{"add":["1044","            testConnection(toUpdateCenterCheckUrl(updateCenterUrl));","1045","        }","1046","","1047","        \/**","1048","         * Converts an update center URL into the URL to use for checking its connectivity.","1049","         * @param updateCenterUrl the URL to convert.","1050","         * @return the converted URL.","1051","         * @throws MalformedURLException if the supplied URL is malformed.","1052","         *\/","1053","        static URL toUpdateCenterCheckUrl(String updateCenterUrl) throws MalformedURLException {","1054","            URL url;","1056","                url = new URL(updateCenterUrl + (updateCenterUrl.indexOf('?') == -1 ? \"?uctest\" : \"&uctest\"));","1058","                url = new URL(updateCenterUrl);","1060","            return url;"],"delete":["1045","                testConnection(new URL(updateCenterUrl + (updateCenterUrl.indexOf('?') == -1 ? \"?uctest\" : \"&uctest\")));","1047","                testConnection(new URL(updateCenterUrl));"]}]}},"e8b1a500c9b9bbccb792c902c914efcb31ca10c9":{"changes":{"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/systemInfo.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/sidepanel2.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/systemInfo.jelly":[{"add":["36","      <h1>","37","        <img src=\"${imagesURL}\/48x48\/${it.icon}\" width=\"48\" height=\"48\" alt=\"\"\/>","38","        ${it.caption} ${%System Information}","39","        <j:if test=\"${!empty(it.node.nodeDescription)}\">","40","          <span style=\"font-size:smaller\">(${it.node.nodeDescription})<\/span>","41","        <\/j:if>","42","      <\/h1>","43","","44","      <l:hasPermission permission=\"${it.CONNECT}\">","45","        <j:choose>","46","          <j:when test=\"${it.online}\">","47","            <h2>${it.oSDescription} slave, version ${it.slaveVersion}<\/h2>","48","","49","            <j:forEach var=\"instance\" items=\"${it.systemInfoExtensions}\">","50","              <h1>${instance.displayName}<\/h1>","51","              <st:include page=\"systemInfo\" from=\"${instance}\"\/>","52","            <\/j:forEach>","53","          <\/j:when>","54","          <j:otherwise>","55","            ${%System Information is unavailable when slave is offline.}","56","          <\/j:otherwise>","57","        <\/j:choose>"],"delete":["35","      <l:hasPermission permission=\"${it.CONNECT}\">","36","        <h1>${it.oSDescription} slave, version ${it.slaveVersion}<\/h1>","38","        <j:forEach var=\"instance\" items=\"${it.systemInfoExtensions}\">","39","          <h1>${instance.displayName}<\/h1>","40","          <st:include page=\"systemInfo\" from=\"${instance}\"\/>","41","        <\/j:forEach>"]}],"core\/src\/main\/resources\/hudson\/slaves\/SlaveComputer\/sidepanel2.jelly":[{"add":["28","    <l:task icon=\"images\/24x24\/computer.png\" href=\"systemInfo\" title=\"${%System Information}\" permission=\"${it.CONNECT}\"\/>"],"delete":["27","  <l:task icon=\"images\/24x24\/computer.png\" href=\"systemInfo\" title=\"${%System Information}\" permission=\"${it.CONNECT}\"\/>"]}]}},"39fbd9792e18c3442ecef99b4d24ae44fac989ce":{"changes":{"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":"MODIFY","core\/src\/main\/resources\/hudson\/triggers\/SCMTrigger\/SCMTriggerCause\/description.jelly":"MODIFY","core\/src\/main\/java\/hudson\/model\/Cause.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":[{"add":["46","import org.apache.commons.io.FileUtils;","47","import org.apache.commons.jelly.XMLOutput;","48","import org.kohsuke.accmod.Restricted;","49","import org.kohsuke.accmod.restrictions.DoNotUse;","50","import org.kohsuke.stapler.StaplerRequest;","51","import org.kohsuke.stapler.DataBoundConstructor;","52","","79","import static java.util.logging.Level.*;","80","import jenkins.model.RunAction2;","81","","82","import javax.annotation.Nonnull;","83","","593","        private transient Run run;","594","","613","        public void onLoad(Run run) {","614","            this.run = run;","615","        }","616","","617","        @Override","619","            this.run = build;","635","        @Restricted(DoNotUse.class)","636","        public Run getRun() {","637","            return this.run;","638","        }","639",""],"delete":["68","import org.apache.commons.io.FileUtils;","69","import org.apache.commons.jelly.XMLOutput;","70","import org.kohsuke.accmod.Restricted;","72","import org.kohsuke.stapler.DataBoundConstructor;","74","import org.kohsuke.stapler.StaplerRequest;"]}],"core\/src\/main\/resources\/hudson\/triggers\/SCMTrigger\/SCMTriggerCause\/description.jelly":[{"add":["25","    <!-- this link loses breadcrumb context, but need absolute URL for upstream cause support (JENKINS-18048) -->","26","    <span><a href=\"${rootURL}\/${it.run.url}pollingLog\">${it.shortDescription}<\/a><\/span>"],"delete":["25","    <span><a href=\"pollingLog\">${it.shortDescription}<\/a><\/span>"]}],"core\/src\/main\/java\/hudson\/model\/Cause.java":[{"add":["179","        @Override","180","        public void onLoad(@Nonnull Run run) {","181","            Item i = Jenkins.getInstance().getItemByFullName(this.upstreamProject);","182","            if (i == null || !(i instanceof Job)) {","183","                \/\/ cannot initialize upstream causes","184","                return;","185","            }","186","","187","            Job j = (Job)i;","188","            Run r = j.getBuildByNumber(this.getUpstreamBuild());","189","            if (r == null) {","190","                \/\/ build doesn't exist anymore","191","                return;","192","            }","193","","194","            for (Cause c : this.upstreamCauses) {","195","                c.onLoad(r);","196","            }","197","        }","198",""],"delete":[]}]}},"d0c04f004e3b1af94e2f186d0c50aa04aabe3d22":{"changes":{"core\/src\/main\/resources\/hudson\/model\/View\/newJob.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/View\/newJob.jelly":[{"add":["15","            <input type=\"radio\" name=\"mode\" value=\"${d.displayName}\" onchange=\"$('ok').disabled=false\" \/>","34","\t\t      <input type=\"submit\" name=\"Submit\" value=\"OK\" id=\"ok\" disabled=\"true\" style=\"margin-left:5em\" \/>"],"delete":["15","            <input type=\"radio\" name=\"mode\" value=\"${d.displayName}\" \/>","34","\t\t      <input type=\"submit\" name=\"Submit\" value=\"OK\" \/>"]}]}},"757fbe41fab0af4dd61d32464e7f4208fdbb0b25":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Job\/rename.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Job\/rename.jelly":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":["122","import org.acegisecurity.AccessDeniedException;","123","import org.acegisecurity.context.SecurityContext;","124","import org.acegisecurity.context.SecurityContextHolder;","1611","    ","1612","    \/**","1613","     * Check new name for job","1614","     * @param newName - New name for job","1615","     * @return {@code true} - if newName occupied and user has permissions for this job","1616","     *         {@code false} - if newName occupied and user hasn't permissions for this job","1617","     *         {@code null} - if newName didn't occupied","1618","     * ","1619","     * @throws Failure if the given name is not good","1620","     *\/","1621","    @CheckForNull","1622","    @Restricted(NoExternalUse.class)","1623","    public Boolean checkIfNameIsUsed(@Nonnull String newName) throws Failure{","1624","        ","1625","        Item item = null;","1626","        Jenkins.checkGoodName(newName);","1627","        ","1628","        try {","1629","            item = getParent().getItem(newName);","1630","        } catch(AccessDeniedException ex) {  ","1631","            if (LOGGER.isLoggable(Level.FINE)) {","1632","                LOGGER.log(Level.FINE, \"Unable to rename the job {0}: name {1} is already in use. \" +","1633","                        \"User {2} has {3} permission, but no {4} for existing job with the same name\", ","1634","                        new Object[] {this.getFullName(), newName, User.current().getFullName(), Item.DISCOVER.name, Item.READ.name} );","1635","            }","1636","            return true;","1637","        }","1638","        ","1639","        if (item != null) {","1640","            \/\/ User has Read permissions for existing job with the same name","1641","            return true;","1642","        } else {","1643","            SecurityContext initialContext = null;","1644","            try {","1645","                initialContext = hudson.security.ACL.impersonate(ACL.SYSTEM);","1646","                item = getParent().getItem(newName);","1647","","1648","                if (item != null) {","1649","                    if (LOGGER.isLoggable(Level.FINE)) {","1650","                        LOGGER.log(Level.FINE, \"Unable to rename the job {0}: name {1} is already in use. \" +","1651","                                \"User {2} has no {3} permission for existing job with the same name\", ","1652","                                new Object[] {this.getFullName(), newName, initialContext.getAuthentication().getName(), Item.DISCOVER.name} );","1653","                    }","1654","                    return false;","1655","                }","1656","","1657","            } finally {","1658","                if (initialContext != null) {","1659","                    SecurityContextHolder.setContext(initialContext);","1660","                }","1661","            }","1662","        }","1663","        return null;","1664","    }"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/Job\/rename.properties":[{"add":["24","newNameNotValid=The name {0} is not valid."],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/Job\/rename.jelly":[{"add":["31","      <j:set var=\"checkIfNameIsUsed\" value=\"${it.checkIfNameIsUsed(newName)}\" \/>","32","      ","33","      <j:choose> ","40","        ","41","        <j:when test=\"${checkIfNameIsUsed != null and !it.name.equalsIgnoreCase(newName)}\" >    ","42","          <j:if test=\"${checkIfNameIsUsed}\" >","43","            ${%newNameInUse(newName)}","44","          <\/j:if>  ","45","          <j:if test=\"${!checkIfNameIsUsed}\" >","46","            ${%newNameNotValid(newName)}","47","          <\/j:if>","52","        "],"delete":["31","      <j:choose>","38","        <j:when test=\"${it.parent.getItem(newName)!=null and !it.name.equalsIgnoreCase(newName)}\">","39","          ${%newNameInUse(newName)}"]}]}},"44eeb10461b0f49fe6c0125a9727f57480d10f10":{"changes":{"core\/src\/main\/java\/hudson\/model\/JDK.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/JDK.java":[{"add":["168","        public @Override void setInstallations(JDK... jdks) {","169","            Jenkins.getInstance().setJDKs(Arrays.asList(jdks));"],"delete":["168","        \/\/ this isn't really synchronized well since the list is Hudson.jdks :(","169","        public @Override synchronized void setInstallations(JDK... jdks) {","170","            List<JDK> list = Jenkins.getInstance().getJDKs();","171","            list.clear();","172","            list.addAll(Arrays.asList(jdks));"]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["1642","    public synchronized List<JDK> getJDKs() {","1649","     * Replaces all JDK installations with those from the given collection.","1650","     *","1651","     * Use {@link hudson.model.JDK.DescriptorImpl#setInstallations(JDK...)} to","1652","     * set JDK installations from external code.","1653","     *\/","1654","    @Restricted(NoExternalUse.class)","1655","    public synchronized void setJDKs(Collection<? extends JDK> jdks) {","1656","        this.jdks = new ArrayList<JDK>(jdks);","1657","    }","1658","","1659","    \/**","2865","            setJDKs(req.bindJSONToList(JDK.class, json.get(\"jdks\")));"],"delete":["1642","    public List<JDK> getJDKs() {","2854","            jdks.clear();","2855","            jdks.addAll(req.bindJSONToList(JDK.class,json.get(\"jdks\")));"]}]}},"c41c278bc45ecfc940d85441f2bdc1362ca38bb3":{"changes":{"core\/src\/main\/java\/hudson\/model\/BuildAuthorizationToken.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/BuildAuthorizationToken.java":[{"add":["4","import hudson.security.ACL;","15"," * @deprecated","16"," *      Use {@link ACL} and {@link AbstractProject#BUILD}. This code is only here","17"," *      for the backward compatibility.","27","        if (req.getParameter(\"pseudoRemoteTrigger\") != null) {","28","            String token = Util.fixEmpty(req.getParameter(\"authToken\"));","29","            if(token!=null)","30","                return new BuildAuthorizationToken(token);","31","        }","32","        ","33","        return null;"],"delete":["23","        if (req.getParameter(\"pseudoRemoteTrigger\") != null)","24","            return new BuildAuthorizationToken(Util.fixEmpty(req.getParameter(\"authToken\")));","25","        else","26","            return null;"]}]}},"8e08d2dcddc1ca3c36d7e570da7a35bd0950b8f2":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["60","  <li class=bug>","61","    Windows path separators not correctly escaped in Maven properties configuration.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10539\">issue 10539<\/a>)"],"delete":[]}]}},"b29a7d88e309604b8d069bb034118174323a8a5f":{"changes":{"core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/footer_de.properties":"MODIFY","core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/resources.css":"MODIFY","war\/src\/main\/less\/abstracts\/colors.less":"MODIFY","core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/footer.jelly":"MODIFY","war\/src\/main\/less\/ui-refresh-overrides.less":"MODIFY","core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/footer.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/footer_de.properties":[{"add":[],"delete":["24","monitors={0,choice,0#Warnungen|1#Warnung|1<Warnungen}"]}],"core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/resources.css":[{"add":["16","    color:#fff;","17","    background-color: #dc3545;"],"delete":["16","    color:#F94B4E;","17","    background-color: #fff;"]}],"war\/src\/main\/less\/abstracts\/colors.less":[{"add":["30","\/\/ Monitor \/ alert new colors","31","@monitor-bg-v2: #f8d7da;","32","@monitor-color-v2: #721c24;","33","","35","@text-color: #333;"],"delete":["31","@text-color: #333;"]}],"core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/footer.jelly":[{"add":[],"delete":["30","                <span class=\"hidden-xs hidden-sm\">${%monitors(it.activeAdministrativeMonitorsCount)}<\/span>"]}],"war\/src\/main\/less\/ui-refresh-overrides.less":[{"add":["84","","85","    #visible-am-button .am-monitor__count {","86","        color: @monitor-color-v2;","87","        background-color: @monitor-bg-v2;","88","    }"],"delete":[]}],"core\/src\/main\/resources\/jenkins\/management\/AdministrativeMonitorsDecorator\/footer.properties":[{"add":[],"delete":["1","monitors={0,choice,0#monitors|1#monitor|1<monitors}"]}]}},"6d7f5a0e94ef20f2a7b3f58f4b04aeec799f33fc":{"changes":{"core\/src\/main\/java\/hudson\/security\/csrf\/CrumbFilter.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/security\/csrf\/CrumbFilter.java":[{"add":["9","import org.acegisecurity.providers.anonymous.AnonymousAuthenticationToken;","73","            Level level = Jenkins.getAuthentication() instanceof AnonymousAuthenticationToken ? Level.FINE : Level.WARNING;"],"delete":["72","            Level level = Jenkins.getAuthentication() == Jenkins.ANONYMOUS ? Level.FINE : Level.WARNING;"]}]}},"8dcf818f654d391646b75fa700b77b9e5c623086":{"changes":{"core\/src\/main\/resources\/hudson\/ProxyConfiguration\/config.groovy":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/ProxyConfiguration\/config.groovy":[{"add":["24","                     method:\"validateProxy\", with:\"testUrl,name,port,userName,secretPassword,noProxyHost\")"],"delete":["24","                     method:\"validateProxy\", with:\"testUrl,name,port,userName,password,noProxyHost\")"]}]}},"1e5112a106146ee4fd26b3975aa0c406f691ba51":{"changes":{"core\/src\/main\/resources\/jenkins\/model\/GlobalCloudConfiguration\/index.groovy":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/model\/GlobalCloudConfiguration\/index.groovy":[{"add":["42","            p(_(\"There are no cloud implementations for dynamically allocated agents installed. \"))","43","            a(href: rootURL + \"\/pluginManager\/available\", _(\"Go to plugin manager.\"))"],"delete":["42","            p {","43","                _(\"There are no cloud implementations for dynamically allocated agents installed.\")","44","                a(href: rootURL + \"\/pluginManager\/available\") {","45","                    _(\"Go to plugin manager.\")","46","                }","47","            }"]}]}},"6a395cbf170480b3ce525f2fbf918c6188c9116b":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":[{"add":["56","        if(free>256 || usage.totalSwapSpace<usage.availableSwapSpace*5)"],"delete":["56","        if(free>256 || usage.totalSwapSpace\/usage.availableSwapSpace<5)"]}]}},"444aa1d2ecb31c00d1ec28ebe8fb0e5a12322d6a":{"changes":{"\/dev\/null":"DELETE","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenProcessFactory.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/JUnitResultArchiver.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenUtil.java":"MODIFY","core\/src\/main\/java\/hudson\/AbortException.java":"MODIFY"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenProcessFactory.java":[{"add":["209","                if(!proc.isAlive())","210","                    throw new AbortException(\"Failed to launch Maven. Exit code = \"+proc.join());"],"delete":["209","                if(!proc.isAlive()) {","210","                    listener.getLogger().println(\"Failed to launch Maven. Exit code = \"+proc.join());","211","                    throw new AbortException();","212","                }"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["389","                if(e.getMessage()!=null)","390","                    listener.error(e.getMessage());","416","            if(mvn==null)","417","                throw new AbortException(\"A Maven installation needs to be available for this project to be built.\\n\"+","418","                \"Either your server has no Maven installations defined, or the requested Maven version does not exist.\");","419","","719","            if(!pom.exists())","720","                throw new AbortException(Messages.MavenModuleSetBuild_NoSuchFile(pom));"],"delete":["389","                \/\/ error should have been already reported.","415","            if(mvn==null) {","416","                logger.println(\"A Maven installation needs to be available for this project to be built.\");","417","                logger.println(\"Either your server has no Maven installations defined, or the requested Maven version does not exist.\");","418","                throw new AbortException();","419","            }","719","            if(!pom.exists()) {","720","                logger.println(Messages.MavenModuleSetBuild_NoSuchFile(pom));","721","                throw new AbortException();","722","            }"]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/JUnitResultArchiver.java":[{"add":["30","import hudson.AbortException;","110","        } catch (IOException e) {","111","            e.printStackTrace(listener.error(\"Failed to archive JUnit reports\"));","112","            build.setResult(Result.FAILURE);","113","            return true;"],"delete":["100","        } catch (IOException e) {","101","            e.printStackTrace(listener.error(\"Failed to archive JUnit reports\"));","102","            build.setResult(Result.FAILURE);","103","            return true;"]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenUtil.java":[{"add":["100","        if(!m2Home.exists())","101","            throw new AbortException(\"Failed to create \"+m2Home+","136","            if(!moduleFile.exists())","137","                throw new AbortException(moduleFile+\" is referenced from \"+project.getFile()+\" but it doesn't exist\");"],"delete":["100","        if(!m2Home.exists()) {","101","            listener.getLogger().println(\"Failed to create \"+m2Home+","103","            throw new AbortException();","104","        }","138","            if(!moduleFile.exists()) {","139","                listener.getLogger().println(moduleFile+\" is referenced from \"+project.getFile()+\" but it doesn't exist\");","140","                throw new AbortException();","141","            }"]}],"core\/src\/main\/java\/hudson\/AbortException.java":[{"add":["28"," * Signals a failure where the error was anticipated and diagnosed.","35","    public AbortException() {","36","    }","37","","38","    \/**","39","     * When this exception is caught, the specified message will be reported.","40","     * @since 1.298","41","     *\/","42","    public AbortException(String message) {","43","        super(message);","44","    }","45",""],"delete":["28"," * Signals a failure where the error message was reported."]}]}},"f49e3a1953c1bddb5c9bf8d5fb93df8da5f59a0e":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["60","  <li class=bug>","61","    \u201CRecurse in subfolders\u201D option for list views produced exceptions when used with native Maven projects.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18025\">issue 18025<\/a>)"],"delete":[]}]}},"257c96c81dd3de218932db2320cfc9fa4a2c4df4":{"changes":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":"MODIFY","maven-plugin\/src\/main\/resources\/hudson\/maven\/MavenModuleSet\/global.jelly":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":[{"add":["2354","            for( TopLevelItemDescriptor d : TopLevelItemDescriptor.all() )","2355","                result &= configureDescriptor(req,json,d);","2356",""],"delete":[]}],"maven-plugin\/src\/main\/resources\/hudson\/maven\/MavenModuleSet\/global.jelly":[{"add":["30","      <f:expandableTextbox name=\"globalMavenOpts\" value=\"${descriptor.globalMavenOpts}\" \/>"],"delete":["30","      <f:expandableTextbox name=\"globalMavenOpts\" value=\"${it.globalMavenOpts}\" \/>"]}]}},"ba3a27a43236ac0bc79e49c238327eb6562b1d0a":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Hudson\/newView.jelly":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/newFromList\/form.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Hudson\/newView.jelly":[{"add":["34","          <f:textbox id=\"name\" name=\"name\" checkUrl=\"'${rootURL}\/viewExistsCheck?value='+encodeURIComponent(this.value)\""],"delete":["34","          <f:textbox id=\"name\" name=\"name\" checkUrl=\"'${rootURL}\/viewExistsCheck?value='+escape(this.value)\""]}],"core\/src\/main\/resources\/lib\/hudson\/newFromList\/form.jelly":[{"add":["37","      <s:textbox id=\"name\" name=\"name\" checkUrl=\"'${rootURL}\/${checkUrl}?value='+encodeURIComponent(this.value)\""],"delete":["37","      <s:textbox id=\"name\" name=\"name\" checkUrl=\"'${rootURL}\/${checkUrl}?value='+escape(this.value)\""]}]}},"a79c1635fd5f7c99a969d2850efd8c2288aff91b":{"changes":{"core\/src\/main\/resources\/lib\/hudson\/executors.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/hudson\/executors.jelly":[{"add":["68","              <div style=\"white-space: normal\">${%Building}"],"delete":["68","              <div nowrap=\"true\">${%Building}"]}]}},"838357700d3173380170ecb28f131a554da0af63":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Computer.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/ComputerTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/labels\/LabelAtom.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["1048","    \/\/ TODO implement addAction, addOrReplaceAction, removeAction, removeActions, replaceActions","1049",""],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/Computer.java":[{"add":["27","import edu.umd.cs.findbugs.annotations.SuppressFBWarnings;","271","    @SuppressWarnings({\"ConstantConditions\",\"deprecation\"})","272","    @SuppressFBWarnings(\"RCN_REDUNDANT_NULLCHECK_OF_NONNULL_VALUE\")","273","    @Override","274","    public void addAction(@Nonnull Action a) {","275","        if (a == null) {","276","            throw new IllegalArgumentException(\"Action must be non-null\");","277","        }","278","        super.getActions().add(a);","279","    }","280","","281","    \/\/ TODO implement addOrReplaceAction, removeAction, removeActions, replaceActions","282",""],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/ComputerTest.java":[{"add":["114","","115","    @Issue(\"JENKINS-42969\")","116","    @Test","117","    public void addAction() throws Exception {","118","        Computer c = j.createSlave().toComputer();","119","        class A extends InvisibleAction {}","120","        assertEquals(0, c.getActions(A.class).size());","121","        c.addAction(new A());","122","        assertEquals(1, c.getActions(A.class).size());","123","        c.addAction(new A());","124","        assertEquals(2, c.getActions(A.class).size());","125","    }","126",""],"delete":["33","import com.gargoylesoftware.htmlunit.html.HtmlPage;","42","import org.junit.Before;"]}],"core\/src\/main\/java\/hudson\/model\/labels\/LabelAtom.java":[{"add":["108","    \/\/ TODO implement addAction, addOrReplaceAction, removeAction, removeActions, replaceActions","109",""],"delete":[]}]}},"6aa47505897a1f5b04336fbfc0cff65938417cae":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["423","      <version>1.3<\/version>"],"delete":["423","      <version>1.2<\/version>"]}],"changelog.html":[{"add":["70","  <li class=bug>","71","    Fixed timeline on build trend page.","72","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-6439\">issue 6439<\/a>)"],"delete":[]}]}},"2999b2c405447020b162fa44acdd4ce4df8c69fb":{"changes":{"core\/src\/main\/java\/hudson\/model\/Job.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/HealthReport.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Job.java":[{"add":[],"delete":["869","            if (score < 100 && score > 0) {","870","                \/\/ HACK","871","                \/\/ force e.g. 4\/5 to be in the 60-79 range","872","                score--;","873","            }"]}],"core\/src\/main\/java\/hudson\/model\/HealthReport.java":[{"add":["46","    \/\/ These are now 0-20, 21-40, 41-60, 61-80, 81+ but filenames unchanged for compatibility","48","    private static final String HEALTH_61_TO_80 = \"health-60to79.gif\";","49","    private static final String HEALTH_41_TO_60 = \"health-40to59.gif\";","50","    private static final String HEALTH_21_TO_40 = \"health-20to39.gif\";","51","    private static final String HEALTH_0_TO_20 = \"health-00to19.gif\";","119","            if (score <= 20) {","120","                this.iconUrl = HEALTH_0_TO_20;","121","            } else if (score <= 40) {","122","                this.iconUrl = HEALTH_21_TO_40;","123","            } else if (score <= 60) {","124","                this.iconUrl = HEALTH_41_TO_60;","125","            } else if (score <= 80) {","126","                this.iconUrl = HEALTH_61_TO_80;"],"delete":["47","    private static final String HEALTH_60_TO_79 = \"health-60to79.gif\";","48","    private static final String HEALTH_40_TO_59 = \"health-40to59.gif\";","49","    private static final String HEALTH_20_TO_39 = \"health-20to39.gif\";","50","    private static final String HEALTH_0_TO_19 = \"health-00to19.gif\";","118","            if (score < 20) {","119","                this.iconUrl = HEALTH_0_TO_19;","120","            } else if (score < 40) {","121","                this.iconUrl = HEALTH_20_TO_39;","122","            } else if (score < 60) {","123","                this.iconUrl = HEALTH_40_TO_59;","124","            } else if (score < 80) {","125","                this.iconUrl = HEALTH_60_TO_79;"]}]}},"98bb78ff1891bb85471a089977066c4b4a11b261":{"changes":{"core\/src\/main\/java\/jenkins\/security\/ImpersonatingScheduledExecutorService.java":"MODIFY","core\/src\/main\/java\/jenkins\/security\/ImpersonatingExecutorService.java":"MODIFY","core\/src\/main\/java\/jenkins\/util\/InterceptingScheduledExecutorService.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/security\/ImpersonatingScheduledExecutorService.java":[{"add":["35"," * @since 2.51"],"delete":["35"," * @since FIXME"]}],"core\/src\/main\/java\/jenkins\/security\/ImpersonatingExecutorService.java":[{"add":["36"," * @since 2.51"],"delete":["36"," * @since FIXME"]}],"core\/src\/main\/java\/jenkins\/util\/InterceptingScheduledExecutorService.java":[{"add":["33"," * @since 2.51"],"delete":["33"," * @since FIXME"]}]}},"c483f1196a292f0fd95ba6620852c8b8925efe13":{"changes":{"core\/src\/main\/java\/hudson\/FilePath.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/FilePath.java":[{"add":["554","                        dir = new File(System.getProperty(\"java.io.tmpdir\"));"],"delete":["554","                        dir = null;"]}]}},"6ebcd2d97dbfbacf133c9a68877d137e196974bc":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/test\/MatrixTestResult.java":"MODIFY","core\/src\/main\/resources\/hudson\/tasks\/test\/MatrixTestResult\/index.jelly":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/test\/MatrixTestResult.java":[{"add":["30","import hudson.tasks.junit.CaseResult;","58","","59","    @Override","60","    public String getTestResultPath(CaseResult it) {","61","        \/\/ Prepend Configuration path","62","        return it.getOwner().getParent().getShortUrl() + super.getTestResultPath(it);","63","    }"],"delete":[]}],"core\/src\/main\/resources\/hudson\/tasks\/test\/MatrixTestResult\/index.jelly":[{"add":["43","              <a href=\"..\/${report.child.project.shortUrl}testReport\">${report.child.project.name}<\/a>","75","            <a href=\"..\/${report.child.project.shortUrl}testReport\">${report.child.project.name}<\/a>","87","                  <a href=\"..\/${report.child.project.shortUrl}testReport\/${f.getRelativePathFrom(report.result)}\">","108","<\/j:jelly>"],"delete":["43","              <a href=\"..\/${report.child.project.shortUrl}\/testReport\">${report.child.project.name}<\/a>","75","            <a href=\"..\/${report.child.project.shortUrl}\/testReport\">${report.child.project.name}<\/a>","87","                  <a href=\"..\/${report.child.project.shortUrl}\/testReport\/${f.getRelativePathFrom(report.result)}\">","108","<\/j:jelly>"]}]}},"1c68183ae80b44e3e11d46d1eb6b20af8f4ecde2":{"changes":{"core\/src\/test\/java\/jenkins\/model\/CoreEnvironmentContributorTest.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/test\/java\/jenkins\/model\/CoreEnvironmentContributorTest.java":[{"add":["16","import org.jvnet.hudson.test.Bug;","42","    @Bug(19307)"],"delete":["2","import static org.mockito.Mockito.doReturn;","5","import static org.powermock.api.mockito.PowerMockito.spy;"]}],"changelog.html":[{"add":["63","  <li class=bug>","64","    SCM polling sometimes broken since 1.527 due to a change in how environment variables are calculated.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-19307\">issue 19307<\/a>)","66","  <li class=bug>"],"delete":["63","    <li class=bug>"]}]}},"0b5a4a3550dcff91b1bedeb77415f683b659634b":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["63","  <li class=bug>","64","    Fixed RememberMe cookie signature generation.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-16278\">issue 16278<\/a>)","66","    "],"delete":[]}]}},"e4902e7e8ab7a21e84ea21a36395b0e2a5077019":{"changes":{"core\/src\/main\/resources\/hudson\/triggers\/SCMTrigger\/global.jelly":"MODIFY","core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/triggers\/SCMTrigger\/global.jelly":[{"add":["26","  <j:if test=\"${descriptor.pollingThreadCountOptionVisible}\">"],"delete":["26","  <j:if test=\"${app.items.size()>10}\">","27","    <!--","28","      unless you have a fair number of projects, this option is likely pointless.","29","      so let's hide this option for new users to avoid confusing them.","30","    -->"]}],"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":[{"add":["47","import org.kohsuke.accmod.Restricted;","48","import org.kohsuke.accmod.restrictions.NoExternalUse;","264","        @Restricted(NoExternalUse.class)","265","        public boolean isPollingThreadCountOptionVisible() {","266","            \/\/ unless you have a fair number of projects, this option is likely pointless.","267","            \/\/ so let's hide this option for new users to avoid confusing them","268","            \/\/ unless it was already changed","269","            return Jenkins.getInstance().getAllItems(AbstractProject.class).size() > 10","270","                    || getPollingThreadCount() != 0;","271","        }","272",""],"delete":[]}]}},"655be64a1753a3077a81fc0c34573bca74dcf5a0":{"changes":{"core\/src\/main\/java\/jenkins\/security\/ClassFilterImpl.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/security\/ClassFilterImpl.java":[{"add":["30","import hudson.remoting.Which;","52","import javax.annotation.CheckForNull;","53","import javax.annotation.Nonnull;","76","    private static final String JENKINS_LOC = codeSource(Jenkins.class);","77","    private static final String REMOTING_LOC = codeSource(ClassFilter.class);","78","","83","        if (Main.isUnitTest && JENKINS_LOC == null) {","154","            String location = codeSource(c);","156","                if (isLocationWhitelisted(location)) {","183","            if (loc.equals(JENKINS_LOC)) {","187","            if (loc.equals(REMOTING_LOC)) {","248","    \/**","249","     * Tries to determine what JAR file a given class was loaded from.","250","     * The location is an opaque string suitable only for comparison to others.","251","     * Similar to {@link Which#jarFile(Class)} but potentially faster, and more tolerant of unknown URL formats.","252","     * @param c some class","253","     * @return something typically like {@code file:\/\u2026\/plugins\/structs\/WEB-INF\/lib\/structs-1.10.jar};","254","     *         or null for classes in the Java Platform, some generated classes, etc.","255","     *\/","256","    private static @CheckForNull String codeSource(@Nonnull Class<?> c) {","257","        CodeSource cs = c.getProtectionDomain().getCodeSource();","258","        if (cs == null) {","259","            return null;","260","        }","261","        URL loc = cs.getLocation();","262","        if (loc == null) {","263","            return null;","264","        }","265","        String r = loc.toString();","266","        if (r.endsWith(\".class\")) {","267","            \/\/ JENKINS-49147: Tomcat bug. Now do the more expensive check\u2026","268","            String suffix = c.getName().replace('.', '\/') + \".class\";","269","            if (r.endsWith(suffix)) {","270","                r = r.substring(0, r.length() - suffix.length());","271","            }","272","        }","273","        return r;","274","    }","275",""],"delete":["77","        if (Main.isUnitTest && Jenkins.class.getProtectionDomain().getCodeSource().getLocation() == null) {","148","            CodeSource codeSource = c.getProtectionDomain().getCodeSource();","149","            URL location = codeSource != null ? codeSource.getLocation() : null;","151","                if (isLocationWhitelisted(location.toString())) {","178","            if (loc.equals(Jenkins.class.getProtectionDomain().getCodeSource().getLocation().toString())) {","182","            if (loc.equals(ClassFilter.class.getProtectionDomain().getCodeSource().getLocation().toString())) {"]}]}},"9e90b59894eeac2a0d03485fab3c9bafe1c46f9c":{"changes":{"core\/src\/main\/java\/jenkins\/security\/apitoken\/ApiTokenStats.java":"MODIFY","core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/security\/apitoken\/ApiTokenStats.java":[{"add":["62","    private Object readResolve() {","219","        private Object readResolve() {"],"delete":["62","    private ApiTokenStats readResolve() {","219","        private SingleTokenStats readResolve() {"]}],"core\/src\/main\/java\/hudson\/triggers\/SCMTrigger.java":[{"add":["247","        private Object readResolve() {","251","            return this;"],"delete":["247","        private void readResolve() {"]}]}},"3f7de7f317441a36be4179d978007db1f644e033":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":[{"add":["26","import hudson.Functions;","98","            String humanReadableSpace = Functions.humanReadableByteSize(size);","99","            if(triggered) {","100","                return Util.wrapToErrorSpan(humanReadableSpace);","102","            return humanReadableSpace;"],"delete":["97","            long space = size;","98","            space\/=1024L;   \/\/ convert to KB","99","            space\/=1024L;   \/\/ convert to MB","100","            if(space\/1024 < 1) {","101","                return Util.wrapToErrorSpan(new BigDecimal(space).scaleByPowerOfTen(-3).toPlainString()+\"GB\");","103","","104","            return space\/1024+\"GB\";"]}],"core\/src\/main\/java\/hudson\/node_monitors\/SwapSpaceMonitor.java":[{"add":["27","import hudson.Functions;","54","       String humanReadableSpace = Functions.humanReadableByteSize(usage.availableSwapSpace);","55","       ","60","            return humanReadableSpace; \/\/ if we have more than 256MB free or less than 80% filled up, it's OK","63","        return Util.wrapToErrorSpan(humanReadableSpace);"],"delete":["57","            return free+\"MB\"; \/\/ if we have more than 256MB free or less than 80% filled up, it's OK","60","        return Util.wrapToErrorSpan(free+\"MB\");"]}]}},"4abc357d338cb8a69b4f4d3c297d010e5ddeeffb":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/MailSender.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/MailSender.java":[{"add":["41","import java.util.*;","56","    ","57","    private List<AbstractProject> includeUpstreamCommitters = new ArrayList<AbstractProject>();","78","","80","        this(recipients,dontNotifyEveryUnstableBuild,sendToIndividuals,charset, Collections.<AbstractProject>emptyList());","81","    }","82","  ","83","    public MailSender(String recipients, boolean dontNotifyEveryUnstableBuild, boolean sendToIndividuals, String charset, Collection<AbstractProject> includeUpstreamCommitters) {","88","        this.includeUpstreamCommitters.addAll(includeUpstreamCommitters);","322","                includeCulpritsOf(up, build, listener, rcp);","334","        for (AbstractProject project : includeUpstreamCommitters) {","335","            includeCulpritsOf(project, build, listener, rcp);","336","        }","337","","360","    private void includeCulpritsOf(AbstractProject upstreamBuild, AbstractBuild<?, ?> currentBuild, BuildListener listener, Set<InternetAddress> recipientList) throws AddressException {","361","        AbstractBuild<?,?> pb = currentBuild.getPreviousBuild();","362","        AbstractBuild<?,?> ub = currentBuild.getUpstreamRelationshipBuild(upstreamBuild);","363","        AbstractBuild<?,?> upb = pb!=null ? pb.getUpstreamRelationshipBuild(upstreamBuild) : null;","364","        if(pb==null && ub==null && upb==null) {","365","            listener.getLogger().println(\"Unable to compute the changesets in \"+ upstreamBuild +\". Is the fingerprint configured?\");","366","            return;","367","        }","368","        if(pb==null || ub==null || upb==null) {","369","            listener.getLogger().println(\"Unable to compute the changesets in \"+ upstreamBuild);","370","            return;","371","        }","372","        for( AbstractBuild<?,?> b=upb; b!=ub && b!=null; b=b.getNextBuild())","373","            recipientList.addAll(buildCulpritList(listener,b.getCulprits()));","374","    }","375",""],"delete":["41","import java.util.Date;","42","import java.util.LinkedHashSet;","43","import java.util.List;","44","import java.util.Set;","45","import java.util.StringTokenizer;","46","import java.util.HashSet;","81","    ","320","                AbstractBuild<?,?> pb = build.getPreviousBuild();","321","                AbstractBuild<?,?> ub = build.getUpstreamRelationshipBuild(up);","322","                AbstractBuild<?,?> upb = pb!=null ? pb.getUpstreamRelationshipBuild(up) : null;","323","                if(pb==null && ub==null && upb==null) {","324","                    listener.getLogger().println(\"Unable to compute the changesets in \"+up+\". Is the fingerprint configured?\");","325","                    continue;","326","                }","327","                if(pb==null || ub==null || upb==null) {","328","                    listener.getLogger().println(\"Unable to compute the changesets in \"+up);","329","                    continue;","330","                }","331","                for( AbstractBuild<?,?> b=upb; b!=ub && b!=null; b=b.getNextBuild())","332","                    rcp.addAll(buildCulpritList(listener,b.getCulprits()));"]}]}},"363e0ea433d651274ce75b808331c7f6f7b45c89":{"changes":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["4285","        if (rsp!=null) {","4286","            rsp.setStatus(HttpServletResponse.SC_OK);","4287","            rsp.setContentType(\"text\/plain\");","4288","            try (PrintWriter w = rsp.getWriter()) {","4289","                w.println(\"Shutting down\");","4290","            }","4291","        }","4292",""],"delete":["4300","","4301","        if (rsp!=null) {","4302","            rsp.setStatus(HttpServletResponse.SC_OK);","4303","            rsp.setContentType(\"text\/plain\");","4304","            try (PrintWriter w = rsp.getWriter()) {","4305","                w.println(\"Shutting down\");","4306","            }","4307","        }"]}]}},"2ffece9d737f4a77ed4059c777948299daf22771":{"changes":{"core\/src\/main\/resources\/lib\/form\/apply\/apply.js":"MODIFY","core\/src\/main\/resources\/lib\/form\/apply.jelly":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/resources\/lib\/form\/textarea\/textarea.js":"MODIFY","test\/src\/test\/resources\/lib\/form\/JSON.js":"ADD","test\/src\/test\/groovy\/lib\/form\/ApplyButtonTest.groovy":"ADD"},"diff":{"core\/src\/main\/resources\/lib\/form\/apply\/apply.js":[{"add":["56","            Event.fire(f,\"jenkins:apply\"); \/\/ give everyone a chance to write back to DOM"],"delete":[]}],"core\/src\/main\/resources\/lib\/form\/apply.jelly":[{"add":["30","","31","    When this button is pressed, the FORM element fires the \"jenkins:apply\" event","32","    that allows interested parties to write back whatever states back into the INPUT","33","    elements."],"delete":[]}],"changelog.html":[{"add":["66","  <li class=bug>","67","    Edited description wasn't reflected when pressing the \"Apply\" button.","68","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18436\">issue 18436<\/a>) <\/ul>"],"delete":["66","<\/ul>"]}],"core\/src\/main\/resources\/lib\/form\/textarea\/textarea.js":[{"add":["15","","16","        \/\/ the form needs to be populated before the \"Apply\" button","17","        e.up('form').on(\"jenkins:apply\",function() {","18","            e.value = codemirror.getValue()","19","        })"],"delete":[]}],"test\/src\/test\/resources\/lib\/form\/JSON.js":[{"add":[],"delete":[]}],"test\/src\/test\/groovy\/lib\/form\/ApplyButtonTest.groovy":[{"add":[],"delete":[]}]}},"06c8dcea6105a1505e6e609491dcc806763cd1f0":{"changes":{"core\/src\/main\/resources\/lib\/form\/hetero-list.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/hetero-list.jelly":[{"add":["128","      <j:set var=\"descriptors\" value=\"${h.filterDescriptors(it,attrs.descriptors)}\" \/>","129","      <j:forEach var=\"descriptor\" items=\"${descriptors}\" varStatus=\"loop\">"],"delete":["128","      <j:forEach var=\"descriptor\" items=\"${attrs.descriptors}\" varStatus=\"loop\">"]}]}},"c83e846fd01f25f2d8468ee0ad61942a4909cd58":{"changes":{"core\/src\/main\/java\/hudson\/matrix\/LinkedLogRotator.java":"MODIFY","core\/src\/main\/java\/hudson\/matrix\/MatrixConfiguration.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/matrix\/LinkedLogRotator.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi","42","    LinkedLogRotator(int artifactDaysToKeep, int artifactNumToKeep) {","43","        super(-1, -1, artifactDaysToKeep, artifactNumToKeep);","44","    }","45","","46","    \/**","47","     * @deprecated since 1.369","48","     *     Use {@link #LinkedLogRotator(int, int)}","49","     *\/","51","        super(-1, -1, -1, -1);","56","        \/\/ Let superclass handle clearing artifacts, if configured:","57","        super.perform(_job);","60","        \/\/ copy it to the array because we'll be deleting builds as we go."],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi","43","        super(-1,-1);","48","        \/\/ copy it to the array because we'll be deleting builds as we go."]}],"core\/src\/main\/java\/hudson\/matrix\/MatrixConfiguration.java":[{"add":["3"," * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts","242","        LogRotator lr = getParent().getLogRotator();","243","        return new LinkedLogRotator(lr != null ? lr.getArtifactDaysToKeep() : -1,","244","                                    lr != null ? lr.getArtifactNumToKeep() : -1);"],"delete":["3"," * Copyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts","242","        return new LinkedLogRotator();"]}]}},"ac749d669d6ba8bd77c0827c8705c9454f973a6a":{"changes":{".gitignore":"MODIFY","pom.xml":"MODIFY"},"diff":{".gitignore":[{"add":[],"delete":["1",".flattened-pom.xml"]}],"pom.xml":[{"add":["30","    <version>1.46<\/version>"],"delete":["30","    <version>1.44<\/version>"]}]}},"d5c2873e4a2dfd97edd938abb6fed000b19fd8fe":{"changes":{"core\/src\/main\/resources\/hudson\/tasks\/test\/MetaTabulatedResult\/body_fr.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/tasks\/test\/MetaTabulatedResult\/body_fr.properties":[{"add":["22","All\\ Failed\\ Tests=Tous les tests qui ont \\u00E9chou\\u00E9","26","Duration=Dur\\u00E9e"],"delete":["22","All\\ Failed\\ Tests=Tous les tests qui ont chous","26","Duration=Dure"]}]}},"80773e1865921d4656cc9b9c0637f38c1ffb8e29":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["214","      <version>1.1.4-hudson-3<\/version>"],"delete":["214","      <version>1.1.4-hudson-2<\/version>"]}]}},"56d62858ef2d812a571cb5c2551f738511fda6af":{"changes":{"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":"MODIFY"},"diff":{"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":[{"add":["519","    var h = e.onclick;"],"delete":["519","    var type = e.type;","520","    var h = e.onclick || function (event) {","521","        if (type && type.toLowerCase() === 'submit') {","522","            var target = event.target;","523","            var form = findAncestor(target, \"FORM\");","524","            form.submit();","525","        } else {","526","            \/\/FIXME: get some usecases for else","527","        }","528","    };"]}]}},"d4f87626c8c95813eff1342e06a230ae4deebdde":{"changes":{"\/dev\/null":"DELETE","test\/src\/test\/java\/hudson\/model\/AperiodicWorkTest.java":"ADD","test\/src\/test\/java\/hudson\/model\/PeriodicWorkTest.java":"MODIFY"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/AperiodicWorkTest.java":[{"add":[],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/PeriodicWorkTest.java":[{"add":["29","        assertThat(\"The task was run within 15 seconds\", tpw.doneSignal.await(15, TimeUnit.SECONDS), is(true));"],"delete":["29","        assertThat(\"The task was not run within 15 seconds\",tpw.doneSignal.await(15, TimeUnit.SECONDS), is(true));"]}]}},"96174ecdf13064bcd5a4426dec6c5923fd1fde84":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/junit\/TestResult.java":"MODIFY","core\/src\/test\/resources\/hudson\/tasks\/junit\/junit-report-1472.xml":"ADD","core\/src\/main\/java\/hudson\/tasks\/junit\/CaseResult.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/SuiteResult.java":"MODIFY","core\/src\/test\/java\/hudson\/tasks\/junit\/SuiteResultTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/junit\/TestResult.java":[{"add":["123","            for( SuiteResult suiteResult : SuiteResult.parse(reportFile) ) {","124","                suites.add( suiteResult );","125","                duration += suiteResult.getDuration();","126","            }"],"delete":["123","            SuiteResult suiteResult = new SuiteResult(reportFile);","124","            suites.add( suiteResult );","125","            duration += suiteResult.getDuration(); "]}],"core\/src\/test\/resources\/hudson\/tasks\/junit\/junit-report-1472.xml":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/CaseResult.java":[{"add":[],"delete":["36","    CaseResult(SuiteResult parent, Element testCase) {","37","        \/\/ reports in http:\/\/www.nabble.com\/difference-in-junit-publisher-and-ant-junitreport-tf4308604.html#a12265700","38","        \/\/ indicates that in certain situations, using the test suite name is better.","39","        \/\/ note however in other situations, this seems not to be the case","40","        \/\/ https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1233","41","        this(parent, parent.getName(), testCase);","42","    }","43",""]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/SuiteResult.java":[{"add":["43","    \/**","44","     * Parses the JUnit XML file into {@link SuiteResult}s.","45","     * This method returns a collection, as a single XML may have multiple &lt;testsuite>","46","     * elements wrapped into the top-level &lt;testsuites>.","47","     *\/","48","    static List<SuiteResult> parse(File xmlReport) throws DocumentException {","49","        List<SuiteResult> r = new ArrayList<SuiteResult>();","50","","51","        \/\/ parse into DOM","52","        SAXReader saxReader = new SAXReader();","53","        \/\/ install EntityResolver for resolving DTDs, which are in files created by TestNG.","54","        \/\/ (see https:\/\/hudson.dev.java.net\/servlets\/ReadMsg?listName=users&msgNo=5530)","55","        XMLEntityResolver resolver = new XMLEntityResolver();","56","        saxReader.setEntityResolver(resolver);","59","","60","        if(root.getName().equals(\"testsuites\")) {","61","            \/\/ multi-suite file","62","            for (Element suite : (List<Element>)root.elements(\"testsuite\"))","63","                r.add(new SuiteResult(xmlReport,suite));","64","        } else {","65","            \/\/ single suite file","66","            r.add(new SuiteResult(xmlReport,root));","67","        }","68","","69","        return r;","70","    }","71","","72","    private SuiteResult(File xmlReport, Element suite) throws DocumentException {","73","        String name = suite.attributeValue(\"name\");","80","        stdout = suite.elementText(\"system-out\");","81","        stderr = suite.elementText(\"system-err\");","83","        Element ex = suite.element(\"error\");","86","            addCase(new CaseResult(this,suite,\"<init>\"));","89","        for (Element e : (List<Element>)suite.elements(\"testcase\")) {","90","            \/\/ https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1233 indicates that","91","            \/\/ when <testsuites> is present, we are better off using @classname on the","92","            \/\/ individual testcase class.","94","            \/\/ https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1463 indicates that","95","            \/\/ @classname may not exist in individual testcase elements. We now","96","            \/\/ also test if the testsuite element has a package name that can be used","97","            \/\/ as the class name instead of the file name which is default.","98","            String classname = e.attributeValue(\"classname\");","99","            if (classname == null) {","100","                classname = suite.attributeValue(\"name\");","102","","103","            \/\/ https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1233 and","104","            \/\/ http:\/\/www.nabble.com\/difference-in-junit-publisher-and-ant-junitreport-tf4308604.html#a12265700","105","            \/\/ are at odds with each other --- when both are present,","106","            \/\/ one wants to use @name from <testsuite>,","107","            \/\/ the other wants to use @classname from <testcase>.","108","","109","            addCase(new CaseResult(this,classname,e));"],"delete":["43","    SuiteResult(File xmlReport) throws DocumentException {","44","\t\tSAXReader saxReader = new SAXReader();","45","\t\t\/\/ fix for problems related to testng-results.xml","46","\t\t\/\/ (see https:\/\/hudson.dev.java.net\/servlets\/ReadMsg?listName=users&msgNo=5530)","47","\t\tXMLEntityResolver resolver = new XMLEntityResolver();","48","\t\tsaxReader.setEntityResolver(resolver);","51","        String name = root.attributeValue(\"name\");","58","        stdout = root.elementText(\"system-out\");","59","        stderr = root.elementText(\"system-err\");","61","        Element ex = root.element(\"error\");","64","            addCase(new CaseResult(this,root,\"<init>\"));","67","        for (Element e : (List<Element>)root.elements(\"testcase\")) {","68","            addCase(new CaseResult(this,e));","69","        }","70","        \/\/ a user reported that there's a slight variation of the format that puts <testsuites> at root","71","        \/\/ see http:\/\/www.nabble.com\/More-JUnit-test-report-problems...-tf4267020.html#a12143611","72","        for (Element suite : (List<Element>)root.elements(\"testsuite\")) {","73","            for (Element e : (List<Element>)suite.elements(\"testcase\")) {","74","                ","75","                \/\/ https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1233 indicates that","76","                \/\/ when <testsuites> is present, we are better off using @classname on the","77","                \/\/ individual testcase class.","79","                \/\/ https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1463 indicates that","80","                \/\/ @classname may not exist in individual testcase elements. We now","81","                \/\/ also test if the testsuite element has a package name that can be used","82","                \/\/ as the class name instead of the file name which is default.","83","                ","84","                String classname = e.attributeValue(\"classname\");","85","                if (classname == null) {","86","                    classname = suite.attributeValue(\"name\");","87","                }","88","                ","89","                if (classname == null) {","90","                    addCase(new CaseResult(this,e));","91","                } else {","92","                    addCase(new CaseResult(this,classname,e));","93","                }"]}],"core\/src\/test\/java\/hudson\/tasks\/junit\/SuiteResultTest.java":[{"add":["4","import java.net.URISyntaxException;","7","import org.dom4j.DocumentException;","18","    private File getDataFile(String name) throws URISyntaxException {","19","        return new File(SuiteResultTest.class.getResource(name).toURI());","20","    }","21","","22","    private SuiteResult parseOne(File file) throws DocumentException {","23","        List<SuiteResult> results = SuiteResult.parse(file);","24","        assertEquals(1,results.size());","25","        return results.get(0);","26","    }","27","","33","        SuiteResult result = parseOne(getDataFile(\"junit-report-1233.xml\"));","48","        SuiteResult result = parseOne(getDataFile(\"junit-report-1463.xml\"));","61","","62","    \/**","63","     * Verifying fix for issue #1472.","64","     * JUnit report produced by TAP (Test Anything Protocol)","65","     * https:\/\/hudson.dev.java.net\/issues\/show_bug.cgi?id=1472","66","     *\/","67","    public void testIssue1472() throws Exception {","68","        List<SuiteResult> results = SuiteResult.parse(getDataFile(\"junit-report-1472.xml\"));","69","        assertTrue(results.size()>20); \/\/ lots of data here","70","","71","        SuiteResult sr0 = results.get(0);","72","        SuiteResult sr1 = results.get(1);","73","        assertEquals(\"make_test.t_basic_lint_t\",sr0.getName());","74","        assertEquals(\"make_test.t_basic_meta_t\",sr1.getName());","75","        assertTrue(!sr0.getStdout().equals(sr1.getStdout()));","76","    }"],"delete":["21","        File file = new File(SuiteResultTest.class.getResource(\"junit-report-1233.xml\").toURI());","22","        SuiteResult result = new SuiteResult(file);","31","    ","38","        File file = new File(SuiteResultTest.class.getResource(\"junit-report-1463.xml\").toURI());","39","        SuiteResult result = new SuiteResult(file);"]}]}},"f2ba3b9642a1465652327fea52aa4598389b9c5a":{"changes":{"core\/src\/main\/resources\/jenkins\/install\/pluginSetupWizard.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/install\/pluginSetupWizard.properties":[{"add":["40","installWizard_skipFirstUser=Continue as admin"],"delete":["40","installWizard_skipFirstUser=Skip"]}]}},"19a2246fe67d938b7f4574dce9180b1d37bd3201":{"changes":{"test\/src\/test\/java\/hudson\/cli\/CopyJobCommandTest.java":"MODIFY","core\/src\/main\/java\/hudson\/cli\/CopyJobCommand.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/cli\/CopyJobCommandTest.java":[{"add":["39","import static org.hamcrest.MatcherAssert.assertThat;","40","","41","import static hudson.cli.CLICommandInvoker.Matcher.hasNoStandardOutput;","42","import static hudson.cli.CLICommandInvoker.Matcher.hasNoErrorOutput;","43","import static hudson.cli.CLICommandInvoker.Matcher.succeeded;","44","","64","    \/\/ hold off build until saved only makes sense on the UI with config screen shown after copying;","65","    \/\/ expect the CLI copy command to leave the job buildable","66","    @Test public void copiedJobIsBuildable() throws Exception {","67","        FreeStyleProject p1 = j.createFreeStyleProject();","68","        String copiedProjectName = \"p2\";","69","","70","        CLICommandInvoker.Result result = new CLICommandInvoker(j, new CopyJobCommand())","71","                .invokeWithArgs(p1.getName(), copiedProjectName);","72","","73","        assertThat(\"Command expected to succeed; \" + result.stderr() + ' ' + result.stdout(), result, succeeded());","74","        assertThat(\"stdout empty\", result, hasNoStandardOutput());","75","        assertThat(\"stderr empty\", result, hasNoErrorOutput());","76","","77","        FreeStyleProject p2 = (FreeStyleProject)j.jenkins.getItem(copiedProjectName);","78","","79","        assertNotNull(p2);","80","        assertTrue(p2.isBuildable());","81","    }","82",""],"delete":[]}],"core\/src\/main\/java\/hudson\/cli\/CopyJobCommand.java":[{"add":["77","        ig.copy(src,dst).save();"],"delete":["77","        ig.copy(src,dst);"]}]}},"fe2b697e145a5d1c2b5cc60fc5f63b18b0aa79f2":{"changes":{"core\/src\/main\/java\/hudson\/XmlFile.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/XmlFile.java":[{"add":["53","import java.io.UnsupportedEncodingException;","199","     * @throws IOException Encoding issues","200","     * @return Reader for the file. should be close externally once read.","203","        FileInputStream fileInputStream = new FileInputStream(file);","204","        try {","205","            return new InputStreamReader(fileInputStream, sniffEncoding());","206","        } catch(IOException ex) {","207","            \/\/ Exception may happen if we fail to find encoding or if this encoding is unsupported.","208","            \/\/ In such case we close the underlying stream and rethrow.","209","            Util.closeAndLogFailures(fileInputStream, LOGGER, \"FileInputStream\", file.toString());","210","            throw ex;","211","        }"],"delete":["200","        return new InputStreamReader(new FileInputStream(file),sniffEncoding());"]}]}},"2820dc723cc4029e529487ec62a71ce17afe1488":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["105","      <version>2.8<\/version>"],"delete":["105","      <version>2.7<\/version>"]}]}},"3e38a509c5aa014cefa8fb2270c04c0531d32164":{"changes":{"core\/src\/test\/java\/hudson\/model\/RunTest.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/model\/RunTest.java":[{"add":["31","import java.util.Locale;","42","import org.jvnet.localizer.LocaleProvider;","131","      LocaleProvider providerToRestore = LocaleProvider.getProvider();","132","      try {","133","        \/\/ This test expects English texts.","134","        LocaleProvider.setProvider(new LocaleProvider() {","135","            @Override","136","            public Locale get() {","137","                return Locale.ENGLISH;","138","            }","139","        });","140","        ","150","      } finally {","151","        LocaleProvider.setProvider(providerToRestore);","152","      }"],"delete":[]}]}},"6fb9e91b63521eb8cdcd072cec6610d856aabf34":{"changes":{"test\/src\/test\/resources\/plugins\/require-system-during-load.hpi":"ADD","core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY","test\/src\/test\/java\/hudson\/PluginManagerTest.java":"MODIFY"},"diff":{"test\/src\/test\/resources\/plugins\/require-system-during-load.hpi":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["821","        try (ACLContext context = ACL.as(ACL.SYSTEM)) {","822","            LOGGER.info(\"Attempting to dynamic load \"+arc);","823","            PluginWrapper p = null;","824","            String sn;","825","            try {","826","                sn = strategy.getShortName(arc);","827","            } catch (AbstractMethodError x) {","828","                LOGGER.log(WARNING, \"JENKINS-12753 fix not active: {0}\", x.getMessage());","829","                p = strategy.createPluginWrapper(arc);","830","                sn = p.getShortName();","831","            }","832","            PluginWrapper pw = getPlugin(sn);","833","            if (pw!=null) {","834","                if (removeExisting) { \/\/ try to load disabled plugins","835","                    for (Iterator<PluginWrapper> i = plugins.iterator(); i.hasNext();) {","836","                        pw = i.next();","837","                        if(sn.equals(pw.getShortName())) {","838","                            i.remove();","839","                            pw = null;","840","                            break;","841","                        }","842","                    }","843","                } else {","844","                    throw new RestartRequiredException(Messages._PluginManager_PluginIsAlreadyInstalled_RestartRequired(sn));","845","                }","846","            }","847","            if (p == null) {","848","                p = strategy.createPluginWrapper(arc);","849","            }","850","            if (p.supportsDynamicLoad()== YesNoMaybe.NO)","851","                throw new RestartRequiredException(Messages._PluginManager_PluginDoesntSupportDynamicLoad_RestartRequired(sn));","852","","853","            \/\/ there's no need to do cyclic dependency check, because we are deploying one at a time,","854","            \/\/ so existing plugins can't be depending on this newly deployed one.","855","","856","            plugins.add(p);","857","            if (p.isActive())","858","                activePlugins.add(p);","859","            synchronized (((UberClassLoader) uberClassLoader).loaded) {","860","                ((UberClassLoader) uberClassLoader).loaded.clear();","861","            }","862","","863","            try {","864","                p.resolvePluginDependencies();","865","                strategy.load(p);","866","","867","                Jenkins.getInstance().refreshExtensions();","868","","869","                p.getPlugin().postInitialize();","870","            } catch (Exception e) {","871","                failedPlugins.add(new FailedPlugin(sn, e));","872","                activePlugins.remove(p);","873","                plugins.remove(p);","874","                throw new IOException(\"Failed to install \"+ sn +\" plugin\",e);","875","            }","876","","877","            \/\/ run initializers in the added plugin","878","            Reactor r = new Reactor(InitMilestone.ordering());","879","            final ClassLoader loader = p.classLoader;","880","            r.addAll(new InitializerFinder(loader) {","881","                @Override","882","                protected boolean filter(Method e) {","883","                    return e.getDeclaringClass().getClassLoader() != loader || super.filter(e);","884","                }","885","            }.discoverTasks(r));","886","            try {","887","                new InitReactorRunner().run(r);","888","            } catch (ReactorException e) {","889","                throw new IOException(\"Failed to initialize \"+ sn +\" plugin\",e);","890","            }","891","","892","            \/\/ recalculate dependencies of plugins optionally depending the newly deployed one.","893","            for (PluginWrapper depender: plugins) {","894","                if (depender.equals(p)) {","895","                    \/\/ skip itself.","896","                    continue;","897","                }","898","                for (Dependency d: depender.getOptionalDependencies()) {","899","                    if (d.shortName.equals(p.getShortName())) {","900","                        \/\/ this plugin depends on the newly loaded one!","901","                        \/\/ recalculate dependencies!","902","                        try {","903","                            getPluginStrategy().updateDependency(depender, p);","904","                        } catch (AbstractMethodError x) {","905","                            LOGGER.log(WARNING, \"{0} does not yet implement updateDependency\", getPluginStrategy().getClass());","906","                        }","911","","912","            \/\/ Redo who depends on who.","913","            resolveDependantPlugins();","914","","915","            LOGGER.info(\"Plugin \" + p.getShortName()+\":\"+p.getVersion() + \" dynamically installed\");"],"delete":["821","        LOGGER.info(\"Attempting to dynamic load \"+arc);","822","        PluginWrapper p = null;","823","        String sn;","824","        try {","825","            sn = strategy.getShortName(arc);","826","        } catch (AbstractMethodError x) {","827","            LOGGER.log(WARNING, \"JENKINS-12753 fix not active: {0}\", x.getMessage());","828","            p = strategy.createPluginWrapper(arc);","829","            sn = p.getShortName();","830","        }","831","        PluginWrapper pw = getPlugin(sn);","832","        if (pw!=null) {","833","            if (removeExisting) { \/\/ try to load disabled plugins","834","                for (Iterator<PluginWrapper> i = plugins.iterator(); i.hasNext();) {","835","                    pw = i.next();","836","                    if(sn.equals(pw.getShortName())) {","837","                        i.remove();","838","                        pw = null;","842","            } else {","843","                throw new RestartRequiredException(Messages._PluginManager_PluginIsAlreadyInstalled_RestartRequired(sn));","846","        if (p == null) {","847","            p = strategy.createPluginWrapper(arc);","848","        }","849","        if (p.supportsDynamicLoad()== YesNoMaybe.NO)","850","            throw new RestartRequiredException(Messages._PluginManager_PluginDoesntSupportDynamicLoad_RestartRequired(sn));","851","","852","        \/\/ there's no need to do cyclic dependency check, because we are deploying one at a time,","853","        \/\/ so existing plugins can't be depending on this newly deployed one.","854","","855","        plugins.add(p);","856","        if (p.isActive())","857","            activePlugins.add(p);","858","        synchronized (((UberClassLoader) uberClassLoader).loaded) {","859","            ((UberClassLoader) uberClassLoader).loaded.clear();","860","        }","861","","862","        try {","863","            p.resolvePluginDependencies();","864","            strategy.load(p);","865","","866","            Jenkins.getInstance().refreshExtensions();","867","","868","            p.getPlugin().postInitialize();","869","        } catch (Exception e) {","870","            failedPlugins.add(new FailedPlugin(sn, e));","871","            activePlugins.remove(p);","872","            plugins.remove(p);","873","            throw new IOException(\"Failed to install \"+ sn +\" plugin\",e);","874","        }","875","","876","        \/\/ run initializers in the added plugin","877","        Reactor r = new Reactor(InitMilestone.ordering());","878","        final ClassLoader loader = p.classLoader;","879","        r.addAll(new InitializerFinder(loader) {","880","            @Override","881","            protected boolean filter(Method e) {","882","                return e.getDeclaringClass().getClassLoader() != loader || super.filter(e);","883","            }","884","        }.discoverTasks(r));","885","        try {","886","            new InitReactorRunner().run(r);","887","        } catch (ReactorException e) {","888","            throw new IOException(\"Failed to initialize \"+ sn +\" plugin\",e);","889","        }","890","","891","        \/\/ recalculate dependencies of plugins optionally depending the newly deployed one.","892","        for (PluginWrapper depender: plugins) {","893","            if (depender.equals(p)) {","894","                \/\/ skip itself.","895","                continue;","896","            }","897","            for (Dependency d: depender.getOptionalDependencies()) {","898","                if (d.shortName.equals(p.getShortName())) {","899","                    \/\/ this plugin depends on the newly loaded one!","900","                    \/\/ recalculate dependencies!","901","                    try {","902","                        getPluginStrategy().updateDependency(depender, p);","903","                    } catch (AbstractMethodError x) {","904","                        LOGGER.log(WARNING, \"{0} does not yet implement updateDependency\", getPluginStrategy().getClass());","905","                    }","906","                    break;","907","                }","908","            }","909","        }","910","","911","        \/\/ Redo who depends on who.","912","        resolveDependantPlugins();","913","","914","        LOGGER.info(\"Plugin \" + p.getShortName()+\":\"+p.getVersion() + \" dynamically installed\");"]}],"test\/src\/test\/java\/hudson\/PluginManagerTest.java":[{"add":["32","import hudson.model.User;","34","import hudson.security.ACL;","35","import hudson.security.ACLContext;","58","import org.jvnet.hudson.test.MockAuthorizationStrategy;","450","    @Issue(\"JENKINS-41684\")","451","    @Test","452","    public void requireSystemDuringLoad() throws Exception {","453","        r.jenkins.setSecurityRealm(r.createDummySecurityRealm());","454","        r.jenkins.setAuthorizationStrategy(new MockAuthorizationStrategy());","455","        try (ACLContext context = ACL.as(User.get(\"underprivileged\").impersonate())) {","456","            dynamicLoad(\"require-system-during-load.hpi\");","457","        }","458","    }","459",""],"delete":[]}]}},"61f0aa2f0f7f28a117058fd8b626d1dde0ca94da":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["92","  <li class=bug>","93","    Canonical name of Maven artifacts may end with \"-\" if classifier is empty.","94","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-11819\">issue 11819<\/a>) "],"delete":[]}]}},"b37f6f1479eb2c1eaabf4d689b461752c1203286":{"changes":{"core\/src\/test\/java\/hudson\/model\/UpdateCenterTest.java":"MODIFY"},"diff":{"core\/src\/test\/java\/hudson\/model\/UpdateCenterTest.java":[{"add":["16","        \/\/ check if we have the internet connectivity. See HUDSON-2095","17","        try {","18","            new URL(\"https:\/\/hudson.dev.java.net\/\").openStream();","19","        } catch (IOException e) {","20","            System.out.println(\"Skipping this test. No internet connectivity\");","21","            return;","22","        }","23",""],"delete":[]}]}},"7e48d4ba4029062ccb13a6ba2a53e8e230b46402":{"changes":{"changelog.html":"MODIFY","core\/src\/test\/java\/hudson\/util\/io\/ZipArchiverTest.java":"ADD","core\/src\/main\/java\/hudson\/util\/io\/ZipArchiver.java":"MODIFY"},"diff":{"changelog.html":[{"add":["57","  <li class=\"bug\">","58","    Incorrect path delimiter used in ZipArchiver when creating archive on Windows.","59","    <a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-9942\">issue 9942<\/a>"],"delete":["57","  <li class=>"]}],"core\/src\/test\/java\/hudson\/util\/io\/ZipArchiverTest.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/util\/io\/ZipArchiver.java":[{"add":["50","    public void visit(final File f, final String _relativePath) throws IOException {","53","        \/\/ On Windows, the elements of relativePath are separated by ","54","        \/\/ back-slashes (\\), but Zip files need to have their path elements separated","55","        \/\/ by forward-slashes (\/)","56","        String relativePath = _relativePath.replace('\\\\', '\/');","57","        "],"delete":["50","    public void visit(File f, String relativePath) throws IOException {"]}]}},"0159f80d96734c21bbec7f62f8382bc30bc1e814":{"changes":{"remoting\/pom.xml":"MODIFY"},"diff":{"remoting\/pom.xml":[{"add":["165","","166","  <profiles>","167","    <profile>","168","      <id>release<\/id>","169","      <properties>","170","        <!-- for releases, just use the POM version. See above ant-run plugin for how this gets used. -->","171","        <build.version>${version}<\/build.version>","172","      <\/properties>","173","    <\/profile>","174","  <\/profiles>"],"delete":[]}]}},"549bfea3785cb78c4a5f766324b982396be50255":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["63","  <li class=bug>","64","    Maven jobs building plugins were no longer identified as upstream snapshot dependencies.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-10530\">issue 10530<\/a>)"],"delete":[]}]}},"ef8ddd8a48df04952e59d242e713ff6e05b972c5":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["136","      <version>1.9<\/version>"],"delete":["136","      <version>1.8<\/version>"]}]}},"5746cdfc7a124cef2a61ae22eed723410f0c8579":{"changes":{"remoting\/src\/main\/java\/hudson\/remoting\/Launcher.java":"MODIFY"},"diff":{"remoting\/src\/main\/java\/hudson\/remoting\/Launcher.java":[{"add":["9","import java.lang.reflect.Method;","10","import java.lang.reflect.InvocationTargetException;","52","            Method m = System.class.getMethod(\"console\");","53","            Object console = m.invoke(null);","65","        } catch (InvocationTargetException e) {","66","            \/\/ this is impossible","67","            throw new AssertionError(e);","68","        } catch (NoSuchMethodException e) {","69","            \/\/ must be running on JDK5","70","        } catch (IllegalAccessException e) {","71","            \/\/ this is impossible","72","            throw new AssertionError(e);"],"delete":["7","import java.io.Console;","51","            Console console = System.console();"]}]}},"d8674e5b5a744f7bd47ac7d7dc7acae43da92389":{"changes":{"maven-agent\/pom.xml":"MODIFY","test\/pom.xml":"MODIFY","remoting\/pom.xml":"MODIFY","debian\/changelog":"MODIFY","core\/pom.xml":"MODIFY","cli\/pom.xml":"MODIFY","maven-plugin\/pom.xml":"MODIFY","maven-interceptor\/pom.xml":"MODIFY","pom.xml":"MODIFY","war\/pom.xml":"MODIFY"},"diff":{"maven-agent\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>"]}],"test\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>"]}],"remoting\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>"]}],"debian\/changelog":[{"add":["0","hudson (1.332) unstable; urgency=low","1","","2","  * See http:\/\/hudson.dev.java.net\/changelog.html for more details.","3","","4"," -- Kohsuke Kawaguchi <kk@kohsuke.org>  Mon, 02 Nov 2009 19:08:10 -0800","5",""],"delete":[]}],"core\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>","335","      <version>1.122<\/version>","384","      <version>1.3.1-hudson-5<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>","335","      <version>1.121<\/version>","384","      <version>1.3.1-hudson-4<\/version>"]}],"cli\/pom.xml":[{"add":["6","    <version>1.333-SNAPSHOT<\/version>"],"delete":["6","    <version>1.332-SNAPSHOT<\/version>"]}],"maven-plugin\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>"]}],"maven-interceptor\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>"]}],"pom.xml":[{"add":["35","  <version>1.333-SNAPSHOT<\/version>"],"delete":["35","  <version>1.332-SNAPSHOT<\/version>"]}],"war\/pom.xml":[{"add":["29","    <version>1.333-SNAPSHOT<\/version>"],"delete":["29","    <version>1.332-SNAPSHOT<\/version>"]}]}},"16709852a918fe0f3f53d3c6c4963ddfdff44024":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/MailSender.java":"MODIFY","core\/src\/main\/java\/hudson\/maven\/reporters\/MavenMailer.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/Mailer.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/MailSender.java":[{"add":["33","public class MailSender {","56","    public boolean execute(AbstractBuild<?, ?> build, BuildListener listener) throws InterruptedException {","62","                AbstractBuild<?, ?> pb = build.getPreviousBuild();","88","    protected MimeMessage getMail(AbstractBuild<?, ?> build, BuildListener listener) throws MessagingException, InterruptedException {","94","            AbstractBuild<?, ?> prev = build.getPreviousBuild();","104","            AbstractBuild<?, ?> prev = build.getPreviousBuild();","116","    private MimeMessage createBackToNormalMail(AbstractBuild<?, ?> build, String subject, BuildListener listener) throws MessagingException {","127","    private MimeMessage createUnstableMail(AbstractBuild<?, ?> build, BuildListener listener) throws MessagingException {","132","        AbstractBuild<?, ?> prev = build.getPreviousBuild();","148","    private void appendBuildUrl(AbstractBuild<?, ?> build, StringBuffer buf) {","155","    private MimeMessage createFailureMail(AbstractBuild<?, ?> build, BuildListener listener) throws MessagingException, InterruptedException {","238","    private MimeMessage createEmptyMail(AbstractBuild<?, ?> build, BuildListener listener) throws MessagingException {","269","        AbstractBuild<?, ?> pb = build.getPreviousBuild();","281","    private String getSubject(AbstractBuild<?, ?> build, String caption) {","288","    protected boolean artifactMatches(String path, AbstractBuild<?, ?> build) {"],"delete":["33","public class MailSender<P extends AbstractProject<P, B>, B extends AbstractBuild<P, B>> {","56","    public boolean execute(B build, BuildListener listener) throws InterruptedException {","62","                B pb = build.getPreviousBuild();","88","    protected MimeMessage getMail(B build, BuildListener listener) throws MessagingException, InterruptedException {","94","            B prev = build.getPreviousBuild();","104","            B prev = build.getPreviousBuild();","116","    private MimeMessage createBackToNormalMail(B build, String subject, BuildListener listener) throws MessagingException {","127","    private MimeMessage createUnstableMail(B build, BuildListener listener) throws MessagingException {","132","        B prev = build.getPreviousBuild();","148","    private void appendBuildUrl(B build, StringBuffer buf) {","155","    private MimeMessage createFailureMail(B build, BuildListener listener) throws MessagingException, InterruptedException {","238","    private MimeMessage createEmptyMail(B build, BuildListener listener) throws MessagingException {","269","        B pb = build.getPreviousBuild();","281","    private String getSubject(B build, String caption) {","288","    protected boolean artifactMatches(String path, B build) {"]}],"core\/src\/main\/java\/hudson\/maven\/reporters\/MavenMailer.java":[{"add":["29","        new MailSender(recipients,dontNotifyEveryUnstableBuild,sendToIndividuals).execute(build,listener);"],"delete":["29","        new MailSender<MavenModule,MavenBuild>(recipients,dontNotifyEveryUnstableBuild,sendToIndividuals).execute(build,listener);"]}],"core\/src\/main\/java\/hudson\/tasks\/Mailer.java":[{"add":["5","import hudson.model.AbstractBuild;","69","    public boolean perform(AbstractBuild<?,?> build, Launcher launcher, BuildListener listener) throws InterruptedException {","72","        return new MailSender(recipients,dontNotifyEveryUnstableBuild,sendToIndividuals) {","75","            public boolean artifactMatches(String path, AbstractBuild<?,?> build) {","76","                ArtifactArchiver aa = (ArtifactArchiver) build.getProject().getPublishersList().toMap().get(ArtifactArchiver.DESCRIPTOR);"],"delete":["9","import hudson.model.Project;","69","    public boolean perform(Build build, Launcher launcher, BuildListener listener) throws InterruptedException {","70","        return _perform(build,launcher,listener);","71","    }","72","","73","    public <P extends Project<P,B>,B extends Build<P,B>> boolean _perform(B build, Launcher launcher, BuildListener listener) throws InterruptedException {","76","        return new MailSender<P,B>(recipients,dontNotifyEveryUnstableBuild,sendToIndividuals) {","79","            public boolean artifactMatches(String path, B build) {","80","                ArtifactArchiver aa = (ArtifactArchiver) build.getProject().getPublishers().get(ArtifactArchiver.DESCRIPTOR);"]}]}},"f0bbc66921fec56dd9565c2a5146734f20f2fb6c":{"changes":{"core\/src\/main\/java\/hudson\/model\/DirectoryBrowserSupport.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/DirectoryBrowserSupport.java":[{"add":["28","import org.apache.commons.io.IOUtils;","354","            InputStream in = f.open();","355","            try {","356","                Util.copyStream(in, zos);","357","            } finally {","358","                IOUtils.closeQuietly(in);","359","            }"],"delete":["353","            Util.copyStream(f.open(), zos);"]}]}},"dcf5f948cd4a7f69d2bb8eb5201b90b88ac20baa":{"changes":{"war\/resources\/scripts\/hudson-behavior.js":"MODIFY","core\/src\/main\/resources\/lib\/form\/expandableTextbox.jelly":"MODIFY"},"diff":{"war\/resources\/scripts\/hudson-behavior.js":[{"add":["276","    var n = field;","277","    while(n.tagName!=\"TABLE\")","278","        n = n.parentNode;","279","    n.parentNode.innerHTML ="],"delete":["276","    field.parentNode.parentNode.parentNode.parentNode.innerHTML ="]}],"core\/src\/main\/resources\/lib\/form\/expandableTextbox.jelly":[{"add":["9","  <j:choose>","10","    <j:when test=\"${h.isMultiline(attrs.value)}\">","11","      <!-- multiline text area to begin with -->","12","      <textarea rows=\"8\" class='setting-input' name='${attrs.name}'>${attrs.value}<\/textarea>","13","    <\/j:when>","14","    <j:otherwise>","15","      <!-- single line textbox with expand button -->","16","      <table border=\"0\" style=\"width:100%\" cellspacing=\"0\" cellpadding=\"0\">","25","      <\/table>","26","    <\/j:otherwise>","27","  <\/j:choose>"],"delete":["9","  <table border=\"0\" style=\"width:100%\" cellspacing=\"0\" cellpadding=\"0\">","10","    <j:choose>","11","      <j:when test=\"${h.isMultiline(attrs.value)}\">","12","        <!-- multiline text area to begin with -->","13","        <textarea rows=\"8\" class='setting-input' name='${attrs.name}'>${attrs.value}<\/textarea>","14","      <\/j:when>","15","      <j:otherwise>","16","        <!-- single line textbox with expand button -->","25","      <\/j:otherwise>","26","    <\/j:choose>","27","  <\/table>"]}]}},"a53a218aa32d6bba72ad7c49fc08532edad7299b":{"changes":{"core\/src\/main\/java\/hudson\/security\/HudsonPrivateSecurityRealm.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/security\/HudsonPrivateSecurityRealm.java":[{"add":["282","            return new UsernamePasswordAuthenticationToken(getUsername(), getPassword());"],"delete":["282","            return new UsernamePasswordAuthenticationToken(null, password);"]}]}},"bafeb427f65600021798c1000b2f99fa43c37fb8":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["150","                  <version>0.9.10-hudson-5<\/version>"],"delete":["150","                  <version>0.9.10-hudson-4<\/version>"]}]}},"8242e0eb1625454ae5539c444c8d8ecf99a70b62":{"changes":{"core\/src\/main\/resources\/lib\/layout\/html.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/layout\/html.jelly":[{"add":["149","    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" \/>"],"delete":[]}]}},"bfaab5118d079405b82b80301d90e19f39970366":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/test\/AggregatedTestResultPublisher.java":"MODIFY","test\/src\/test\/java\/hudson\/tasks\/test\/AggregatedTestResultPublisherTest.java":"MODIFY"},"diff":{"changelog.html":[{"add":["57","  <li class=\"major bug\">","58","    NPE since 1.545 when using aggregated test result publisher without specifying downstream jobs explicitly.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18410\">issue 18410<\/a>)"],"delete":["57","  <li class=>"]}],"core\/src\/main\/java\/hudson\/tasks\/test\/AggregatedTestResultPublisher.java":[{"add":["89","        build.addAction(new TestResultAction(jobs, includeFailedBuilds, build));","133","        @SuppressWarnings(\"deprecation\") \/\/ calls getProject in constructor, so needs owner immediately"],"delete":["89","        build.addAction(new TestResultAction(jobs, includeFailedBuilds));","133","        public TestResultAction(String jobs, boolean includeFailedBuilds) {","134","            this(jobs, includeFailedBuilds, null);","135","        }","136","","137","        @Deprecated"]}],"test\/src\/test\/java\/hudson\/tasks\/test\/AggregatedTestResultPublisherTest.java":[{"add":["169","        upstreamProject.getPublishersList().add(new AggregatedTestResultPublisher(null));"],"delete":["169","        upstreamProject.getPublishersList().add(new AggregatedTestResultPublisher(TEST_PROJECT_NAME));"]}]}},"81c16190bbc6e9ee9e9ad32ba9814c0c78fec7b5":{"changes":{"core\/src\/main\/java\/hudson\/security\/LDAPSecurityRealm.java":"MODIFY","war\/resources\/help\/security\/ldap\/server.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/security\/LDAPSecurityRealm.java":[{"add":["423","\/\/update to allow ldap:\/\/ or ldaps:\/\/ prefix  (issue #2599)","424","                        Matcher m = Pattern.compile(\"(ldaps:\/\/)?([^:]+)(?:\\\\:(\\\\d+))?\").matcher(server.trim());","426","                            error(\"Syntax of this field is SERVER or SERVER:PORT or ldaps:\/\/SERVER[:PORT]\");","431","                            InetAddress adrs = InetAddress.getByName(m.group(2));","432","                            int port = m.group(1)!=null ? 636 : 389;","433","                            if(m.group(3)!=null)","434","                                port = Integer.parseInt(m.group(3));"],"delete":["423","                        Matcher m = Pattern.compile(\"([^:]+)(?:\\\\:(\\\\d+))?\").matcher(server.trim());","425","                            error(\"Syntax of this field is SERVER or SERVER:PORT\");","430","                            InetAddress adrs = InetAddress.getByName(m.group(1));","431","                            int port=389;","432","                            if(m.group(2)!=null)","433","                                port = Integer.parseInt(m.group(2));"]}],"war\/resources\/help\/security\/ldap\/server.html":[{"add":["1","    Specify the name of the LDAP server host name (like <tt>ldap.sun.com<\/tt>).","6","    the port is other than the default 636).","7","<\/div>"],"delete":["1","    Specify the name of the LDAP server host name (like <tt>ldap.sun.com<\/tt>)","6","    the port is other than the default 636)","7","<\/div>"]}]}},"989945f6336c0b61b70e26d0952a0ff50404774c":{"changes":{"core\/src\/main\/resources\/lib\/form\/textarea.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/textarea.jelly":[{"add":["100","    <j:if test=\"${customizedFields != null and attrs.field != null and value != default}\">","101","      <j:mute>${customizedFields.add(name)}<\/j:mute>","102","    <\/j:if>","103","    <!-- resize handle -->","104","    <div class=\"textarea-handle\"\/>"],"delete":["101","  <j:if test=\"${customizedFields != null and attrs.field != null and value != default}\">","102","    <j:mute>${customizedFields.add(name)}<\/j:mute>","103","  <\/j:if>","104","  <!-- resize handle -->","105","  <div class=\"textarea-handle\"\/>"]}]}},"5f83800963c4eb084f582f9bbd7b7defee168251":{"changes":{"core\/src\/main\/java\/jenkins\/security\/ResourceDomainConfiguration.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/security\/ResourceDomainConfiguration.java":[{"add":["35","import org.apache.commons.io.IOUtils;","51","import java.nio.charset.StandardCharsets;","172","                if (responseCode == 404) {","173","                    String responseBody = String.join(\"\", IOUtils.readLines(httpURLConnection.getErrorStream(), StandardCharsets.UTF_8));","174","                    if (responseMessage.contains(ERROR_RESPONSE) || responseBody.contains(ERROR_RESPONSE)) {","175","                        return FormValidation.ok(Messages.ResourceDomainConfiguration_ResourceResponse());","176","                    }"],"delete":["170","                if (responseCode == 404 && responseMessage.equals(ERROR_RESPONSE)) {","171","                    return FormValidation.ok(Messages.ResourceDomainConfiguration_ResourceResponse());"]}]}},"33e80ba12d68d89a672fa7c18659543e179bc597":{"changes":{"war\/images\/hourglass.svg":"ADD","war\/resources\/images\/16x16\/hourglass.gif":"ADD","war\/resources\/images\/24x24\/hourglass.gif":"ADD","core\/src\/main\/resources\/lib\/hudson\/queue.jelly":"MODIFY"},"diff":{"war\/images\/hourglass.svg":[{"add":[],"delete":[]}],"war\/resources\/images\/16x16\/hourglass.gif":[{"add":[],"delete":[]}],"war\/resources\/images\/24x24\/hourglass.gif":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/lib\/hudson\/queue.jelly":[{"add":["34","  <t:setIconSize\/>","63","                  <a href=\"${rootURL}\/${item.task.url}\">","66","                  <j:if test=\"${stuck}\">","67","                    <span title=\"${%Starving for a free executor. Time to add more slaves!}\">","68","                      &#160;<img src=\"${imagesURL}\/${subIconSize}\/hourglass.gif\" \/>","69","                    <\/span>","70","                  <\/j:if>","93","<\/j:jelly>"],"delete":["62","                  <a href=\"${rootURL}\/${item.task.url}\" style=\"${stuck?'color:#ef2929':null}\">","64","                    <j:if test=\"${stuck}\">(${%appears to be stuck})<\/j:if>","88","<\/j:jelly>"]}]}},"cd948cf64382a68f47d207062b62223cba9dbeb0":{"changes":{"test\/src\/test\/java\/org\/jvnet\/hudson\/main\/AppTest.java":"MODIFY"},"diff":{"test\/src\/test\/java\/org\/jvnet\/hudson\/main\/AppTest.java":[{"add":["5","import hudson.tasks.BatchFile;","27","        if(System.getProperty(\"os.name\").contains(\"Windows\")) {","28","            project.getBuildersList().add(new BatchFile(\"echo hello\"));","29","        } else {","30","            project.getBuildersList().add(new Shell(\"echo hello\"));","31","        }","37","        assertTrue(s,s.contains(\"echo hello\"));"],"delete":["26","        project.getBuildersList().add(new Shell(\"echo hello\"));","32","        assertTrue(s.contains(\"+ echo hello\"));"]}]}},"200a0beb74298444149b459de970b82043ec4998":{"changes":{"core\/src\/main\/java\/hudson\/model\/User.java":"MODIFY","core\/src\/test\/java\/hudson\/model\/UserTest.java":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/model\/User.java":[{"add":["90","import org.apache.commons.lang.StringUtils;","705","     * @param id ID to be checked","706","     * @return {@code true} if the username or fullname is valid.","707","     *      For {@code null} or blank IDs returns {@code false}.","710","    public static boolean isIdOrFullnameAllowed(@CheckForNull String id) {","711","        \/\/TODO: StringUtils.isBlank() checks the null falue, but FindBugs is not smart enough. Remove it later","712","        if (id == null || StringUtils.isBlank(id)) {","713","            return false;","714","        }"],"delete":["704","     * @return true if the username or fullname is valid","707","    public static boolean isIdOrFullnameAllowed(String id) {"]}],"core\/src\/test\/java\/hudson\/model\/UserTest.java":[{"add":[],"delete":[]}]}},"631a73400df2ee7e83e7b72aca8333409223de71":{"changes":{"pom.xml":"MODIFY"},"diff":{"pom.xml":[{"add":["182","        <version>2.61<\/version>"],"delete":["182","        <version>2.60<\/version>"]}]}},"bee66ede31d45b9d0814e4a45cbf2223585817e2":{"changes":{"core\/src\/main\/java\/hudson\/util\/FormValidation.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/FormValidation.java":[{"add":["640","            return Descriptor.getCurrentDescriptorByNameUrl() + '\/' + relativePath();"],"delete":["640","            return jsStringEscape(Descriptor.getCurrentDescriptorByNameUrl()) + '\/' + relativePath();"]}]}},"a035c8f8d38a16b54b8b9d29d6b5de205bb872f7":{"changes":{"core\/src\/main\/java\/hudson\/model\/listeners\/JobListener.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/listeners\/JobListener.java":[{"add":["53","            listener.onLoaded();"],"delete":[]}]}},"1a28a34187a119b73251880220c40129291536eb":{"changes":{"core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["208","                            g.requires(PLUGINS_PREPARED).add(\"Checking cyclic dependencies\",new Executable() {"],"delete":["208","                            g.requires(PLUGINS_LISTED).add(\"Checking cyclic dependencies\",new Executable() {"]}]}},"d7ae2279ad4200654b75a3ca8419a82b228ed1d4":{"changes":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Hudson.java":[{"add":["2095","        for (Action a : getExtensionList(RootAction.class))","2096","            if (!actions.contains(a)) actions.add(a);"],"delete":["2095","        actions.addAll(getExtensionList(RootAction.class));"]}]}},"6bf6e7f501ce2c27d99824936b92d3f9703856d6":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["72","  <li class=bug>","73","    Always use forward slashes in path separators during in ZIP archives generated by Directory Browser","74","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22514\">issue 22514<\/a>)  "],"delete":["72","  <li class=>","91","  <li class=bug>","92","    Always use forward slashes in path separators during in ZIP archives generated by Directory Browser","93","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-22514\">issue 22514<\/a>)  "]}]}},"d6f7c8f947a70a9486212110390490643367fc51":{"changes":{"war\/src\/launcher\/java\/Main.java":"MODIFY"},"diff":{"war\/src\/launcher\/java\/Main.java":[{"add":["0","import javax.naming.InitialContext;","1","import javax.naming.NamingException;","2","import javax.naming.Context;","65","            arguments.add(\"--webroot=\"+new File(getHomeDir(),\"war\"));","111","","112","    \/**","113","     * Determines the home directory for Hudson.","114","     *","115","     * People makes configuration mistakes, so we are trying to be nice","116","     * with those by doing {@link String#trim()}.","117","     *\/","118","    private static File getHomeDir() {","119","        \/\/ check JNDI for the home directory first","120","        try {","121","            InitialContext iniCtxt = new InitialContext();","122","            Context env = (Context) iniCtxt.lookup(\"java:comp\/env\");","123","            String value = (String) env.lookup(\"HUDSON_HOME\");","124","            if(value!=null && value.trim().length()>0)","125","                return new File(value.trim());","126","            \/\/ look at one more place. See issue #1314","127","            value = (String) iniCtxt.lookup(\"HUDSON_HOME\");","128","            if(value!=null && value.trim().length()>0)","129","                return new File(value.trim());","130","        } catch (NamingException e) {","131","            \/\/ ignore","132","        }","133","","134","        \/\/ finally check the system property","135","        String sysProp = System.getProperty(\"HUDSON_HOME\");","136","        if(sysProp!=null)","137","            return new File(sysProp.trim());","138","","139","        \/\/ look at the env var next","140","        try {","141","            String env = System.getenv(\"HUDSON_HOME\");","142","            if(env!=null)","143","            return new File(env.trim()).getAbsoluteFile();","144","        } catch (Throwable _) {","145","            \/\/ when this code runs on JDK1.4, this method fails","146","            \/\/ fall through to the next method","147","        }","148","","149","        \/\/ otherwise pick a place by ourselves","150","","151","\/* ServletContext not available yet","152","        String root = event.getServletContext().getRealPath(\"\/WEB-INF\/workspace\");","153","        if(root!=null) {","154","            File ws = new File(root.trim());","155","            if(ws.exists())","156","                \/\/ Hudson <1.42 used to prefer this before ~\/.hudson, so","157","                \/\/ check the existence and if it's there, use it.","158","                \/\/ otherwise if this is a new installation, prefer ~\/.hudson","159","                return ws;","160","        }","161","*\/","162","","163","        \/\/ if for some reason we can't put it within the webapp, use home directory.","164","        return new File(new File(System.getProperty(\"user.home\")),\".hudson\");","165","    }"],"delete":["62","            arguments.add(\"--webroot=\"+new File(System.getProperty(\"user.home\"),\".hudson\/war\"));"]}]}},"01b8e7e94e5cce53c409489ccc87d7c7a93a4bfa":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/SlaveComputer.java":[{"add":["391","     * Same as {@link #setChannel(InputStream, OutputStream, OutputStream, Channel.Listener)}, but for","392","     * {@link TaskListener}."],"delete":["391","     * @param in","392","     *      Stream connected to the remote agent. It's the caller's responsibility to do","393","     *      buffering on this stream, if that's necessary.","394","     * @param out","395","     *      Stream connected to the remote peer. It's the caller's responsibility to do","396","     *      buffering on this stream, if that's necessary.","397","     * @param taskListener","398","     *      Receives the portion of data in <tt>is<\/tt> before","399","     *      the data goes into the \"binary mode\". This is useful","400","     *      when the established communication channel might include some data that might","401","     *      be useful for debugging\/trouble-shooting.","402","     * @param listener","403","     *      Gets a notification when the channel closes, to perform clean up. Can be null.","404","     *      By the time this method is called, the cause of the termination is reported to the user,","405","     *      so the implementation of the listener doesn't need to do that again."]}]}},"9dd1e367682d8cb66bb9f44390d86cd065955a98":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["128","                <resolveArtifact groupId=\"org.jvnet.hudson.winstone\" artifactId=\"winstone\" version=\"0.9.10-hudson-22\" type=\"jar\" tofile=\"${basedir}\/target\/generated-resources\/winstone.jar\" \/>"],"delete":["128","                <resolveArtifact groupId=\"org.jvnet.hudson.winstone\" artifactId=\"winstone\" version=\"0.9.10-hudson-21\" type=\"jar\" tofile=\"${basedir}\/target\/generated-resources\/winstone.jar\" \/>"]}]}},"b23751b120867431e8dd1be1bad3f046876bcc1f":{"changes":{"core\/pom.xml":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["422","      <exclusions>","423","        <exclusion><!-- using a patched version -->","424","          <groupId>javax.activation<\/groupId>","425","          <artifactId>activation<\/artifactId>","426","        <\/exclusion>","427","      <\/exclusions>","430","      <groupId>org.jvnet.hudson<\/groupId>","432","      <version>1.1.1-hudson-1<\/version>"],"delete":["424","      <groupId>javax.activation<\/groupId>","426","      <version>1.1<\/version>"]}]}},"43a502d977acbfb338ed270539517dc2f4a5b907":{"changes":{"core\/src\/main\/java\/hudson\/model\/Slave.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Slave.java":[{"add":["105","","106","        if (numExecutors<=0)","107","            throw new FormException(\"Invalid slave configuration for \" + name + \". Invalid # of executors.\", null);"],"delete":[]}]}},"62f8d7c7f57b5bfe604cc0d96b60f1b62b284857":{"changes":{"core\/src\/main\/java\/hudson\/model\/LoadBalancer.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/LoadBalancer.java":[{"add":["66","                        if (isLargeHudson && offer.getNode() instanceof Hudson)"],"delete":["66","                        if (isLargeHudson && offer.getNode() instanceof Slave)"]}]}},"fd9896cff63456e70f000efb95e30d01780cd533":{"changes":{"core\/src\/main\/resources\/hudson\/diagnosis\/HudsonHomeDiskUsageMonitor\/message_fr.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/diagnosis\/HudsonHomeDiskUsageMonitor\/message_fr.properties":[{"add":["24","blurb=Votre r\\u00E9pertoire de donn\\u00E9es Jenkins \"{0}\" (c-\\u00E0-d <tt>JENKINS_HOME<\/tt>) est presque plein. Vous devriez agir avant qu''il soit compl\\u00E8tement rempli."],"delete":["24","blurb=Vour r\\u00E9pertoire de donn\\u00E9es Jenkins \"{0}\" (c-\\u00E0-d <tt>JENKINS_HOME<\/tt>) est presque plein. Vous devriez agir avant qu''il soit compl\\u00E8tement rempli."]}]}},"604f68a1f28a354ab1511f5198de953f47a62737":{"changes":{"core\/pom.xml":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/pom.xml":[{"add":["750","      <version>1.4<\/version>"],"delete":["750","      <version>1.2<\/version>"]}],"changelog.html":[{"add":["47","  <li class=bug>","48","    \"java -jar hudson.war --daemon\" was forcing umask 027. This includes Debian\/redhat packages.","49","    (<a href=\"http:\/\/issues.hudson-ci.org\/browse\/HUDSON-5114\">issue 5114<\/a>)"],"delete":[]}]}},"cb65e33c6bc464f94ba9219c1d201675e38f344d":{"changes":{"core\/src\/main\/java\/hudson\/util\/Secret.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/Secret.java":[{"add":["146","     * This method uses specific provider selected via hudson.util.Secret.provider system property","147","     * to provide a workaround for the above bug where default provide gives an unusable instance.","148","     * (Glassfish Enterprise users should set value of this property to \"SunJCE\")","151","        return PROVIDER != null ? Cipher.getInstance(algorithm, PROVIDER)","152","                                : Cipher.getInstance(algorithm);","201","     * Workaround for HUDSON-6459 \/ https:\/\/glassfish.dev.java.net\/issues\/show_bug.cgi?id=11862 .","202","     * @see #getCipher(String)","203","     *\/","204","    private static final String PROVIDER = System.getProperty(Secret.class.getName()+\".provider\");","205","","206","    \/**"],"delete":["146","     * Falls back to \"SunJCE\" provider if unable to get the Cipher from the default provider.","149","        try {","150","            return Cipher.getInstance(algorithm);","151","        } catch (Exception e) {","152","            return Cipher.getInstance(algorithm, \"SunJCE\");","153","        }"]}]}},"603b35ae9e79cd84e9f3aa930fecee78c49fdfe6":{"changes":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":"MODIFY","core\/src\/main\/resources\/hudson\/node_monitors\/MonitorMarkedNodeOffline\/message.properties":"ADD","test\/src\/test\/java\/hudson\/model\/ComputerSetTest.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/NodeMonitor.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/ComputerSet\/configure.jelly":"ADD","core\/src\/main\/java\/hudson\/node_monitors\/MonitorMarkedNodeOffline.java":"ADD","core\/src\/main\/resources\/hudson\/model\/ComputerSet\/sidepanel.jelly":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/ResponseTimeMonitor.java":"MODIFY","core\/src\/main\/java\/hudson\/node_monitors\/AbstractNodeMonitorDescriptor.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/ComputerSet.java":"MODIFY","core\/src\/main\/resources\/hudson\/node_monitors\/MonitorMarkedNodeOffline\/message.jelly":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/node_monitors\/DiskSpaceMonitorDescriptor.java":[{"add":["85","        if(size!=null && !size.moreThanGB() && markOffline(c))","86","            LOGGER.warning(Messages.DiskSpaceMonitor_MarkedOffline(c.getName()));"],"delete":["85","        if(size!=null && !size.moreThanGB()) {","86","            \/\/ TODO: this scheme should be generalized, so that Hudson can remember why it's marking the node","87","            \/\/ as offline, as well as allowing the user to force Hudson to use it.","88","            if(!c.isTemporarilyOffline()) {","89","                LOGGER.warning(Messages.DiskSpaceMonitor_MarkedOffline(c.getName()));","90","                c.setTemporarilyOffline(true);","91","            }","92","        }"]}],"core\/src\/main\/resources\/hudson\/node_monitors\/MonitorMarkedNodeOffline\/message.properties":[{"add":[],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/ComputerSetTest.java":[{"add":["27","import com.gargoylesoftware.htmlunit.html.HtmlForm;","39","","40","    \/**","41","     * Tests the basic UI behavior of the node monitoring","42","     *\/","43","    public void testConfiguration() throws Exception {","44","        HudsonTestCase.WebClient client = new WebClient();","45","        HtmlForm form = client.goTo(\"computer\/configure\").getFormByName(\"config\");","46","        submit(form);","47","    }"],"delete":[]}],"core\/src\/main\/java\/hudson\/node_monitors\/NodeMonitor.java":[{"add":["29","import hudson.tasks.Publisher;","42","import java.io.Serializable;","43","","57"," *","58"," * <dt>config.jelly (optional)<\/dt>","59"," * <dd>","60"," * Configuration fragment to be displayed in {@code http:\/\/server\/hudson\/computer\/configure}.","61"," * Used for configuring the threshold for taking nodes offline. ","64"," * <h2>Persistence<\/h2>","65"," * <p>","66"," * {@link NodeMonitor}s are persisted via XStream.","67"," *","73","    private volatile boolean ignored;","74","","117","     * True if this monitoring shouldn't mark the slaves offline.","118","     *","119","     * <p>","120","     * Many {@link NodeMonitor}s implement a logic that if the value goes above\/below","121","     * a threshold, the slave will be marked offline as a preventive measure.","122","     * This flag controls that.","123","     *","124","     * <p>","125","     * Unlike {@link Publisher}, where the absence of an instance indicates that it's disengaged,","126","     * in {@link NodeMonitor} this boolean flag is used to indicate the disengagement, so that","127","     * monitors work in opt-out basis.","128","     *\/","129","    public boolean isIgnored() {","130","        return ignored;","131","    }","132","","133","    public void setIgnored(boolean ignored) {","134","        this.ignored = ignored;","135","    }","136","","137","    \/**"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/ComputerSet\/configure.jelly":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/node_monitors\/MonitorMarkedNodeOffline.java":[{"add":[],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/ComputerSet\/sidepanel.jelly":[{"add":["33","      <l:task icon=\"images\/24x24\/setting.gif\" href=\"configure\" title=\"${%Configure}\" permission=\"${app.ADMINISTER}\" \/>"],"delete":[]}],"core\/src\/main\/java\/hudson\/node_monitors\/ResponseTimeMonitor.java":[{"add":["68","            if(d.hasTooManyTimeouts() && markOffline(c))","69","                LOGGER.warning(Messages.ResponseTimeMonitor_MarkedOffline(c.getName()));"],"delete":["68","            if(d.hasTooManyTimeouts()) {","69","                \/\/ TODO: this scheme should be generalized, so that Hudson can remember why it's marking the node","70","                \/\/ as offline, as well as allowing the user to force Hudson to use it.","71","                if(!c.isTemporarilyOffline()) {","72","                    LOGGER.warning(Messages.ResponseTimeMonitor_MarkedOffline(c.getName()));","73","                    c.setTemporarilyOffline(true);","74","                }","75","            }"]}],"core\/src\/main\/java\/hudson\/node_monitors\/AbstractNodeMonitorDescriptor.java":[{"add":["28","import hudson.model.ComputerSet;","29","import hudson.model.AdministrativeMonitor;","123","     * Is this monitor currently ignored?","124","     *\/","125","    public boolean isIgnored() {","126","        NodeMonitor m = ComputerSet.getMonitors().get(this);","127","        return m==null || m.isIgnored();","128","    }","129","","130","    \/**","131","     * Utility method to mark the computer offline for derived classes.","132","     *","133","     * @return true","134","     *      if the node was actually taken offline by this act (as opposed to us deciding not to do it,","135","     *      or the computer already marked offline.)","136","     *\/","137","    protected boolean markOffline(Computer c) {","138","        if(isIgnored() || c.isTemporarilyOffline()) return false; \/\/ noop","139","","140","        \/\/ TODO: define a mechanism to leave a note on this computer so that people know why we took it offline","141","        c.setTemporarilyOffline(true);","142","","143","        \/\/ notify the admin","144","        MonitorMarkedNodeOffline no = AdministrativeMonitor.all().get(MonitorMarkedNodeOffline.class);","145","        if(no!=null)","146","            no.active = true;","147","        return true;","148","    }","149","","150","    \/**"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/ComputerSet.java":[{"add":["25","import hudson.BulkChange;","26","import hudson.DescriptorExtensionList;","28","import hudson.XmlFile;","31","import hudson.slaves.NodeDescriptor;","32","import hudson.util.DescribableList;","42","import java.io.File;","47","import java.util.Map;","48","import java.util.HashMap;","49","import java.util.TreeMap;","50","import java.util.Comparator;","51","import java.util.logging.Level;","52","import java.util.logging.Logger;","63","    \/**","64","     * This is the owner that persists {@link #monitors}.","65","     *\/","66","    private static final Saveable MONITORS_OWNER = new Saveable() {","67","        public void save() throws IOException {","68","            getConfigFile().write(monitors);","69","        }","70","    };","71","","72","    private static final DescribableList<NodeMonitor,Descriptor<NodeMonitor>> monitors","73","            = new DescribableList<NodeMonitor, Descriptor<NodeMonitor>>(MONITORS_OWNER);","80","    \/**","81","     * @deprecated as of 1.301","82","     *      Use {@link #getMonitors()}.","83","     *\/","85","        return monitors.toList();","94","     * Exposing {@link NodeMonitor#all()} for Jelly binding.","95","     *\/","96","    public DescriptorExtensionList<NodeMonitor,Descriptor<NodeMonitor>> getNodeMonitorDescriptors() {","97","        return NodeMonitor.all();","98","    }","99","","100","    public static DescribableList<NodeMonitor,Descriptor<NodeMonitor>> getMonitors() {","101","        return monitors;","102","    }","103","","104","    \/**","105","     * Returns a subset pf {@link #getMonitors()} that are {@linkplain NodeMonitor#isIgnored() not ignored}.","106","     *\/","107","    public static Map<Descriptor<NodeMonitor>,NodeMonitor> getNonIgnoredMonitors() {","108","        Map<Descriptor<NodeMonitor>,NodeMonitor> r = new HashMap<Descriptor<NodeMonitor>, NodeMonitor>();","109","        for (NodeMonitor m : monitors) {","110","            if(!m.isIgnored())","111","                r.put(m.getDescriptor(),m);","112","        }","113","        return r;","114","    }","115","","116","    \/**","311","    \/**","312","     * Accepts submission from the configuration page.","313","     *\/","314","    public final synchronized void doConfigSubmit( StaplerRequest req, StaplerResponse rsp ) throws IOException, ServletException {","315","        BulkChange bc = new BulkChange(MONITORS_OWNER);","316","        try {","317","            Hudson.getInstance().checkPermission(Hudson.ADMINISTER);","318","            monitors.rebuild(req,req.getSubmittedForm(),getNodeMonitorDescriptors());","319","","320","            \/\/ add in the rest of instances are ignored instances","321","            for (Descriptor<NodeMonitor> d : NodeMonitor.all())","322","                if(monitors.get(d)==null) {","323","                    NodeMonitor i = createDefaultInstance(d, true);","324","                    if(i!=null)","325","                        monitors.add(i);","326","                }","327","            rsp.sendRedirect2(\".\");","328","        } catch (FormException e) {","329","            sendError(e,req,rsp);","330","        } finally {","331","            bc.commit();","332","        }","333","    }","334","","335","    \/**","336","     * {@link NodeMonitor}s are persisted in this file.","337","     *\/","338","    private static XmlFile getConfigFile() {","339","        return new XmlFile(new File(Hudson.getInstance().getRootDir(),\"nodeMonitors.xml\"));","340","    }","341","","351","    private static final Logger LOGGER = Logger.getLogger(ComputerSet.class.getName());","352","","354","        try {","355","            DescribableList<NodeMonitor,Descriptor<NodeMonitor>> r","356","                    = new DescribableList<NodeMonitor, Descriptor<NodeMonitor>>(Saveable.NOOP);","357","","358","            \/\/ load persisted monitors","359","            XmlFile xf = getConfigFile();","360","            if(xf.exists()) {","361","                DescribableList<NodeMonitor,Descriptor<NodeMonitor>> persisted =","362","                        (DescribableList<NodeMonitor,Descriptor<NodeMonitor>>) xf.read();","363","                r.replaceBy(persisted.toList());","365","","366","            \/\/ if we have any new monitors, let's add them","367","            for (Descriptor<NodeMonitor> d : NodeMonitor.all())","368","                if(r.get(d)==null) {","369","                    NodeMonitor i = createDefaultInstance(d,false);","370","                    if(i!=null)","371","                        r.add(i);","372","                }","373","            monitors.replaceBy(r.toList());","374","        } catch (IOException e) {","375","            LOGGER.log(Level.WARNING, \"Failed to instanciate NodeMonitors\",e);","376","        }","377","    }","378","","379","    private static NodeMonitor createDefaultInstance(Descriptor<NodeMonitor> d, boolean ignored) {","380","        try {","381","            NodeMonitor nm = d.clazz.newInstance();","382","            nm.setIgnored(ignored);","383","            return nm;","384","        } catch (InstantiationException e) {","385","            LOGGER.log(Level.SEVERE, \"Failed to instanciate \"+d.clazz,e);","386","        } catch (IllegalAccessException e) {","387","            LOGGER.log(Level.SEVERE, \"Failed to instanciate \"+d.clazz,e);","388","        }","389","        return null;"],"delete":["26","import hudson.slaves.NodeDescriptor;","41","import java.util.ArrayList;","53","    private static final List<NodeMonitor> monitors;","61","        return monitors;","274","        \/\/ create all instances","275","        ArrayList<NodeMonitor> r = new ArrayList<NodeMonitor>();","276","        for (Descriptor<NodeMonitor> d : NodeMonitor.all())","277","            try {","278","                r.add(d.newInstance(null,null));","279","            } catch (FormException e) {","280","                \/\/ so far impossible. TODO: report","282","        monitors = r;"]}],"core\/src\/main\/resources\/hudson\/node_monitors\/MonitorMarkedNodeOffline\/message.jelly":[{"add":[],"delete":[]}]}},"ec95aa5b21ab8d5bc0a74bf7553b57523e76766f":{"changes":{"core\/src\/main\/resources\/lib\/form\/checkbox.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/checkbox.jelly":[{"add":["46","    <st:attribute name=\"readonly\">","47","      If set to true, this will take precedence over the onclick attribute and prevent the state of the checkbox from being changed.","48","    <\/st:attribute>","68","         onclick=\"${attrs.readonly=='true' ? 'return false;' : attrs.onclick}\" id=\"${attrs.id}\" class=\"${attrs.negative!=null ? 'negative' : null} ${attrs.checkUrl!=null?'validated':''}\""],"delete":["65","         onclick=\"${attrs.onclick}\" id=\"${attrs.id}\" class=\"${attrs.negative!=null ? 'negative' : null} ${attrs.checkUrl!=null?'validated':''}\""]}]}},"208c7b613c9bc380e1e6f377be789e09f936bb84":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["59","  <li class=bug>","60","    Show an error message if no name is provided when creating a job (CLI)","61","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-6958\">issue 6958<\/a>)"],"delete":[]}]}},"00e8f77b564cfc9e0d29fc37daa37ec593228c0b":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/ArtifactArchiver.java":[{"add":["249","                if (result == null || result.isBetterOrEqualTo(Result.UNSTABLE)) {"],"delete":["249","                if (result != null && result.isBetterOrEqualTo(Result.UNSTABLE)) {"]}]}},"f4302f544d0fb0165cdd10da073d06678e66ebe3":{"changes":{"core\/src\/main\/resources\/lib\/form\/editableComboBox.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/editableComboBox.jelly":[{"add":["49","  <input id=\"${attrs.id}\" autocomplete=\"off\" class=\"${attrs.clazz} ${attrs.checkUrl!=null ? 'validated' : ''}\"","52","         checkUrl=\"${attrs.checkUrl}\" \/>"],"delete":["49","  <input id=\"${attrs.id}\" autocomplete=\"off\" class=\"${attrs.clazz} ${checkUrl!=null ? 'validated' : ''}\"","52","         checkUrl=\"${checkUrl}\" \/>"]}]}},"73aac1073983e1f667d801387571d31857253ffc":{"changes":{"core\/src\/main\/java\/hudson\/model\/View.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/View\/sidepanel.jelly":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/View.java":[{"add":["631","     * @deprecated Potentially very expensive call; do not use from Jelly views.","713","        \/**","714","         * @deprecated Potentially very expensive call; do not use from Jelly views.","715","         *\/","793","                            \/\/ XXX consider also adding the user of the UserCause when applicable"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/View\/sidepanel.jelly":[{"add":["49","        <j:otherwise>","51","        <\/j:otherwise>"],"delete":["49","        <j:when test=\"${it.isDefault() or it.hasPeople()}\">","51","        <\/j:when>"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Slow rendering of view pages in large installations due to eager check whether the \u201CPeople\u201D link would show anything.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-16244\">issue 16244<\/a>)"],"delete":["57","  <li class=>"]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["983","     * @deprecated Potentially very expensive call; do not use from Jelly views."],"delete":[]}]}},"75e19dd26c2377af98ebfe6606e489f19158156e":{"changes":{"core\/src\/main\/resources\/hudson\/tasks\/junit\/CaseResult\/index.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/tasks\/junit\/CaseResult\/index.jelly":[{"add":["69","      <j:if test=\"${!empty(it.errorDetails)}\">","71","      <pre>${it.annotate(it.errorDetails)}<\/pre>","72","      <\/j:if>","73","","74","      <j:if test=\"${!empty(it.errorStackTrace)}\">","77","      <\/j:if>"],"delete":["70","      <pre>\"${it.annotate(it.errorDetails)}\"<\/pre>"]}]}},"10643f9cf61e2eee1a7bf8b3394b3f6cb175450a":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenFingerprinter.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/reporters\/MavenFingerprinter.java":[{"add":["182","            if (projectBuilderConfiguration == null) {","183","                return null;","184","            }"],"delete":[]}],"changelog.html":[{"add":["60","  <li class=bug>","61","    NPE in MavenFingerprinter.getArtifactRepositoryMaven21.","62","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18441\">issue 18441<\/a>)"],"delete":[]}]}},"20391abe462119973206ee96469724801a524e16":{"changes":{"test\/src\/test\/java\/hudson\/model\/ParametersTest.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/PasswordParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/BooleanParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/ChoiceParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/FileParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/RunParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/TextParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/StringParameterDefinition\/index.jelly":"MODIFY","core\/src\/main\/java\/hudson\/model\/ParameterDefinition.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/ParametersTest.java":[{"add":["91","        assertEquals(\"choice description\", ((HtmlElement) element.getNextSibling().getNextSibling().selectSingleNode(\"td[@class='setting-description']\")).getTextContent());"],"delete":["91","        assertEquals(\"choice description\", ((HtmlElement) element.selectSingleNode(\"td\/div\")).getAttribute(\"description\"));"]}],"core\/src\/main\/resources\/hudson\/model\/PasswordParameterDefinition\/index.jelly":[{"add":["28","\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">","29","\t\t<div name=\"parameter\">"],"delete":["28","\t<f:entry title=\"${it.name}\" description=\"${it.description}\">","29","\t\t<div name=\"parameter\" description=\"${it.description}\">"]}],"core\/src\/main\/resources\/hudson\/model\/BooleanParameterDefinition\/index.jelly":[{"add":["28","\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">","29","\t\t<div name=\"parameter\">"],"delete":["28","\t<f:entry title=\"${it.name}\" description=\"${it.description}\">","29","\t\t<div name=\"parameter\" description=\"${it.description}\">"]}],"core\/src\/main\/resources\/hudson\/model\/ChoiceParameterDefinition\/index.jelly":[{"add":["28","\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">","29","\t\t<div name=\"parameter\">"],"delete":["28","\t<f:entry title=\"${it.name}\" description=\"${it.description}\">","29","\t\t<div name=\"parameter\" description=\"${it.description}\">"]}],"core\/src\/main\/resources\/hudson\/model\/FileParameterDefinition\/index.jelly":[{"add":["28","\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">"],"delete":["28","\t<f:entry title=\"${it.name}\" description=\"${it.description}\">"]}],"core\/src\/main\/resources\/hudson\/model\/RunParameterDefinition\/index.jelly":[{"add":["28","\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">","29","\t\t<div name=\"parameter\">"],"delete":["28","\t<f:entry title=\"${it.name}\" description=\"${it.description}\">","29","\t\t<div name=\"parameter\" description=\"${it.description}\">"]}],"core\/src\/main\/resources\/hudson\/model\/TextParameterDefinition\/index.jelly":[{"add":["26","  <f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">","27","    <div name=\"parameter\">"],"delete":["26","  <f:entry title=\"${it.name}\" description=\"${it.description}\">","27","    <div name=\"parameter\" description=\"${it.description}\">"]}],"core\/src\/main\/resources\/hudson\/model\/StringParameterDefinition\/index.jelly":[{"add":["28","\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">"],"delete":["28","\t<f:entry title=\"${it.name}\" description=\"${it.safeDescription}\">"]}],"core\/src\/main\/java\/hudson\/model\/ParameterDefinition.java":[{"add":["34","import java.util.logging.Logger;","140","    \/**","141","     * return parameter description, applying the configured MarkupFormatter for jenkins instance.","142","     * @since 1.521","143","     *\/","144","    public String getFormattedDescription() {","148","            LOGGER.warning(\"failed to translate description using configured markup formatter\");","149","            return \"\";","257","","258","    private static final Logger LOGGER = Logger.getLogger(ParameterDefinition.class.getName());"],"delete":["139","    public String getSafeDescription() {","143","            return \"failed to translate description using configured markup formatter\";"]}]}},"99ec6b1d32dfb1443dc1bafd04e4ed507e8be38d":{"changes":{"core\/src\/main\/resources\/hudson\/triggers\/SlowTriggerAdminMonitor\/message.groovy":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/triggers\/SlowTriggerAdminMonitor\/message.groovy":[{"add":["27","            tam.errors.each { trigger, val ->"],"delete":["27","            tam.errors.each { String trigger, SlowTriggerAdminMonitor.Value val ->"]}]}},"a43c011a8c154bd978aea0fa223297e22f4259de":{"changes":{"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/CVSSCM.java":[{"add":["224","        if(!isUpdatable(dir)) {","225","            listener.getLogger().println(\"Workspace is inconsistent with configuration. Scheduling a new build\");","226","            return true;","227","        }","228",""],"delete":[]}]}},"6b8af39b0317bad90851d4f8025fd71fadb9deaa":{"changes":{"core\/src\/main\/java\/hudson\/model\/LoadStatistics.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/OverallLoadStatistics.java":"MODIFY","core\/src\/main\/java\/hudson\/slaves\/NodeProvisioner.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","core\/src\/main\/java\/jenkins\/model\/UnlabeledLoadStatistics.java":"MODIFY","core\/src\/test\/java\/hudson\/model\/LoadStatisticsTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Label.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/LoadStatistics.java":[{"add":["26","import hudson.Util;","50","import java.io.Serializable;","71","     * {@code true} if and only if the new way of building statistics has been implemented by this class.","72","     * @since 1.FIXME","73","     *\/","74","    private final boolean modern;","75","","76","    \/**","77","     * Number of executors defined for Jenkins and how it changes over time.","78","     * @since 1.FIXME","79","     *\/","80","    @Exported","81","    public final MultiStageTimeSeries definedExecutors;","82","","83","    \/**","84","     * Number of executors on-line and how it changes over time. Replaces {@link #totalExecutors}","85","     * @since 1.FIXME","86","     *\/","87","    @Exported","88","    public final MultiStageTimeSeries onlineExecutors;","89","","90","    \/**","91","     * Number of executors in the process of coming on-line and how it changes over time.","92","     * @since 1.FIXME","93","     *\/","94","    @Exported","95","    public final MultiStageTimeSeries connectingExecutors;","96","","97","    \/**","104","     * Number of executors not executing and how it changes over time. Note the these executors may not be able to","105","     * take work, see {@link #availableExecutors}.","106","     * @since 1.FIXME","109","    public final MultiStageTimeSeries idleExecutors;","110","","111","    \/**","112","     * Number of executors not executing and available to take work and how it changes over time.","113","     * @since 1.FIXME","114","     *\/","115","    @Exported","116","    public final MultiStageTimeSeries availableExecutors;","117","","118","    \/**","119","     * Number of total executors and how it changes over time.","120","     * @deprecated use {@link #onlineExecutors}. Note {@code totalExecutors==onlineExecutors} for backward","121","     * compatibility support.","122","     *\/","123","    @Exported","124","    @Deprecated","133","","134","    protected LoadStatistics(int initialOnlineExecutors, int initialBusyExecutors) {","135","        this.definedExecutors = new MultiStageTimeSeries(Messages._LoadStatistics_Legends_DefinedExecutors(),","136","                ColorPalette.YELLOW, initialOnlineExecutors, DECAY);","137","        this.onlineExecutors = new MultiStageTimeSeries(","138","                Messages._LoadStatistics_Legends_OnlineExecutors(), ColorPalette.BLUE, initialOnlineExecutors,DECAY);","139","        this.connectingExecutors = new MultiStageTimeSeries(Messages._LoadStatistics_Legends_ConnectingExecutors(),","140","                ColorPalette.YELLOW, 0, DECAY);","143","        this.idleExecutors = new MultiStageTimeSeries(Messages._LoadStatistics_Legends_IdleExecutors(),","144","                ColorPalette.YELLOW, initialOnlineExecutors - initialBusyExecutors, DECAY);","145","        this.availableExecutors = new MultiStageTimeSeries(Messages._LoadStatistics_Legends_AvailableExecutors(),","146","                ColorPalette.YELLOW, initialOnlineExecutors - initialBusyExecutors, DECAY);","149","        this.totalExecutors = onlineExecutors;","150","        modern = Util.isOverridden(LoadStatistics.class, getClass(), \"getNodes\")","151","                && Util.isOverridden(LoadStatistics.class, getClass(), \"matches\", SubTask.class);","154","    \/**","155","     * @deprecated use {@link #idleExecutors} directly.","156","     *\/","157","    @Deprecated","159","        return idleExecutors.pick(timeScale).getLatest();","164","     * @deprecated use {@link #computeSnapshot()} and then {@link LoadStatisticsSnapshot#getIdleExecutors()}","166","    @Deprecated","171","     * @deprecated use {@link #computeSnapshot()} and then {@link LoadStatisticsSnapshot#getOnlineExecutors()}","173","    @Deprecated","178","     * @deprecated use {@link #computeSnapshot()} and then {@link LoadStatisticsSnapshot#getQueueLength()}","180","    @Deprecated","226","        renderer.setSeriesPaint(0, ColorPalette.BLUE);  \/\/ online","229","        renderer.setSeriesPaint(3, ColorPalette.YELLOW);\/\/ available","237","        return MultiStageTimeSeries.createTrendChart(timeScale,onlineExecutors,busyExecutors,queueLength,availableExecutors);","252","     * @deprecated use {@link #updateCounts(LoadStatisticsSnapshot)}","254","    @Deprecated","256","        updateCounts(computeSnapshot());","257","    }","258","","259","    \/**","260","     * Updates all the series from the current snapshot.","261","     * @param current the current snapshot.","262","     * @since 1.FIXME","263","     *\/","264","    protected void updateCounts(LoadStatisticsSnapshot current) {","265","        definedExecutors.update(current.getDefinedExecutors());","266","        onlineExecutors.update(current.getOnlineExecutors());","267","        connectingExecutors.update(current.getConnectingExecutors());","268","        busyExecutors.update(current.getBusyExecutors());","269","        idleExecutors.update(current.getIdleExecutors());","270","        availableExecutors.update(current.getAvailableExecutors());","271","        queueLength.update(current.getQueueLength());","272","    }","273","","274","    \/**","275","     * Returns the {@link Node} instances that this statistic counts.","276","     * @return the {@link Node}","277","     * @since 1.FIXME","278","     *\/","279","    protected abstract Iterable<Node> getNodes();","280","","281","    \/**","282","     * Returns {@code true} is the specified {@link SubTask} from the {@link Queue} should be counted.","283","     * @param item the {@link SubTask}","284","     * @return {@code true} IFF the specified {@link SubTask} from the {@link Queue} should be counted.","285","     * @since 1.FIXME","286","     *\/","287","    protected abstract boolean matches(SubTask item);","288","","289","    \/**","290","     * Computes a self-consistent snapshot of the load statistics.","291","     *","292","     * Note: The original method of computing load statistics would compute the total and idle counts independently","293","     * which could lead to counting errors while jobs started in between the different state counting operations.","294","     * By returning a {@link LoadStatisticsSnapshot} we get a single consistent view of the counts which was valid","295","     * for at least one point in time during the execution of this method.","296","     *","297","     * @return a self-consistent snapshot of the load statistics.","298","     * @since 1.FIXME","299","     *\/","300","    public LoadStatisticsSnapshot computeSnapshot() {","301","        if (modern) {","302","            return computeSnapshot(Jenkins.getInstance().getQueue().getBuildableItems());","303","        } else {","304","            int t = computeTotalExecutors();","305","            int i = computeIdleExecutors();","306","            return new LoadStatisticsSnapshot(t, t, Math.max(i-t,0), Math.max(t-i,0), i, i, computeQueueLength());","307","        }","308","    }","309","","310","    \/**","311","     * Computes the self-consistent snapshot with the specified queue items.","312","","313","     * @param queue the queue items.","314","     * @return a self-consistent snapshot of the load statistics.","315","     * @since 1.FIXME","316","     *\/","317","    protected LoadStatisticsSnapshot computeSnapshot(Iterable<Queue.BuildableItem> queue) {","318","        final LoadStatisticsSnapshot.Builder builder = LoadStatisticsSnapshot.builder();","319","        final Iterable<Node> nodes = getNodes();","320","        if (nodes != null) {","321","            for (Node node : nodes) {","322","                builder.with(node);","323","            }","324","        }","325","        int q = 0;","326","        if (queue != null) {","327","            for (Queue.BuildableItem item : queue) {","328","                for (SubTask st : item.task.getSubTasks()) {","329","                    if (matches(st))","330","                        q++;","331","                }","332","            }","333","        }","334","        return builder.withQueueLength(q).build();","344","    public static int CLOCK = Integer.getInteger(LoadStatistics.class.getName() + \".clock\", 10 * 1000);","361","                l.loadStatistics.updateCounts(l.loadStatistics.computeSnapshot(bis));","365","            j.unlabeledLoad.updateCounts(j.unlabeledLoad.computeSnapshot(bis));","367","            j.overallLoad.updateCounts(j.overallLoad.computeSnapshot(bis));","380","","381","    \/**","382","     * Holds a snapshot of the current statistics.","383","     * @since 1.FIXME","384","     *\/","385","    @ExportedBean","386","    public static class LoadStatisticsSnapshot implements Serializable {","387","        private static final long serialVersionUID = 1L;","388","","389","        \/**","390","         * The total number of executors that Jenkins currently knows, this includes all off-line slaves.","391","         *\/","392","        private final int definedExecutors;","393","        \/**","394","         * The total number of executors that are currently on-line.","395","         *\/","396","        private final int onlineExecutors;","397","        \/**","398","         * The total number of executors that are currently in the process of connecting to Jenkins.","399","         *\/","400","        private final int connectingExecutors;","401","        \/**","402","         * The total number of executors that are currently busy running jobs.","403","         *\/","404","        private final int busyExecutors;","405","        \/**","406","         * The total number of executors that are currently on-line and idle. This includes executors that are","407","         * not accepting tasks.","408","         *\/","409","        private final int idleExecutors;","410","        \/**","411","         * The total number of executors that are currently on-line, idle and accepting tasks.","412","         *\/","413","        private final int availableExecutors;","414","        \/**","415","         * The number of items in the queue.","416","         *\/","417","        private final int queueLength;","418","","419","        private LoadStatisticsSnapshot(","420","                int definedExecutors, int onlineExecutors, int connectingExecutors,","421","                int busyExecutors, int idleExecutors, int availableExecutors,","422","                int queueLength) {","423","            this.definedExecutors = definedExecutors;","424","            this.onlineExecutors = onlineExecutors;","425","            this.connectingExecutors = connectingExecutors;","426","            \/\/ assert definedExecutors == onlineExecutors + connectingExecutors;","427","            this.busyExecutors = busyExecutors;","428","            this.idleExecutors = idleExecutors;","429","            \/\/ assert onlineExecutors == busyExecutors + idleExecutors;","430","            this.availableExecutors = availableExecutors;","431","            \/\/ assert availableExecutors <= idleExecutors;","432","            this.queueLength = queueLength;","433","        }","434","","435","        \/**","436","          * The total number of executors that Jenkins currently knows, this includes all off-line slaves.","437","          *\/","438","        @Exported","439","        public int getDefinedExecutors() {","440","            return definedExecutors;","441","        }","442","","443","        \/**","444","         * The total number of executors that are currently on-line.","445","         *\/","446","        @Exported","447","        public int getOnlineExecutors() {","448","            return onlineExecutors;","449","        }","450","","451","        \/**","452","         * The total number of executors that are currently in the process of connecting to Jenkins.","453","         *\/","454","        @Exported","455","        public int getConnectingExecutors() {","456","            return connectingExecutors;","457","        }","458","","459","        \/**","460","         * The total number of executors that are currently busy running jobs.","461","         *\/","462","        @Exported","463","        public int getBusyExecutors() {","464","            return busyExecutors;","465","        }","466","","467","        \/**","468","         * The total number of executors that are currently on-line and idle. This includes executors that are","469","         * not accepting tasks.","470","         *\/","471","        @Exported","472","        public int getIdleExecutors() {","473","            return idleExecutors;","474","        }","475","","476","        \/**","477","         * The total number of executors that are currently on-line, idle and accepting tasks.","478","         *\/","479","        @Exported","480","        public int getAvailableExecutors() {","481","            return availableExecutors;","482","        }","483","","484","        \/**","485","         * The number of items in the queue.","486","         *\/","487","        @Exported","488","        public int getQueueLength() {","489","            return queueLength;","490","        }","491","","492","        \/** {@inheritDoc} *\/","493","        @Override","494","        public boolean equals(Object o) {","495","            if (this == o) {","496","                return true;","497","            }","498","            if (o == null || getClass() != o.getClass()) {","499","                return false;","500","            }","501","","502","            LoadStatisticsSnapshot that = (LoadStatisticsSnapshot) o;","503","","504","            if (availableExecutors != that.availableExecutors) {","505","                return false;","506","            }","507","            if (busyExecutors != that.busyExecutors) {","508","                return false;","509","            }","510","            if (connectingExecutors != that.connectingExecutors) {","511","                return false;","512","            }","513","            if (definedExecutors != that.definedExecutors) {","514","                return false;","515","            }","516","            if (idleExecutors != that.idleExecutors) {","517","                return false;","518","            }","519","            if (onlineExecutors != that.onlineExecutors) {","520","                return false;","521","            }","522","            if (queueLength != that.queueLength) {","523","                return false;","524","            }","525","","526","            return true;","527","        }","528","","529","        \/** {@inheritDoc} *\/","530","        @Override","531","        public int hashCode() {","532","            int result = definedExecutors;","533","            result = 31 * result + onlineExecutors;","534","            result = 31 * result + connectingExecutors;","535","            result = 31 * result + busyExecutors;","536","            result = 31 * result + idleExecutors;","537","            result = 31 * result + availableExecutors;","538","            result = 31 * result + queueLength;","539","            return result;","540","        }","541","","542","        \/** {@inheritDoc} *\/","543","        @Override","544","        public String toString() {","545","            final StringBuilder sb = new StringBuilder(\"LoadStatisticsSnapshot{\");","546","            sb.append(\"definedExecutors=\").append(definedExecutors);","547","            sb.append(\", onlineExecutors=\").append(onlineExecutors);","548","            sb.append(\", connectingExecutors=\").append(connectingExecutors);","549","            sb.append(\", busyExecutors=\").append(busyExecutors);","550","            sb.append(\", idleExecutors=\").append(idleExecutors);","551","            sb.append(\", availableExecutors=\").append(availableExecutors);","552","            sb.append(\", queueLength=\").append(queueLength);","553","            sb.append('}');","554","            return sb.toString();","555","        }","556","","557","        \/**","558","         * Use a builder so we can add more stats if needed.","559","         * Not thread safe","560","         * @since 1.FIXME","561","         *\/","562","        public static class Builder {","563","            private int definedExecutors;","564","            private int onlineExecutors;","565","            private int connectingExecutors;","566","            private int busyExecutors;","567","            private int idleExecutors;","568","            private int availableExecutors;","569","            private int queueLength;","570","","571","            public LoadStatisticsSnapshot build() {","572","                return new LoadStatisticsSnapshot(","573","                        definedExecutors, onlineExecutors, connectingExecutors,","574","                        busyExecutors, idleExecutors, availableExecutors,","575","                        queueLength","576","                );","577","            }","578","","579","            public Builder withQueueLength(int queueLength) {","580","                this.queueLength = queueLength;","581","                return this;","582","            }","583","","584","            public Builder with(Node node) {","585","                if (node != null)","586","                return with(node.toComputer());","587","                return this;","588","            }","589","","590","            public Builder with(Computer computer) {","591","                if (computer.isOnline()) {","592","                    final List<Executor> executors = computer.getExecutors();","593","                    final boolean acceptingTasks = computer.isAcceptingTasks();","594","                    for (Executor e : executors) {","595","                        definedExecutors++;","596","                        onlineExecutors++;","597","                        if (e.getCurrentWorkUnit() != null) {","598","                            busyExecutors++;","599","                        } else {","600","                            idleExecutors++;","601","                            if (acceptingTasks) availableExecutors++;","602","                        }","603","                    }","604","                } else {","605","                    final int numExecutors = computer.getNumExecutors();","606","                    definedExecutors += numExecutors;","607","                    if (computer.isConnecting()) {","608","                        connectingExecutors += numExecutors;","609","                    }","610","                }","611","                return this;","612","            }","613","","614","        }","615","","616","        public static Builder builder() {","617","            return new Builder();","618","        }","619","    }","620",""],"delete":["75","     * Number of total executors and how it changes over time.","86","    protected LoadStatistics(int initialTotalExecutors, int initialBusyExecutors) {","87","        this.totalExecutors = new MultiStageTimeSeries(","88","                Messages._LoadStatistics_Legends_TotalExecutors(), ColorPalette.BLUE, initialTotalExecutors,DECAY);","96","        return totalExecutors.pick(timeScale).getLatest() - busyExecutors.pick(timeScale).getLatest();","157","        renderer.setSeriesPaint(0, ColorPalette.BLUE);  \/\/ total","167","        return MultiStageTimeSeries.createTrendChart(timeScale,totalExecutors,busyExecutors,queueLength);","182","     * Updates {@link #totalExecutors} and {@link #busyExecutors} by using","183","     * the current snapshot value.","184","     *","185","     * {@link #queueLength} is updated separately via {@link LoadStatisticsUpdater} to","186","     * improve the efficiency because we are counting this for all {@link LoadStatistics} at once.","189","        int t = computeTotalExecutors();","190","        int i = computeIdleExecutors();","191","        totalExecutors.update(t);","192","        busyExecutors.update(t-i);","202","    public static int CLOCK = Integer.getInteger(LoadStatistics.class.getName()+\".clock\",10*1000);","219","                l.loadStatistics.updateExecutorCounts();","220","                l.loadStatistics.queueLength.update(count(bis, l));","224","            j.unlabeledLoad.updateExecutorCounts();","225","            j.unlabeledLoad.queueLength.update(count(bis, null));","227","            j.overallLoad.updateExecutorCounts();","228","            j.overallLoad.queueLength.update(bis.size());"]}],"core\/src\/main\/java\/hudson\/model\/OverallLoadStatistics.java":[{"add":["27","import hudson.model.queue.SubTask;","71","    @Override","72","    protected Iterable<Node> getNodes() {","73","        return Jenkins.getActiveInstance().getNodes();","74","    }","75","","76","    @Override","77","    protected boolean matches(SubTask item) {","78","        return true;","79","    }","80","","86","        return MultiStageTimeSeries.createTrendChart(timeScale,busyExecutors,onlineExecutors,queueLength,availableExecutors);"],"delete":["75","        return MultiStageTimeSeries.createTrendChart(timeScale,busyExecutors,totalExecutors,queueLength);"]}],"core\/src\/main\/java\/hudson\/slaves\/NodeProvisioner.java":[{"add":["227","        final LoadStatistics.LoadStatisticsSnapshot snapshot = stat.computeSnapshot();","229","        int availableSnapshot = snapshot.getAvailableExecutors();","230","        int queueLengthSnapshot = snapshot.getQueueLength();","231","","232","        if (queueLengthSnapshot <= availableSnapshot) {","234","                    \"Queue length {0} is less than the available capacity {1}. No provisioning strategy required\",","235","                    new Object[]{queueLengthSnapshot, availableSnapshot});","237","            StrategyState state = new StrategyState(snapshot, label, plannedCapacitySnapshot);","310","         * The current statistics snapshot for this {@link #label}.","312","        private final LoadStatistics.LoadStatisticsSnapshot snapshot;","326","        private StrategyState(LoadStatistics.LoadStatisticsSnapshot snapshot, Label label, int plannedCapacitySnapshot) {","327","            this.snapshot = snapshot;","341","         * The current snapshot of the load statistics for this {@link #getLabel()}.","342","         * @since 1.FIXME","343","         *\/","344","        public LoadStatistics.LoadStatisticsSnapshot getSnapshot() {","345","            return snapshot;","346","        }","347","","348","        \/**","350","         * @deprecated use {@link #getSnapshot()}, {@link LoadStatistics.LoadStatisticsSnapshot#getQueueLength()}","353","            return snapshot.getQueueLength();","365","         * @deprecated use {@link #getSnapshot()}, {@link LoadStatistics.LoadStatisticsSnapshot#getAvailableExecutors()}","368","            return snapshot.getAvailableExecutors();","373","         * @deprecated use {@link #getSnapshot()}, {@link LoadStatistics.LoadStatisticsSnapshot#getOnlineExecutors()}","376","            return snapshot.getOnlineExecutors();","403","         * @deprecated use {@link #getAvailableExecutorsLatest()}","406","            return getAvailableExecutorsLatest();","411","         * @deprecated use {@link #getOnlineExecutorsLatest()}","414","            return getOnlineExecutorsLatest();","415","        }","416","","417","        \/**","418","         * The time series average number of defined executors for this {@link #getLabel()}","419","         * @since 1.FIXME","420","         *\/","421","        public float getDefinedExecutorsLatest() {","422","            return stat.definedExecutors.getLatest(TIME_SCALE);","423","        }","424","","425","        \/**","426","         * The time series average number of online executors for this {@link #getLabel()}","427","         * @since 1.FIXME","428","         *\/","429","        public float getOnlineExecutorsLatest() {","430","            return stat.onlineExecutors.getLatest(TIME_SCALE);","431","        }","432","","433","        \/**","434","         * The time series average number of connecting executors for this {@link #getLabel()}","435","         * @since 1.FIXME","436","         *\/","437","        public float getConnectingExecutorsLatest() {","438","            return stat.connectingExecutors.getLatest(TIME_SCALE);","439","        }","440","","441","        \/**","442","         * The time series average number of busy executors for this {@link #getLabel()}","443","         * @since 1.FIXME","444","         *\/","445","        public float getBusyExecutorsLatest() {","446","            return stat.busyExecutors.getLatest(TIME_SCALE);","447","        }","448","","449","        \/**","450","         * The time series average number of idle executors for this {@link #getLabel()}","451","         * @since 1.FIXME","452","         *\/","453","        public float getIdleExecutorsLatest() {","454","            return stat.idleExecutors.getLatest(TIME_SCALE);","455","        }","456","","457","        \/**","458","         * The time series average number of available executors for this {@link #getLabel()}","459","         * @since 1.FIXME","460","         *\/","461","        public float getAvailableExecutorsLatest() {","462","            return stat.availableExecutors.getLatest(TIME_SCALE);","517","            sb.append(\", snapshot=\").append(snapshot);","569","            final LoadStatistics.LoadStatisticsSnapshot snapshot = state.getSnapshot();","570","            boolean needSomeWhenNoneAtAll = (snapshot.getAvailableExecutors() + snapshot.getConnectingExecutors() == 0)","571","                    && (snapshot.getOnlineExecutors() + state.getPlannedCapacitySnapshot() + state.getAdditionalPlannedCapacity() == 0)","572","                    && (snapshot.getQueueLength() > 0);","573","            float available = Math.max(snapshot.getAvailableExecutors(), state.getAvailableExecutorsLatest());","574","            if (available < MARGIN || needSomeWhenNoneAtAll) {","578","                float qlen = Math.min(state.getQueueLengthLatest(), snapshot.getQueueLength());","579","","580","                float connectingCapacity = Math.min(state.getConnectingExecutorsLatest(), snapshot.getConnectingExecutors());","586","                float excessWorkload = qlen - plannedCapacity - connectingCapacity;","595","                                    + \"(planned capacity={1,number,#.###},connecting capacity={7,number,#.###},\"","596","                                    + \"Qlen={2,number,#.###},available={3,number,#.###}&{4,number,integer},\"","597","                                    + \"online={5,number,integer},m={6,number,#.###})\",","599","                                    excessWorkload, plannedCapacity, qlen, available, snapshot.getAvailableExecutors(),","600","                                    snapshot.getOnlineExecutors(), m , snapshot.getConnectingExecutors()"],"delete":["227","        int idleSnapshot = stat.computeIdleExecutors();","228","        int queueLengthSnapshot = stat.computeQueueLength();","230","        if (queueLengthSnapshot <= idleSnapshot) {","232","                    \"Queue length {0} is less than the idle capacity {1}. No provisioning strategy required\",","233","                    new Object[]{queueLengthSnapshot, idleSnapshot});","235","            StrategyState state =","236","                    new StrategyState(queueLengthSnapshot, label, idleSnapshot, stat.computeTotalExecutors(),","237","                            plannedCapacitySnapshot);","306","         * The number of items in the queue requiring this {@link #label}.","307","         *\/","308","        private final int queueLengthSnapshot;","309","        \/**","314","         * The number of idle executors for this {@link #label}","316","        private final int idleSnapshot;","317","        \/**","318","         * The total number of executors for this {@link #label}","319","         *\/","320","        private final int totalSnapshot;","331","         * @param queueLengthSnapshot the queue length.","333","         * @param idleSnapshot the idle executor count.","334","         * @param totalSnapshot the totoal executor count.","337","        private StrategyState(int queueLengthSnapshot, Label label, int idleSnapshot, int totalSnapshot,","338","                              int plannedCapacitySnapshot) {","339","            this.queueLengthSnapshot = queueLengthSnapshot;","341","            this.idleSnapshot = idleSnapshot;","342","            this.totalSnapshot = totalSnapshot;","358","            return queueLengthSnapshot;","372","            return idleSnapshot;","379","            return totalSnapshot;","408","            return stat.getLatestIdleExecutors(TIME_SCALE);","415","            return stat.totalExecutors.getLatest(TIME_SCALE);","470","            sb.append(\", queueLengthSnapshot=\").append(queueLengthSnapshot);","472","            sb.append(\", idleSnapshot=\").append(idleSnapshot);","473","            sb.append(\", totalSnapshot=\").append(totalSnapshot);","524","            boolean needSomeWhenNoneAtAll = (state.getIdleSnapshot() == 0)","525","                    && (state.getTotalSnapshot() + state.getPlannedCapacitySnapshot() + state.getAdditionalPlannedCapacity() == 0)","526","                    && (state.getQueueLengthSnapshot() > 0);","527","            float idle = Math.max(state.getIdleLatest(), state.getIdleSnapshot());","528","            if (idle < MARGIN || needSomeWhenNoneAtAll) {","532","                float qlen = Math.min(state.getQueueLengthLatest(), state.getQueueLengthSnapshot());","538","                float excessWorkload = qlen - plannedCapacity;","547","                                    + \"(planned capacity={1,number,#.###},\"","548","                                    + \"Qlen={2,number,#.###},idle={3,number,#.###}&{4,number,integer},\"","549","                                    + \"total={5,number,integer},m={6,number,#.###})\",","551","                                    excessWorkload, plannedCapacity, qlen, idle, state.getIdleSnapshot(),","552","                                    state.getTotalSnapshot(), m"]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["324","LoadStatistics.Legends.DefinedExecutors=Defined executors","325","LoadStatistics.Legends.OnlineExecutors=Online executors","326","LoadStatistics.Legends.ConnectingExecutors=Connecting executors","329","LoadStatistics.Legends.IdleExecutors=Idle executors","330","LoadStatistics.Legends.AvailableExecutors=Available executors"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/UnlabeledLoadStatistics.java":[{"add":["31","import hudson.model.queue.SubTask;","32","import hudson.util.Iterators;","33","","34","import java.util.Iterator;","35","import java.util.LinkedHashSet;","36","import java.util.List;","37","import java.util.NoSuchElementException;","38","import java.util.Set;","51","    private final Iterable<Node> nodes = new UnlabeledNodesIterable();","52","","85","","86","    @Override","87","    protected Iterable<Node> getNodes() {","88","        return nodes;","89","    }","90","","91","    @Override","92","    protected boolean matches(SubTask item) {","93","        return true;","94","    }","95","","96","    private static class UnlabeledNodesIterable implements Iterable<Node> {","97","","98","        @Override","99","        public Iterator<Node> iterator() {","100","            return new UnlabeledNodesIterator();","101","        }","102","    }","103","","104","    private static class UnlabeledNodesIterator extends Iterators.FilterIterator<Node> {","105","","106","        protected UnlabeledNodesIterator() {","107","            super(Jenkins.getActiveInstance().getNodes().iterator());","108","        }","109","","110","        @Override","111","        protected boolean filter(Node n) {","112","            return n != null && n.getMode() == Mode.NORMAL;","113","        }","114","","115","        public void remove() {","116","            \/\/ why does Iterators.FilterIterator do the stupid thing and allow remove?","117","            \/\/ (remove should remove the object last returned by next(), but it won't if hasNext() is called","118","            \/\/ the way Iterators.FilterIterator is written... it should just return a read-only","119","            \/\/ view... which is what we do!","120","            throw new UnsupportedOperationException(\"remove\");","121","        }","122","    }"],"delete":[]}],"core\/src\/test\/java\/hudson\/model\/LoadStatisticsTest.java":[{"add":["26","import hudson.model.queue.SubTask;","27","import junit.framework.TestCase;","58","            @Override","59","            protected Iterable<Node> getNodes() {","60","                throw new UnsupportedOperationException();","61","            }","62","","63","            @Override","64","            protected boolean matches(SubTask item) {","65","                throw new UnsupportedOperationException();","66","            }","70","            ls.onlineExecutors.update(4);","72","            ls.availableExecutors.update(1);","77","            ls.onlineExecutors.update(0);","79","            ls.availableExecutors.update(0);"],"delete":["59","            ls.totalExecutors.update(4);","65","            ls.totalExecutors.update(0);"]}],"core\/src\/main\/java\/hudson\/model\/Label.java":[{"add":["41","import hudson.model.queue.SubTask;","110","","111","            @Override","112","            protected Set<Node> getNodes() {","113","                return Label.this.getNodes();","114","            }","115","","116","            @Override","117","            protected boolean matches(SubTask item) {","118","                return item.getAssignedLabel() == Label.this;","119","            }"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3494","                    while (isQuietingDown && (overallLoad.computeSnapshot().getBusyExecutors() > 0)) {"],"delete":["3494","                    while (isQuietingDown","3495","                           && (overallLoad.computeTotalExecutors() > overallLoad.computeIdleExecutors())) {"]}]}},"9c0d3a77773a8626a41a088e85e1eabf84f74b5e":{"changes":{"core\/src\/main\/java\/hudson\/tasks\/junit\/TestResultAction.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/TestResult.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/CaseResult.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/ClassResult.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/TabulatedResult.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/test\/AggregatedTestResultAction.java":"MODIFY","core\/src\/main\/resources\/lib\/test\/bar.jelly":"MODIFY","war\/resources\/css\/style.css":"MODIFY","core\/src\/main\/resources\/hudson\/tasks\/junit\/CaseResult\/index.jelly":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/junit\/PackageResult.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/test\/AbstractTestResultAction.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/tasks\/junit\/TestResultAction.java":[{"add":["34","    private int skipCount;","51","        skipCount = result.getSkipCount();","75","","83","            skipCount = r.getSkipCount();","98","    public int getSkipCount() {","99","        if(totalCount==null)","100","            getResult();    \/\/ this will compute the result","101","        return skipCount;","102","    }","103","","104","    @Override","105","    @Exported"],"delete":["73","        "]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/TestResult.java":[{"add":["50","","51","    private transient int skippedTests;","53","    private float duration;","170","        return totalTests-getFailCount()-getSkipCount();","181","    public int getSkipCount() {","182","        return skippedTests;","183","    }","184","","185","    @Override","234","                if(cr.isSkipped())","235","                    skippedTests++;","236","                else if(!cr.isPassed())"],"delete":["51","    private float duration; ","168","        return totalTests-getFailCount();","227","                if(!cr.isPassed())"]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/CaseResult.java":[{"add":["19","    private final boolean skipped;","33","        this(parent,testCase.attributeValue(\"name\"), getError(testCase), parseTime(testCase), isMarkedAsSkipped(testCase));","69","        skipped = isMarkedAsSkipped(testCase);","73","        this( parent, testName, errorStackTrace, 0.0f, false ); ","75","    CaseResult(SuiteResult parent, String testName, String errorStackTrace, float duration, boolean skipped) {","80","        this.duration = duration;","81","        this.skipped = skipped;","91","    \/**","92","     * If the testCase element includes the skipped element (as output by TestNG), then","93","     * the test has neither passed nor failed, it was never run.","94","     *\/","95","    private static boolean isMarkedAsSkipped(Element testCase) {","96","        return testCase.element(\"skipped\") != null;","97","    }","98","","199","    \/**","200","     * @return true if the test was not skipped and did not fail, false otherwise.","201","     *\/","203","        return !skipped && errorStackTrace==null;","204","    }","205","","206","    \/**","207","     * Tests whether the test was skipped or not.  TestNG allows tests to be","208","     * skipped if their dependencies fail or they are part of a group that has","209","     * been configured to be skipped.","210","     * @return true if the test was not executed, false otherwise.","211","     *\/","212","    public boolean isSkipped() {","213","        return skipped;","266","        if (skipped) {","267","            return Status.SKIPPED;","268","        }","294","         * This test was skipped due to configuration or the","295","         * failure or skipping of a method that it depends on.","296","         *\/","297","        SKIPPED(\"result-skipped\",\"Skipped\",false),","298","        \/**"],"delete":["32","        this(parent,testCase.attributeValue(\"name\"), getError(testCase), parseTime(testCase));","71","        this( parent, testName, errorStackTrace, 0.0f ); ","73","    CaseResult(SuiteResult parent, String testName, String errorStackTrace, float duration) {","78","        this.duration = duration; ","189","        return errorStackTrace==null;"]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/ClassResult.java":[{"add":["21","    private int passCount,failCount,skipCount;","86","    @Exported","87","    public int getSkipCount() {","88","        return skipCount;","89","    }","90","","96","        passCount=failCount=skipCount=0;","100","            if (r.isSkipped()) {","101","                skipCount++;","102","            }","103","            else if(r.isPassed()) {","104","                passCount++;","105","            }","106","            else {","107","                failCount++;","108","            }"],"delete":["21","    private int passCount,failCount;","91","        passCount=failCount=0;","95","            if(r.isPassed())    passCount++;","96","            else                failCount++;"]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/TabulatedResult.java":[{"add":["27","     * Gets the total number of skipped tests.","28","     *\/","29","    public abstract int getSkipCount();","30","","31","    \/**","35","        return getPassCount()+getFailCount()+getSkipCount();"],"delete":["30","        return getPassCount()+getFailCount();"]}],"core\/src\/main\/java\/hudson\/tasks\/test\/AggregatedTestResultAction.java":[{"add":["14"," *","19","    private int failCount,skipCount,totalCount;","47","        failCount = skipCount = totalCount = 0;","55","        skipCount += child.getSkipCount();"],"delete":["14"," * ","19","    private int failCount,totalCount;","47","        failCount = totalCount = 0;"]}],"core\/src\/main\/resources\/lib\/test\/bar.jelly":[{"add":["23","          <!-- Only show skips if there are some since they don't make sense for JUnit, only for TestNG. -->","24","          <j:if test=\"${it.skipCount > 0}\">","25","            , ${it.skipCount} skipped","26","            <j:if test=\"${prev!=null}\">","27","              (${h.getDiffString(it.skipCount-prev.skipCount)})","28","            <\/j:if>","29","          <\/j:if>","32","          <!-- Failed tests part of the bar. -->","33","          <div style=\"width:${it.failCount*100\/it.totalCount}%; height: 1em; background-color: #EF2929; float: left\"><\/div>","34","          <!-- Skipped tests part of the bar. -->","35","          <div style=\"width:${it.skipCount*100\/it.totalCount}%; height: 1em; background-color: #FCE94F; float: left\"><\/div>"],"delete":["25","          <div style=\"width:${it.failCount*100\/it.totalCount}%; height: 1em; background-color: #EF2929\"><\/div>"]}],"war\/resources\/css\/style.css":[{"add":["538",".result-skipped {","539","  color: #ddbb00;","540","}","541",""],"delete":[]}],"core\/src\/main\/resources\/hudson\/tasks\/junit\/CaseResult\/index.jelly":[{"add":["13","          <j:choose>","14","            <j:when test=\"${it.skipped}\">","15","              Skipped for the past","16","            <\/j:when>","17","            <j:otherwise>","18","              Failing for the past","19","            <\/j:otherwise>","20","          <\/j:choose>"],"delete":["13","          Failing for the past"]}],"core\/src\/main\/java\/hudson\/tasks\/junit\/PackageResult.java":[{"add":["27","    private int passCount,failCount,skipCount;","75","    @Exported","76","    public int getSkipCount() {","77","        return skipCount;","78","    }","79","","93","                if(!cr.isPassed() && !cr.isSkipped())","116","            skipCount += cr.getSkipCount();"],"delete":["27","    private int passCount,failCount;","88","                if(!cr.isPassed())"]}],"core\/src\/main\/java\/hudson\/tasks\/test\/AbstractTestResultAction.java":[{"add":["51","     * Gets the number of skipped tests.","52","     *\/","53","    public int getSkipCount() {","54","        \/\/ Not all sub-classes will understand the concept of skipped tests.","55","        \/\/ This default implementation is for them, so that they don't have","56","        \/\/ to implement it (this avoids breaking existing plug-ins - i.e. those","57","        \/\/ written before this method was added in 1.178).","58","        \/\/ Sub-classes that do support skipped tests should over-ride this method.","59","        return 0;","60","    }","61","","62","    \/**","176","            if(!failureOnly) {","177","                dsb.add( a.getSkipCount(), \"skipped\", new NumberOnlyBuildLabel(a.owner));","178","                dsb.add( a.getTotalCount()-a.getFailCount()-a.getSkipCount(),\"total\", new NumberOnlyBuildLabel(a.owner));","179","            }","240","                switch (row) {","241","                    case 0:","242","                        return String.valueOf(Util.combine(a.getFailCount(), \"failure\"));","243","                    case 1:","244","                        return String.valueOf(Util.combine(a.getSkipCount(), \"skip\"));","245","                    default:","246","                        return String.valueOf(Util.combine(a.getTotalCount(), \"test\"));","247","                }","251","        ar.setSeriesPaint(0,ColorPalette.RED); \/\/ Failures.","252","        ar.setSeriesPaint(1,ColorPalette.YELLOW); \/\/ Skips.","253","        ar.setSeriesPaint(2,ColorPalette.BLUE); \/\/ Total."],"delete":["164","            if(!failureOnly)","165","                dsb.add( a.getTotalCount()-a.getFailCount(),\"total\", new NumberOnlyBuildLabel(a.owner));","226","                if(row==0)","227","                    return String.valueOf(Util.combine(a.getFailCount(),\"failure\"));","228","                else","229","                    return String.valueOf(Util.combine(a.getTotalCount(),\"test\"));","233","        ar.setSeriesPaint(0,ColorPalette.RED);","234","        ar.setSeriesPaint(1,ColorPalette.BLUE);"]}]}},"eaa5ce0799785ada0a356a3a6ca60a1a9d1bc624":{"changes":{"core\/src\/main\/resources\/lib\/form\/hetero-list.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/hetero-list.jelly":[{"add":["128","            <l:renderOnDemand tag=\"tr\" clazz=\"config-page\" capture=\"descriptor,it,instance,h,${capture}\">"],"delete":["128","            <l:renderOnDemand tag=\"tr\" clazz=\"config-page\" capture=\"descriptor,it,instance,${capture}\">"]}]}},"3560c08346bcd987ccb613f540b48659bc142de4":{"changes":{"debian\/hudson.init":"MODIFY"},"diff":{"debian\/hudson.init":[{"add":["33","    mkdir `dirname $PIDFILE` > \/dev\/null 2>&1 || true"],"delete":["33","    mkdir `dirname $PIDFILE` || true"]}]}},"783e9195ccc4f460a3369e8c077e5ce078b1e1be":{"changes":{"core\/src\/main\/java\/hudson\/scm\/SubversionSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/SubversionSCM.java":[{"add":["298","            this( info.getURL().toDecodedString(), info.getCommittedRevision().getNumber() );"],"delete":["298","            this( info.getURL().toDecodedString(), info.getRevision().getNumber() );"]}]}},"cce49e7b3cba50bd46e5b8d6c6d3182f398bc277":{"changes":{"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/configure.jelly":"MODIFY","core\/src\/main\/resources\/jenkins\/model\/Jenkins\/help-rawWorkspaceDir.html":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY","core\/src\/main\/resources\/jenkins\/model\/Jenkins\/help-rawBuildsDir.html":"MODIFY"},"diff":{"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/configure.jelly":[{"add":["42","        <f:entry field=\"rawWorkspaceDir\" title=\"${%Workspace Root Directory}\" >","43","          <f:textbox readonly=\"readonly\" \/>","46","          <f:textbox readonly=\"readonly\"\/>"],"delete":["42","        <f:entry field=\"rawWorkspaceDir\" title=\"${%Workspace Root Directory}\">","43","          <f:textbox\/>","46","          <f:textbox\/>"]}],"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/help-rawWorkspaceDir.html":[{"add":["1","    <p><strong>This value is only modifiable using a system property.","2","        To do so, pass <code>-Djenkins.model.Jenkins.WORKSPACES_DIR=\"the_value\"<\/code>","3","        to the Jenkins JVM options during startup.<\/strong>","4","    <\/p>","5","    <p>","9","    <\/p>"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["3042","","3043","        setBuildsAndWorkspacesDir();","3044","    }","3045","","3046","    private void setBuildsAndWorkspacesDir() {","3047","        String newBuildsDir = SystemProperties.getString(BUILDS_DIR_PROP);","3048","        if (newBuildsDir != null && !buildsDir.equals(newBuildsDir)) {","3049","            LOGGER.log(Level.WARNING, \"Changing builds directories from {0} to {1}. Beware that no automated data migration will occur.\",","3050","                       new String[]{buildsDir, newBuildsDir});","3051","            buildsDir = newBuildsDir;","3052","        }","3053","","3054","        String newWorkspacesDir = SystemProperties.getString(WORKSPACES_DIR_PROP);","3055","        if (newWorkspacesDir != null && !workspaceDir.equals(newBuildsDir)) {","3056","            LOGGER.log(Level.WARNING, \"Changing workspaces directories from {0} to {1}. Beware that no automated data migration will occur.\",","3057","                       new String[]{workspaceDir, newWorkspacesDir});","3058","            workspaceDir = newWorkspacesDir;","3059","        }","3060",""],"delete":[]}],"core\/src\/main\/resources\/jenkins\/model\/Jenkins\/help-rawBuildsDir.html":[{"add":["1","    <p><strong>This value is only modifiable using a system property.","2","        To do so, pass <code>-Djenkins.model.Jenkins.BUILDS_DIR=\"the_value\"<\/code>","3","        to the Jenkins JVM options during startup.<\/strong>","4","    <\/p>","5","    <p>Specifies where Jenkins will store build records on the file system. This","7","    <\/p>"],"delete":["1","    Specifies where Jenkins will store build records on the file system. This"]}]}},"fd93cf05df65d831cc5724acdc1a009867937a34":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["63","  <li class=bug>","64","    Fixed a bug in the calendar computation.","65","    (<a href=\"http:\/\/issues.hudson-ci.org\/browse\/HUDSON-8656\">issue 8656 in Hudson<\/a>)"],"delete":[]}]}},"e9ffeeee48c65c42ec65d8cebb5807598448cdd3":{"changes":{"core\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","core\/src\/main\/java\/hudson\/matrix\/MatrixBuild.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","core\/src\/main\/java\/hudson\/tasks\/MailSender.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":"MODIFY","core\/src\/main\/java\/hudson\/maven\/MavenBuild.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Build.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["332","        public void post2(BuildListener listener) throws Exception {"],"delete":["332","        public void post(BuildListener listener) {"]}],"core\/src\/main\/java\/hudson\/matrix\/MatrixBuild.java":[{"add":["2","import hudson.model.*;","10","import java.util.ArrayList;","137","        public void post2(BuildListener listener) throws Exception {"],"delete":["2","import hudson.model.AbstractBuild;","3","import hudson.model.BuildListener;","4","import hudson.model.Result;","5","import hudson.model.Executor;","6","import hudson.model.Hudson;","7","import hudson.model.Queue;","18","import java.util.ArrayList;","19","import java.util.logging.Logger;","143","        public void post(BuildListener listener) throws IOException, InterruptedException {"]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":[],"delete":["73","    public transient Set<User> culprits;","74",""]}],"core\/src\/main\/java\/hudson\/tasks\/MailSender.java":[{"add":["4","import hudson.model.*;","238","            Set<User> culprits = build.getCulprits();","240","            if(debug)","241","                listener.getLogger().println(\"Trying to send e-mails to individuals who broke the build. sizeof(culprits)==\"+culprits.size());","243","            for (User a : culprits) {"],"delete":["4","import hudson.model.AbstractBuild;","5","import hudson.model.AbstractProject;","6","import hudson.model.BuildListener;","7","import hudson.model.Result;","8","import hudson.model.User;","10","import hudson.scm.ChangeLogSet.Entry;","23","import java.util.HashSet;","119","        \/\/ Reset the list of culprits","120","        build.getProject().culprits.clear();","121","","247","            if(debug) {","248","                int count = 0;","249","                for (Entry cs : build.getChangeSet())   count++;","250","                listener.getLogger().println(\"Trying to send e-mails to individuals who broke the build. sizeof(changeset)==\"+count);","251","            }","253","            if (build.getProject().culprits == null)","254","            \tbuild.getProject().culprits = new HashSet<User>();","256","            for (Entry change : build.getChangeSet()) {","257","                build.getProject().culprits.add(change.getAuthor());","258","            }","259","","260","            for (User a : build.getProject().culprits) {"]}],"core\/src\/main\/java\/hudson\/model\/AbstractBuild.java":[{"add":["5","import hudson.util.AdaptedIterator;","8","import hudson.model.Fingerprint.BuildPtr;","9","import hudson.model.Fingerprint.RangeSet;","17","import hudson.tasks.Builder;","18","import hudson.tasks.Fingerprinter.FingerprintAction;","19","import hudson.tasks.test.AbstractTestResultAction;","22","import org.kohsuke.stapler.export.Exported;","29","import java.util.*;","63","    \/**","64","     * Cumulative list of people who contributed to the build problem.","65","     *","66","     * <p>","67","     * This is a list of {@link User#getId() user ids} who made a change","68","     * since the last non-broken build. Can be null (which should be","69","     * treated like empty set), because of the compatibility.","70","     *","71","     * <p>","72","     * This field is semi-final --- once set the value will never be modified.","73","     *","74","     * @since 1.137","75","     *\/","76","    private volatile Set<String> culprits;","77","","112","    \/**","113","     * List of users who committed a change since the last non-broken build till now.","114","     *","115","     * <p>","116","     * This","117","     *","118","     * @return","119","     *      can be empty but never null.","120","     *\/","121","    @Exported","122","    public Set<User> getCulprits() {","123","        if(culprits==null) {","124","            Set<User> r = new HashSet<User>();","125","            if(getPreviousBuild()!=null && isBuilding() && getPreviousBuild().getResult().isWorseThan(Result.UNSTABLE)) {","126","                \/\/ we are still building, so this is just the current latest information,","127","                \/\/ but we seems to be failing so far, so inherit culprits from the previous build.","128","                \/\/ isBuilding() check is to avoid recursion when loading data from old Hudson, which doesn't record","129","                \/\/ this information","130","                r.addAll(getPreviousBuild().getCulprits());","131","            }","132","            for( Entry e : getChangeSet() )","133","                r.add(e.getAuthor());","134","            return r;","135","        }","136","","137","        return new AbstractSet<User>() {","138","            public Iterator<User> iterator() {","139","                return new AdaptedIterator<String,User>(culprits.iterator()) {","140","                    protected User adapt(String id) {","141","                        return User.get(id);","142","                    }","143","                };","144","            }","145","","146","            public int size() {","147","                return culprits.size();","148","            }","149","        };","150","    }","151","","233","","234","        \/**","235","         * @see #post(BuildListener)","236","         *\/","237","        protected abstract void post2(BuildListener listener) throws Exception;","238","","239","        public final void post(BuildListener listener) throws Exception {","240","            try {","241","                post2(listener);","242","            } finally {","243","                \/\/ update the culprit list","244","                HashSet<String> r = new HashSet<String>();","245","                for (User u : getCulprits())","246","                    r.add(u.getId());","247","                culprits = r;","248","            }","249","        }"],"delete":["6","import org.kohsuke.stapler.export.Exported;","7","import hudson.tasks.Fingerprinter.FingerprintAction;","8","import hudson.tasks.test.AbstractTestResultAction;","9","import hudson.tasks.Builder;","13","import hudson.model.Fingerprint.RangeSet;","14","import hudson.model.Fingerprint.BuildPtr;","28","import java.util.Calendar;","29","import java.util.Map;","30","import java.util.HashMap;","31","import java.util.Collections;","32","import java.util.List;","33","import java.util.ArrayList;"]}],"core\/src\/main\/java\/hudson\/maven\/MavenBuild.java":[{"add":["345","        public void post2(BuildListener listener) throws Exception {"],"delete":["345","        public void post(BuildListener listener) throws IOException, InterruptedException {"]}],"core\/src\/main\/java\/hudson\/model\/Build.java":[{"add":["138","        public void post2(BuildListener listener) throws IOException, InterruptedException {"],"delete":["138","        public void post(BuildListener listener) throws IOException, InterruptedException {"]}]}},"01b4ac7d902381f65b88a45738b696a0f9ea5cfa":{"changes":{"core\/src\/main\/resources\/lib\/layout\/pane.jelly":"MODIFY","war\/src\/main\/webapp\/scripts\/hudson-behavior.js":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/layout\/pane.jelly":[{"add":["50","  <j:set var=\"paneIsCollapsed\" value=\"${h.isCollapsed(attrs.id)}\" \/>","51","  <div class=\"container-fluid pane-frame track-mouse ${paneIsCollapsed ? 'collapsed' : 'expanded'}\" id=\"${attrs.id}\">","55","           title=\"${paneIsCollapsed ? '%expand' : '%collapse'}\">","56","          <l:icon alt=\"${paneIsCollapsed ? '%expand' : '%collapse'}\" class=\"${paneIsCollapsed ? 'icon-expand' : 'icon-collapse'} icon-sm\"\/>","63","        <j:when test=\"${paneIsCollapsed}\">"],"delete":["50","  <div class=\"container-fluid pane-frame track-mouse\" id=\"${attrs.id}\">","54","           title=\"${h.isCollapsed(attrs.id) ? '%expand' : '%collapse'}\">","55","          <l:icon alt=\"${h.isCollapsed(attrs.id) ? '%expand' : '%collapse'}\" class=\"${h.isCollapsed(attrs.id) ? 'icon-expand' : 'icon-collapse'} icon-sm\"\/>","62","        <j:when test=\"${h.isCollapsed(attrs.id)}\">"]}],"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":[{"add":["1590","    ","1591","    \/\/ If the build history pane is collapsed, just return immediately and don't set up","1592","    \/\/ the build history refresh.","1593","    if (bh.hasClassName('collapsed')) {","1594","        return;","1595","    }","1596","    "],"delete":[]}]}},"ea65aad5c2a324798871557fa8eb4b644f5aec2e":{"changes":{"core\/src\/main\/java\/hudson\/scm\/SubversionSCM.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/scm\/SubversionSCM.java":[{"add":["334","            if (!repositoryLocationsExist() && build.getProject().getLastSuccessfulBuild()!=null) {","336","                \/\/ but only do so if there was at least some successful build,","337","                \/\/ to make sure that initial configuration error won't disable the build. see issue #1567"],"delete":["334","            if (!repositoryLocationsExist()) {"]}]}},"97da1618c52792bd675f8677b7e18df629f80eb7":{"changes":{"core\/src\/main\/resources\/hudson\/model\/AbstractProject\/sidepanel.jelly":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/AbstractProject\/sidepanel.jelly":[{"add":["48","                  onclick=\"${it.parameterized?null:'return build(this)'}\" post=\"${!it.parameterized}\" permission=\"${it.BUILD}\"\/>"],"delete":["48","                  onclick=\"${it.parameterized?null:'return build(this)'}\" post=\"true\" permission=\"${it.BUILD}\"\/>"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    \u201CBuild Now\u201D context menu item broken for parameterized jobs.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-17110\">issue 17110<\/a>)"],"delete":["57","  <li class=>"]}]}},"9620057a58dc07b52752683a433e200f36d4317d":{"changes":{"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":"MODIFY"},"diff":{"war\/src\/main\/webapp\/scripts\/hudson-behavior.js":[{"add":["2204","    if (rsp.status == 200) {","2205","        elt.innerHTML = rsp.responseText;","2206","    } else {","2207","        var id = 'valerr' + (iota++);","2208","        elt.innerHTML = '<a href=\"\" onclick=\"document.getElementById(\\'' + id","2209","        + '\\').style.display=\\'block\\';return false\">ERROR<\/a><div id=\"'","2210","        + id + '\" style=\"display:none\">' + rsp.responseText + '<\/div>';","2211","        var error = document.getElementById('error-description'); \/\/ cf. oops.jelly","2212","        if (error) {","2213","            var div = document.getElementById(id);","2214","            while (div.firstChild) {","2215","                div.removeChild(div.firstChild);","2216","            }","2217","            div.appendChild(error);","2218","        }","2219","    }"],"delete":["2204","    var i;","2205","    elt.innerHTML = rsp.status==200 ? rsp.responseText","2206","        : '<a href=\"\" onclick=\"document.getElementById(\\'valerr' + (i=iota++)","2207","        + '\\').style.display=\\'block\\';return false\">ERROR<\/a><div id=\"valerr'","2208","        + i + '\" style=\"display:none\">' + rsp.responseText + '<\/div>';"]}]}},"f719bd06a46b0c8f8249f5d4848db61947b920be":{"changes":{"test\/src\/test\/groovy\/hudson\/model\/AbstractProjectTest.groovy":"MODIFY","core\/src\/main\/java\/hudson\/matrix\/MatrixConfiguration.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/queue\/ScheduleResult.java":"ADD","core\/src\/main\/java\/hudson\/model\/Queue.java":"MODIFY","core\/src\/main\/java\/hudson\/matrix\/listeners\/MatrixBuildListener.java":"MODIFY"},"diff":{"test\/src\/test\/groovy\/hudson\/model\/AbstractProjectTest.groovy":[{"add":["25","import com.gargoylesoftware.htmlunit.ElementNotFoundException","26","import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;","72","    public void testConfigRoundtrip() {","84","    public void testWipeWorkspace() {","101","    public void testWipeWorkspaceProtected() {","118","    public void testWipeWorkspaceProtected2() {","141","    public void testOptionalBlockDataBindingRoundtrip() {","154","    public void testConfiguringBlockBuildWhenUpstreamBuildingRoundtrip() {","176","    public void testPollingAndBuildExclusion() {","227","    public void testBuildSymlinks() {","264","    public void testSymlinkForPostBuildFailure() {","289","    public void testGetBuildAfterGC() {","298","    public void testHandleBuildTrigger() {","333","    public void testExternalBuildDirectorySymlinks() {","364","    public void testExternalBuildDirectoryRenameDelete() {","384","    public void testDeleteRedirect() {","397","","398","    private String deleteRedirectTarget(String job) {","399","        def wc = createWebClient();","406","    @Bug(18407)","407","    public void testQueueSuccessBehavior() {","408","        \/\/ prevent any builds to test the behaviour","409","        jenkins.numExecutors = 0;","410","        jenkins.updateComputerList(false);","411","","412","        def p = createFreeStyleProject()","413","        def f = p.scheduleBuild2(0)","414","        assert f!=null;","415","        def g = p.scheduleBuild2(0)","416","        assert f==g;","417","","418","        p.makeDisabled(true)","419","        assert p.scheduleBuild2(0)==null","420","    }","421","","422","    \/**","423","     * Do the same as {@link #testQueueSuccessBehavior()} but over HTTP","424","     *\/","425","    @Bug(18407)","426","    public void testQueueSuccessBehaviorOverHTTP() {","427","        \/\/ prevent any builds to test the behaviour","428","        jenkins.numExecutors = 0;","429","        jenkins.updateComputerList(false);","430","","431","        def p = createFreeStyleProject()","432","        def wc = createWebClient();","433","","434","        def rsp = wc.getPage(\"${getURL()}${p.url}build\").webResponse","435","        assert rsp.statusCode==201;","436","        assert rsp.getResponseHeaderValue(\"Location\")!=null;","437","","438","        def rsp2 = wc.getPage(\"${getURL()}${p.url}build\").webResponse","439","        assert rsp2.statusCode==201;","440","        assert rsp.getResponseHeaderValue(\"Location\")==rsp2.getResponseHeaderValue(\"Location\")","441","","442","        p.makeDisabled(true)","443","","444","        try {","445","            wc.getPage(\"${getURL()}${p.url}build\")","446","            fail();","447","        } catch (FailingHttpStatusCodeException e) {","448","            \/\/ request should fail","449","        }","450","    }"],"delete":["25","import com.gargoylesoftware.htmlunit.ElementNotFoundException;","71","    public void testConfigRoundtrip() throws Exception {","83","    public void testWipeWorkspace() throws Exception {","100","    public void testWipeWorkspaceProtected() throws Exception {","117","    public void testWipeWorkspaceProtected2() throws Exception {","140","    public void testOptionalBlockDataBindingRoundtrip() throws Exception {","153","    public void testConfiguringBlockBuildWhenUpstreamBuildingRoundtrip() throws Exception {","175","    public void testPollingAndBuildExclusion() throws Exception {","226","    public void testBuildSymlinks() throws Exception {","263","    public void testSymlinkForPostBuildFailure() throws Exception {","288","    public void testGetBuildAfterGC() throws Exception {","297","    public void testHandleBuildTrigger() throws Exception {","332","    public void testExternalBuildDirectorySymlinks() throws Exception {","363","    public void testExternalBuildDirectoryRenameDelete() throws Exception {","383","    public void testDeleteRedirect() throws Exception {","396","    private String deleteRedirectTarget(String job) throws Exception {","397","        WebClient wc = createWebClient();"]}],"core\/src\/main\/java\/hudson\/matrix\/MatrixConfiguration.java":[{"add":["395","\t *    Use {@link #scheduleBuild(List, Cause)}.  Since 1.480","404","     * @param c     Reason for starting the build","415","        return Jenkins.getInstance().getQueue().schedule2(this, getQuietPeriod(), allActions ).isAccepted();"],"delete":["395","\t *    Use {@link #scheduleBuild(List<? extends Action>, Cause)}.  Since 1.480","398","","405","     * @param cause     Reason for starting the build","416","        return Jenkins.getInstance().getQueue().schedule(this, getQuietPeriod(), allActions )!=null;"]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["50","import hudson.model.queue.ScheduleResult;","920","        ScheduleResult i = Jenkins.getInstance().getQueue().schedule2(this, quietPeriod, queueActions);","921","        if(i.isAccepted())","922","            return (QueueTaskFuture)i.getItem().getFuture();","1814","        ScheduleResult r = Jenkins.getInstance().getQueue().schedule2(this, delay.getTime(), getBuildCause(req));","1815","        if (r.isAccepted()) {","1816","            rsp.sendRedirect(SC_CREATED,req.getContextPath()+'\/'+r.getItem().getUrl());"],"delete":["51","import hudson.model.Queue.WaitingItem;","920","        WaitingItem i = Jenkins.getInstance().getQueue().schedule(this, quietPeriod, queueActions);","921","        if(i!=null)","922","            return (QueueTaskFuture)i.getFuture();","1814","        WaitingItem item = Jenkins.getInstance().getQueue().schedule(this, (int) delay.getTime(), getBuildCause(req));","1815","        if (item!=null) {","1816","            rsp.sendRedirect(SC_CREATED,req.getContextPath()+'\/'+item.getUrl());"]}],"core\/src\/main\/java\/hudson\/model\/queue\/ScheduleResult.java":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/Queue.java":[{"add":["48","import hudson.model.queue.ScheduleResult;","49","import hudson.model.queue.ScheduleResult.Created;","478","     * @deprecated as of 1.521","479","     *  Use {@link #schedule2(Task, int, List)}","480","     *\/","481","    public synchronized WaitingItem schedule(Task p, int quietPeriod, List<Action> actions) {","482","        return schedule2(p, quietPeriod, actions).getCreateItem();","483","    }","484","","485","    \/**","495","     *      {@link ScheduleResult.Refused} if Jenkins refused to add this task into the queue (for example because the system","496","     *      is about to shutdown.) Otherwise the task is either merged into existing items in the queue","497","     *      (in which case you get {@link ScheduleResult.Existing} instance back), or a new item","498","     *      gets created in the queue (in which case you get {@link Created}.","499","     *","500","     *      Note the nature of the queue","504","     *      That said, one can still look at {@link Item#future}, {@link Item#id}, etc.","506","    public synchronized @Nonnull ScheduleResult schedule2(Task p, int quietPeriod, List<Action> actions) {","516","                return ScheduleResult.refused();    \/\/ veto","533","    private synchronized @Nonnull ScheduleResult scheduleInternal(Task p, int quietPeriod, List<Action> actions) {","558","            return ScheduleResult.created(added);","592","","593","        \/\/ REVISIT: when there are multiple existing items in the queue that matches the incoming one,","594","        \/\/ whether the new one should affect all existing ones or not is debateable. I for myself","595","        \/\/ thought this would only affect one, so the code was bit of surprise, but I'm keeping the current","596","        \/\/ behaviour.","597","        return ScheduleResult.existing(duplicatesInQueue.get(0));","625","    \treturn schedule2(p, quietPeriod, actions).getCreateItem();","626","    }","627","","628","    \/**","629","     * Convenience wrapper method around {@link #schedule2(Task, int, List)}","630","     *\/","631","    public synchronized @Nonnull ScheduleResult schedule2(Task p, int quietPeriod, Action... actions) {","632","    \treturn schedule2(p, quietPeriod, Arrays.asList(actions));"],"delete":["485","     *      null if this task is already in the queue and therefore the add operation was no-op.","486","     *      Otherwise indicates the {@link WaitingItem} object added, although the nature of the queue","490","     *      That said, one can still look at {@link WaitingItem#future}, {@link WaitingItem#id}, etc.","492","    public synchronized WaitingItem schedule(Task p, int quietPeriod, List<Action> actions) {","502","                return null;    \/\/ veto","519","    private synchronized WaitingItem scheduleInternal(Task p, int quietPeriod, List<Action> actions) {","544","            return added;","578","        return null;","606","    \treturn schedule(p, quietPeriod, Arrays.asList(actions));"]}],"core\/src\/main\/java\/hudson\/matrix\/listeners\/MatrixBuildListener.java":[{"add":["43"," * ({@link Queue#schedule2(Task, int, List)}, then access this from {@link MatrixBuild} to drive"],"delete":["43"," * ({@link Queue#schedule(Task, int, List)}, then access this from {@link MatrixBuild} to drive"]}]}},"ec9b4f11866e80ae4a432b9127e71afddf30de86":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["196","            return computeResult();","199","            if (effectiveResult == null) {","200","                effectiveResult = computeResult();","202","            return effectiveResult;","204","    }","205","","206","    private Result computeResult() {"],"delete":["196","            return super.getResult();","199","            if (effectiveResult != null) {","200","                return effectiveResult;","217","        synchronized (notifyModuleBuildLock) {","218","            if (effectiveResult == null) {","219","                effectiveResult = r;","220","            }","221","        }"]}]}},"11458c956e64673d99a9dc2c05cfd5f9533b4e1b":{"changes":{"changelog.html":"MODIFY","pom.xml":"MODIFY"},"diff":{"changelog.html":[{"add":["72","  <li class='major bug'>","73","    JNLP slaves now satisfies stricter requirements imposed by JDK7u45.","74","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-20204\">issue 20204<\/a>)","75","  <li class=bug>","76","    Fixed NPE executing <tt>Pipe.EOF<\/tt> with <tt>ProxyWriter<\/tt>","77","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-20769\">issue 20769<\/a>)"],"delete":[]}],"pom.xml":[{"add":["174","        <version>2.35<\/version>"],"delete":["174","        <version>2.33<\/version>"]}]}},"a1e709ddf0ca48b25ad07ee13a2fbdb0a6d97c0e":{"changes":{"changelog.html":"MODIFY","core\/src\/main\/resources\/hudson\/slaves\/JNLPLauncher\/main.jelly":"MODIFY"},"diff":{"changelog.html":[{"add":["72","    JNLP slave index page failed to explain how to pass <code>-jnlpCredentials<\/code>.","73","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-16273\">issue 16273<\/a>)","74","  <li class=bug>"],"delete":[]}],"core\/src\/main\/resources\/hudson\/slaves\/JNLPLauncher\/main.jelly":[{"add":["34","      <j:if test=\"${h.hasPermission(it, it.CONNECT)}\">","47","          <j:choose>","48","            <j:when test=\"${it.ACL.hasPermission(app.ANONYMOUS, it.CONNECT)}\">","49","              <li>","50","                <p>","51","                  ${%Run from slave command line:}","52","                <\/p>","53","                <pre>javaws ${h.inferHudsonURL(request)}${it.url}slave-agent.jnlp<\/pre>","54","              <\/li>","55","              <li>","56","                <p>","57","                  ${%Or if the slave is headless:}","58","                <\/p>","59","                <pre>java -jar <a href=\"${rootURL}\/jnlpJars\/slave.jar\">slave.jar<\/a> -jnlpUrl ${h.inferHudsonURL(request)}${it.url}slave-agent.jnlp<\/pre>","60","              <\/li>","61","            <\/j:when>","62","            <j:otherwise>","63","              <li>","64","                <p>","65","                  ${%Run from slave command line:}","66","                <\/p>","67","                <pre>java -jar <a href=\"${rootURL}\/jnlpJars\/slave.jar\">slave.jar<\/a> -jnlpUrl ${h.inferHudsonURL(request)}${it.url}slave-agent.jnlp -jnlpCredentials ${app.authentication.name}:<a href=\"${rootURL}\/user\/${app.authentication.name}\/configure\" target=\"_blank\">your-API-token<\/a><\/pre>","68","              <\/li>","69","            <\/j:otherwise>","70","          <\/j:choose>","79","      <\/j:if>"],"delete":["34","      <l:isAdmin><!-- TODO: we need a permission to launch a slave -->","47","          <li>","48","            <p>","49","              ${%Run from slave command line:}","50","            <\/p>","51","            <pre>javaws ${h.inferHudsonURL(request)}${it.url}slave-agent.jnlp<\/pre>","52","          <\/li>","53","          <li>","54","            <p>","55","              ${%Or if the slave is headless:}","56","            <\/p>","57","            <pre>java -jar <a href=\"${rootURL}\/jnlpJars\/slave.jar\">slave.jar<\/a> -jnlpUrl ${h.inferHudsonURL(request)}${it.url}slave-agent.jnlp<\/pre>","58","          <\/li>","67","      <\/l:isAdmin>"]}]}},"85a8dd009a35377ca64d067d6cc4254e8ec29a16":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["69","  <li class=bug>","70","    EXECUTOR_NUMBER uniqueness can degrate over time","71","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-4756\">issue 4756<\/a>)"],"delete":[]}]}},"7a552e8e0209043e6b03951699dcbc16dfbbe082":{"changes":{"core\/src\/main\/java\/hudson\/model\/View.java":"MODIFY","changelog.html":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/View.java":[{"add":["284","        synchronized (PropertyList.class) {","290","            return properties;"],"delete":["284","        synchronized (this) {","291","","292","        return properties;"]}],"changelog.html":[{"add":["57","  <li class=bug>","58","    Deadlock involving views.","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-15368\">issue 15368<\/a>)"],"delete":[]}]}},"8f012d63d771b22d74eec8396b2895f0e45f0e6f":{"changes":{"war\/pom.xml":"MODIFY"},"diff":{"war\/pom.xml":[{"add":["100","      <version>2.9<\/version>"],"delete":["100","      <version>2.8<\/version>"]}]}},"22d2dc487ddb5558694efd3d17e49d07adda19b3":{"changes":{"changelog.html":"MODIFY"},"diff":{"changelog.html":[{"add":["62","  <li class=bug>","63","    Many messages about RecordReaper IllegalArgumentException","64","    (<a href=\"http:\/\/issues.jenkins-ci.org\/browse\/JENKINS-8647\">issue 8647<\/a>)"],"delete":[]}]}},"3b67a0847d0310742ea741a83e156a12fe981e0b":{"changes":{"\/dev\/null":"DELETE","test\/src\/test\/groovy\/hudson\/matrix\/MatrixProjectTest.groovy":"ADD","core\/src\/main\/java\/hudson\/matrix\/Layouter.java":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/project\/matrix.jelly":"MODIFY"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"test\/src\/test\/groovy\/hudson\/matrix\/MatrixProjectTest.groovy":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/matrix\/Layouter.java":[{"add":["114","     * Computes the repeat count of n-th X-axis.","115","     *\/","116","    public int repeatX(int n) {","117","        int w = 1;","118","        for( n--; n>=0; n-- )","119","            w *= x.get(n).size();","120","        return w;","121","    }","122","","123","    \/**"],"delete":[]}],"core\/src\/main\/resources\/lib\/hudson\/project\/matrix.jelly":[{"add":["57","          <j:forEach var=\"x\" items=\"${o.x}\" varStatus=\"loop\">","63","              <j:forEach begin=\"1\" end=\"${o.repeatX(loop.index)}\">","64","                <j:forEach var=\"v\" items=\"${x.values}\">","65","                  <td colspan=\"${o.width(loop.index)}\">${v}<\/td>","66","                <\/j:forEach>"],"delete":["57","          <j:forEach var=\"x\" items=\"${o.x}\">","63","              <j:forEach var=\"v\" items=\"${x.values}\" varStatus=\"loop\">","64","                <td colspan=\"${o.width(loop.index)}\">${v}<\/td>"]}]}},"cfbf4ca45ec97c05b47b69d1d59d3f5ae1f50c82":{"changes":{"core\/src\/main\/resources\/lib\/form\/combobox.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/form\/combobox.jelly":[{"add":["51","         autocomplete=\"off\" class=\"combobox2 setting-input ${attrs.clazz}${attrs.checkUrl!=null ? ' validated' : ''}\""],"delete":["51","         autocomplete=\"off\" class=\"combobox2 settings-input ${attrs.clazz}${attrs.checkUrl!=null ? ' validated' : ''}\""]}]}},"cdc18ec56987204535c9919ea385c555d3d66863":{"changes":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/util\/ProcessTree.java":[{"add":["427","                        if(env !=null)","428","                          return env;","429","                        env = new EnvVars();   ","430","                        ","431","                        try ","433","                           env.putAll(p.getEnvironmentVariables());","434","                        } catch (WinpException e)","435","                        {","436","                           LOGGER.log(FINE, \"Failed to get environment variable \", e);","437","                        }                          "],"delete":["427","                        if(env==null)  ","429","                            try","430","                            {","431","                                env = new EnvVars(p.getEnvironmentVariables());","432","                            } catch (WinpException e)","433","                            {","434","                                LOGGER.log(FINE, \"Failed to get environment variable \", e);","435","                            }                          ","436","                        }"]}]}},"2db804ec5d8217a1a4c1adea2d492b37de37484d":{"changes":{"pom.xml":"MODIFY"},"diff":{"pom.xml":[{"add":["108","    <remoting.version>3.26<\/remoting.version>"],"delete":["108","    <remoting.version>3.25<\/remoting.version>"]}]}},"d244b6b69aa013ca4818c3e4de15f9b9d4c8427b":{"changes":{"core\/src\/main\/java\/hudson\/model\/ChoiceParameterDefinition.java":"MODIFY","core\/src\/main\/resources\/hudson\/model\/ChoiceParameterDefinition\/config.jelly":"MODIFY","core\/src\/main\/resources\/hudson\/model\/Messages.properties":"MODIFY","test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY","core\/src\/test\/java\/hudson\/model\/ChoiceParameterDefinitionTest.java":"ADD"},"diff":{"core\/src\/main\/java\/hudson\/model\/ChoiceParameterDefinition.java":[{"add":["17","    public static final String CHOICES_DELIMETER = \"\\\\r?\\\\n\";","18","","22","    public static boolean areValidChoices(String choices) {","23","        String strippedChoices = choices.trim();","24","        return !StringUtils.isEmpty(strippedChoices) && strippedChoices.split(CHOICES_DELIMETER).length > 0;","25","    }","26","","30","        this.choices = Arrays.asList(choices.split(CHOICES_DELIMETER));","55",""],"delete":["23","        this.choices = Arrays.asList(choices.split(\"\\\\r?\\\\n\"));","24","        if (choices.length()==0) {","25","            throw new IllegalArgumentException(\"No choices found\");","26","        }","33","        if (this.choices.isEmpty()) {","34","            throw new IllegalArgumentException(\"No choices found\");","35","        }","54","    "]}],"core\/src\/main\/resources\/hudson\/model\/ChoiceParameterDefinition\/config.jelly":[{"add":["32","\t\t<f:textarea checkUrl=\"'${rootURL}\/checkChoices?value='+encodeURIComponent(this.value)\" name=\"parameter.choices\" value=\"${instance.choicesText}\" \/>"],"delete":["32","\t\t<f:textarea name=\"parameter.choices\" value=\"${instance.choicesText}\" \/>"]}],"core\/src\/main\/resources\/hudson\/model\/Messages.properties":[{"add":["310","ChoiceParameterDefinition.MissingChoices=Requires Choices."],"delete":[]}],"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":[{"add":["48","","52","import static org.junit.Assert.assertEquals;","53","","312","","313","    @Test","314","    public void testCheckChoices() throws Exception {","315","        Jenkins jenkins = Jenkins.getInstance();","316","","317","        assertEquals(FormValidation.Kind.OK, jenkins.doCheckChoices(\"abc\\ndef\").kind);","318","        assertEquals(FormValidation.Kind.ERROR, jenkins.doCheckChoices(\"\").kind);","319","    }","320",""],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["32","import hudson.model.ChoiceParameterDefinition;","3563","     * Checks if parameterised build choices are valid.","3564","     *\/","3565","    public FormValidation doCheckChoices(@QueryParameter String value) {","3566","        if (ChoiceParameterDefinition.areValidChoices(value)) {","3567","            return FormValidation.ok();","3568","        } else {","3569","            return FormValidation.error(Messages.ChoiceParameterDefinition_MissingChoices());","3570","        }","3571","    }","3572","","3573","    \/**"],"delete":[]}],"core\/src\/test\/java\/hudson\/model\/ChoiceParameterDefinitionTest.java":[{"add":[],"delete":[]}]}},"34bf393255bb603bb3b0fb921a41fc3916d16f42":{"changes":{"core\/src\/main\/java\/hudson\/model\/View.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/ViewTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/View.java":[{"add":["1055","","1056","        rsp.addHeader(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");","1057","        rsp.addHeader(\"Pragma\", \"no-cache\");","1058","        rsp.addHeader(\"Expires\", \"0\");"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/ViewTest.java":[{"add":["27","import com.gargoylesoftware.htmlunit.util.NameValuePair;","56","import java.util.HashMap;","58","import java.util.Map;","63","","64","import static org.hamcrest.CoreMatchers.is;","92","    @Issue(\"JENKINS-43848\")","93","    @Test public void testNoCacheHeadersAreSet() throws Exception {","94","        List<NameValuePair> responseHeaders = j.createWebClient()","95","                .goTo(\"view\/all\/itemCategories\", \"application\/json\")","96","                .getWebResponse()","97","                .getResponseHeaders();","98","","99","","100","        final Map<String, String> values = new HashMap<>();","101","","102","        for(NameValuePair p : responseHeaders) {","103","            values.put(p.getName(), p.getValue());","104","        }","105","","106","        String resp = values.get(\"Cache-Control\");","107","        assertThat(resp, is(\"no-cache, no-store, must-revalidate\"));","108","        assertThat(values.get(\"Expires\"), is(\"0\"));","109","        assertThat(values.get(\"Pragma\"), is(\"no-cache\"));","110","    }","111",""],"delete":[]}]}},"1e338d3565c8c58d2556f344a7c34a3b3ab18ca3":{"changes":{"\/dev\/null":"DELETE","core\/src\/main\/java\/hudson\/PluginWrapper.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/java\/hudson\/PluginManager.java":"MODIFY","test\/src\/test\/java\/hudson\/PluginManagerTest.java":"MODIFY","test\/src\/test\/java\/hudson\/PluginManagerUtil.java":"MODIFY"},"diff":{"\/dev\/null":[{"add":[],"delete":[]}],"core\/src\/main\/java\/hudson\/PluginWrapper.java":[{"add":["210","            this.version = s.substring(idx+1);","211","            ","213","            String[] osgiProperties = s.split(\";\");","225","            return shortName + \" (\" + version + \")\";","518","            if (parent.getPlugin(d.shortName) == null)","521","        if (!missingDependencies.isEmpty())","522","            throw new IOException(\"Dependency \"+Util.join(missingDependencies, \", \")+\" doesn't exist\");","523","","526","            if (parent.getPlugin(d.shortName) != null)","527","                dependencies.add(d);"],"delete":["90","     * A plugin won't be loaded unless his declared dependencies are present and match the required minimal version.","91","     * This can be set to false to disable the version check (legacy behaviour)","92","     *\/","93","    private static final boolean ENABLE_PLUGIN_DEPENDENCIES_VERSION_CHECK = Boolean.parseBoolean(System.getProperty(PluginWrapper.class.getName()+\".\" + \"dependenciesVersionCheck.enabled\", \"true\"));","94","","95","    \/**","216","            String version = s.substring(idx+1);","217","","219","            String[] osgiProperties = version.split(\"[;]\");","227","            if (isOptional) {","228","                this.version = osgiProperties[0];","229","            } else {","230","                this.version = version;","231","            }","236","            return shortName + \" (\" + version + \") \" + (optional ? \"optional\" : \"\");","401","     * Returns the required Jenkins core version of this plugin.","402","     * @return the required Jenkins core version of this plugin.","403","     * @since 1.657","404","     *\/","405","    @Exported","406","    public @CheckForNull String getRequiredCoreVersion() {","407","        String v = manifest.getMainAttributes().getValue(\"Jenkins-Version\");","408","        if (v!= null) return v;","409","","410","        v = manifest.getMainAttributes().getValue(\"Hudson-Version\");","411","        if (v!= null) return v;","412","        return null;","413","    }","414","","415","    \/**","541","        if (ENABLE_PLUGIN_DEPENDENCIES_VERSION_CHECK) {","542","            String requiredCoreVersion = getRequiredCoreVersion();","543","            if (requiredCoreVersion == null) {","544","                LOGGER.warning(shortName + \" doesn't declare required core version.\");","545","            } else {","546","                if (Jenkins.getVersion().isOlderThan(new VersionNumber(requiredCoreVersion))) {","547","                    throw new IOException(shortName + \" requires a more recent core version (\" + requiredCoreVersion + \") than the current (\" + Jenkins.getVersion() + \").\");","548","                }","549","            }","550","        }","552","        List<String> obsoleteDependencies = new ArrayList<String>();","553","        List<String> disabledDependencies = new ArrayList<String>();","556","            PluginWrapper dependency = parent.getPlugin(d.shortName);","557","            if (dependency == null) {","559","            } else {","560","                if (dependency.isActive()) {","561","                    if (ENABLE_PLUGIN_DEPENDENCIES_VERSION_CHECK && dependency.getVersionNumber().isOlderThan(new VersionNumber(d.version))) {","562","                        obsoleteDependencies.add(dependency.getShortName() + \"(\" + dependency.getVersion() + \" < \" + d.version + \")\");","563","                    }","564","                } else {","565","                    disabledDependencies.add(d.toString());","566","                }","567","","568","            }","572","            PluginWrapper dependency = parent.getPlugin(d.shortName);","573","            if (dependency != null && dependency.isActive()) {","574","                if (ENABLE_PLUGIN_DEPENDENCIES_VERSION_CHECK && dependency.getVersionNumber().isOlderThan(new VersionNumber(d.version))) {","575","                    obsoleteDependencies.add(dependency.getShortName() + \"(\" + dependency.getVersion() + \" < \" + d.version + \")\");","576","                } else {","577","                    dependencies.add(d);","578","                }","579","            }","580","        }","581","        StringBuilder messageBuilder = new StringBuilder();","582","        if (!missingDependencies.isEmpty()) {","583","            boolean plural = missingDependencies.size() > 1;","584","            messageBuilder.append(plural ? \"Dependencies \" : \"Dependency \")","585","                    .append(Util.join(missingDependencies, \", \"))","586","                    .append(\" \").append(plural ? \"don't\" : \"doesn't\")","587","                    .append(\" exist. \");","588","        }","589","        if (!disabledDependencies.isEmpty()) {","590","            boolean plural = disabledDependencies.size() > 1;","591","            messageBuilder.append(plural ? \"Dependencies \" : \"Dependency \")","592","                    .append(Util.join(disabledDependencies, \", \"))","593","                    .append(\" \").append(plural ? \"are\" : \"is\")","594","                    .append(\" disabled. \");","595","        }","596","        if (!obsoleteDependencies.isEmpty()) {","597","            boolean plural = obsoleteDependencies.size() > 1;","598","            messageBuilder.append(plural ? \"Dependencies \" : \"Dependency \")","599","                    .append(Util.join(obsoleteDependencies, \", \"))","600","                    .append(\" \").append(plural ? \"are\" : \"is\")","601","                    .append(\" older than required.\");","602","        }","603","        String message = messageBuilder.toString();","604","        if (!message.isEmpty()) {","605","            throw new IOException(message);"]}],"changelog.html":[{"add":["58","  <li class=>"],"delete":["58","  <li class=\"major RFE\">","59","    Plugin dependencies are now strictly enforced during Jenkins startup, to avoid cryptic errors later.","60","    You may use <code>-Dhudson.PluginWrapper.dependenciesVersionCheck.enabled=false<\/code> to revert to the old behavior.","61","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-21486\">issue 21486<\/a>)"]}],"core\/src\/main\/java\/hudson\/PluginManager.java":[{"add":["681","        activePlugins.add(p);"],"delete":["681","        if (p.isActive())","682","            activePlugins.add(p);"]}],"test\/src\/test\/java\/hudson\/PluginManagerTest.java":[{"add":[],"delete":["49","","342","    @Issue(\"JENKINS-21486\")","343","    @Test public void installPluginWithObsoleteDependencyFails() throws Exception {","344","        \/\/ Load dependee 0.0.1.","345","        {","346","            dynamicLoad(\"dependee.hpi\");","347","        }","348","","349","        \/\/ Load mandatory-depender 0.0.2, depending on dependee 0.0.2","350","        try {","351","            dynamicLoad(\"mandatory-depender-0.0.2.hpi\");","352","            fail(\"Should not have worked\");","353","        } catch (IOException e) {","354","            \/\/ Expected","355","        }","356","    }","357","","358","    @Issue(\"JENKINS-21486\")","359","    @Test public void installPluginWithDisabledOptionalDependencySucceeds() throws Exception {","360","        \/\/ Load dependee 0.0.2.","361","        {","362","            dynamicLoadAndDisable(\"dependee-0.0.2.hpi\");","363","        }","364","","365","        \/\/ Load depender 0.0.2, depending optionally on dependee 0.0.2","366","        {","367","            dynamicLoad(\"depender-0.0.2.hpi\");","368","        }","369","","370","        \/\/ dependee is not loaded so we cannot list any extension for it.","371","        try {","372","            r.jenkins.getExtensionList(\"org.jenkinsci.plugins.dependencytest.dependee.DependeeExtensionPoint\");","373","            fail();","374","        } catch( ClassNotFoundException _ ){","375","        }","376","    }","377","","378","    @Issue(\"JENKINS-21486\")","379","    @Test public void installPluginWithDisabledDependencyFails() throws Exception {","380","        \/\/ Load dependee 0.0.2.","381","        {","382","            dynamicLoadAndDisable(\"dependee-0.0.2.hpi\");","383","        }","384","","385","        \/\/ Load mandatory-depender 0.0.2, depending on dependee 0.0.2","386","        try {","387","            dynamicLoad(\"mandatory-depender-0.0.2.hpi\");","388","            fail(\"Should not have worked\");","389","        } catch (IOException e) {","390","            \/\/ Expected","391","        }","392","    }","393","","394","","395","    @Issue(\"JENKINS-21486\")","396","    @Test public void installPluginWithObsoleteOptionalDependencyFails() throws Exception {","397","        \/\/ Load dependee 0.0.1.","398","        {","399","            dynamicLoad(\"dependee.hpi\");","400","        }","401","","402","        \/\/ Load depender 0.0.2, depending optionally on dependee 0.0.2","403","        try {","404","            dynamicLoad(\"depender-0.0.2.hpi\");","405","            fail(\"Should not have worked\");","406","        } catch (IOException e) {","407","            \/\/ Expected","408","        }","409","    }","410","","449","","450","    private void dynamicLoadAndDisable(String plugin) throws IOException, InterruptedException, RestartRequiredException {","451","        PluginManagerUtil.dynamicLoad(plugin, r.jenkins, true);","452","    }"]}],"test\/src\/test\/java\/hudson\/PluginManagerUtil.java":[{"add":[],"delete":["50","        dynamicLoad(plugin, jenkins, false);","51","    }","52","","53","    public static void dynamicLoad(String plugin, Jenkins jenkins, boolean disable) throws IOException, InterruptedException, RestartRequiredException {","57","        if (disable) {","58","            new File(dest.getPath() + \".disabled\").createNewFile();","59","        }"]}]}},"66b28f30131e078375b9ca970fa288f21896011e":{"changes":{"core\/src\/main\/resources\/lib\/layout\/layout.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/layout\/layout.jelly":[{"add":["68","              <form action=\"${searchURL}\" method=\"get\" style=\"position:relative; top:0.5em;\">","81","            <\/td><td style=\"vertical-align: middle; padding-right: 1em; width:1px; whtiespace:nowrap;\">"],"delete":["68","              <form action=\"${searchURL}\" method=\"get\">","81",""]}]}},"744be9d1da7b33568f5314130a9ffbd562271e16":{"changes":{"core\/src\/main\/java\/hudson\/init\/impl\/GroovyInitScript.java":"MODIFY","core\/src\/main\/java\/hudson\/init\/InitMilestone.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/init\/impl\/GroovyInitScript.java":[{"add":["34"," * It runs strictly after the initialization of other tasks during the last initialization milestone.","39","    @Initializer(after=JOB_CONFIG_ADAPTED)"],"delete":["38","    @Initializer(after=JOB_LOADED)"]}],"core\/src\/main\/java\/hudson\/init\/InitMilestone.java":[{"add":["108","     * By this milestone, any job configuration is adapted or updated just in case any plugin needs to update former\/old configurations.","109","     * It does not include {@link hudson.init.impl.GroovyInitScript}s which get executed later","115","     * The very last milestone.","116","     * All executions should be completed by it, including {@link hudson.init.impl.GroovyInitScript}s."],"delete":["108","     * By this milestone, any job configuration is adapted or updated just in case any plugin needs to update former\/old configurations or init scripts","114","     * The very last milestone","115","     *"]}]}},"288b8d0b01f92072d0b86efb898c011f31a7fc30":{"changes":{"changelog.html":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/AbstractMavenProcessFactory.java":"MODIFY"},"diff":{"changelog.html":[{"add":["63","  <li class='major bug'>","64","    Since 1.520, Jenkins requires Java 6 or later, breaking Maven builds set to use JDK 5. Now falls back to JVM of slave agent but sets compile\/test flags to use defined JDK.","65","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18403\">issue 18403<\/a>)"],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/AbstractMavenProcessFactory.java":[{"add":["31","import java.io.File;","227","            JDK jdk = getJava(listener);","228","            JDK originalJdk = null;","229","            JDK: while (true) {","230","            final Acceptor acceptor = launcher.getChannel().call(new SocketHandler());","231","            final ArgumentListBuilder cmdLine = buildMavenAgentCmdLine(listener, acceptor.getPort(), jdk);","250","            try {","251","                ch.call(new ConfigureOriginalJDK(originalJdk));","252","            } catch (IOException x) {","253","                if (originalJdk == null) { \/\/ so we only try this once","254","                    for (Throwable t = x; t != null; t = t.getCause()) {","255","                        if (t instanceof UnsupportedClassVersionError) {","256","                            listener.error(\"[JENKINS-18403] JDK 5 not supported to run Maven; retrying with slave Java and setting compile\/test properties to point to \" + jdk.getHome());","257","                            originalJdk = jdk;","258","                            jdk = launcher.getChannel().call(new FindJavaHome());","259","                            continue JDK;","260","                        }","261","                    }","262","                }","263","                throw x;","264","            }","270","            }","282","    \/** Verifies that the channel is open and functioning, and (if the second time around) sets properties for the original JDK. *\/","283","    private static final class ConfigureOriginalJDK implements Callable<Void,Error> {","284","        private static final long serialVersionUID = 1;","285","        private final JDK jdk;","286","        ConfigureOriginalJDK(JDK jdk) {","287","            this.jdk = jdk;","288","        }","289","        @Override public Void call() throws Error {","290","            if (jdk != null) {","291","                System.setProperty(\"maven.compiler.fork\", \"true\");","292","                System.setProperty(\"maven.compiler.executable\", new File(jdk.getBinDir(), File.separatorChar == '\\\\' ? \"javac.exe\" : \"javac\").getAbsolutePath());","293","                \/\/ For Surefire, in case it is set to fork (we cannot unconditionally override forkMode):","294","                System.setProperty(\"jvm\", new File(jdk.getBinDir(), File.separatorChar == '\\\\' ? \"java.exe\" : \"java\").getAbsolutePath());","295","            }","296","            return null;","297","        }","298","    }","299","","300","    \/** Locates JRE this slave agent is running on, or null. *\/","301","    private static final class FindJavaHome implements Callable<JDK,Error> {","302","        private static final long serialVersionUID = 1;","303","        @Override public JDK call() throws Error {","304","            JDK jdk = new JDK(\"this\", System.getProperty(\"java.home\"));","305","            return jdk.getExists() ? jdk : \/* i.e. just run \"java\" and hope for the best *\/null;","306","        }","307","    }","308","","325","        return buildMavenAgentCmdLine(listener, tcpPort, getJava(listener));","326","    }","327","","328","    private ArgumentListBuilder buildMavenAgentCmdLine(BuildListener listener, int tcpPort, JDK jdk) throws IOException, InterruptedException {"],"delete":["213","            final Acceptor acceptor = launcher.getChannel().call(new SocketHandler());","227","            final ArgumentListBuilder cmdLine = buildMavenAgentCmdLine( listener,acceptor.getPort());","294","        JDK jdk = getJava(listener);"]}]}},"f258aff7a736a81306ecb7d3c56cacc9b3a09a68":{"changes":{"core\/src\/main\/java\/hudson\/model\/WorkspaceCleanupThread.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/WorkspaceCleanupThread.java":[{"add":["141","        \/\/ TODO this may only check the last build in fact:","142","        if (item instanceof Job<?,?>) {","143","            Job<?,?> j = (Job<?,?>) item;","144","            if (j.isBuilding()) {","145","                LOGGER.log(Level.FINE, \"Job {0} is building, so not deleting\", item.getFullDisplayName());","146","                return false;","147","            }","148","        }","149",""],"delete":[]}]}},"83671af504197f031c1e89a5122a1d4168288bb4":{"changes":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["4131","        if (rsp != null) {","4132","            rsp.sendRedirect2(\".\");","4133","        }"],"delete":["4131","        rsp.sendRedirect2(\".\");"]}]}},"0908fd4424c59435182a286b25e140d533e69526":{"changes":{"core\/src\/main\/resources\/hudson\/tasks\/test\/MatrixTestResult\/index.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/tasks\/test\/MatrixTestResult\/index.jelly":[{"add":["45","            <td data=\"${report.result.duration}\" class=\"pane\" style=\"text-align:right\">"],"delete":["45","            <td class=\"pane\" style=\"text-align:right;\">"]}]}},"3e344a94a9eed316d0c351becb08287b473b6521":{"changes":{"test\/src\/test\/java\/hudson\/model\/QueueTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/Queue.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/QueueTest.java":[{"add":["347","    ","348","    @Issue(\"JENKINS-10944\")","349","    @Test public void flyweightTasksBlockedByShutdown() throws Exception {","350","        r.jenkins.doQuietDown(true, 0);","351","        AtomicInteger cnt = new AtomicInteger();","352","        TestFlyweightTask task = new TestFlyweightTask(cnt, null);","353","        assertTrue(Queue.isBlockedByShutdown(task));","354","        r.jenkins.getQueue().schedule2(task, 0);","355","        r.jenkins.getQueue().maintain();","356","        r.jenkins.doCancelQuietDown();","357","        assertFalse(Queue.isBlockedByShutdown(task));","358","        r.waitUntilNoActivity();","359","        assertEquals(1, cnt.get());","360","        assert task.exec instanceof OneOffExecutor : task.exec;","361","    }","362","","363","    @Issue(\"JENKINS-24519\")","364","    @Test public void flyweightTasksBlockedBySlave() throws Exception {","365","        Label label = Label.get(\"myslave\");","366","        AtomicInteger cnt = new AtomicInteger();","367","        TestFlyweightTask task = new TestFlyweightTask(cnt, label);","368","        r.jenkins.getQueue().schedule2(task, 0);","369","        r.jenkins.getQueue().maintain();","370","        r.createSlave(label);","371","        r.waitUntilNoActivity();","372","        assertEquals(1, cnt.get());","373","        assert task.exec instanceof OneOffExecutor : task.exec;","374","    }","375","","376","    private static class TestFlyweightTask extends TestTask implements Queue.FlyweightTask {","377","        Executor exec;","378","        private final Label assignedLabel;","379","        TestFlyweightTask(AtomicInteger cnt, Label assignedLabel) {","380","            super(cnt);","381","            this.assignedLabel = assignedLabel;","382","        }","383","        @Override protected void doRun() {","384","            exec = Executor.currentExecutor();","385","        }","386","        @Override public Label getAssignedLabel() {","387","            return assignedLabel;","388","        }","389","    }","401","    private static class TestTask extends AbstractQueueTask {","424","        protected void doRun() {}","430","                    doRun();"],"delete":["358","    private static final class TestTask extends AbstractQueueTask {"]}],"core\/src\/main\/java\/hudson\/model\/Queue.java":[{"add":["1099","                    Runnable r = makeBuildable(new BuildableItem(p));","1100","                    if (r != null) {","1101","                        p.leave(this);","1102","                        r.run();","1103","                    }","1119","                Runnable r = makeBuildable(new BuildableItem(top));","1120","                if (r != null) {","1121","                    r.run();","1122","                } else {","1123","                    new BlockedItem(top).enter(this);","1124","                }","1173","    \/**","1174","     * Tries to make an item ready to build.","1175","     * @param p a proposed buildable item","1176","     * @return a thunk to actually prepare it (after leaving an earlier list), or null if it cannot be run now","1177","     *\/","1178","    private @CheckForNull Runnable makeBuildable(final BuildableItem p) {","1179","        if (p.task instanceof FlyweightTask) {","1180","            if (!isBlockedByShutdown(p.task)) {","1196","                final Computer c = n.toComputer();","1200","                return new Runnable() {","1201","                    @Override public void run() {","1202","                        c.startFlyWeightTask(new WorkUnitContext(p).createWorkUnit(p.task));","1203","                        makePending(p);","1204","                    }","1205","                };","1206","            }","1209","            return null;","1210","        } else { \/\/ regular heavyweight task","1211","            return new Runnable() {","1212","                @Override public void run() {","1213","                    p.enter(Queue.this);","1214","                }","1215","            };"],"delete":["108","import jenkins.security.QueueItemAuthenticatorConfiguration;","1100","                    p.leave(this);","1101","                    makeBuildable(new BuildableItem(p));","1117","                makeBuildable(new BuildableItem(top));","1166","    private void makeBuildable(BuildableItem p) {","1167","        if (p.task instanceof FlyweightTask && !isBlockedByShutdown(p.task)) {","1168","","1169","","1185","                Computer c = n.toComputer();","1189","                c.startFlyWeightTask(new WorkUnitContext(p).createWorkUnit(p.task));","1190","                makePending(p);","1191","                return;","1194","            \/\/ so do the scheduling like other normal jobs.","1196","","1197","        p.enter(this);"]}]}},"e7eec1cbe60067871689871f12a56d496abe60a2":{"changes":{"core\/src\/test\/java\/jenkins\/util\/UrlHelperTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/org\/apache\/commons\/validator\/routines\/DomainValidator.java":"MODIFY","core\/src\/main\/java\/jenkins\/util\/UrlHelper.java":"MODIFY"},"diff":{"core\/src\/test\/java\/jenkins\/util\/UrlHelperTest.java":[{"add":["11","    @Issue(\"JENKINS-31661\")","14","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/www.google.com\/\"));","20","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/localhost:8080\/jenkins\/\"));","44","    ","45","    @Test","46","    @Issue(\"JENKINS-51064\")","47","    public void isAlsoValid() {","48","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/my-server:8080\/jenkins\"));","49","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/jenkins.internal\/\"));","50","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/jenkins.otherDomain\/\"));","51","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/my-server.domain:8080\/jenkins\"));","52","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/my-ser_ver.do_m-ain:8080\/jenkins\"));","53","        assertTrue(UrlHelper.isValidRootUrl(\"http:\/\/my-ser_ver.do_m-ain:8080\/jenkins\"));","54","    ","55","        \/\/ forbidden to start or end domain with - or .","56","        assertFalse(UrlHelper.isValidRootUrl(\"http:\/\/-jenkins.com\"));","57","        assertFalse(UrlHelper.isValidRootUrl(\"http:\/\/jenkins.com-\"));","58","        assertFalse(UrlHelper.isValidRootUrl(\"http:\/\/.jenkins.com\"));","59","        assertFalse(UrlHelper.isValidRootUrl(\"http:\/\/jenkins.com.\"));","60","    ","61","        \/\/ forbidden to have multiple dots in chain","62","        assertFalse(UrlHelper.isValidRootUrl(\"http:\/\/jen..kins.com\"));","63","    }","64","}"],"delete":["8","@Issue(\"JENKINS-31661\")","42","","43","}"]}],"core\/src\/main\/java\/jenkins\/org\/apache\/commons\/validator\/routines\/DomainValidator.java":[{"add":["2004","    \/\/[PATCH]","2005","    public","2006","    \/\/ end of [PATCH]"],"delete":[]}],"core\/src\/main\/java\/jenkins\/util\/UrlHelper.java":[{"add":["25","import jenkins.org.apache.commons.validator.routines.DomainValidator;","32","    \/**","33","     * Authorize the {@code _} and {@code -} characters in domain","34","     * <p>","35","     * Avoid {@code -} and {@code .} to be first or last","36","     *\/","37","    private static String DOMAIN_REGEX = System.getProperty(","38","            UrlHelper.class.getName() + \".DOMAIN_REGEX\", ","39","            \"(\\\\w(\\\\.?-?\\\\w+)*)(:\\\\d{1,5})?\"","40","    );","41","    ","43","        UrlValidator validator = new CustomUrlValidator();","44","        return validator.isValid(url);","45","    }","46","    ","47","    private static class CustomUrlValidator extends UrlValidator {","48","        private CustomUrlValidator() {","49","            super(new String[]{\"http\", \"https\"}, UrlValidator.ALLOW_LOCAL_URLS + UrlValidator.NO_FRAGMENTS);","52","        @Override ","53","        protected boolean isValidAuthority(String authority) {","54","            \/\/ to support ipv6","55","            boolean superResult = super.isValidAuthority(authority);","56","            if(!superResult && authority == null){","57","                return false;","58","            }","59","            String authorityASCII = DomainValidator.unicodeToASCII(authority);","60","            return authorityASCII.matches(DOMAIN_REGEX);","61","        }"],"delete":["29","import java.net.MalformedURLException;","30","import java.net.URL;","31","","35","        String[] schemes = {\"http\", \"https\"};","36","        \/\/ option to accept url like http:\/\/localhost or http:\/\/SERVER_JENKINS that are often used inside company's network","37","        UrlValidator validator = new UrlValidator(schemes, UrlValidator.ALLOW_LOCAL_URLS + UrlValidator.NO_FRAGMENTS);","38","        boolean isValid = validator.isValid(url);","39","        if (!isValid) {","40","            \/\/ potentially it contains _'s in hostname which seems accepted but not by the UrlValidator","41","            \/\/ https:\/\/issues.apache.org\/jira\/browse\/VALIDATOR-358","42","            try {","43","                URL urlObject = new URL(url);","44","                String host = urlObject.getHost();","45","                if (host.contains(\"_\")) {","46","                    String hostWithoutUnderscore = host.replace(\"_\", \"\");","47","                    String modifiedUrl = url.replace(host, hostWithoutUnderscore);","48","                    isValid = validator.isValid(modifiedUrl);","49","                }","50","            } catch (MalformedURLException e) {","51","                return false;","52","            }","55","        return isValid;"]}]}},"58e1228c99fd3d5063b0967d7780dc536bc2c463":{"changes":{"core\/src\/main\/java\/hudson\/slaves\/ComputerListener.java":"MODIFY","test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":"MODIFY","core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/slaves\/ComputerListener.java":[{"add":["145","     *      This is connected to the launch log of the computer or Jenkins master."],"delete":["145","     *      This is connected to the launch log of the computer."]}],"test\/src\/test\/java\/jenkins\/model\/JenkinsTest.java":[{"add":["44","import hudson.model.Computer;","54","import hudson.model.TaskListener;","74","import java.io.IOException;","457","","458","    @Test","459","    @Issue(\"JENKINS-38487\")","460","    public void startupShouldNotFailOnFailingOnlineListener() {","461","        \/\/ We do nothing, FailingOnOnlineListener & JenkinsRule should cause the ","462","        \/\/ boot failure if the issue is not fixed.","463","    }","464","","465","    @TestExtension(value = \"startupShouldNotFailOnFailingOnlineListener\")","466","    public static final class FailingOnOnlineListener extends ComputerListener {","467","        ","468","        @Override","469","        public void onOnline(Computer c, TaskListener listener) throws IOException, InterruptedException {","470","            throw new IOException(\"Something happened (the listener always throws this exception)\");","471","        }","472","    }"],"delete":[]}],"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["960","            {\/\/ master is online now, it's instance must always exist","961","                final Computer c = toComputer();","962","                if(c != null) {","963","                    for (ComputerListener cl : ComputerListener.all()) {","964","                        try {","965","                            cl.onOnline(c, new LogTaskListener(LOGGER, INFO));","966","                        } catch (Throwable t) {","967","                            if (t instanceof Error) {","968","                                \/\/ We propagate Runtime errors, because they are fatal.","969","                                throw t;","970","                            }","971","","972","                            \/\/ Other exceptions should be logged instead of failing the Jenkins startup (See listener's Javadoc)","973","                            \/\/ We also throw it for InterruptedException since it's what is expected according to the javadoc","974","                            LOGGER.log(SEVERE, String.format(\"Invocation of the computer listener %s failed for the Jenkins master node\",","975","                                    cl.getClass()), t);","976","                        }","977","                    }","978","                }"],"delete":["960","            {\/\/ master is online now","961","                Computer c = toComputer();","962","                if(c!=null)","963","                    for (ComputerListener cl : ComputerListener.all())","964","                        cl.onOnline(c, new LogTaskListener(LOGGER, INFO));"]}]}},"608c69fc20a5399230da62560ba5cfe6149ad0c7":{"changes":{"core\/src\/main\/java\/hudson\/ClassicPluginStrategy.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/ClassicPluginStrategy.java":[{"add":["164","                \/\/ some earlier versions of maven-hpi-plugin apparently puts \"null\" as a literal here. Watch out for those.","165","                (hudsonVersion == null || hudsonVersion.equals(\"null\") || hudsonVersion.compareTo(\"1.296\") <= 0)) {"],"delete":["164","                (hudsonVersion == null || hudsonVersion.compareTo(\"1.296\") <= 0)) {"]}]}},"1205e9f6c492c53983a7f02926a53739b50b92fd":{"changes":{"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY","changelog.html":"MODIFY","test\/src\/main\/java\/org\/jvnet\/hudson\/test\/MockFolder.java":"MODIFY"},"diff":{"test\/src\/test\/java\/hudson\/model\/AbstractProjectTest.java":[{"add":["387","    @Bug(17575)","394","        MockFolder d = Jenkins.getInstance().createProject(MockFolder.class, \"d\");","395","        d.addView(new AllView(\"v2\"));","396","        d.createProject(FreeStyleProject.class, \"j3\");","397","        d.createProject(FreeStyleProject.class, \"j4\");","398","        d.createProject(FreeStyleProject.class, \"j5\");","399","        assertEquals(\"job\/d\/\", deleteRedirectTarget(\"job\/d\/job\/j3\"));","400","        assertEquals(\"job\/d\/view\/v2\/\", deleteRedirectTarget(\"job\/d\/view\/v2\/job\/j4\"));","401","        assertEquals(\"view\/v1\/job\/d\/\", deleteRedirectTarget(\"view\/v1\/job\/d\/job\/j5\"));"],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["97","import org.kohsuke.stapler.Ancestor;","120","import java.util.ListIterator;","1884","        List<Ancestor> ancestors = req.getAncestors();","1885","        ListIterator<Ancestor> it = ancestors.listIterator(ancestors.size());","1886","        String url = getParent().getUrl(); \/\/ fallback but we ought to get to Jenkins.instance at the root","1887","        while (it.hasPrevious()) {","1888","            Object a = it.previous().getObject();","1889","            if (a instanceof View) {","1890","                url = ((View) a).getUrl();","1891","                break;","1892","            } else if (a instanceof ViewGroup) {","1893","                url = ((ViewGroup) a).getUrl();","1894","                break;","1895","            }","1896","        }","1897","        rsp.sendRedirect2(req.getContextPath() + '\/' + url);"],"delete":["1882","        View view = req.findAncestorObject(View.class);","1883","        if (view == null)","1884","            rsp.sendRedirect2(req.getContextPath() + '\/' + getParent().getUrl());","1885","        else ","1886","            rsp.sendRedirect2(req.getContextPath() + '\/' + view.getUrl());"]}],"changelog.html":[{"add":["67","    Incorrect redirection after delete of job in folder in view.","68","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-17575\">issue 17575<\/a>)","69","  <li class=bug>"],"delete":[]}],"test\/src\/main\/java\/org\/jvnet\/hudson\/test\/MockFolder.java":[{"add":["28","import hudson.model.Action;","29","import hudson.model.AllView;","31","import hudson.model.Hudson;","38","import hudson.model.View;","39","import hudson.model.ViewGroup;","40","import hudson.model.ViewGroupMixIn;","42","import hudson.views.DefaultViewsTabBar;","43","import hudson.views.ViewsTabBar;","47","import java.util.ArrayList;","49","import java.util.Collections;","51","import java.util.List;","58","import org.kohsuke.stapler.StaplerFallback;","61","import org.kohsuke.stapler.WebMethod;","69","public class MockFolder extends AbstractItem implements ModifiableTopLevelItemGroup, TopLevelItem, ViewGroup, StaplerFallback {","72","    private final List<View> views = new ArrayList<View>(Collections.singleton(new AllView(\"All\", this)));","73","    private String primaryView;","74","    private ViewsTabBar viewsTabBar;","120","    private ViewGroupMixIn vgmixin() {","121","        return new ViewGroupMixIn(this) {","122","            @Override protected List<View> views() {","123","                return views;","124","            }","125","            @Override protected String primaryView() {","126","                return primaryView != null ? primaryView : views.get(0).getViewName();","127","            }","128","            @Override protected void primaryView(String newName) {","129","                primaryView = newName;","130","            }","131","        };","132","    }","133","","177","    public void addView(View view) throws IOException {","178","        vgmixin().addView(view);","179","    }","180","","181","    @Override public boolean canDelete(View view) {","182","        return vgmixin().canDelete(view);","183","    }","184","","185","    @Override public void deleteView(View view) throws IOException {","186","        vgmixin().deleteView(view);","187","    }","188","","189","    @Override public Collection<View> getViews() {","190","        return vgmixin().getViews();","191","    }","192","","193","    @Override public View getView(String name) {","194","        return vgmixin().getView(name);","195","    }","196","","197","    @Override public View getPrimaryView() {","198","        return vgmixin().getPrimaryView();","199","    }","200","","201","    @Override public void onViewRenamed(View view, String oldName, String newName) {","202","        vgmixin().onViewRenamed(view, oldName, newName);","203","    }","204","","205","    @Override public ViewsTabBar getViewsTabBar() {","206","        if (viewsTabBar == null) {","207","            viewsTabBar = new DefaultViewsTabBar();","208","        }","209","        return viewsTabBar;","210","    }","211","","212","    @Override public ItemGroup<? extends TopLevelItem> getItemGroup() {","213","        return this;","214","    }","215","","216","    @Override public List<Action> getViewActions() {","217","        \/\/ XXX what should the default be? View.getOwnerViewActions uses Jenkins.actions; Jenkins.viewActions would make more sense as a default;","218","        \/\/ or should it be empty by default since non-top-level folders probably do not need the same actions as root?","219","        return Collections.emptyList();","220","    }","221","","222","    @Override public Object getStaplerFallback() {","223","        return getPrimaryView();","224","    }","225","","226","    \/**","227","     * Same as {@link #getItem} but named this way as a {@link WebMethod}.","228","     * @see Hudson#getJob","229","     *\/","230","    public TopLevelItem getJob(String name) {","231","        return getItem(name);","232","    }","233",""],"delete":["56","public class MockFolder extends AbstractItem implements ModifiableTopLevelItemGroup, TopLevelItem { \/\/ could be a ViewGroup too"]}]}},"527c5935fd95bd0238a284314bd3487be0c9a0a7":{"changes":{"core\/src\/main\/resources\/hudson\/diagnosis\/HudsonHomeDiskUsageMonitor\/index.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/diagnosis\/HudsonHomeDiskUsageMonitor\/index.properties":[{"add":["25","  When this directory completely fills up, it will wreak havoc because Jenkins cannot store any more data."],"delete":["25","  When this directory completely fills up, it\\'ll wreak havoc because Jenkins can\\'t store any more data."]}]}},"e81a9076c414eda983559f17aa8f0c38b8a89b09":{"changes":{"core\/src\/main\/java\/hudson\/model\/AbstractItem.java":"MODIFY","core\/src\/main\/java\/hudson\/model\/AbstractProject.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/AbstractItem.java":[{"add":["184","        ItemListener.fireOnUpdated(this);","186","        "],"delete":[]}],"core\/src\/main\/java\/hudson\/model\/AbstractProject.java":[{"add":["55","import hudson.model.listeners.ItemListener;","705","        ItemListener.fireOnUpdated(this);"],"delete":[]}]}},"b1c7e2ae76fefe56650f0817865b49c8ea249877":{"changes":{"core\/src\/main\/resources\/lib\/hudson\/executors_sv_SE.properties":"MODIFY","core\/src\/main\/resources\/lib\/hudson\/queue_sv_SE.properties":"MODIFY","core\/src\/main\/resources\/hudson\/model\/View\/sidepanel_sv_SE.properties":"MODIFY"},"diff":{"core\/src\/main\/resources\/lib\/hudson\/executors_sv_SE.properties":[{"add":["26","Unknown\\ Task=Ok\\u00E4nd uppgift"],"delete":["26","Unknown\\ Task=\\u00D6kand uppgift"]}],"core\/src\/main\/resources\/lib\/hudson\/queue_sv_SE.properties":[{"add":["25","Unknown\\ Task=Ok\\u00E4nd uppgift"],"delete":["25","Unknown\\ Task=\\u00D6kand uppgift"]}],"core\/src\/main\/resources\/hudson\/model\/View\/sidepanel_sv_SE.properties":[{"add":["28","Project\\ Relationship=Jobberoenden"],"delete":["28","Project\\ Relationship=Jobbberoenden"]}]}},"ae354a961a7cb0016642e9fb9c9a9d5446efb887":{"changes":{"core\/src\/main\/java\/hudson\/model\/Run.java":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/Run.java":[{"add":["656","        \/\/ in certain situations (aborted m2 builds) r.getResult() can still be null, although it should theoretically never happen","657","        while( r!=null && (r.getResult() == null || r.getResult()==Result.NOT_BUILT) )"],"delete":["656","        while( r!=null && r.getResult()==Result.NOT_BUILT )"]}]}},"56969828cd9814e1063c8a203349541b9f0c0f29":{"changes":{"core\/src\/main\/java\/hudson\/model\/ParametersDefinitionProperty.java":"MODIFY","changelog.html":"MODIFY","core\/src\/main\/resources\/hudson\/model\/ParametersDefinitionProperty\/index.jelly":"MODIFY"},"diff":{"core\/src\/main\/java\/hudson\/model\/ParametersDefinitionProperty.java":[{"add":["36","import hudson.Util;","143","        if (item!=null) {","144","            String url = formData.optString(\"redirectTo\");","145","            if (url==null || Util.isAbsoluteUri(url))   \/\/ avoid open redirect","146","                url = req.getContextPath()+'\/'+item.getUrl();","147","            rsp.sendRedirect(formData.optInt(\"statusCode\",SC_CREATED), url);","148","        } else"],"delete":["142","        if (item!=null)","143","            rsp.sendRedirect(SC_CREATED,req.getContextPath()+'\/'+item.getUrl());","144","        else"]}],"changelog.html":[{"add":["58","    Build with parameters returns empty web page","59","    (<a href=\"https:\/\/issues.jenkins-ci.org\/browse\/JENKINS-18425\">issue 18425<\/a>)","60","  <li class=bug>"],"delete":[]}],"core\/src\/main\/resources\/hudson\/model\/ParametersDefinitionProperty\/index.jelly":[{"add":["53","          <!--","54","            When used from the UI, use 303 redirect and send back to the job top page.","55","            When neither of those options are given, we'll report \"201 Created\".","56","","57","            We can't use XHR for submitting this as there might be file parameters,","58","            and submitting to IFRAME won't work either because 201 can't have HTML response.","59","","60","            So I think all we can do is this somewhat clunky workaround.","61","           -->","62","          <input type=\"hidden\" name=\"statusCode\" value=\"303\" \/>","63","          <input type=\"hidden\" name=\"redirectTo\" value=\".\" \/>"],"delete":[]}]}},"5600aa9b44c887ad634a16aa80b6119c3a158cd0":{"changes":{"maven-plugin\/src\/main\/java\/hudson\/maven\/AbstractMavenBuild.java":"MODIFY","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":"MODIFY","test\/src\/test\/resources\/hudson\/tasks\/maven-test-failure.zip":"ADD","test\/src\/test\/java\/hudson\/tasks\/BuildTriggerTest.java":"MODIFY","test\/src\/test\/resources\/hudson\/tasks\/maven-empty.zip":"ADD","maven-plugin\/src\/main\/java\/hudson\/maven\/MavenBuild.java":"MODIFY"},"diff":{"maven-plugin\/src\/main\/java\/hudson\/maven\/AbstractMavenBuild.java":[{"add":["34","import hudson.tasks.BuildTrigger;","44","     * Extra verbose debug switch.","62","     * Returns immediately if build result doesn't meet the required level","63","     * (as specified by {@link BuildTrigger}, or {@link Result#SUCCESS} if none).","69","        BuildTrigger bt = getParent().getPublishersList().get(BuildTrigger.class);","70","        if (getResult().isWorseThan(bt!=null ? bt.getThreshold() : Result.SUCCESS)) return;","71",""],"delete":["43","     * Extra versbose debug switch."]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenModuleSetBuild.java":[{"add":["236","    @Override","611","                scheduleDownstreamBuilds(listener);","661","            @Override","685","        @Override","774","        @Override"],"delete":["610","                if(getResult().isBetterOrEqualTo(Result.SUCCESS)) {","611","                \tscheduleDownstreamBuilds(listener);","612","                }"]}],"test\/src\/test\/resources\/hudson\/tasks\/maven-test-failure.zip":[{"add":[],"delete":[]}],"test\/src\/test\/java\/hudson\/tasks\/BuildTriggerTest.java":[{"add":["27","import hudson.maven.MavenModuleSet;","28","import hudson.maven.MavenModuleSetBuild;","30","import hudson.model.FreeStyleProject;","32","import hudson.model.Run;","33","import org.jvnet.hudson.test.ExtractResourceSCM;","42","","43","    private FreeStyleProject createDownstreamProject() throws Exception {","44","        FreeStyleProject dp = createFreeStyleProject(\"downstream\");","55","        return dp;","56","    }","57","","58","    private void doTriggerTest(boolean evenWhenUnstable, Result triggerResult,","59","            Result dontTriggerResult) throws Exception {","60","        FreeStyleProject p = createFreeStyleProject(),","61","                dp = createDownstreamProject();","62","        p.getPublishersList().add(new BuildTrigger(\"downstream\", evenWhenUnstable));","63","        p.getBuildersList().add(new MockBuilder(dontTriggerResult));","64","        hudson.rebuildDependencyGraph();","65","","67","        Build b = p.scheduleBuild2(0).get();","68","        assertNoDownstreamBuild(dp, b);","69","","70","        \/\/ Next build should trigger downstream job","71","        p.getBuildersList().replace(new MockBuilder(triggerResult));","72","        b = p.scheduleBuild2(0).get();","73","        assertDownstreamBuild(dp, b);","74","    }","75","","76","    private void assertNoDownstreamBuild(FreeStyleProject dp, Run b) throws Exception {","82","    }","84","    private void assertDownstreamBuild(FreeStyleProject dp, Run b) throws Exception {","97","","98","    private void doMavenTriggerTest(boolean evenWhenUnstable) throws Exception {","99","        FreeStyleProject dp = createDownstreamProject();","100","        configureDefaultMaven();","101","        MavenModuleSet m = createMavenProject();","102","        m.getPublishersList().add(new BuildTrigger(\"downstream\", evenWhenUnstable));","103","        if (!evenWhenUnstable) {","104","            \/\/ Configure for UNSTABLE","105","            m.setGoals(\"clean test\");","106","            m.setScm(new ExtractResourceSCM(getClass().getResource(\"maven-test-failure.zip\")));","107","        } \/\/ otherwise do nothing which gets FAILURE","108","        \/\/ First build should not trigger downstream project","109","        MavenModuleSetBuild b = m.scheduleBuild2(0).get();","110","        assertNoDownstreamBuild(dp, b);","111","","112","        if (evenWhenUnstable) {","113","            \/\/ Configure for UNSTABLE","114","            m.setGoals(\"clean test\");","115","            m.setScm(new ExtractResourceSCM(getClass().getResource(\"maven-test-failure.zip\")));","116","        } else {","117","            \/\/ Configure for SUCCESS","118","            m.setGoals(\"clean\");","119","            m.setScm(new ExtractResourceSCM(getClass().getResource(\"maven-empty.zip\")));","120","        }","121","        \/\/ Next build should trigger downstream project","122","        b = m.scheduleBuild2(0).get();","123","        assertDownstreamBuild(dp, b);","124","    }","125","","126","    public void testMavenBuildTrigger() throws Exception {","127","        doMavenTriggerTest(false);","128","    }","129","","130","    public void testMavenTriggerEvenWhenUnstable() throws Exception {","131","        doMavenTriggerTest(true);","132","    }"],"delete":["28","import hudson.model.Project;","38","    private void doTriggerTest(boolean evenWhenUnstable, Result triggerResult,","39","            Result dontTriggerResult) throws Exception {","40","        Project p = createFreeStyleProject(),","41","                dp = createFreeStyleProject(\"downstream\");","42","        p.getPublishersList().add(new BuildTrigger(\"downstream\", evenWhenUnstable));","43","        p.getBuildersList().add(new MockBuilder(dontTriggerResult));","44","        hudson.rebuildDependencyGraph();","56","        Build b = (Build)p.scheduleBuild2(0).get();","63","        \/\/ Next build should trigger downstream job","64","        p.getBuildersList().replace(new MockBuilder(triggerResult));","65","        b = (Build)p.scheduleBuild2(0).get();"]}],"test\/src\/test\/resources\/hudson\/tasks\/maven-empty.zip":[{"add":[],"delete":[]}],"maven-plugin\/src\/main\/java\/hudson\/maven\/MavenBuild.java":[{"add":["228","    @Override","258","            @Override","551","        @Override","553","            scheduleDownstreamBuilds(listener);"],"delete":["550","            if(getResult().isBetterOrEqualTo(Result.SUCCESS))","551","                scheduleDownstreamBuilds(listener);"]}]}},"5ba9bf4417a9de253d8af5471adfcc9baa4d1d3d":{"changes":{"core\/src\/main\/java\/jenkins\/diagnostics\/ooom\/BuildPtr.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/diagnostics\/ooom\/BuildPtr.java":[{"add":["91","        listener.getLogger().println(\"Renaming \"+buildDir);"],"delete":["91","        listener.getLogger().println(\"Renaming \"+dir);"]}]}},"a523a30fef3465b422c70bdb1551869d3410bf6a":{"changes":{"core\/src\/main\/resources\/hudson\/model\/Slave\/ComputerImpl\/slave-agent.jnlp.jelly":"MODIFY"},"diff":{"core\/src\/main\/resources\/hudson\/model\/Slave\/ComputerImpl\/slave-agent.jnlp.jelly":[{"add":["33","        <argument>${app.secretKey}<\/argument>"],"delete":["33","        <argument>${app.tcpSlaveAgentListener.secretKey}<\/argument>"]}]}},"42734675f4825e4856f67945981ce44d2190dbd6":{"changes":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":"MODIFY","test\/src\/test\/java\/hudson\/model\/labels\/LabelExpressionTest.java":"MODIFY"},"diff":{"core\/src\/main\/java\/jenkins\/model\/Jenkins.java":[{"add":["1572","        expr = hudson.util.QuotedStringTokenizer.unquote(expr);"],"delete":[]}],"test\/src\/test\/java\/hudson\/model\/labels\/LabelExpressionTest.java":[{"add":["198","        ","199","        l = jenkins.getLabel(\"label1||label2\"); \/\/ create label expression","200","        l = jenkins.getLabel(\"\\\"label1||label2\\\"\");","201","        assertEquals(\"label1||label2\",l.getName());"],"delete":[]}]}}}